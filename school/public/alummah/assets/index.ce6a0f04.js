var L=(o,r,t)=>new Promise((n,e)=>{var s=i=>{try{p(t.next(i))}catch(f){e(f)}},a=i=>{try{p(t.throw(i))}catch(f){e(f)}},p=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,a);p((t=t.apply(o,r)).next())});import{c as _,r as E,a as v,b as y,d as R,_ as T,e as O,f as S,g as I,o as A,h as j,s as k,i as w,B as V,j as b}from"./vendor.706533f0.js";const D=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=t(e);fetch(e.href,s)}};D();const N="modulepreload",P={},H="/assets/school/alummah/",c=function(r,t){return!t||t.length===0?r():Promise.all(t.map(n=>{if(n=`${H}${n}`,n in P)return;P[n]=!0;const e=n.endsWith(".css"),s=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${s}`))return;const a=document.createElement("link");if(a.rel=e?"stylesheet":N,e||(a.as="script",a.crossOrigin=""),a.href=n,document.head.appendChild(a),e)return new Promise((p,i)=>{a.addEventListener("load",p),a.addEventListener("error",i)})})).then(()=>r())},g=_({url:"frappe.auth.get_logged_user",cache:"User",onError(o){o&&o.exc_type==="AuthenticationError"&&l.push({name:"LoginPage"})}});function h(){let r=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return r==="Guest"&&(r=null),r}let u="";const m=E({login:_({url:"school.al_ummah.api2.login",makeParams({email:o,password:r,role:t}){return{usr:o,pwd:r,role:t||"System User"}},onSuccess(o){if(console.log("Login successful:",o),o&&o.status==="success"){g.reload(),m.user=h(),m.login.reset();const r=u==="parent"?"Parenthome":"Teacherhome";console.log("Redirecting based on selected role:",u,"\u2192",r),l.replace({name:r})}else l.replace(o.default_route||"/")},onError(o){console.error("Login failed:",o),alert("Login failed. Please check your credentials and try again.")}}),logout:_({url:"logout",onSuccess(){g.reset(),m.user=h(),u="",l.replace({name:"Login"})},onError(o){console.error("Logout failed:",o),m.user=null,u="",l.replace({name:"Login"})}}),user:h(),isLoggedIn:v(()=>!!m.user)});function x(o){u=o}const B=[{path:"/",name:"Home",component:()=>c(()=>import("./Home.5f604afa.js"),["assets/Home.5f604afa.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"Login",path:"/account/login",component:()=>c(()=>import("./Login.83b88e2a.js"),["assets/Login.83b88e2a.js","assets/Login.897882ce.css","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"Teacherhome",path:"/teacher/home",component:()=>c(()=>import("./TeacherHome.11d705df.js"),["assets/TeacherHome.11d705df.js","assets/TeacherHome.9a853810.css","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"Parenthome",path:"/parent/home",component:()=>c(()=>import("./ParentHome.10e7553c.js"),["assets/ParentHome.10e7553c.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"ForgotPassword",path:"/forgot-password",component:()=>c(()=>import("./ForgotPassword.10774479.js"),["assets/ForgotPassword.10774479.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"OTPLogin",path:"/otp-login",component:()=>c(()=>import("./OTPLogin.989d51a7.js"),["assets/OTPLogin.989d51a7.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"SignInScreen",path:"/google-signin",component:()=>c(()=>import("./SignInScreen.27e07e4f.js"),["assets/SignInScreen.27e07e4f.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"TeacherSignup",path:"/teacher/signup",component:()=>c(()=>import("./TeacherSignup.ef4ccc3d.js"),["assets/TeacherSignup.ef4ccc3d.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])},{name:"ParentSignup",path:"/parent/signup",component:()=>c(()=>import("./ParentSignup.99fb2a90.js"),["assets/ParentSignup.99fb2a90.js","assets/vendor.706533f0.js","assets/vendor.1f7d581e.css"])}],l=y({history:R("/alummah"),routes:B});l.beforeEach((o,r,t)=>L(void 0,null,function*(){let n=m.isLoggedIn;try{yield g.promise}catch(e){n=!1}o.name==="Login"&&n?t({name:u==="parent"?"Parenthome":"Teacherhome"}):o.name!=="Login"&&!n?t({name:"Login"}):o.name==="Home"&&n?t({name:u==="parent"?"Parenthome":"Teacherhome"}):t()}));const U={};function C(o,r){const t=I("router-view");return A(),O("div",null,[S(t)])}var F=T(U,[["render",C]]);let d=j(F);k("resourceFetcher",b);d.use(l);d.use(w);d.component("Button",V);d.mount("#app");export{x as a,m as s};
