var I=(e,s,t)=>new Promise((r,o)=>{var n=l=>{try{c(t.next(l))}catch(g){o(g)}},a=l=>{try{c(t.throw(l))}catch(g){o(g)}},c=l=>l.done?r(l.value):Promise.resolve(l.value).then(n,a);c((t=t.apply(e,s)).next())});import{c as O,a as j,_ as D,r as f,o as V,b as B,d as u,e as d,f as i,n as G,t as y,F as S,g as P,p as U,h as $,i as E,j as F,k as N,s as M,l as z,B as H,m as Y}from"./vendor.5ef9971d.js";const K=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}};K();const W="modulepreload",T={},J="/assets/school/alummah/",p=function(s,t){return!t||t.length===0?s():Promise.all(t.map(r=>{if(r=`${J}${r}`,r in T)return;T[r]=!0;const o=r.endsWith(".css"),n=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${n}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":W,o||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),o)return new Promise((c,l)=>{a.addEventListener("load",c),a.addEventListener("error",l)})})).then(()=>s())},Q=[{path:"/",name:"Home",redirect:{name:"Login"}},{name:"Login",path:"/account/login",component:()=>p(()=>import("./Login.7021b0ca.js"),["assets/Login.7021b0ca.js","assets/Login.897882ce.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css","assets/session.23a3cd1c.js"]),meta:{requiresAuth:!1}},{name:"Teacherhome",path:"/teacher-home",component:()=>p(()=>import("./TeacherHome.d1568880.js"),["assets/TeacherHome.d1568880.js","assets/TeacherHome.0d3a7cee.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css","assets/session.23a3cd1c.js","assets/UserGroupIcon.153ba84b.js"]),meta:{requiresAuth:!0,requiredRole:"instructor"}},{name:"Parenthome",path:"/parent-home",component:()=>p(()=>import("./ParentHome.924d2351.js"),["assets/ParentHome.924d2351.js","assets/ParentHome.b29ec978.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css","assets/session.23a3cd1c.js","assets/UserGroupIcon.153ba84b.js"]),meta:{requiresAuth:!0,requiredRole:"guardian"}},{name:"ForgotPassword",path:"/forgot-password",component:()=>p(()=>import("./ForgotPassword.0777066e.js"),["assets/ForgotPassword.0777066e.js","assets/ForgotPassword.407b63ac.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"OTPLogin",path:"/otp-login",component:()=>p(()=>import("./OTPLogin.d19e21f8.js"),["assets/OTPLogin.d19e21f8.js","assets/OTPLogin.14ebff1b.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"SignInScreen",path:"/google-signin",component:()=>p(()=>import("./SignInScreen.c1c43711.js"),["assets/SignInScreen.c1c43711.js","assets/SignInScreen.8683290f.css","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"TeacherSignup",path:"/teacher/signup",component:()=>p(()=>import("./TeacherSignup.b4fae9b5.js"),["assets/TeacherSignup.b4fae9b5.js","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"ParentSignup",path:"/parent/signup",component:()=>p(()=>import("./ParentSignup.2a7a24e6.js"),["assets/ParentSignup.2a7a24e6.js","assets/vendor.5ef9971d.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}}],_=O({history:j("/alummah"),routes:Q});function X(){const s=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return s&&s!=="Guest"&&s!=="undefined"}function L(){try{const e=localStorage.getItem("userRoles");return e?JSON.parse(e):[]}catch(e){return[]}}function m(e){return L().includes(e)}function A(){return L(),m("Instructor")||m("Guardian")}function b(){const e=localStorage.getItem("logout_clicked_timestamp");return e?Date.now()-parseInt(e)<5e3:!1}function Z(){const e=localStorage.getItem("logout_clicked_timestamp");if(!e)return;Date.now()-parseInt(e)>5e3&&localStorage.removeItem("logout_clicked_timestamp")}function x(e,s,t){e==="role"&&b()||window.dispatchEvent(new CustomEvent("show-api-message-popup",{detail:{type:e||"info",title:s||"Information",message:t}}))}function v(){const e=localStorage.getItem("selectedLoginRole");return L(),e==="teacher"&&m("Instructor")?{name:"Teacherhome"}:e==="parent"&&m("Guardian")?{name:"Parenthome"}:m("Instructor")?(localStorage.setItem("selectedLoginRole","teacher"),{name:"Teacherhome"}):m("Guardian")?(localStorage.setItem("selectedLoginRole","parent"),{name:"Parenthome"}):(b()||x("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),{name:"Login"})}window.addEventListener("login-success",()=>{const e=v();_.replace(e)});window.addEventListener("otp-verification-success",()=>{const e=v();_.replace(e)});window.addEventListener("google-auth-success",()=>{const e=v();_.replace(e)});_.beforeEach((e,s,t)=>I(void 0,null,function*(){Z();const r=X(),o=["ForgotPassword","OTPLogin","SignInScreen","TeacherSignup","ParentSignup"],n="Login";if(o.includes(e.name)){t();return}if(e.name===n){if(r)if(A()){const c=v();t(c)}else b()||x("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),t();else t();return}if(!r){t({name:"Login"});return}const a=localStorage.getItem("selectedLoginRole");if(L(),!A()){b()||x("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),t({name:"Login"});return}if(e.meta.requiredRole){const c=e.meta.requiredRole;if(c==="instructor"&&a==="teacher"&&m("Instructor"))t();else if(c==="guardian"&&a==="parent"&&m("Guardian"))t();else{const l=v();t(l)}return}t()}));const w=e=>(U("data-v-1244d29c"),e=e(),$(),e),ee={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},te={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},oe={class:"text-center"},re={key:0,class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},se=w(()=>i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)),ne=[se],ae={key:1,class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ie=w(()=>i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)),ce=[ie],le={key:2,class:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ue=w(()=>i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)),de=[ue],pe={class:"text-lg font-semibold text-gray-800 mb-2"},me={class:"text-gray-600 mb-4"},ge={class:"flex space-x-3"},he=["disabled"],fe={key:0},_e=w(()=>i("div",{class:"spinner-small"},null,-1)),ve=[_e],we=["disabled"],ye={key:0},Le=w(()=>i("div",{class:"spinner-small"},null,-1)),be=[Le],ke={setup(e){const s=f(!1),t=f(!1),r=f("csrf"),o=f(""),n=f(""),a=h=>{const{type:R,title:C,message:q}=h.detail||{};r.value=R||"csrf",o.value=C||"Session Conflict",n.value=q||"It seems you're already logged in. Please logout from other session to continue.",s.value=!0},c=()=>{s.value=!1,l()},l=()=>{r.value="csrf",o.value="",n.value=""},g=()=>I(this,null,function*(){localStorage.setItem("logout_clicked_timestamp",Date.now().toString()),t.value=!0;try{const h=`${window.location.origin}/alummah/account/login`;window.location.href=`/logout?redirect-to=${encodeURIComponent(h)}`}catch(h){console.error("Logout failed:",h),window.location.href="/alummah/account/login"}finally{t.value=!1,s.value=!1}});return V(()=>{window.addEventListener("show-api-message-popup",a)}),B(()=>{window.removeEventListener("show-api-message-popup",a)}),(h,R)=>s.value?(u(),d("div",ee,[i("div",te,[i("div",oe,[i("div",{class:G(["mx-auto flex items-center justify-center h-12 w-12 rounded-full mb-4",r.value==="csrf"?"bg-red-100":r.value==="role"?"bg-yellow-100":"bg-blue-100"])},[r.value==="csrf"?(u(),d("svg",re,ne)):r.value==="role"?(u(),d("svg",ae,ce)):(u(),d("svg",le,de))],2),i("h3",pe,y(o.value),1),i("p",me,y(n.value),1),i("div",ge,[r.value==="info"?(u(),d("button",{key:0,onClick:c,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," OK ")):r.value==="role"?(u(),d(S,{key:1},[i("button",{onClick:c,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),i("button",{onClick:g,class:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2",disabled:t.value},[t.value?(u(),d("span",fe,ve)):P("",!0),i("span",null,y(t.value?"Logging out...":"Logout"),1)],8,he)],64)):(u(),d(S,{key:2},[i("button",{onClick:c,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),i("button",{onClick:g,class:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center justify-center space-x-2",disabled:t.value},[t.value?(u(),d("span",ye,be)):P("",!0),i("span",null,y(t.value?"Logging out...":"Logout"),1)],8,we)],64))])])])])):P("",!0)}};var Ie=D(ke,[["__scopeId","data-v-1244d29c"]]);const Pe={id:"app"},xe={setup(e){return(s,t)=>{const r=F("router-view");return u(),d("div",Pe,[E(r),E(Ie)])}}};let k=N(xe);M("resourceFetcher",Y);k.use(_);k.use(z);k.component("Button",H);k.mount("#app");export{p as _,_ as r};
