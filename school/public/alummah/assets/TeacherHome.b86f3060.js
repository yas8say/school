var J=(c,_,u)=>new Promise((h,l)=>{var M=g=>{try{w(u.next(g))}catch(r){l(r)}},j=g=>{try{w(u.throw(g))}catch(r){l(r)}},w=g=>g.done?h(g.value):Promise.resolve(g.value).then(M,j);w((u=u.apply(c,_)).next())});import{e as o,f as e,d as s,J as G,u as i,t as n,j as L,n as D,g as T,i as z,F as se,C as oe,_ as ae,k as ge,r as S,w as he,H as U,o as le,p as ie,h as ce,Q as fe,K as X,O as xe,z as be,A as Se,M as de,E as ye,b as Ie,D as Fe,R as ze}from"./vendor.9597569f.js";import{session as Ce}from"./session.03628eb4.js";import{r as Oe,a as Ve,b as Ge,A as He}from"./AttendanceRecord.ee32f826.js";import{a as ue,b as Ae,r as je}from"./XMarkIcon.949f4367.js";import{r as Me,a as Ue,b as We,c as we,d as qe,e as Je,f as Ye,g as Ze}from"./InboxIcon.bb8323b6.js";import"./index.ae7cf64f.js";function Ke(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.62 48.62 0 0 1 12 20.904a48.62 48.62 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.636 50.636 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.717 50.717 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443m-7.007 11.55A5.981 5.981 0 0 0 6.75 15.75v-1.5"})])}function Qe(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})])}function Xe(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function ve(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function et(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}function tt(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ee(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})])}function Te(c,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const st={class:"flex items-start"},ot={class:"flex-shrink-0"},nt={class:"ml-3 flex-1"},rt={class:"text-sm font-medium"},lt={class:"text-sm mt-1"},$e={props:{show:Boolean,type:{type:String,default:"success"},title:String,message:String},emits:["close"],setup(c){return(_,u)=>c.show?(s(),o("div",{key:0,class:D(["fixed top-4 right-4 z-50 max-w-sm p-4 rounded-lg shadow-lg border-l-4 transition-all duration-300",c.type==="success"?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"])},[e("div",st,[e("div",ot,[c.type==="success"?(s(),G(i(Oe),{key:0,class:"w-5 h-5 text-green-500"})):(s(),G(i(Ve),{key:1,class:"w-5 h-5 text-red-500"}))]),e("div",nt,[e("p",rt,n(c.title),1),e("p",lt,n(c.message),1)]),e("button",{onClick:u[0]||(u[0]=h=>_.$emit("close")),class:"ml-4 flex-shrink-0 text-gray-400 hover:text-gray-600"},[L(i(ue),{class:"w-4 h-4"})])])],2)):T("",!0)}},at={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},it={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto"},ct={class:"text-lg font-semibold text-gray-800 mb-4"},dt={key:0,class:"space-y-3 mb-4"},ut={class:"flex justify-between"},mt=e("span",{class:"text-gray-600"},"Courses to Remove:",-1),gt={class:"font-semibold text-red-600"},ht={class:"flex justify-between"},vt=e("span",{class:"text-gray-600"},"Affected Students:",-1),_t={class:"font-semibold"},pt={key:0,class:"mt-3"},ft=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Selected Courses:",-1),xt={class:"max-h-32 overflow-y-auto space-y-1 border border-gray-200 rounded p-2"},bt={class:"text-xs text-gray-500"},yt={class:"text-sm text-blue-600 bg-blue-50 p-3 rounded border border-blue-200"},wt={class:"font-medium"},$t={class:"mt-1"},kt=e("div",{class:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded border border-yellow-200"},[e("p",{class:"font-medium"},"Warning"),e("p",{class:"mt-1"}," This action cannot be undone. Students will lose access to the selected courses. ")],-1),St={class:"flex space-x-3 pt-4 border-t border-gray-200"},ke={props:{mode:{type:String,default:"attendance"},selectedCourses:{type:Array,default:()=>[]},affectedStudents:{type:Array,default:()=>[]},actionType:{type:String,default:"global"},availableCourses:{type:Array,default:()=>[]}},emits:["confirm","cancel"],setup(c){const _=c,u=z(()=>{switch(_.mode){case"remove-courses":return"Confirm Course Removal";case"attendance":return"Confirm Attendance";case"promotion":return"Confirm Promotion";default:return"Confirm Action"}}),h=z(()=>{switch(_.mode){case"remove-courses":return"bg-red-600 hover:bg-red-700";case"attendance":return"bg-blue-600 hover:bg-blue-700";case"promotion":return"bg-green-600 hover:bg-green-700";default:return"bg-blue-600 hover:bg-blue-700"}}),l=z(()=>{switch(_.mode){case"remove-courses":return"Remove Courses";case"attendance":return"Confirm Attendance";case"promotion":return"Promote Students";default:return"Confirm"}}),M=j=>{const w=_.availableCourses.find(g=>g.course===j);return w?w.course_name:j};return(j,w)=>(s(),o("div",at,[e("div",it,[e("h3",ct,n(i(u)),1),c.mode==="remove-courses"?(s(),o("div",dt,[e("div",ut,[mt,e("span",gt,n(c.selectedCourses.length),1)]),e("div",ht,[vt,e("span",_t,n(c.affectedStudents.length),1)]),c.selectedCourses.length>0?(s(),o("div",pt,[ft,e("div",xt,[(s(!0),o(se,null,oe(c.selectedCourses,g=>(s(),o("div",{key:g,class:"text-sm text-gray-600 bg-gray-50 px-2 py-1 rounded flex items-center justify-between"},[e("span",null,n(M(g)),1),e("span",bt,n(g),1)]))),128))])])):T("",!0),e("div",yt,[e("p",wt,n(c.actionType==="global"?"Global Removal":"Individual Removal"),1),e("p",$t,n(c.actionType==="global"?"This will remove the selected courses from ALL students in the class.":"This will remove courses from specific students only."),1)]),kt])):T("",!0),e("div",St,[e("button",{onClick:w[0]||(w[0]=g=>j.$emit("cancel")),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:w[1]||(w[1]=g=>j.$emit("confirm")),class:D(["flex-1 px-4 py-2 text-white rounded-lg font-medium transition-colors",i(h)])},n(i(l)),3)])])]))}};const Y=c=>(ie("data-v-fa5b60e8"),c=c(),ce(),c),Ct={class:"min-h-screen bg-gray-50 p-4"},At={class:"mb-6"},jt={class:"flex justify-between items-start"},Mt=Y(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Remove Courses from Students",-1)),Et={key:0,class:"text-gray-600"},Tt={key:1,class:"text-sm text-gray-500 mt-1"},Nt={class:"text-sm text-gray-500"},Pt={key:2,class:"text-sm text-gray-500"},Rt={class:"text-right"},Lt={class:"text-sm font-medium text-gray-600"},Dt={class:"text-2xl font-bold text-red-600"},Bt={class:"text-xs text-gray-500"},It={key:0,class:"flex justify-center items-center py-8"},Ft=Y(()=>e("div",{class:"spinner"},null,-1)),zt=Y(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students and courses...",-1)),Ot=[Ft,zt],Vt={key:1,class:"text-center py-8"},Gt={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 max-w-md mx-auto"},Ht=Y(()=>e("h3",{class:"text-lg font-semibold text-yellow-800 mb-2"},"No Program Found",-1)),Ut=Y(()=>e("p",{class:"text-yellow-700 mb-4"}," The selected student group is not associated with any program. Course removal is only available for student groups with assigned programs. ",-1)),Wt={key:2,class:"text-center py-8"},qt={class:"bg-blue-50 border border-blue-200 rounded-lg p-6 max-w-md mx-auto"},Jt=Y(()=>e("h3",{class:"text-lg font-semibold text-blue-800 mb-2"},"No Courses Available",-1)),Yt=Y(()=>e("p",{class:"text-blue-700 mb-4"}," There are no courses assigned to this program. Please add courses to the program before using this feature. ",-1)),Zt={key:3,class:"space-y-6"},Kt={class:"bg-white rounded-lg shadow-sm p-6"},Qt=Y(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Remove Courses from All Students",-1)),Xt=Y(()=>e("p",{class:"text-sm text-gray-600 mb-4"},"Select courses to remove from all students in this class:",-1)),es={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},ts=["onClick"],ss={class:"flex items-center space-x-3 flex-1"},os={class:"flex-1 min-w-0"},ns={class:"font-medium text-gray-800 text-sm"},rs={class:"text-xs text-gray-500"},ls={class:"bg-white rounded-lg shadow-sm p-4"},as=Y(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-3"},"Student Course Selections",-1)),is=Y(()=>e("p",{class:"text-sm text-gray-600 mb-3"},"Select courses to remove from individual students:",-1)),cs={class:"space-y-3"},ds={class:"flex items-center justify-between mb-2"},us={class:"flex items-center space-x-3"},ms={class:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-xs relative overflow-hidden"},gs=["src"],hs={key:1,class:"text-white text-xs font-medium"},vs={class:"min-w-0"},_s={class:"font-medium text-gray-800 text-sm leading-tight"},ps={class:"text-xs text-gray-500"},fs={class:"text-right"},xs={class:"flex flex-wrap gap-1"},bs=["onClick"],ys={class:"flex items-center space-x-1"},ws={class:"text-gray-800 whitespace-nowrap"},$s={key:0,class:"text-xs text-gray-500 italic px-2 py-1"},ks={class:"bg-white rounded-lg shadow-sm p-6"},Ss={class:"flex justify-between items-center"},Cs=Y(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Remove Selected Courses",-1)),As={class:"text-sm text-gray-600"},js=["disabled"],Ms={props:{selectedGroup:String},setup(c){const _=c;ge();const u=S([]),h=S([]),l=S({program:null,program_name:null}),M=S(!0),j=S(!1),w=S(!1),g=S([]),r=S({}),R=S([]),b=S([]),P=S("global"),x=S({show:!1,type:"success",title:"",message:""}),C=z(()=>g.value.length>0),I=z(()=>Object.values(r.value).some(a=>a.length>0)),F=z(()=>P.value==="global"?u.value.length:Object.entries(r.value).filter(([a,A])=>A.length>0).length),$=z(()=>{if(P.value==="global")return g.value.length;{let a=0;return Object.values(r.value).forEach(A=>{a+=A.length}),a}}),H=z(()=>C.value||I.value),Z=z(()=>C.value&&I.value?`Removing ${g.value.length} courses from all students and individual selections from ${F.value-u.value.length} students`:C.value?`Removing ${g.value.length} courses from all ${u.value.length} students`:I.value?`Removing selected courses from ${F.value} students`:"Select courses to remove from students"),K=z(()=>w.value?"Removing Courses...":C.value&&I.value?`Remove Courses (${$.value} from ${F.value} students)`:C.value?`Remove from All Students (${g.value.length})`:I.value?`Remove from ${F.value} Students (${$.value})`:"Remove Courses");he(g,a=>{u.value.forEach(A=>{const k=A.courses.map(O=>O.course);r.value[A.student]=a.filter(O=>k.includes(O))})},{deep:!0});const Q=U({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(a){return console.log("Student and course data loaded:",a),a},onError(a){console.error("Error fetching student data:",a),V("error","Load Failed","Failed to load student and course data. Please check your connection and try again.")}}),te=U({url:"school.al_ummah.api2.remove_courses_from_students",onSuccess(a){console.log("Courses removed successfully:",a),w.value=!1,W(a,"Courses removed successfully!")},onError(a){console.error("Error removing courses:",a),w.value=!1,E(a,"remove courses")}}),V=(a,A,k)=>{x.value={show:!0,type:a,title:A,message:k},setTimeout(()=>{x.value.show=!1},5e3)},W=(a,A)=>{var k;if(a.success===!0||a.status==="success"||((k=a.message)==null?void 0:k.includes("successfully"))){const O=a.message||A;V("success","Success!",O),setTimeout(()=>{f()},2e3)}else V("success","Success!",A),setTimeout(()=>{f()},2e3)},E=(a,A)=>{a.exc_type==="PermissionError"?V("error","Permission Denied",`You do not have permission to ${A}. Please contact your administrator.`):a.messages&&a.messages.length>0?V("error","Operation Failed",a.messages[0]):a.message?V("error","Operation Failed",a.message):V("error","Operation Failed",`Failed to ${A}. Please check your connection and try again.`)},y=a=>a?a.startsWith("http")||a.startsWith("//")?a:a.startsWith("/")?window.location.origin+a:`${window.location.origin}/${a.replace(/^\//,"")}`:null,m=a=>a?a.split(" ").map(A=>A.charAt(0)).join("").toUpperCase().substring(0,2):"?",d=a=>{a.target.style.display="none"},f=()=>J(this,null,function*(){M.value=!0;try{const a=_.selectedGroup||localStorage.getItem("selected_student_group");if(!a){V("error","Selection Required","Please select a class first."),M.value=!1;return}const A={based_on:"Batch",student_group:a,get_courses:!0},k=yield Q.fetch(A);let O=[];if(Array.isArray(k)?O=k:k&&k.students&&(O=k.students,l.value={program:k.program,program_name:k.program_name},h.value=k.courses||[]),!O||O.length===0){V("error","No Students","No students found for this class."),u.value=[],h.value=[];return}u.value=O,t(),console.log("Loaded data:",{program:l.value,students:u.value.length,courses:h.value.length})}catch(a){console.error("Error fetching student data:",a),V("error","Load Failed","Failed to load student data.")}finally{M.value=!1}}),t=()=>{r.value={},u.value.forEach(a=>{r.value[a.student]=[]})},v=a=>r.value[a]||[],p=a=>{const A=g.value.indexOf(a);A>-1?g.value.splice(A,1):g.value.push(a)},ee=()=>{g.value=h.value.map(a=>a.course)},q=()=>{g.value=[]},Re=(a,A)=>{const k=u.value.find(pe=>pe.student===a);if(!k||!k.courses.some(pe=>pe.course===A))return;r.value[a]||(r.value[a]=[]);const _e=r.value[a].indexOf(A);_e>-1?r.value[a].splice(_e,1):r.value[a].push(A)},Le=()=>{if(!H.value){V("error","Selection Required","Please select courses to remove.");return}if(C.value&&I.value){P.value="combined";const a=new Set([...g.value]);Object.values(r.value).forEach(A=>{A.forEach(k=>a.add(k))}),R.value=Array.from(a),b.value=u.value.map(A=>A.student)}else if(C.value)P.value="global",R.value=g.value,b.value=u.value.map(a=>a.student);else{P.value="individual";const a=new Set;Object.values(r.value).forEach(A=>{A.forEach(k=>a.add(k))}),R.value=Array.from(a),b.value=Object.entries(r.value).filter(([A,k])=>k.length>0).map(([A])=>A)}j.value=!0},De=()=>J(this,null,function*(){j.value=!1,w.value=!0;try{let a=[];P.value==="global"||P.value==="combined"?a=u.value.map(A=>({student:A.student,student_name:A.student_name,courses:R.value})):a=b.value.map(A=>{const k=u.value.find(O=>O.student===A);return{student:A,student_name:(k==null?void 0:k.student_name)||"Unknown",courses:r.value[A]||[]}}),console.log("Removing courses:",{actionType:P.value,students:a,program:l.value}),yield te.submit({students:JSON.stringify(a),program_id:l.value.program,student_group:_.selectedGroup||localStorage.getItem("selected_student_group")}),Be()}catch(a){console.error("Error in course removal:",a),w.value=!1}}),Be=()=>{g.value=[],u.value.forEach(a=>{r.value[a.student]=[]})};return le(()=>{f()}),(a,A)=>(s(),o("div",Ct,[e("div",At,[e("div",jt,[e("div",null,[Mt,l.value.program_name?(s(),o("p",Et," Remove courses from students in "+n(l.value.program_name),1)):T("",!0),c.selectedGroup?(s(),o("p",Tt,"Current Class: "+n(c.selectedGroup),1)):T("",!0),e("p",Nt,"Total Students: "+n(u.value.length),1),l.value.program_name?(s(),o("p",Pt," Program: "+n(l.value.program_name),1)):T("",!0)]),e("div",Rt,[e("p",Lt,n(P.value==="global"?"Global Selection":"Individual Selection"),1),e("p",Dt,n(i($)),1),e("p",Bt,n(i(F))+" students, "+n(i($))+" courses ",1)])])]),L($e,{show:x.value.show,type:x.value.type,title:x.value.title,message:x.value.message,onClose:A[0]||(A[0]=k=>x.value.show=!1)},null,8,["show","type","title","message"]),M.value?(s(),o("div",It,Ot)):l.value.program?h.value.length===0?(s(),o("div",Wt,[e("div",qt,[L(i(et),{class:"w-12 h-12 text-blue-500 mx-auto mb-4"}),Jt,Yt])])):(s(),o("div",Zt,[e("div",Kt,[Qt,Xt,e("div",es,[(s(!0),o(se,null,oe(h.value,k=>(s(),o("div",{key:k.course,class:D(["flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 transition-colors",g.value.includes(k.course)?"bg-blue-50 border-blue-500":"bg-white"]),onClick:O=>p(k.course)},[e("div",ss,[e("div",{class:D(["w-4 h-4 rounded border-2 flex items-center justify-center flex-shrink-0",g.value.includes(k.course)?"bg-blue-500 border-blue-500":"border-gray-300"])},[g.value.includes(k.course)?(s(),G(i(ve),{key:0,class:"w-3 h-3 text-white"})):T("",!0)],2),e("div",os,[e("h3",ns,n(k.course_name),1),e("p",rs,n(k.course),1)])])],10,ts))),128))]),e("div",{class:"flex space-x-3"},[e("button",{onClick:ee,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm"}," Select All Courses "),e("button",{onClick:q,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm"}," Clear All ")])]),e("div",ls,[as,is,e("div",cs,[(s(!0),o(se,null,oe(u.value,k=>(s(),o("div",{key:k.student,class:"border border-gray-200 rounded-lg p-3 hover:border-gray-300 transition-colors"},[e("div",ds,[e("div",us,[e("div",ms,[k.img_url?(s(),o("img",{key:0,src:y(k.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:d},null,40,gs)):(s(),o("span",hs,n(m(k.student_name)),1))]),e("div",vs,[e("h3",_s,n(k.student_name),1),e("p",ps,"Roll No: "+n(k.group_roll_number),1)])]),e("div",fs,[e("p",{class:D(["text-xs font-medium",v(k.student).length>0?"text-red-600":"text-gray-500"])},n(v(k.student).length)+" selected ",3)])]),e("div",xs,[(s(!0),o(se,null,oe(k.courses,O=>(s(),o("div",{key:O.course,class:D(["flex items-center px-2 py-1 border border-gray-200 rounded cursor-pointer hover:border-red-300 transition-colors text-xs",v(k.student).includes(O.course)?"bg-red-50 border-red-500":"bg-white"]),onClick:_e=>Re(k.student,O.course)},[e("div",ys,[e("div",{class:D(["w-3 h-3 rounded border flex items-center justify-center flex-shrink-0",v(k.student).includes(O.course)?"bg-red-500 border-red-500":"border-gray-300"])},[v(k.student).includes(O.course)?(s(),G(i(Ee),{key:0,class:"w-2 h-2 text-white"})):T("",!0)],2),e("span",ws,n(O.course_name),1)])],10,bs))),128)),k.courses.length===0?(s(),o("div",$s," No courses enrolled ")):T("",!0)])]))),128))])]),e("div",ks,[e("div",Ss,[e("div",null,[Cs,e("p",As,n(i(Z)),1)]),e("button",{onClick:Le,disabled:!i(H)||w.value,class:D(["px-6 py-3 text-white rounded-lg font-medium transition-colors text-sm",!i(H)||w.value?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"])},n(i(K)),11,js)])])])):(s(),o("div",Vt,[e("div",Gt,[L(i(Me),{class:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),Ht,Ut])])),j.value?(s(),G(ke,{key:4,mode:"remove-courses","selected-courses":R.value,"affected-students":b.value,"action-type":P.value,"available-courses":h.value,onConfirm:De,onCancel:A[1]||(A[1]=k=>j.value=!1)},null,8,["selected-courses","affected-students","action-type","available-courses"])):T("",!0)]))}};var Es=ae(Ms,[["__scopeId","data-v-fa5b60e8"]]);const Ts={class:"space-y-3"},Ns={class:"flex justify-between items-center mb-4"},Ps={class:"text-sm text-gray-600"},Rs=["disabled"],Ls={class:"flex items-center space-x-4"},Ds={class:"flex-shrink-0"},Bs=["src"],Is={key:1,class:"text-white text-sm font-medium opacity-70"},Fs={class:"flex-1 min-w-0"},zs={class:"font-medium text-gray-500 truncate"},Os={class:"flex items-center space-x-4 text-sm text-gray-500"},Vs=e("span",{class:"text-gray-400"},"\u2022",-1),Gs={class:"truncate"},Hs={class:"flex items-center space-x-2 mt-1"},Us={class:"flex-shrink-0"},Ws=["onClick"],qs={class:"flex items-center space-x-4"},Js={class:"flex-shrink-0"},Ys=["src"],Zs={key:1,class:"text-white text-sm font-medium"},Ks={class:"flex-1 min-w-0"},Qs={class:"font-medium text-gray-800 truncate"},Xs={class:"flex items-center space-x-4 text-sm text-gray-600"},eo=e("span",{class:"text-gray-400"},"\u2022",-1),to={class:"truncate"},so={key:0,class:"mt-1"},oo={class:"text-xs text-gray-500"},no={key:0,class:"ml-2 text-xs text-green-600 font-semibold"},ro={class:"flex-shrink-0"},lo={key:1,class:"text-center py-8"},ao=e("p",{class:"text-gray-600"},"No students available",-1),Ne={props:{students:{type:Array,default:()=>[]},selectedStudents:{type:Array,default:()=>[]},mode:{type:String,default:"attendance"},showMarkedStudents:{type:Boolean,default:!1},markedStudents:{type:Array,default:()=>[]},availableStudents:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},promotionInfo:{type:String,default:""},selectedGroup:{type:String,default:""}},emits:["student-toggle","toggle-all","reload"],setup(c,{emit:_}){const u=c,h=z(()=>u.selectedStudents.length===u.availableStudents.length),l=b=>u.selectedStudents.includes(b.student),M=b=>l(b)?"border-green-500 bg-green-50":"border-gray-200",j=b=>l(b)?"bg-green-500 border-green-500":"border-gray-300",w=b=>{if(!b)return"N/A";const P=b.match(/\(([^)]+)\)/);return P?P[1]:"N/A"},g=b=>b?b.startsWith("http")||b.startsWith("//")?b:b.startsWith("/")?window.location.origin+b:`${window.location.origin}/${b.replace(/^\//,"")}`:null,r=b=>b?b.split(" ").map(P=>P.charAt(0)).join("").toUpperCase().substring(0,2):"?",R=b=>{b.target.style.display="none"};return(b,P)=>(s(),o("div",Ts,[e("div",Ns,[e("p",Ps,[fe(b.$slots,"header-stats",{},()=>[X(" Total: "+n(c.students.length),1)])]),e("button",{onClick:P[0]||(P[0]=x=>b.$emit("toggle-all")),class:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300",disabled:c.disabled},[fe(b.$slots,"toggle-button-text",{},()=>[X(n(i(h)?"Deselect All":"Select All"),1)])],8,Rs)]),c.showMarkedStudents&&c.markedStudents.length>0?(s(!0),o(se,{key:0},oe(c.markedStudents,x=>(s(),o("div",{key:x.student,class:"bg-gray-100 rounded-lg shadow-sm p-4 border-2 border-gray-300 cursor-not-allowed"},[e("div",Ls,[e("div",Ds,[e("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden",x.present===1?"bg-gradient-to-br from-green-400 to-green-500":"bg-gradient-to-br from-yellow-400 to-yellow-500"])},[x.img_url?(s(),o("img",{key:0,src:g(x.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover opacity-70",onError:R,loading:"lazy"},null,40,Bs)):(s(),o("span",Is,n(r(x.student_name)),1))],2)]),e("div",Fs,[e("h3",zs,n(x.student_name),1),e("div",Os,[e("span",null,"Roll No: "+n(x.group_roll_number),1),Vs,e("span",Gs,n(x.student),1)]),e("div",Hs,[x.present===1?(s(),G(i(ve),{key:0,class:"w-4 h-4 text-green-500"})):T("",!0),x.on_leave===1?(s(),G(i(Ge),{key:1,class:"w-4 h-4 text-yellow-500"})):T("",!0),e("span",{class:D(["text-xs font-medium",x.present===1?"text-green-600":"text-yellow-600"])},n(x.present===1?"Already Marked Present":"On Leave"),3)])]),e("div",Us,[e("div",{class:D(["w-6 h-6 rounded-full border-2 flex items-center justify-center",x.present===1?"bg-green-500 border-green-500":"bg-yellow-500 border-yellow-500"])},[x.present===1?(s(),G(i(ve),{key:0,class:"w-4 h-4 text-white"})):T("",!0),x.on_leave===1?(s(),G(i(Ee),{key:1,class:"w-4 h-4 text-white"})):T("",!0)],2)])])]))),128)):T("",!0),(s(!0),o(se,null,oe(c.availableStudents,x=>(s(),o("div",{key:x.student,class:D(["bg-white rounded-lg shadow-sm p-4 border-2 transition-colors cursor-pointer hover:border-blue-300",M(x)]),onClick:C=>b.$emit("student-toggle",x.student)},[e("div",qs,[e("div",Js,[e("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden",c.mode==="attendance"?"bg-gradient-to-br from-blue-500 to-purple-600":"bg-gradient-to-br from-green-500 to-green-600"])},[x.img_url?(s(),o("img",{key:0,src:g(x.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:R,loading:"lazy"},null,40,Ys)):(s(),o("span",Zs,n(r(x.student_name)),1))],2)]),e("div",Ks,[e("h3",Qs,n(x.student_name),1),e("div",Xs,[e("span",null,"Roll No: "+n(x.group_roll_number),1),eo,e("span",to,n(x.student),1)]),c.mode==="promotion"?(s(),o("div",so,[e("span",oo," Current Year: "+n(w(c.selectedGroup)),1),c.promotionInfo&&l(x)?(s(),o("span",no,n(c.promotionInfo),1)):T("",!0)])):T("",!0)]),e("div",ro,[e("div",{class:D(["w-6 h-6 rounded-full border-2 flex items-center justify-center",j(x)])},[l(x)?(s(),G(i(ve),{key:0,class:"w-4 h-4 text-white"})):T("",!0)],2)])])],10,Ws))),128)),c.students.length===0?(s(),o("div",lo,[ao,fe(b.$slots,"empty-state-action",{},()=>[e("button",{onClick:P[1]||(P[1]=x=>b.$emit("reload")),class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])])):T("",!0)]))}},io={class:"flex space-x-4 mt-6"},co=e("span",null,"Cancel",-1),uo=["disabled"],Pe={props:{mode:{type:String,default:"attendance"},submitting:{type:Boolean,default:!1},canSubmit:{type:Boolean,default:!1}},emits:["cancel","submit"],setup(c){const _=c,u=_.submitting?_.mode==="attendance"?"Submitting...":"Promoting...":_.mode==="attendance"?"Submit":"Promote Students";return(h,l)=>(s(),o("div",io,[e("button",{onClick:l[0]||(l[0]=M=>h.$emit("cancel")),class:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center space-x-2"},[L(i(ue),{class:"w-5 h-5"}),co]),e("button",{onClick:l[1]||(l[1]=M=>h.$emit("submit")),disabled:c.submitting||!c.canSubmit,class:D(["flex-1 px-4 py-3 text-white rounded-lg font-medium transition-colors flex items-center justify-center space-x-2",c.submitting||!c.canSubmit?"bg-gray-400 cursor-not-allowed":c.mode==="attendance"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"])},[L(i(Xe),{class:"w-5 h-5"}),e("span",null,n(i(u)),1)],10,uo)]))}};const me=c=>(ie("data-v-1f528d86"),c=c(),ce(),c),mo={class:"min-h-screen bg-gray-50 p-4"},go={class:"mb-6"},ho={class:"flex justify-between items-start"},vo=me(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Take Attendance",-1)),_o=me(()=>e("p",{class:"text-gray-600"},"Select students who are present today",-1)),po={key:0,class:"text-sm text-gray-500 mt-1"},fo={class:"text-sm text-gray-500"},xo=me(()=>e("span",null,"Back to Dashboard",-1)),bo={key:0,class:"flex justify-center items-center py-8"},yo=me(()=>e("div",{class:"spinner"},null,-1)),wo=me(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students...",-1)),$o=[yo,wo],ko={props:{selectedGroup:String},setup(c){const _=c,u=ge(),h=S([]),l=S([]),M=S(!0),j=S(!1),w=S(!1),g=S({show:!1,type:"success",title:"",message:""}),r=z(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),R=z(()=>h.value.filter(m=>m.present===1||m.on_leave===1)),b=z(()=>h.value.filter(m=>m.present===0&&m.on_leave===0)),P=z(()=>R.value.length),x=z(()=>b.value.length===0),C=z(()=>b.value.length>0),I=U({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(m){return console.log("Attendance data loaded:",m),m},onError(m){console.error("Error fetching attendance:",m),$("error","Load Failed","Failed to load student data. Please check your connection and try again.")}}),F=U({url:"school.al_ummah.api2.mark_attendance",onSuccess(m){console.log("Attendance marked successfully:",m),w.value=!1,H(m,"Attendance marked successfully!")},onError(m){console.error("Error marking attendance:",m),w.value=!1,Z(m,"attendance")}}),$=(m,d,f)=>{g.value={show:!0,type:m,title:d,message:f},setTimeout(()=>{g.value.show=!1},5e3)},H=(m,d)=>{var f;if(m.success===!0||m.status==="success"||((f=m.message)==null?void 0:f.includes("successfully"))){const t=m.message||d;$("success","Success!",t),setTimeout(()=>{u.push({name:"Teacherhome"})},2e3)}else $("success","Success!",d),setTimeout(()=>{u.push({name:"Teacherhome"})},2e3)},Z=(m,d)=>{m.exc_type==="PermissionError"?$("error","Permission Denied",`You do not have permission to ${d==="attendance"?"mark attendance":"promote students"}. Please contact your administrator.`):m.messages&&m.messages.length>0?$("error","Operation Failed",m.messages[0]):m.message?$("error","Operation Failed",m.message):$("error","Operation Failed",`Failed to ${d==="attendance"?"submit attendance":"promote students"}. Please check your connection and try again.`)},K=()=>J(this,null,function*(){M.value=!0;try{const m=_.selectedGroup||localStorage.getItem("selected_student_group");if(!m){$("error","Selection Required","Please select a class first."),M.value=!1;return}const d={based_on:"Batch",student_group:m},f=yield I.fetch(d);let t=[];if(Array.isArray(f))t=f;else if(f&&f.students)t=f.students;else{$("error","No Students","No students found for this class."),h.value=[];return}if(!t||t.length===0){$("error","No Students","No students found for this class."),h.value=[];return}h.value=t,l.value=b.value.map(v=>v.student)}catch(m){console.error("Error fetching attendance:",m),$("error","Load Failed","Failed to load student data.")}finally{M.value=!1}}),Q=()=>{x.value||(l.value.length===b.value.length?l.value=[]:l.value=b.value.map(m=>m.student))},te=m=>{const d=h.value.find(t=>t.student===m);if(d&&(d.present===1||d.on_leave===1))return;const f=l.value.indexOf(m);f>-1?l.value.splice(f,1):l.value.push(m)},V=()=>{u.push({name:"Teacherhome"})},W=()=>{if(l.value.length===0){$("error","Selection Required","Please select at least one student as present.");return}j.value=!0},E=()=>J(this,null,function*(){j.value=!1,w.value=!0;const m=b.value.filter(v=>l.value.includes(v.student)).map(v=>({student:v.student,student_name:v.student_name,group_roll_number:v.group_roll_number,disabled:!1,checked:!0})),d=b.value.filter(v=>!l.value.includes(v.student)).map(v=>({student:v.student,student_name:v.student_name,group_roll_number:v.group_roll_number,disabled:!1,checked:!1})),f=new Date().toISOString().split("T")[0],t=_.selectedGroup||localStorage.getItem("selected_student_group");try{yield F.submit({students_present:JSON.stringify(m),students_absent:JSON.stringify(d),student_group:t,date:f})}catch(v){console.error("Error submitting attendance:",v),w.value=!1}}),y=()=>{u.push({name:"Teacherhome"})};return le(()=>{K()}),(m,d)=>(s(),o("div",mo,[e("div",go,[e("div",ho,[e("div",null,[vo,_o,c.selectedGroup?(s(),o("p",po,"Current Class: "+n(c.selectedGroup),1)):T("",!0),e("p",fo,"Date: "+n(i(r)),1)]),e("button",{onClick:V,class:"px-4 py-2 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center space-x-2"},[L(i(Qe),{class:"w-5 h-5"}),xo])])]),L($e,{show:g.value.show,type:g.value.type,title:g.value.title,message:g.value.message,onClose:d[0]||(d[0]=f=>g.value.show=!1)},null,8,["show","type","title","message"]),M.value?(s(),o("div",bo,$o)):(s(),G(Ne,{key:1,students:h.value,"selected-students":l.value,mode:"attendance","show-marked-students":!0,"marked-students":i(R),"available-students":i(b),disabled:i(x),onStudentToggle:te,onToggleAll:Q,onReload:K},{"header-stats":xe(()=>[X(" Total: "+n(h.value.length)+" | To Mark Present: "+n(l.value.length)+" | To Mark Absent: "+n(i(b).length-l.value.length)+" | Already Marked: "+n(i(P)),1)]),"toggle-button-text":xe(()=>[X(n(l.value.length===i(b).length?"Mark All Absent":"Mark All Present"),1)]),_:1},8,["students","selected-students","marked-students","available-students","disabled"])),h.value.length>0?(s(),G(Pe,{key:2,mode:"attendance",submitting:w.value,"can-submit":i(C),onCancel:y,onSubmit:W},null,8,["submitting","can-submit"])):T("",!0),j.value?(s(),G(ke,{key:3,mode:"attendance","present-students":l.value,"available-students":i(b),"marked-students-count":i(P),onConfirm:E,onCancel:d[1]||(d[1]=f=>j.value=!1)},null,8,["present-students","available-students","marked-students-count"])):T("",!0)]))}};var So=ae(ko,[["__scopeId","data-v-1f528d86"]]);const Co={class:"min-h-screen bg-gray-50 p-4"},Ao={class:"max-w-4xl mx-auto"},jo=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Create Notice"),e("p",{class:"text-gray-600"},"Send announcements to students and parents")],-1),Mo={class:"bg-white rounded-lg shadow-sm p-6"},Eo={class:"mb-6"},To=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Title * ",-1),No={class:"mb-6"},Po=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Message * ",-1),Ro={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Lo={class:"text-sm text-blue-700"},Do=e("span",{class:"font-medium"},"Selected Class:",-1),Bo={class:"flex justify-end"},Io=["disabled"],Fo={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},zo=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1),Oo=[zo],Vo={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Go=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),Ho=[Go],Uo={setup(c){const _=S(""),u=S(""),h=S(""),l=U({url:"school.al_ummah.api2.submit_notice",auto:!1,onSuccess(r){console.log("Notice submission response:",r),r.message?w(r.message):typeof r=="string"&&r.includes("success")?w(r):w("Notice published successfully!"),_.value="",u.value=""},onError(r){console.error("Error submitting notice:",r),r.message?g(r.message):r.exc_type==="ValidationError"?g("Validation error: Please check your input data."):g("An error occurred while submitting the notice.")}}),M=()=>{try{const r=localStorage.getItem("selected_student_group");r&&(h.value=r)}catch(r){console.error("Failed to load selected student group:",r)}},j=()=>J(this,null,function*(){if(!_.value.trim()||!u.value.trim()){g("Please enter both title and notice message.");return}if(!h.value){g("Student group information is missing.");return}const r={notice_heading:u.value.trim(),notice_message:_.value.trim(),student_group:h.value};console.log("Submitting notice:",r),yield l.fetch(r)}),w=r=>{alert(`\u2705 Success: ${r}`)},g=r=>{alert(`\u274C Error: ${r}`)};return le(()=>{M()}),(r,R)=>(s(),o("div",Co,[e("div",Ao,[jo,e("div",Mo,[e("div",Eo,[To,be(e("input",{"onUpdate:modelValue":R[0]||(R[0]=b=>u.value=b),type:"text",placeholder:"Enter notice title",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Se,u.value]])]),e("div",No,[Po,be(e("textarea",{"onUpdate:modelValue":R[1]||(R[1]=b=>_.value=b),rows:"8",placeholder:"Enter your notice message here...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"},null,512),[[Se,_.value]])]),e("div",Ro,[e("p",Lo,[Do,X(" "+n(h.value||"No class selected"),1)])]),e("div",Bo,[e("button",{onClick:j,disabled:i(l).loading,class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors"},[i(l).loading?(s(),o("svg",Vo,Ho)):(s(),o("svg",Fo,Oo)),e("span",null,n(i(l).loading?"Publishing...":"Publish Notice"),1)],8,Io)])])])]))}};const ne=c=>(ie("data-v-b50e67de"),c=c(),ce(),c),Wo={class:"min-h-screen bg-gray-50 p-4"},qo={class:"mb-6"},Jo=ne(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Previous Notices",-1)),Yo=ne(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),Zo={key:0,class:"text-sm text-gray-500 mt-1"},Ko={key:0,class:"flex justify-center items-center py-8"},Qo=ne(()=>e("div",{class:"spinner"},null,-1)),Xo=ne(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),en=[Qo,Xo],tn={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},sn=ne(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),on={key:2,class:"space-y-4"},nn=["onClick"],rn={class:"p-6"},ln={class:"flex items-start justify-between mb-3"},an={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},cn={class:"text-sm text-gray-500 whitespace-nowrap"},dn={class:"text-gray-600 line-clamp-2 mb-4"},un={class:"flex items-center justify-between text-sm text-gray-500"},mn=["onClick"],gn={key:0,class:"text-center py-12"},hn=ye('<div class="bg-white rounded-lg shadow-sm p-8" data-v-b50e67de><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b50e67de><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-b50e67de></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-b50e67de>No Notices Found</h3><p class="text-gray-600" data-v-b50e67de>No notices have been published for this class yet.</p></div>',1),vn=[hn],_n={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},pn={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},fn={class:"p-6"},xn={class:"flex items-center justify-between mb-4"},bn={class:"text-xl font-bold text-gray-800"},yn=ne(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),wn=[yn],$n={class:"mb-4 text-sm text-gray-500"},kn={class:"prose max-w-none mb-6"},Sn={class:"text-gray-700 whitespace-pre-wrap"},Cn={class:"flex space-x-3 pt-4 border-t"},An=ne(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),jn=ne(()=>e("span",null,"Delete Notice",-1)),Mn=[An,jn],En={setup(c){const _=S([]),u=S(""),h=S(null),l=S(!1),M=U({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(C){console.log("Notices loaded:",C),_.value=Array.isArray(C)?C:[]},onError(C){console.error("Error fetching notices:",C),_.value=[]}}),j=U({url:"school.al_ummah.api2.delete_notice",auto:!1,onSuccess(){console.log("Notice deleted successfully"),g(),b()},onError(C){console.error("Error deleting notice:",C),x("Error","Failed to delete notice. Please try again.")}}),w=()=>{try{const C=localStorage.getItem("selected_student_group");C&&(u.value=C)}catch(C){console.error("Failed to load selected student group:",C)}},g=()=>{if(!u.value)return;const C={student_group:u.value};M.fetch(C)},r=C=>{if(!C)return"No date";try{return new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(I){return C}},R=C=>{h.value=C,l.value=!0},b=()=>{l.value=!1,h.value=null},P=C=>{if(!C){x("Error","No notice ID provided");return}confirm("Are you sure you want to delete this notice? This action cannot be undone.")&&j.fetch({name:C})},x=(C,I)=>{C==="Error"?window.alert(`Error: ${I}`):window.alert(I)};return le(()=>{w(),u.value&&g()}),he(u,C=>{C&&g()}),(C,I)=>(s(),o("div",Wo,[e("div",qo,[Jo,Yo,u.value?(s(),o("p",Zo,"Class: "+n(u.value),1)):T("",!0)]),i(M).loading?(s(),o("div",Ko,en)):i(M).error?(s(),o("div",tn,[sn,e("button",{onClick:g,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(s(),o("div",on,[(s(!0),o(se,null,oe(_.value,(F,$)=>(s(),o("div",{key:$,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:H=>R(F)},[e("div",rn,[e("div",ln,[e("h3",an,n(F.notice_heading||"No Title"),1),e("span",cn,n(r(F.date)),1)]),e("p",dn,n(F.notice_message||"No message content"),1),e("div",un,[e("span",null,"By: "+n(F.owner||"System"),1),e("button",{onClick:de(H=>P(F.name),["stop"]),class:"text-red-600 hover:text-red-800 font-medium"}," Delete ",8,mn)])])],8,nn))),128)),_.value.length===0?(s(),o("div",gn,vn)):T("",!0)])),h.value&&l.value?(s(),o("div",_n,[e("div",pn,[e("div",fn,[e("div",xn,[e("h2",bn,n(h.value.notice_heading),1),e("button",{onClick:b,class:"text-gray-400 hover:text-gray-600"},wn)]),e("div",$n,[e("p",null,"Published on: "+n(r(h.value.date)),1),e("p",null,"By: "+n(h.value.owner||"System"),1)]),e("div",kn,[e("p",Sn,n(h.value.notice_message),1)]),e("div",Cn,[e("button",{onClick:I[0]||(I[0]=F=>P(h.value.name)),class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2"},Mn),e("button",{onClick:b,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Close ")])])])])):T("",!0)]))}};var Tn=ae(En,[["__scopeId","data-v-b50e67de"]]);const N=c=>(ie("data-v-19534540"),c=c(),ce(),c),Nn={class:"min-h-screen bg-gray-50 p-4"},Pn={key:0,class:"flex justify-center items-center py-12"},Rn=N(()=>e("div",{class:"spinner"},null,-1)),Ln=N(()=>e("span",{class:"ml-3 text-gray-600 text-lg"},"Loading leave applications...",-1)),Dn=[Rn,Ln],Bn={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6 mb-6 max-w-4xl mx-auto"},In={class:"flex items-start space-x-4"},Fn=N(()=>e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),zn={class:"flex-1"},On=N(()=>e("p",{class:"text-red-800 font-semibold text-lg"},"Unable to Load Applications",-1)),Vn={class:"text-red-700 mt-2"},Gn={key:2,class:"text-center py-16"},Hn=ye('<div class="max-w-md mx-auto" data-v-19534540><div class="w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-2xl flex items-center justify-center" data-v-19534540><svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-19534540></path></svg></div><h3 class="text-xl font-semibold text-gray-700 mb-2" data-v-19534540>No Leave Applications</h3><p class="text-gray-500" data-v-19534540>There are no leave applications for this group.</p></div>',1),Un=[Hn],Wn={key:3,class:"max-w-6xl mx-auto"},qn={class:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6"},Jn={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Yn=N(()=>e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Leave Applications"),e("p",{class:"text-gray-600 mt-1"},"Review and manage student leave requests")],-1)),Zn={class:"flex items-center space-x-4 mt-4 sm:mt-0"},Kn={class:"flex items-center space-x-2"},Qn=N(()=>e("div",{class:"w-3 h-3 bg-yellow-500 rounded-full"},null,-1)),Xn={class:"text-sm text-gray-600"},er={class:"flex items-center space-x-2"},tr=N(()=>e("div",{class:"w-3 h-3 bg-green-500 rounded-full"},null,-1)),sr={class:"text-sm text-gray-600"},or={class:"grid gap-6"},nr={class:"p-6"},rr={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},lr={class:"flex items-start space-x-4 flex-1 min-w-0"},ar={class:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm"},ir={class:"text-white font-semibold text-lg"},cr={class:"flex-1 min-w-0"},dr={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},ur={class:"font-bold text-gray-900 text-xl"},mr={class:"text-gray-600 text-sm mt-1"},gr={class:"flex items-center space-x-3"},hr=["onClick"],vr=N(()=>e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)),_r=[vr],pr={class:"flex flex-wrap items-center gap-4 mt-4"},fr={class:"flex items-center space-x-2 text-gray-700"},xr=N(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),br={class:"text-sm font-medium"},yr={class:"flex items-center space-x-2 text-gray-700"},wr=N(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),$r={class:"text-sm font-medium"},kr={class:"flex items-center space-x-2 text-blue-700"},Sr=N(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),Cr={class:"text-sm font-semibold"},Ar={class:"text-gray-600 mt-3 line-clamp-2"},jr={key:0,class:"mt-3"},Mr=N(()=>e("span",{class:"inline-flex items-center px-3 py-1.5 bg-green-50 text-green-700 rounded-lg text-sm font-medium"},[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),X(" Medical Certificate Available ")],-1)),Er=[Mr],Tr={key:0,class:"border-t border-gray-100 p-6 bg-gray-50 rounded-b-2xl"},Nr={class:"grid grid-cols-1 xl:grid-cols-2 gap-8"},Pr={class:"space-y-6"},Rr={class:"bg-white rounded-xl border border-gray-200 p-6"},Lr=N(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Leave Details",-1)),Dr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Br=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student Name",-1)),Ir={class:"text-gray-900 font-semibold mt-1"},Fr=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student ID",-1)),zr={class:"text-gray-900 font-semibold mt-1"},Or=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Leave ID",-1)),Vr={class:"text-gray-900 font-semibold mt-1"},Gr=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Duration",-1)),Hr={class:"text-gray-900 font-semibold mt-1"},Ur=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),Wr=N(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Mark as Present",-1)),qr={class:"text-gray-900 font-semibold mt-1"},Jr={class:"bg-white rounded-xl border border-gray-200 p-6"},Yr=N(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-3"},"Reason for Leave",-1)),Zr={class:"text-gray-700 bg-gray-50 p-4 rounded-lg border border-gray-200"},Kr={key:0,class:"bg-white rounded-xl border border-gray-200 p-6"},Qr=N(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-4"},"Approve Leave",-1)),Xr=["onClick","disabled"],el=N(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),tl=N(()=>e("span",null,"Approve Leave Application",-1)),sl=[el,tl],ol=N(()=>e("p",{class:"text-gray-500 text-sm mt-3 text-center"}," This will approve the leave request and notify the student ",-1)),nl={key:1,class:"bg-green-50 rounded-xl border border-green-200 p-6 text-center"},rl=ye('<div class="flex items-center justify-center space-x-2 text-green-700 mb-2" data-v-19534540><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-19534540></path></svg><span class="font-semibold" data-v-19534540>Leave Approved</span></div><p class="text-green-600 text-sm" data-v-19534540> This leave application has been approved and processed. </p>',2),ll=[rl],al={key:0,class:"space-y-6"},il={class:"bg-white rounded-xl border border-gray-200 p-6"},cl=N(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Medical Certificate",-1)),dl={class:"space-y-4"},ul={class:"border-2 border-dashed border-gray-200 rounded-xl overflow-hidden bg-gray-50"},ml=["src","onClick"],gl={class:"grid grid-cols-2 gap-3"},hl=["onClick"],vl=N(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),_l=N(()=>e("span",null,"View Full Size",-1)),pl=[vl,_l],fl=["onClick"],xl=N(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),bl=N(()=>e("span",null,"Download",-1)),yl=[xl,bl],wl={key:1,class:"flex items-center justify-center p-8 bg-white rounded-xl border border-gray-200"},$l=N(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-gray-500 font-medium"},"No medical certificate provided")],-1)),kl=[$l],Sl={key:2,class:"flex items-center justify-center p-8 bg-green-50 rounded-xl border border-green-200"},Cl=N(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-green-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-green-700 font-medium"},"Approved without medical certificate")],-1)),Al=[Cl],jl={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ml=N(()=>e("div",{class:"bg-white rounded-2xl p-8 flex items-center space-x-4 shadow-xl"},[e("div",{class:"spinner-small"}),e("div",null,[e("p",{class:"font-semibold text-gray-900"},"Approving Leave"),e("p",{class:"text-gray-600 text-sm mt-1"},"Please wait while we process your request...")])],-1)),El=[Ml],Tl={key:5,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},Nl={class:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-lg"},Pl={class:"flex items-start space-x-3"},Rl=N(()=>e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),Ll={class:"flex-1"},Dl=N(()=>e("p",{class:"text-red-800 font-medium text-sm"},"Error",-1)),Bl={class:"text-red-700 text-sm mt-1"},Il=N(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Fl=[Il],zl={key:6,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},Ol={class:"bg-green-50 border border-green-200 rounded-xl p-4 shadow-lg"},Vl={class:"flex items-start space-x-3"},Gl=N(()=>e("svg",{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),Hl={class:"flex-1"},Ul=N(()=>e("p",{class:"text-green-800 font-medium text-sm"},"Success",-1)),Wl={class:"text-green-700 text-sm mt-1"},ql=N(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Jl=[ql],Yl={key:7,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},Zl={class:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col shadow-2xl"},Kl={class:"flex justify-between items-center p-6 border-b border-gray-200"},Ql=N(()=>e("h3",{class:"text-xl font-bold text-gray-900"},"Medical Certificate",-1)),Xl={class:"text-gray-600 text-sm mt-1"},ea=N(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),ta=[ea],sa={class:"flex-1 p-6 overflow-auto"},oa=["src"],na=N(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),ra=N(()=>e("span",null,"Download Certificate",-1)),la=[na,ra],aa={setup(c){const _=S([]),u=S(""),h=S(null),l=S(!1),M=S(""),j=S(""),w=S(!1),g=S(!1),r=S(""),R=z(()=>_.value.filter(t=>t.docstatus===0).length),b=z(()=>_.value.filter(t=>t.docstatus===1).length),P=(t,v="error")=>{r.value=t,v==="success"?(g.value=!0,setTimeout(()=>{g.value=!1},5e3)):(w.value=!0,setTimeout(()=>{w.value=!1},5e3))},x=U({url:"school.al_ummah.api2.get_leave_application_list",auto:!1,onSuccess(t){console.log("Raw API response:",t),Array.isArray(t)?_.value=t:t&&typeof t=="object"?t.message&&Array.isArray(t.message)?_.value=t.message:t.appeals&&Array.isArray(t.appeals)?_.value=t.appeals:t.leave_applications&&Array.isArray(t.leave_applications)?_.value=t.leave_applications:Array.isArray(t.data)?_.value=t.data:_.value=Object.keys(t).length>0?[t]:[]:_.value=[],console.log("Processed appeals:",_.value),u.value=""},onError(t){console.error("Error fetching leave applications:",t);const v=I(t,"Failed to load leave applications.");u.value=v,_.value=[]}}),C=U({url:"school.al_ummah.api2.approve_leave",method:"POST",auto:!1,onSuccess(t){if(console.log("\u2705 Approve API Response:",t),t.success){const v=_.value.findIndex(p=>p.name===t.name);v!==-1&&(_.value[v].docstatus=1,console.log("\u{1F504} Updated appeal docstatus to approved")),P(t.message||"Leave application approved successfully.","success"),h.value=null,f()}else console.log("\u274C API returned success: false"),P(t.message||"Failed to approve leave application.")},onError(t){console.error("\u{1F6A8} Error approving leave:",t);const v=I(t,"Failed to approve leave application.");P(v)}}),I=(t,v)=>{if(!t)return v;if(t._server_messages)try{const p=JSON.parse(t._server_messages||"[]");if(p.length>0){const ee=p[p.length-1];try{const q=JSON.parse(ee);return q.message||q.exc_type||v}catch(q){return ee||v}}}catch(p){console.error("Error parsing server messages:",p)}return t.message?t.message:t.exc_type||t.exc_message?t.exc_message||t.exc_type||v:typeof t=="string"?t:v},F=t=>{if(!t)return"N/A";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(v){return t||"N/A"}},$=(t,v)=>{if(!t||!v)return 0;try{const p=new Date(t),ee=new Date(v),q=Math.abs(ee-p);return Math.ceil(q/(1e3*60*60*24))+1}catch(p){return 0}},H=t=>t?t.split(" ").map(v=>v[0]).join("").toUpperCase().substring(0,2):"?",Z=t=>t===0?"Pending":"Approved",K=t=>t===0?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",Q=t=>{console.error("Image failed to load"),t.target.style.display="none"},te=t=>{console.error("Modal image failed to load"),P("Failed to load medical certificate image."),l.value=!1},V=t=>{h.value=h.value===t?null:t},W=(t,v)=>{t?(M.value=t,j.value=v,l.value=!0):P("Unable to display medical certificate.")},E=(t,v)=>{if(t){const p=document.createElement("a");p.href=t,p.download=`medical-certificate-${v||"student"}.jpg`,p.target="_blank",document.body.appendChild(p),p.click(),document.body.removeChild(p)}},y=()=>{M.value&&E(M.value,j.value)},m=t=>J(this,null,function*(){if(!t){P("Cannot approve: Missing leave application ID");return}const v=_.value.find(ee=>ee.name===t);if(!v){P("Leave application not found.");return}if(v.docstatus!==0){P("This leave application has already been processed.");return}console.log("Approving leave:",t);const p={name:t};console.log("Sending approve data:",p),yield C.submit(p)}),d=()=>{try{const t=localStorage.getItem("selected_student_group");if(t)try{const v=JSON.parse(t);return v.student_group||v.name||v}catch(v){return t}return null}catch(t){return console.error("Error getting student group:",t),null}},f=()=>{const t=d();if(!t){u.value="No student group found. Please select a student first.",_.value=[];return}const v={student_group:t};console.log("Fetching leave applications with params:",v),x.fetch(v)};return le(()=>{f()}),(t,v)=>(s(),o("div",Nn,[i(x).loading?(s(),o("div",Pn,Dn)):u.value?(s(),o("div",Bn,[e("div",In,[Fn,e("div",zn,[On,e("p",Vn,n(u.value),1),e("button",{onClick:f,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors"}," Try Again ")])])])):!_.value||_.value.length===0?(s(),o("div",Gn,Un)):(s(),o("div",Wn,[e("div",qn,[e("div",Jn,[Yn,e("div",Zn,[e("div",Kn,[Qn,e("span",Xn,n(i(R))+" pending",1)]),e("div",er,[tr,e("span",sr,n(i(b))+" approved",1)])])])]),e("div",or,[(s(!0),o(se,null,oe(_.value,(p,ee)=>(s(),o("div",{key:p.name||`appeal-${ee}`,class:"bg-white rounded-2xl shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300"},[e("div",nr,[e("div",rr,[e("div",lr,[e("div",ar,[e("span",ir,n(H(p.student_name||p.student||"Unknown")),1)]),e("div",cr,[e("div",dr,[e("div",null,[e("h3",ur,n(p.student_name||p.student||"Unknown Student"),1),e("p",mr,n(p.student||"No Student ID"),1)]),e("div",gr,[e("span",{class:D(["px-3 py-1.5 rounded-full text-sm font-semibold",K(p.docstatus)])},n(Z(p.docstatus)),3),e("button",{onClick:q=>V(p.name),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[(s(),o("svg",{class:D(["w-5 h-5 transition-transform duration-200",{"rotate-180":h.value===p.name}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_r,2))],8,hr)])]),e("div",pr,[e("div",fr,[xr,e("span",br,"From "+n(F(p.from_date)),1)]),e("div",yr,[wr,e("span",$r,"To "+n(F(p.to_date)),1)]),e("div",kr,[Sr,e("span",Cr,n(p.total_leave_days||$(p.from_date,p.to_date))+" days",1)])]),e("p",Ar,n(p.reason||"No reason provided"),1),p.img_url?(s(),o("div",jr,Er)):T("",!0)])])])]),h.value===p.name?(s(),o("div",Tr,[e("div",Nr,[e("div",Pr,[e("div",Rr,[Lr,e("div",Dr,[e("div",null,[Br,e("p",Ir,n(p.student_name||"N/A"),1)]),e("div",null,[Fr,e("p",zr,n(p.student||"N/A"),1)]),e("div",null,[Or,e("p",Vr,n(p.name||"N/A"),1)]),e("div",null,[Gr,e("p",Hr,n(p.total_leave_days||$(p.from_date,p.to_date))+" days",1)]),e("div",null,[Ur,e("p",{class:D([K(p.docstatus),"px-3 py-1.5 rounded-full text-sm font-semibold inline-block mt-1"])},n(Z(p.docstatus)),3)]),e("div",null,[Wr,e("p",qr,n(p.mark_as_present?"Yes":"No"),1)])])]),e("div",Jr,[Yr,e("p",Zr,n(p.reason||"No reason provided"),1)]),p.docstatus===0?(s(),o("div",Kr,[Qr,e("button",{onClick:de(q=>m(p.name),["stop"]),disabled:i(C).loading,class:"w-full px-6 py-3 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 shadow-sm hover:shadow-md"},sl,8,Xr),ol])):(s(),o("div",nl,ll))]),p.img_url?(s(),o("div",al,[e("div",il,[cl,e("div",dl,[e("div",ul,[e("img",{src:p.img_url,alt:"Medical Certificate",onError:Q,class:"w-full h-64 object-contain cursor-pointer transition-transform duration-200 hover:scale-105",onClick:de(q=>W(p.img_url,p.student_name),["stop"])},null,40,ml)]),e("div",gl,[e("button",{onClick:de(q=>W(p.img_url,p.student_name),["stop"]),class:"px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2"},pl,8,hl),e("button",{onClick:de(q=>E(p.img_url,p.student_name),["stop"]),class:"px-4 py-2.5 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2"},yl,8,fl)])])])])):p.docstatus===0?(s(),o("div",wl,kl)):(s(),o("div",Sl,Al))])])):T("",!0)]))),128))])])),i(C).loading?(s(),o("div",jl,El)):T("",!0),w.value?(s(),o("div",Tl,[e("div",Nl,[e("div",Pl,[Rl,e("div",Ll,[Dl,e("p",Bl,n(r.value),1)]),e("button",{onClick:v[0]||(v[0]=p=>w.value=!1),class:"text-red-400 hover:text-red-600 transition-colors"},Fl)])])])):T("",!0),g.value?(s(),o("div",zl,[e("div",Ol,[e("div",Vl,[Gl,e("div",Hl,[Ul,e("p",Wl,n(r.value),1)]),e("button",{onClick:v[1]||(v[1]=p=>g.value=!1),class:"text-green-400 hover:text-green-600 transition-colors"},Jl)])])])):T("",!0),l.value?(s(),o("div",Yl,[e("div",Zl,[e("div",Kl,[e("div",null,[Ql,e("p",Xl,n(j.value),1)]),e("button",{onClick:v[2]||(v[2]=p=>l.value=!1),class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"},ta)]),e("div",sa,[e("img",{src:M.value,alt:"Medical Certificate Full Size",class:"w-full h-auto max-h-full object-contain mx-auto rounded-lg",onError:te},null,40,oa)]),e("div",{class:"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl"},[e("div",{class:"flex justify-center"},[e("button",{onClick:y,class:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center space-x-3"},la)])])])])):T("",!0)]))}};var ia=ae(aa,[["__scopeId","data-v-19534540"]]);const re=c=>(ie("data-v-14cc5106"),c=c(),ce(),c),ca={class:"min-h-screen bg-gray-50 p-4"},da={class:"mb-6"},ua={class:"flex justify-between items-start"},ma=re(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Promote Students",-1)),ga=re(()=>e("p",{class:"text-gray-600"},"Select students to promote to next academic year",-1)),ha={key:0,class:"text-sm text-gray-500 mt-1"},va={class:"text-sm text-gray-500"},_a={class:"flex flex-col items-end space-y-2"},pa={class:"bg-white rounded-lg border border-gray-300 p-1 flex"},fa={key:0,class:"text-sm bg-green-50 px-3 py-2 rounded-lg border border-green-200 max-w-xs"},xa=re(()=>e("div",{class:"font-semibold text-green-800 mb-1"},"Promotion Details:",-1)),ba={class:"text-green-700"},ya=X("From: "),wa={class:"font-medium"},$a=X("To: "),ka={class:"font-medium"},Sa=X("Program: "),Ca={class:"font-medium"},Aa=X("Academic Year: "),ja={class:"font-medium"},Ma={key:1,class:"text-sm bg-red-50 px-3 py-2 rounded-lg border border-red-200 max-w-xs"},Ea=re(()=>e("div",{class:"font-semibold text-red-800 mb-1"},"Cannot Promote:",-1)),Ta={class:"text-red-700"},Na={key:0,class:"flex justify-center items-center py-8"},Pa=re(()=>e("div",{class:"spinner"},null,-1)),Ra=re(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students...",-1)),La=[Pa,Ra],Da={key:0,class:"ml-2 text-green-600 font-semibold"},Ba={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ia={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},Fa={class:"text-center"},za={class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},Oa=re(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Permission Denied",-1)),Va=re(()=>e("p",{class:"text-gray-600 mb-4"}," You are not allowed to promote students. Please contact your administrator to enable this feature. ",-1)),Ga={setup(c){const _=ge(),u=S(_.currentRoute.value.query.group||localStorage.getItem("selected_student_group")),h=S([]),l=S([]),M=S(!0),j=S(!1),w=S(!1),g=S(!1),r=S({success:!1,allowed:!1,message:"",current_group:"",next_group:"",next_academic_year:"",next_program:"",group_exists:!1}),R=S({show:!1,type:"success",title:"",message:""}),b=z(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),P=z(()=>l.value.length>0&&r.value.success&&r.value.allowed&&r.value.group_exists),x=z(()=>r.value.success?`\u2192 ${r.value.next_group} (${r.value.next_program})`:""),C=U({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(d){return console.log("Attendance data loaded:",d),d},onError(d){console.error("Error fetching attendance:",d),$("error","Load Failed","Failed to load student data. Please check your connection and try again.")}}),I=U({url:"school.al_ummah.api6.promote_students",onSuccess(d){console.log("Students promoted successfully:",d),g.value=!1,d.success===!1?Z({message:d.message},"promotion"):H(d,"Students promoted successfully!")},onError(d){console.error("Error promoting students:",d),g.value=!1,Z(d,"promotion")}}),F=U({url:"school.al_ummah.api3.fetch_student_group",onSuccess(d){return console.log("Student group info loaded:",d),r.value=d,d},onError(d){console.error("Error fetching student group info:",d),r.value={success:!1,allowed:!1,message:"Failed to load promotion information"}}}),$=(d,f,t)=>{R.value={show:!0,type:d,title:f,message:t},setTimeout(()=>{R.value.show=!1},5e3)},H=(d,f)=>{var t;if(d.success===!0||d.status==="success"||((t=d.message)==null?void 0:t.includes("successfully"))){const v=d.message||f;$("success","Success!",v),setTimeout(()=>{_.push({name:"Teacherhome"})},2e3)}else $("success","Success!",f),setTimeout(()=>{_.push({name:"Teacherhome"})},2e3)},Z=(d,f)=>{d.exc_type==="PermissionError"?$("error","Permission Denied",`You do not have permission to ${f==="attendance"?"mark attendance":"promote students"}. Please contact your administrator.`):d.messages&&d.messages.length>0?$("error","Operation Failed",d.messages[0]):d.message?$("error","Operation Failed",d.message):$("error","Operation Failed",`Failed to ${f==="attendance"?"submit attendance":"promote students"}. Please check your connection and try again.`)},K=d=>J(this,null,function*(){try{yield F.submit({current_group_name:d})}catch(f){console.error("Error fetching student group info:",f)}}),Q=()=>J(this,null,function*(){M.value=!0;try{if(!u.value){$("error","Selection Required","Please select a class first."),M.value=!1;return}if(yield K(u.value),!r.value.allowed){w.value=!0,M.value=!1;return}const d={based_on:"Batch",student_group:u.value},f=yield C.fetch(d);let t=[];if(Array.isArray(f))t=f;else if(f&&f.students)t=f.students;else{$("error","No Students","No students found for this class."),h.value=[];return}if(!t||t.length===0){$("error","No Students","No students found for this class."),h.value=[];return}h.value=t}catch(d){console.error("Error fetching promotion data:",d),$("error","Load Failed","Failed to load student data.")}finally{M.value=!1}}),te=d=>{const f=l.value.indexOf(d);f>-1?l.value.splice(f,1):l.value.push(d)},V=()=>{l.value.length===h.value.length?l.value=[]:l.value=h.value.map(d=>d.student)},W=d=>{d==="attendance"&&_.push({name:"AttendancePage"})},E=()=>{if(!r.value.allowed){w.value=!0;return}if(!r.value.success){$("error","Cannot Promote",r.value.message||"Unknown error");return}if(l.value.length===0){$("error","Selection Required","Please select at least one student to promote.");return}j.value=!0},y=()=>J(this,null,function*(){j.value=!1,g.value=!0;const d=h.value.filter(f=>l.value.includes(f.student)).map(f=>({student:f.student,student_name:f.student_name,current_academic_year:f.academic_year,group_roll_number:f.group_roll_number,current_group:u.value,next_group:r.value.next_group}));try{yield I.submit({students:JSON.stringify(d),student_group:u.value,next_academic_year:r.value.next_academic_year,next_student_group:r.value.next_group,next_program:r.value.next_program})}catch(f){console.error("Error promoting students:",f),g.value=!1}}),m=()=>{_.push({name:"Teacherhome"})};return le(()=>{Q()}),(d,f)=>(s(),o("div",ca,[e("div",da,[e("div",ua,[e("div",null,[ma,ga,u.value?(s(),o("p",ha,"Current Class: "+n(u.value),1)):T("",!0),e("p",va,"Date: "+n(i(b)),1)]),e("div",_a,[e("div",pa,[e("button",{onClick:f[0]||(f[0]=t=>W("attendance")),class:"px-3 py-1 text-sm font-medium rounded-md transition-colors text-gray-600 hover:text-gray-800"}," Take Attendance "),e("button",{onClick:f[1]||(f[1]=t=>W("promotion")),class:"px-3 py-1 text-sm font-medium rounded-md transition-colors bg-green-600 text-white"}," Promote Students ")]),r.value.success?(s(),o("div",fa,[xa,e("div",ba,[e("div",null,[ya,e("span",wa,n(u.value),1)]),e("div",null,[$a,e("span",ka,n(r.value.next_group),1)]),e("div",null,[Sa,e("span",Ca,n(r.value.next_program),1)]),e("div",null,[Aa,e("span",ja,n(r.value.next_academic_year),1)])])])):T("",!0),!r.value.success&&r.value.message?(s(),o("div",Ma,[Ea,e("div",Ta,n(r.value.message),1)])):T("",!0)])])]),L($e,{show:R.value.show,type:R.value.type,title:R.value.title,message:R.value.message,onClose:f[2]||(f[2]=t=>R.value.show=!1)},null,8,["show","type","title","message"]),M.value?(s(),o("div",Na,La)):(s(),G(Ne,{key:1,students:h.value,"selected-students":l.value,mode:"promotion","available-students":h.value,"promotion-info":i(x),"selected-group":u.value,onStudentToggle:te,onToggleAll:V,onReload:Q},{"header-stats":xe(()=>[X(" Total: "+n(h.value.length)+" | Selected for Promotion: "+n(l.value.length)+" | Not Selected: "+n(h.value.length-l.value.length)+" ",1),r.value.success?(s(),o("span",Da," \u2192 To: "+n(r.value.next_group),1)):T("",!0)]),_:1},8,["students","selected-students","available-students","promotion-info","selected-group"])),h.value.length>0?(s(),G(Pe,{key:2,mode:"promotion",submitting:g.value,"can-submit":i(P),onCancel:m,onSubmit:E},null,8,["submitting","can-submit"])):T("",!0),j.value?(s(),G(ke,{key:3,mode:"promotion","selected-students":l.value,"total-students":h.value.length,"student-group-info":r.value,onConfirm:y,onCancel:f[3]||(f[3]=t=>j.value=!1)},null,8,["selected-students","total-students","student-group-info"])):T("",!0),w.value?(s(),o("div",Ba,[e("div",Ia,[e("div",Fa,[e("div",za,[L(i(ue),{class:"w-6 h-6 text-red-600"})]),Oa,Va,e("button",{onClick:f[4]||(f[4]=t=>w.value=!1),class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," OK ")])])])):T("",!0)]))}};var Ha=ae(Ga,[["__scopeId","data-v-14cc5106"]]);const B=c=>(ie("data-v-34555227"),c=c(),ce(),c),Ua={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},Wa={class:"max-w-4xl max-h-full w-full h-full flex items-center justify-center"},qa=["src"],Ja={key:1,class:"fixed inset-0 bg-red-50 bg-opacity-90 flex items-center justify-center z-50 p-4"},Ya={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},Za={class:"flex items-center mb-4"},Ka={class:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"},Qa=B(()=>e("h3",{class:"text-lg font-semibold text-red-800"},"Something went wrong",-1)),Xa={class:"text-gray-600 mb-4"},ei={key:2,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},ti=B(()=>e("div",{class:"text-center"},[e("div",{class:"spinner mb-4 mx-auto"}),e("p",{class:"text-gray-600"},"Loading your dashboard...")],-1)),si=[ti],oi={key:3,class:"flex flex-col md:flex-row w-full min-h-screen"},ni={class:"md:hidden bg-white shadow-sm border-b border-gray-200 p-4 flex items-center justify-between"},ri={class:"flex items-center space-x-3"},li=["src"],ai={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},ii={class:"min-w-0 flex-1"},ci={class:"text-sm font-semibold text-gray-800 truncate"},di=B(()=>e("p",{class:"text-xs text-gray-500"},"Teacher",-1)),ui={class:"flex items-center justify-between md:hidden pb-4 border-b border-gray-200"},mi=B(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Menu",-1)),gi={class:"flex-1 overflow-y-auto space-y-6 md:space-y-8"},hi={class:"hidden md:flex items-start space-x-4 border-b pb-4"},vi=["src"],_i={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},pi={class:"min-w-0 flex-1"},fi={class:"text-xl font-semibold text-gray-800 break-words"},xi=B(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Teacher",-1)),bi={class:"space-y-2"},yi=B(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Class:",-1)),wi=["disabled"],$i=B(()=>e("option",{value:"",disabled:""},"Select a class",-1)),ki=["value"],Si={key:0,class:"text-sm text-yellow-600"},Ci={class:"space-y-3"},Ai=B(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),ji={class:"space-y-2"},Mi=["disabled"],Ei=B(()=>e("span",{class:"truncate"},"Dashboard",-1)),Ti=["disabled"],Ni=B(()=>e("span",{class:"truncate"},"Take Attendance",-1)),Pi=["disabled"],Ri=B(()=>e("span",{class:"truncate"},"Promote Students",-1)),Li=["disabled"],Di=B(()=>e("span",{class:"truncate"},"Remove Courses",-1)),Bi=["disabled"],Ii=B(()=>e("span",{class:"truncate"},"Student Record",-1)),Fi=["disabled"],zi=B(()=>e("span",{class:"truncate"},"Create Notice",-1)),Oi=["disabled"],Vi=B(()=>e("span",{class:"truncate"},"Previous Notices",-1)),Gi=["disabled"],Hi=B(()=>e("span",{class:"truncate"},"Browse Leave Appeals",-1)),Ui={class:"pt-4 border-t border-gray-200 flex-shrink-0"},Wi=["disabled"],qi=B(()=>e("span",null,"Logout",-1)),Ji={key:0},Yi={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 mb-4 md:mb-6"},Zi={class:"text-xl md:text-2xl font-bold text-gray-800 mb-2"},Ki=B(()=>e("p",{class:"text-gray-600 text-sm md:text-base"},"Manage your classroom activities and student records from here.",-1)),Qi={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-4 md:mb-6"},Xi={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-blue-500"},ec={class:"flex items-center justify-between"},tc=B(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Selected Class",-1)),sc={class:"text-lg md:text-2xl font-bold text-gray-800 truncate"},oc={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-green-500"},nc={class:"flex items-center justify-between"},rc=B(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Available Classes",-1)),lc={class:"text-lg md:text-2xl font-bold text-gray-800"},ac={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-purple-500"},ic={class:"flex items-center justify-between"},cc=B(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Today's Date",-1)),dc={class:"text-lg md:text-2xl font-bold text-gray-800"},uc={class:"bg-white rounded-lg shadow-sm p-4 md:p-6"},mc=B(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),gc={class:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"},hc=["disabled"],vc=B(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Take Today's Attendance"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Mark student attendance for today")],-1)),_c=["disabled"],pc=B(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Create New Notice"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Send announcement to students")],-1)),fc={key:0,class:"text-sm text-yellow-600 mt-3"},xc={key:1,class:"h-full"},bc={setup(c){const _=ge(),u=S({}),h=S([]),l=S(""),M=S(!1),j=S("dashboard"),w=S(null),g=S(!1),r=S(!1),R=S(""),b={attendance:So,"attendance-record":He,"create-notice":Uo,"previous-notices":Tn,"leave-appeals":ia,promotion:Ha,"remove-courses":Es},P=()=>b[j.value]||null,x=E=>{$.loading||(j.value=E,window.innerWidth<768&&(M.value=!1))},C=E=>{E&&(R.value=E,r.value=!0)},I=Ce.user,F=()=>{var E;try{const y=localStorage.getItem("user_details"),m=localStorage.getItem("selected_student_group");if(y){const d=JSON.parse(y);u.value={name:d.name,img_url:d.img_url},((E=d.student_groups)==null?void 0:E.length)&&(h.value=d.student_groups,l.value=m||d.student_groups[0],g.value=!0)}}catch(y){console.warn("Error loading from localStorage:",y)}},$=U({url:"school.al_ummah.api2.get_instructor_app_data",params:{teacherID:I},auto:!1,onSuccess(E){var y;console.log("Instructor details loaded:",E),w.value=null;try{E?(u.value={name:E.name,img_url:E.img_url},((y=E.student_groups)==null?void 0:y.length)&&(h.value=E.student_groups,l.value=E.student_groups[0],localStorage.setItem("selected_student_group",E.student_groups[0])),localStorage.setItem("user_details",JSON.stringify({name:E.name,img_url:E.img_url,student_groups:E.student_groups})),g.value=!0):w.value="No user data received from server"}catch(m){console.error("Error processing user data:",m),w.value="Error processing user data"}},onError(E){console.error("Error loading instructor details:",E),w.value="Failed to load user data. Please try again.",g.value||Z()}}),H=z(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),Z=()=>{try{F(),(u.value.name||h.value.length)&&(g.value=!0,w.value=null)}catch(E){console.error("Error loading from localStorage:",E),w.value="Unable to load user data. Please refresh the page."}},K=()=>J(this,null,function*(){l.value&&localStorage.setItem("selected_student_group",l.value)}),Q=E=>{E.target.style.display="none";const y=E.target.nextElementSibling;y&&(y.style.display="flex")},te=()=>{w.value=null,g.value=!1,$.reload()},V=()=>J(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student_group"),yield Ce.logout.submit(),_.push({name:"Login"})}catch(E){console.error("Logout error:",E),localStorage.clear(),_.push({name:"Login"})}}),W=()=>{window.innerWidth>=768&&(M.value=!1)};return le(()=>{F(),window.addEventListener("resize",W),setTimeout(()=>{$.reload().catch(E=>{console.error("Failed to reload user details:",E),w.value="Network error. Please check your connection."})},100)}),Ie(()=>{window.removeEventListener("resize",W)}),he(()=>$.loading,E=>{!E&&$.data&&console.log("Data loaded successfully")}),he(()=>j.value,()=>{window.innerWidth<768&&(M.value=!1)}),(E,y)=>(s(),o("div",Ua,[r.value?(s(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4",onClick:y[2]||(y[2]=m=>r.value=!1)},[e("div",Wa,[e("img",{src:R.value,alt:"Full size profile photo",class:"max-w-full max-h-full object-contain",onClick:y[0]||(y[0]=de(()=>{},["stop"]))},null,8,qa),e("button",{onClick:y[1]||(y[1]=m=>r.value=!1),class:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors"},[L(i(ue),{class:"w-8 h-8"})])])])):T("",!0),w.value?(s(),o("div",Ja,[e("div",Ya,[e("div",Za,[e("div",Ka,[L(i(Me),{class:"w-6 h-6 text-red-600"})]),Qa]),e("p",Xa,n(w.value),1),e("div",{class:"flex space-x-3"},[e("button",{onClick:te,class:"flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors"}," Try Again "),e("button",{onClick:V,class:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors"}," Logout ")])])])):i($).loading&&!g.value?(s(),o("div",ei,si)):(s(),o("div",oi,[e("header",ni,[e("div",ri,[e("div",{class:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0 cursor-pointer",onClick:y[3]||(y[3]=m=>C(u.value.img_url))},[u.value.img_url?(s(),o("img",{key:0,src:u.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:Q},null,40,li)):(s(),o("div",ai,[L(i(Ae),{class:"w-5 h-5 text-gray-400"})]))]),e("div",ii,[e("h2",ci,n(u.value.name||"Teacher"),1),di])]),e("button",{onClick:y[4]||(y[4]=m=>M.value=!M.value),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[L(i(Ue),{class:"w-6 h-6"})])]),M.value?(s(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:y[5]||(y[5]=m=>M.value=!1)})):T("",!0),e("aside",{class:D(["bg-white shadow-md p-4 md:p-6 space-y-6 md:space-y-8 z-50","fixed md:relative inset-y-0 left-0 transform transition-transform duration-300 ease-in-out","w-72 max-w-full",M.value?"translate-x-0":"-translate-x-full md:translate-x-0","flex flex-col h-screen md:h-auto"])},[e("div",ui,[mi,e("button",{onClick:y[6]||(y[6]=m=>M.value=!1),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[L(i(ue),{class:"w-5 h-5"})])]),e("div",gi,[e("div",hi,[e("div",{class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden cursor-pointer",onClick:y[7]||(y[7]=m=>C(u.value.img_url))},[u.value.img_url?(s(),o("img",{key:0,src:u.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:Q},null,40,vi)):(s(),o("div",_i,[L(i(Ae),{class:"w-6 h-6 text-gray-400"})]))]),e("div",pi,[e("h2",fi,n(u.value.name||"Loading..."),1),xi])]),e("div",bi,[yi,be(e("select",{"onUpdate:modelValue":y[8]||(y[8]=m=>l.value=m),onChange:K,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",disabled:i($).loading||!h.value.length},[$i,(s(!0),o(se,null,oe(h.value,(m,d)=>(s(),o("option",{key:d,value:m},n(m),9,ki))),128))],40,wi),[[Fe,l.value]]),h.value.length?T("",!0):(s(),o("p",Si," No classes available "))]),e("div",Ci,[Ai,e("nav",ji,[e("button",{onClick:y[9]||(y[9]=m=>x("dashboard")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:i($).loading},[L(i(We),{class:"w-5 h-5 flex-shrink-0"}),Ei],10,Mi),e("button",{onClick:y[10]||(y[10]=m=>x("attendance")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="attendance"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:!l.value||i($).loading},[L(i(we),{class:"w-5 h-5 flex-shrink-0"}),Ni],10,Ti),e("button",{onClick:y[11]||(y[11]=m=>x("promotion")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="promotion"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"]),disabled:!l.value||i($).loading},[L(i(Ke),{class:"w-5 h-5 flex-shrink-0"}),Ri],10,Pi),e("button",{onClick:y[12]||(y[12]=m=>x("remove-courses")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="remove-courses"?"bg-red-100 border border-red-200 text-red-800":"bg-red-50 text-red-800 hover:bg-red-100"]),disabled:!l.value||i($).loading},[L(i(tt),{class:"w-5 h-5 flex-shrink-0"}),Di],10,Li),e("button",{onClick:y[13]||(y[13]=m=>x("attendance-record")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="attendance-record"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"]),disabled:!l.value||i($).loading},[L(i(je),{class:"w-5 h-5 flex-shrink-0"}),Ii],10,Bi),e("button",{onClick:y[14]||(y[14]=m=>x("create-notice")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="create-notice"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"]),disabled:!l.value||i($).loading},[L(i(Te),{class:"w-5 h-5 flex-shrink-0"}),zi],10,Fi),e("button",{onClick:y[15]||(y[15]=m=>x("previous-notices")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="previous-notices"?"bg-purple-100 border border-purple-200 text-purple-800":"bg-purple-50 text-purple-800 hover:bg-purple-100"]),disabled:!l.value||i($).loading},[L(i(qe),{class:"w-5 h-5 flex-shrink-0"}),Vi],10,Oi),e("button",{onClick:y[16]||(y[16]=m=>x("leave-appeals")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",j.value==="leave-appeals"?"bg-indigo-100 border border-indigo-200 text-indigo-800":"bg-indigo-50 text-indigo-800 hover:bg-indigo-100"]),disabled:!l.value||i($).loading},[L(i(Je),{class:"w-5 h-5 flex-shrink-0"}),Hi],10,Gi)])]),e("div",Ui,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",onClick:V,disabled:i($).loading},[L(i(Ye),{class:"w-5 h-5 flex-shrink-0"}),qi],8,Wi)])])],2),e("main",{class:D(["flex-1 min-h-screen md:min-h-0 p-4 md:p-6 lg:p-8 bg-gray-50",{"opacity-50 pointer-events-none":i($).loading}])},[j.value==="dashboard"?(s(),o("div",Ji,[e("div",Yi,[e("h1",Zi,"Welcome, "+n(u.value.name||"Teacher")+"!",1),Ki]),e("div",Qi,[e("div",Xi,[e("div",ec,[e("div",null,[tc,e("p",sc,n(l.value||"None"),1)]),L(i(je),{class:"w-6 h-6 md:w-8 md:h-8 text-blue-500 flex-shrink-0"})])]),e("div",oc,[e("div",nc,[e("div",null,[rc,e("p",lc,n(h.value.length),1)]),L(i(we),{class:"w-6 h-6 md:w-8 md:h-8 text-green-500 flex-shrink-0"})])]),e("div",ac,[e("div",ic,[e("div",null,[cc,e("p",dc,n(i(H)),1)]),L(i(Ze),{class:"w-6 h-6 md:w-8 md:h-8 text-purple-500 flex-shrink-0"})])])]),e("div",uc,[mc,e("div",gc,[e("button",{onClick:y[17]||(y[17]=m=>x("attendance")),disabled:!l.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[L(i(we),{class:"w-5 h-5 md:w-6 md:h-6 text-blue-600 mr-3 flex-shrink-0"}),vc],8,hc),e("button",{onClick:y[18]||(y[18]=m=>x("create-notice")),disabled:!l.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[L(i(Te),{class:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 mr-3 flex-shrink-0"}),pc],8,_c)]),l.value?T("",!0):(s(),o("p",fc," Please select a class to access these features "))])])):(s(),o("div",xc,[(s(),G(ze(P()),{"selected-group":l.value,onBackToDashboard:y[19]||(y[19]=m=>x("dashboard")),key:l.value+j.value},null,8,["selected-group"]))]))],2)]))]))}};var jc=ae(bc,[["__scopeId","data-v-34555227"]]);export{jc as default};
