var A=(y,s,a)=>new Promise((d,c)=>{var p=h=>{try{r(a.next(h))}catch(C){c(C)}},v=h=>{try{r(a.throw(h))}catch(C){c(C)}},r=h=>h.done?d(h.value):Promise.resolve(h.value).then(p,v);r((a=a.apply(y,s)).next())});import{_ as B,r as S,w as M,u as z,o as P,d as l,e as n,y as o,f as e,t as i,g as f,p as R,h as U,x as F,F as W,G as Q,L as ne,z as X,A as O,C as V,D as T,n as D,b as re,i as k,E as de,N as ie,O as ce,M as ue}from"./vendor.f9104dde.js";import{session as Y}from"./session.26c2a600.js";import{b as _e,c as K,d as me,r as ge,e as he,f as Z,g as pe,h as ee,i as xe,a as te,j as ve}from"./XMarkIcon.01a7cfc5.js";import"./index.8cf7819b.js";const I=y=>(R("data-v-1c7d4abe"),y=y(),U(),y),be={class:"min-h-screen bg-gray-50 p-4"},fe={key:0,class:"flex justify-center items-center py-8"},ye=I(()=>e("div",{class:"spinner"},null,-1)),we=I(()=>e("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)),$e=[ye,we],ke={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Se=I(()=>e("p",{class:"text-red-800 font-medium mb-2"},"Failed to load student details",-1)),Ce={class:"text-red-700 text-sm"},Ie={key:2,class:"bg-white rounded-lg shadow-sm"},Ne={class:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-t-lg p-6"},je={class:"flex items-center space-x-4"},De={class:"flex-shrink-0"},Ee=["src"],Le={class:"flex-1 text-white"},Ae={class:"text-2xl font-bold"},Me={class:"text-blue-100"},Pe={key:0,class:"text-blue-100"},Ve={class:"text-blue-100"},Be={class:"text-blue-100"},ze={class:"p-6"},Re={class:"space-y-4 mb-6"},Ue=I(()=>e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),Fe=I(()=>e("p",{class:"text-sm text-gray-600"},"Phone",-1)),Oe={class:"font-medium text-gray-800"},Te={key:1,class:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg"},Je=I(()=>e("div",{class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})])],-1)),qe={class:"flex-1"},Ge=I(()=>e("p",{class:"text-sm text-gray-600"},"Address",-1)),He={class:"font-medium text-gray-800"},We={class:"bg-gray-50 rounded-lg p-6"},Qe=I(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Attendance Summary",-1)),Xe={class:"grid grid-cols-3 gap-4"},Ye={class:"text-center bg-green-50 rounded-lg p-4 border border-green-200"},Ke={class:"text-2xl font-bold text-green-600"},Ze=I(()=>e("p",{class:"text-sm text-green-700 font-medium"},"Present",-1)),et={class:"text-center bg-red-50 rounded-lg p-4 border border-red-200"},tt={class:"text-2xl font-bold text-red-600"},st=I(()=>e("p",{class:"text-sm text-red-700 font-medium"},"Absent",-1)),ot={class:"text-center bg-yellow-50 rounded-lg p-4 border border-yellow-200"},at={class:"text-2xl font-bold text-yellow-600"},lt=I(()=>e("p",{class:"text-sm text-yellow-700 font-medium"},"Leave",-1)),nt={key:3,class:"text-center py-8"},rt=I(()=>e("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"No Student Data",-1)),dt=I(()=>e("p",{class:"text-gray-600 mb-4"},"Unable to load student information.",-1)),it={setup(y){const s=S({}),a=M({url:"school.al_ummah.api2.get_student_app_data",auto:!1,onSuccess(r){if(r&&r.student)s.value=r;else throw r&&r.error?new Error(r.error):new Error("No student data received")},onError(r){console.error("Error fetching student details:",r),s.value={}}}),d=z(()=>s.value.base64profile?`data:image/jpeg;base64,${s.value.base64profile}`:"https://via.placeholder.com/150?text=Student"),c=r=>{r.target.src="https://via.placeholder.com/150?text=Student"},p=()=>{s.value.mobile&&window.open(`tel:${s.value.mobile}`,"_self")},v=()=>A(this,null,function*(){try{let r=localStorage.getItem("selected_student");if(r&&r.startsWith("{"))try{const h=JSON.parse(r);r=h.student||h.name}catch(h){console.error("Error parsing student data:",h)}if(!r)throw new Error("No student ID found");yield a.fetch({studentID:r})}catch(r){console.error("Error loading student details:",r)}});return P(()=>{v()}),(r,h)=>(l(),n("div",be,[o(a).loading?(l(),n("div",fe,$e)):o(a).error?(l(),n("div",ke,[Se,e("p",Ce,i(o(a).error.message),1),e("button",{onClick:v,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):s.value&&s.value.student?(l(),n("div",Ie,[e("div",Ne,[e("div",je,[e("div",De,[e("img",{src:o(d),alt:"Student",class:"w-20 h-20 rounded-full border-4 border-white object-cover",onError:c},null,40,Ee)]),e("div",Le,[e("h1",Ae,i(s.value.student_name||s.value.name||"Unknown Student"),1),e("p",Me,"Student ID: "+i(s.value.student),1),s.value.group_roll_no?(l(),n("p",Pe,"Roll No: "+i(s.value.group_roll_no),1)):f("",!0),e("p",Ve,"Class: "+i(s.value.student_group),1),e("p",Be,"Today: "+i(s.value.status||"No Record"),1)])])]),e("div",ze,[e("div",Re,[s.value.mobile?(l(),n("div",{key:0,class:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors",onClick:p},[Ue,e("div",null,[Fe,e("p",Oe,i(s.value.mobile),1)])])):f("",!0),s.value.address?(l(),n("div",Te,[Je,e("div",qe,[Ge,e("p",He,i(s.value.address),1)])])):f("",!0)]),e("div",We,[Qe,e("div",Xe,[e("div",Ye,[e("p",Ke,i(s.value.present_count||0),1),Ze]),e("div",et,[e("p",tt,i(s.value.absent_count||0),1),st]),e("div",ot,[e("p",at,i(s.value.leave_count||0),1),lt])])])])])):(l(),n("div",nt,[e("div",{class:"bg-white rounded-lg shadow-sm p-8"},[rt,dt,e("button",{onClick:v,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])]))]))}};var ct=B(it,[["__scopeId","data-v-1c7d4abe"]]);const L=y=>(R("data-v-5403aa4c"),y=y(),U(),y),ut={class:"min-h-screen bg-gray-50 p-4"},_t={class:"mb-6"},mt=L(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Notices",-1)),gt=L(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),ht={key:0,class:"text-sm text-gray-500 mt-1"},pt={key:0,class:"flex justify-center items-center py-8"},xt=L(()=>e("div",{class:"spinner"},null,-1)),vt=L(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),bt=[xt,vt],ft={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},yt=L(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),wt={key:2,class:"space-y-4"},$t=["onClick"],kt={class:"p-6"},St={class:"flex items-start justify-between mb-3"},Ct={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},It={class:"text-sm text-gray-500 whitespace-nowrap"},Nt={class:"text-gray-600 line-clamp-2 mb-2"},jt={class:"text-sm text-gray-500"},Dt={key:0,class:"text-center py-12"},Et=ne('<div class="bg-white rounded-lg shadow-sm p-8" data-v-5403aa4c><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5403aa4c><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-5403aa4c></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-5403aa4c>No Notices Found</h3><p class="text-gray-600" data-v-5403aa4c>No notices have been published for this class yet.</p></div>',1),Lt=[Et],At={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Mt={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},Pt={class:"p-6"},Vt={class:"flex items-center justify-between mb-4"},Bt={class:"text-xl font-bold text-gray-800"},zt=L(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Rt=[zt],Ut={class:"mb-4 text-sm text-gray-500"},Ft={class:"prose max-w-none mb-6"},Ot={class:"text-gray-700 whitespace-pre-wrap"},Tt={setup(y){const s=S([]),a=S(""),d=S(null),c=S(!1),p=M({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(t){console.log("Notices loaded:",t),s.value=Array.isArray(t)?t:[]},onError(t){console.error("Error fetching notices:",t),s.value=[]}}),v=()=>{try{const t=localStorage.getItem("selected_student_group");t&&(a.value=t)}catch(t){console.error("Failed to load selected student group:",t)}},r=()=>{if(!a.value)return;const t={student_group:a.value};p.fetch(t)},h=t=>{if(!t)return"No date";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(m){return t}},C=t=>{d.value=t,c.value=!0},E=()=>{c.value=!1,d.value=null};return P(()=>{v(),a.value&&r()}),F(a,t=>{t&&r()}),(t,m)=>(l(),n("div",ut,[e("div",_t,[mt,gt,a.value?(l(),n("p",ht,"Class: "+i(a.value),1)):f("",!0)]),o(p).loading?(l(),n("div",pt,bt)):o(p).error?(l(),n("div",ft,[yt,e("button",{onClick:r,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(l(),n("div",wt,[(l(!0),n(W,null,Q(s.value,(g,w)=>(l(),n("div",{key:w,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:b=>C(g)},[e("div",kt,[e("div",St,[e("h3",Ct,i(g.notice_heading||"No Title"),1),e("span",It,i(h(g.date)),1)]),e("p",Nt,i(g.notice_message||"No message content"),1),e("div",jt,[e("span",null,"By: "+i(g.owner||"System"),1)])])],8,$t))),128)),s.value.length===0?(l(),n("div",Dt,Lt)):f("",!0)])),d.value&&c.value?(l(),n("div",At,[e("div",Mt,[e("div",Pt,[e("div",Vt,[e("h2",Bt,i(d.value.notice_heading),1),e("button",{onClick:E,class:"text-gray-400 hover:text-gray-600"},Rt)]),e("div",Ut,[e("p",null,"Published on: "+i(h(d.value.date)),1),e("p",null,"By: "+i(d.value.owner||"System"),1)]),e("div",Ft,[e("p",Ot,i(d.value.notice_message),1)]),e("div",{class:"flex justify-end pt-4 border-t"},[e("button",{onClick:E,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Close ")])])])])):f("",!0)]))}};var Jt=B(Tt,[["__scopeId","data-v-5403aa4c"]]);const qt={class:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6"},Gt={class:"mb-4 p-4 bg-blue-50 rounded-lg"},Ht=e("h3",{class:"text-lg font-semibold text-blue-800 mb-2"},"Student Information",-1),Wt={key:0,class:"text-sm text-blue-700"},Qt=e("strong",null,"Student:",-1),Xt={key:1,class:"text-sm text-blue-700"},Yt=e("strong",null,"Group:",-1),Kt={key:2,class:"text-sm text-red-600"},Zt={class:"mb-4"},es=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"From Date *",-1),ts={class:"mb-4"},ss=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"To Date *",-1),os={key:0,class:"mb-4"},as=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Total Days",-1),ls=["value"],ns={class:"mb-4"},rs=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reason *",-1),ds={class:"mb-6"},is=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload Image (Optional)",-1),cs={key:0,class:"text-xs text-gray-500 mt-1"},us=["disabled"],_s={key:0,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ms=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1),gs=[ms],hs={key:1,class:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ps=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),xs=[ps],vs={key:1,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md"},bs={class:"flex items-start"},fs=e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),ys=e("p",{class:"text-red-700 text-sm font-medium"},"Unable to submit leave application",-1),ws={class:"text-red-600 text-sm mt-1"},$s={key:2,class:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md"},ks={class:"flex items-start"},Ss=e("svg",{class:"w-5 h-5 text-green-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Cs=e("p",{class:"text-green-700 text-sm font-medium"},"Success!",-1),Is={class:"text-green-600 text-sm mt-1"},Ns={setup(y){const s=X({from_date:"",to_date:"",reason:"",total_days:"",image:null}),a=X({student:"",student_name:"",student_group:""}),d=S(""),c=S(""),p=z(()=>a.student&&s.from_date&&s.to_date&&s.reason&&a.student_group),v=()=>{try{const t=localStorage.getItem("selected_student"),m=localStorage.getItem("selected_student_group");if(t){let g;try{g=JSON.parse(t)}catch(w){g=t}if(typeof g=="object"&&g!==null?(a.student=g.student||g.name||"",a.student_name=g.student_name||g.name||""):(a.student=g,a.student_name=g),m)try{const w=JSON.parse(m);a.student_group=w.student_group||w.name||w}catch(w){a.student_group=m}}else d.value="Student data not found in storage. Please select a student first."}catch(t){console.error("Error loading student info:",t),d.value="Failed to load student info."}},r=t=>new Promise((m,g)=>{const w=new FileReader;w.onload=()=>{const b=w.result.split(",")[1];m(b)},w.onerror=b=>g(b),w.readAsDataURL(t)}),h=t=>{const m=t.target.files[0];m?s.image=m:s.image=null},C=M({url:"school.al_ummah.api2.submit_leave_application",method:"POST",auto:!1,onSuccess(t){if(console.log("API response:",t),t.status==="success"){const m=t.message||"Leave application submitted successfully!";c.value=m,d.value="",Object.assign(s,{from_date:"",to_date:"",reason:"",total_days:"",image:null}),setTimeout(()=>{c.value=""},5e3)}else d.value=t.message||"Failed to submit leave application."},onError(t){if(console.error("API error details:",{response:t.response,exc_type:t.exc_type,exc_message:t.exc_message,_server_messages:t._server_messages,message:t.message}),t.response&&t.response.includes("already exists against the student"))d.value="Leave already submitted for this student. You cannot submit multiple applications.";else if(t._server_messages&&t._server_messages.includes("already exists against the student"))d.value="Leave already submitted for this student.";else if(t.exc_message&&t.exc_message.includes("already exists against the student"))d.value="Leave already submitted for this student.";else if(t.exc_type==="ValidationError")t.exc_message?d.value=t.exc_message.replace("frappe.exceptions.ValidationError: ",""):d.value="Validation error occurred. Please check your input.";else if(t._server_messages)try{const m=JSON.parse(t._server_messages||"[]");if(m.length>0){const g=m[m.length-1],w=JSON.parse(g);d.value=w.message||"An error occurred while submitting the leave application."}}catch(m){d.value=t.message||"An error occurred while submitting the leave application."}else d.value=t.message||"An error occurred while submitting the leave application.";c.value=""}}),E=()=>A(this,null,function*(){if(!p.value){d.value="Please fill in all required fields.";return}d.value="",c.value="";try{let t=null;s.image&&s.image instanceof File&&(t=yield r(s.image));const m={student:a.student,from_date:s.from_date,to_date:s.to_date,student_group:a.student_group,reason:s.reason,image:t};console.log("Submitting leave application with data:",m),yield C.submit(m)}catch(t){console.error("Submission error:",t),d.value="An error occurred while processing your request."}});return P(()=>{v()}),(t,m)=>(l(),n("div",qt,[e("div",Gt,[Ht,o(a).student_name?(l(),n("p",Wt,[Qt,O(" "+i(o(a).student_name),1)])):f("",!0),o(a).student_group?(l(),n("p",Xt,[Yt,O(" "+i(o(a).student_group),1)])):f("",!0),o(a).student_name?f("",!0):(l(),n("p",Kt," No student information found. Please select a student first. "))]),e("div",Zt,[es,V(e("input",{type:"date","onUpdate:modelValue":m[0]||(m[0]=g=>o(s).from_date=g),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[T,o(s).from_date]])]),e("div",ts,[ss,V(e("input",{type:"date","onUpdate:modelValue":m[1]||(m[1]=g=>o(s).to_date=g),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[T,o(s).to_date]])]),o(s).total_days?(l(),n("div",os,[as,e("input",{type:"text",value:o(s).total_days,readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,ls)])):f("",!0),e("div",ns,[rs,V(e("textarea",{"onUpdate:modelValue":m[2]||(m[2]=g=>o(s).reason=g),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for leave...",required:""},null,512),[[T,o(s).reason]])]),e("div",ds,[is,e("input",{type:"file",onChange:h,accept:"image/*",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32),o(s).image?(l(),n("p",cs," Image selected: "+i(o(s).image.name),1)):f("",!0)]),e("button",{onClick:E,disabled:o(C).loading||!o(p),class:D(["w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",o(C).loading||!o(p)?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"])},[o(C).loading?(l(),n("svg",hs,xs)):(l(),n("svg",_s,gs)),O(" "+i(o(C).loading?"Submitting...":"Appeal Leave"),1)],10,us),d.value?(l(),n("div",vs,[e("div",bs,[fs,e("div",null,[ys,e("p",ws,i(d.value),1)])])])):f("",!0),c.value?(l(),n("div",$s,[e("div",ks,[Ss,e("div",null,[Cs,e("p",Is,i(c.value),1)])])])):f("",!0)]))}};const x=y=>(R("data-v-244fbd7e"),y=y(),U(),y),js={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},Ds={key:0,class:"fixed inset-0 bg-red-50 bg-opacity-90 flex items-center justify-center z-50 p-4"},Es={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},Ls={class:"flex items-center mb-4"},As={class:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"},Ms=x(()=>e("h3",{class:"text-lg font-semibold text-red-800"},"Something went wrong",-1)),Ps={class:"text-gray-600 mb-4"},Vs={key:1,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},Bs=x(()=>e("div",{class:"text-center"},[e("div",{class:"spinner mb-4 mx-auto"}),e("p",{class:"text-gray-600"},"Loading your dashboard...")],-1)),zs=[Bs],Rs={key:2,class:"flex flex-col md:flex-row w-full min-h-screen"},Us={class:"md:hidden bg-white shadow-sm border-b border-gray-200 p-4 flex items-center justify-between"},Fs={class:"flex items-center space-x-3"},Os={class:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0"},Ts=["src"],Js={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},qs={class:"min-w-0 flex-1"},Gs={class:"text-sm font-semibold text-gray-800 truncate"},Hs=x(()=>e("p",{class:"text-xs text-gray-500"},"Parent",-1)),Ws={class:"flex items-center justify-between md:hidden pb-4 border-b border-gray-200"},Qs=x(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Menu",-1)),Xs={class:"flex-1 overflow-y-auto space-y-6 md:space-y-8"},Ys={class:"hidden md:flex items-start space-x-4 border-b pb-4"},Ks={class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden"},Zs=["src"],eo={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},to={class:"min-w-0 flex-1"},so={class:"text-xl font-semibold text-gray-800 break-words"},oo=x(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Parent",-1)),ao={key:0,class:"text-xs text-gray-600 mt-1 truncate"},lo={class:"space-y-2"},no=x(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Child:",-1)),ro=["disabled"],io=x(()=>e("option",{value:"",disabled:""},"Select a child",-1)),co=["value"],uo={key:0,class:"text-sm text-yellow-600"},_o={class:"space-y-3"},mo=x(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),go={class:"space-y-2"},ho=["disabled"],po=x(()=>e("span",{class:"truncate"},"Dashboard",-1)),xo=["disabled"],vo=x(()=>e("span",{class:"truncate"},"Attendance Record",-1)),bo=["disabled"],fo=x(()=>e("span",{class:"truncate"},"Browse Notices",-1)),yo=["disabled"],wo=x(()=>e("span",{class:"truncate"},"Appeal Leave",-1)),$o={class:"pt-4 border-t border-gray-200 flex-shrink-0"},ko=["disabled"],So=x(()=>e("span",null,"Logout",-1)),Co={key:0},Io={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 mb-4 md:mb-6"},No={class:"text-xl md:text-2xl font-bold text-gray-800 mb-2"},jo=x(()=>e("p",{class:"text-gray-600 text-sm md:text-base"},"Monitor your child's activities and school records from here.",-1)),Do={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-4 md:mb-6"},Eo={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-blue-500"},Lo={class:"flex items-center justify-between"},Ao=x(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Selected Child",-1)),Mo={class:"text-lg md:text-2xl font-bold text-gray-800 truncate"},Po={key:0,class:"text-xs text-gray-500 mt-1"},Vo={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-green-500"},Bo={class:"flex items-center justify-between"},zo=x(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Available Children",-1)),Ro={class:"text-lg md:text-2xl font-bold text-gray-800"},Uo={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-purple-500"},Fo={class:"flex items-center justify-between"},Oo=x(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Today's Date",-1)),To={class:"text-lg md:text-2xl font-bold text-gray-800"},Jo={class:"bg-white rounded-lg shadow-sm p-4 md:p-6"},qo=x(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),Go={class:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"},Ho=["disabled"],Wo=x(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"View Attendance Record"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Check your child's attendance history")],-1)),Qo=["disabled"],Xo=x(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Appeal for Leave"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Submit leave appeal for your child")],-1)),Yo={key:0,class:"text-sm text-yellow-600 mt-3"},Ko={key:1,class:"h-full"},Zo={setup(y){const s=ue(),a=S({}),d=S([]),c=S(null),p=S(!1),v=S("dashboard"),r=S(null),h=S(!1),C={"attendance-info":ct,"browse-notices":Jt,"appeal-leave":Ns},E=()=>C[v.value]||null,t=_=>{b.loading||(v.value=_,window.innerWidth<768&&(p.value=!1))},m=Y.user,g="parent",w=()=>{var _;try{const u=localStorage.getItem("user_details"),j=localStorage.getItem("selected_student");if(u){const N=JSON.parse(u);a.value={name:N.name,image:N.base64profile,address:N.address},((_=N.student_list)==null?void 0:_.length)&&(d.value=N.student_list,j?c.value=JSON.parse(j):c.value=N.student_list[0],h.value=!0)}}catch(u){console.warn("Error loading from localStorage:",u)}},b=M({url:"school.al_ummah.api2.get_user_details",params:{role:g,username:m},auto:!1,onSuccess(_){var u,j;console.log("Parent user details loaded:",_),r.value=null;try{_&&_.user_details?(a.value={name:_.user_details.name,image:_.user_details.base64profile,address:_.user_details.address},((u=_.user_details.student_list)==null?void 0:u.length)&&(d.value=_.user_details.student_list,c.value=_.user_details.student_list[0],localStorage.setItem("selected_student",JSON.stringify(_.user_details.student_list[0])),localStorage.setItem("selected_student_group",((j=_.user_details.student_list[0])==null?void 0:j.student_group)||"")),localStorage.setItem("user_details",JSON.stringify(_.user_details)),h.value=!0):r.value="No user data received from server"}catch(N){console.error("Error processing user data:",N),r.value="Error processing user data"}},onError(_){console.error("Error loading parent user details:",_),r.value="Failed to load user data. Please try again.",h.value||oe()}}),se=z(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),oe=()=>{try{w(),(a.value.name||d.value.length)&&(h.value=!0,r.value=null)}catch(_){console.error("Error loading from localStorage:",_),r.value="Unable to load user data. Please refresh the page."}},ae=()=>A(this,null,function*(){c.value&&(localStorage.setItem("selected_student",JSON.stringify(c.value)),localStorage.setItem("selected_student_group",c.value.student_group||""))}),J=_=>{_.target.style.display="none";const u=_.target.nextElementSibling;u&&(u.style.display="flex")},le=()=>{r.value=null,h.value=!1,b.reload()},q=()=>A(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student"),localStorage.removeItem("selected_student_group"),yield Y.logout.submit(),s.push({name:"Login"})}catch(_){console.error("Logout error:",_),localStorage.clear(),s.push({name:"Login"})}}),G=()=>{window.innerWidth>=768&&(p.value=!1)};return P(()=>{w(),window.addEventListener("resize",G),setTimeout(()=>{b.reload().catch(_=>{console.error("Failed to reload user details:",_),r.value="Network error. Please check your connection."})},100)}),re(()=>{window.removeEventListener("resize",G)}),F(()=>b.loading,_=>{!_&&b.data&&console.log("Parent data loaded successfully")}),F(()=>v.value,()=>{window.innerWidth<768&&(p.value=!1)}),(_,u)=>{var j,N,H;return l(),n("div",js,[r.value?(l(),n("div",Ds,[e("div",Es,[e("div",Ls,[e("div",As,[k(o(_e),{class:"w-6 h-6 text-red-600"})]),Ms]),e("p",Ps,i(r.value),1),e("div",{class:"flex space-x-3"},[e("button",{onClick:le,class:"flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors"}," Try Again "),e("button",{onClick:q,class:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors"}," Logout ")])])])):o(b).loading&&!h.value?(l(),n("div",Vs,zs)):(l(),n("div",Rs,[e("header",Us,[e("div",Fs,[e("div",Os,[a.value.image?(l(),n("img",{key:0,src:`data:image/jpeg;base64,${a.value.image}`,alt:"Parent",class:"object-cover w-full h-full",onError:J},null,40,Ts)):(l(),n("div",Js,[k(o(K),{class:"w-5 h-5 text-gray-400"})]))]),e("div",qs,[e("h2",Gs,i(a.value.name||"Parent"),1),Hs])]),e("button",{onClick:u[0]||(u[0]=$=>p.value=!p.value),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[k(o(me),{class:"w-6 h-6"})])]),p.value?(l(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:u[1]||(u[1]=$=>p.value=!1)})):f("",!0),e("aside",{class:D(["bg-white shadow-md p-4 md:p-6 space-y-6 md:space-y-8 z-50","fixed md:relative inset-y-0 left-0 transform transition-transform duration-300 ease-in-out","w-72 max-w-full",p.value?"translate-x-0":"-translate-x-full md:translate-x-0","flex flex-col h-screen md:h-auto"])},[e("div",Ws,[Qs,e("button",{onClick:u[2]||(u[2]=$=>p.value=!1),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[k(o(ge),{class:"w-5 h-5"})])]),e("div",Xs,[e("div",Ys,[e("div",Ks,[a.value.image?(l(),n("img",{key:0,src:`data:image/jpeg;base64,${a.value.image}`,alt:"Parent",class:"object-cover w-full h-full",onError:J},null,40,Zs)):(l(),n("div",eo,[k(o(K),{class:"w-6 h-6 text-gray-400"})]))]),e("div",to,[e("h2",so,i(a.value.name||"Loading..."),1),oo,a.value.address?(l(),n("p",ao,i(a.value.address),1)):f("",!0)])]),e("div",lo,[no,V(e("select",{"onUpdate:modelValue":u[3]||(u[3]=$=>c.value=$),onChange:ae,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",disabled:o(b).loading||!d.value.length},[io,(l(!0),n(W,null,Q(d.value,$=>(l(),n("option",{key:$.student,value:$},i($.student_name||"Unnamed Student"),9,co))),128))],40,ro),[[de,c.value]]),d.value.length?f("",!0):(l(),n("p",uo," No children available "))]),e("div",_o,[mo,e("nav",go,[e("button",{onClick:u[4]||(u[4]=$=>t("dashboard")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",v.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:o(b).loading},[k(o(he),{class:"w-5 h-5 flex-shrink-0"}),po],10,ho),e("button",{onClick:u[5]||(u[5]=$=>t("attendance-info")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",v.value==="attendance-info"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:!c.value||o(b).loading},[k(o(Z),{class:"w-5 h-5 flex-shrink-0"}),vo],10,xo),e("button",{onClick:u[6]||(u[6]=$=>t("browse-notices")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",v.value==="browse-notices"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"]),disabled:!c.value||o(b).loading},[k(o(pe),{class:"w-5 h-5 flex-shrink-0"}),fo],10,bo),e("button",{onClick:u[7]||(u[7]=$=>t("appeal-leave")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",v.value==="appeal-leave"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"]),disabled:!c.value||o(b).loading},[k(o(ee),{class:"w-5 h-5 flex-shrink-0"}),wo],10,yo)])])]),e("div",$o,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",onClick:q,disabled:o(b).loading},[k(o(xe),{class:"w-5 h-5 flex-shrink-0"}),So],8,ko)])],2),e("main",{class:D(["flex-1 min-h-screen md:min-h-0 p-4 md:p-6 lg:p-8 bg-gray-50",{"opacity-50 pointer-events-none":o(b).loading}])},[v.value==="dashboard"?(l(),n("div",Co,[e("div",Io,[e("h1",No,"Welcome, "+i(a.value.name||"Parent")+"!",1),jo]),e("div",Do,[e("div",Eo,[e("div",Lo,[e("div",null,[Ao,e("p",Mo,i(((j=c.value)==null?void 0:j.student_name)||"None"),1),((N=c.value)==null?void 0:N.student_group)?(l(),n("p",Po,"Class: "+i(c.value.student_group),1)):f("",!0)]),k(o(te),{class:"w-6 h-6 md:w-8 md:h-8 text-blue-500 flex-shrink-0"})])]),e("div",Vo,[e("div",Bo,[e("div",null,[zo,e("p",Ro,i(d.value.length),1)]),k(o(te),{class:"w-6 h-6 md:w-8 md:h-8 text-green-500 flex-shrink-0"})])]),e("div",Uo,[e("div",Fo,[e("div",null,[Oo,e("p",To,i(o(se)),1)]),k(o(ve),{class:"w-6 h-6 md:w-8 md:h-8 text-purple-500 flex-shrink-0"})])])]),e("div",Jo,[qo,e("div",Go,[e("button",{onClick:u[8]||(u[8]=$=>t("attendance-info")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[k(o(Z),{class:"w-5 h-5 md:w-6 md:h-6 text-blue-600 mr-3 flex-shrink-0"}),Wo],8,Ho),e("button",{onClick:u[9]||(u[9]=$=>t("appeal-leave")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[k(o(ee),{class:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 mr-3 flex-shrink-0"}),Xo],8,Qo)]),c.value?f("",!0):(l(),n("p",Yo," Please select a child to access these features "))])])):(l(),n("div",Ko,[(l(),ie(ce(E()),{"selected-student":c.value,onBackToDashboard:u[10]||(u[10]=$=>t("dashboard")),key:((H=c.value)==null?void 0:H.student)+v.value},null,8,["selected-student"]))]))],2)]))])}}};var la=B(Zo,[["__scopeId","data-v-244fbd7e"]]);export{la as default};
