var A=(x,s,l)=>new Promise((d,m)=>{var f=h=>{try{a(l.next(h))}catch(S){m(S)}},p=h=>{try{a(l.throw(h))}catch(S){m(S)}},a=h=>h.done?d(h.value):Promise.resolve(h.value).then(f,p);a((l=l.apply(x,s)).next())});import{_ as E,l as C,c as M,a as V,x as L,o as n,e as r,u as o,m as e,t as i,n as w,p as P,q as R,w as T,F,E as z,M as K,r as J,z as U,A as B,C as O,y as D,D as Q,f as $,K as Y}from"./vendor.e48cf2aa.js";import{s as q}from"./index.6c2e3381.js";import{a as X,b as G,c as Z,d as H,e as ee,r as W,f as te}from"./UserGroupIcon.1e609207.js";const k=x=>(P("data-v-1c7d4abe"),x=x(),R(),x),se={class:"min-h-screen bg-gray-50 p-4"},oe={key:0,class:"flex justify-center items-center py-8"},le=k(()=>e("div",{class:"spinner"},null,-1)),ae=k(()=>e("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)),ne=[le,ae],re={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},de=k(()=>e("p",{class:"text-red-800 font-medium mb-2"},"Failed to load student details",-1)),ie={class:"text-red-700 text-sm"},ce={key:2,class:"bg-white rounded-lg shadow-sm"},ue={class:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-t-lg p-6"},_e={class:"flex items-center space-x-4"},me={class:"flex-shrink-0"},ge=["src"],he={class:"flex-1 text-white"},pe={class:"text-2xl font-bold"},ve={class:"text-blue-100"},be={key:0,class:"text-blue-100"},xe={class:"text-blue-100"},fe={class:"text-blue-100"},ye={class:"p-6"},we={class:"space-y-4 mb-6"},$e=k(()=>e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),ke=k(()=>e("p",{class:"text-sm text-gray-600"},"Phone",-1)),Se={class:"font-medium text-gray-800"},Ie={key:1,class:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg"},Ne=k(()=>e("div",{class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})])],-1)),Ce={class:"flex-1"},De=k(()=>e("p",{class:"text-sm text-gray-600"},"Address",-1)),je={class:"font-medium text-gray-800"},Ae={class:"bg-gray-50 rounded-lg p-6"},Me=k(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Attendance Summary",-1)),Le={class:"grid grid-cols-3 gap-4"},Be={class:"text-center bg-green-50 rounded-lg p-4 border border-green-200"},Ee={class:"text-2xl font-bold text-green-600"},Ve=k(()=>e("p",{class:"text-sm text-green-700 font-medium"},"Present",-1)),Pe={class:"text-center bg-red-50 rounded-lg p-4 border border-red-200"},Re={class:"text-2xl font-bold text-red-600"},Ue=k(()=>e("p",{class:"text-sm text-red-700 font-medium"},"Absent",-1)),Oe={class:"text-center bg-yellow-50 rounded-lg p-4 border border-yellow-200"},Te={class:"text-2xl font-bold text-yellow-600"},Fe=k(()=>e("p",{class:"text-sm text-yellow-700 font-medium"},"Leave",-1)),ze={key:3,class:"text-center py-8"},Je=k(()=>e("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"No Student Data",-1)),qe=k(()=>e("p",{class:"text-gray-600 mb-4"},"Unable to load student information.",-1)),Ge={setup(x){const s=C({}),l=M({url:"school.al_ummah.api2.get_student_app_data",auto:!1,onSuccess(a){if(a&&a.student)s.value=a;else throw a&&a.error?new Error(a.error):new Error("No student data received")},onError(a){console.error("Error fetching student details:",a),s.value={}}}),d=V(()=>s.value.base64profile?`data:image/jpeg;base64,${s.value.base64profile}`:"https://via.placeholder.com/150?text=Student"),m=a=>{a.target.src="https://via.placeholder.com/150?text=Student"},f=()=>{s.value.mobile&&window.open(`tel:${s.value.mobile}`,"_self")},p=()=>A(this,null,function*(){try{let a=localStorage.getItem("selected_student");if(a&&a.startsWith("{"))try{const h=JSON.parse(a);a=h.student||h.name}catch(h){console.error("Error parsing student data:",h)}if(!a)throw new Error("No student ID found");yield l.fetch({studentID:a})}catch(a){console.error("Error loading student details:",a)}});return L(()=>{p()}),(a,h)=>(n(),r("div",se,[o(l).loading?(n(),r("div",oe,ne)):o(l).error?(n(),r("div",re,[de,e("p",ie,i(o(l).error.message),1),e("button",{onClick:p,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):s.value&&s.value.student?(n(),r("div",ce,[e("div",ue,[e("div",_e,[e("div",me,[e("img",{src:o(d),alt:"Student",class:"w-20 h-20 rounded-full border-4 border-white object-cover",onError:m},null,40,ge)]),e("div",he,[e("h1",pe,i(s.value.student_name||s.value.name||"Unknown Student"),1),e("p",ve,"Student ID: "+i(s.value.student),1),s.value.group_roll_no?(n(),r("p",be,"Roll No: "+i(s.value.group_roll_no),1)):w("",!0),e("p",xe,"Class: "+i(s.value.student_group),1),e("p",fe,"Today: "+i(s.value.status||"No Record"),1)])])]),e("div",ye,[e("div",we,[s.value.mobile?(n(),r("div",{key:0,class:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors",onClick:f},[$e,e("div",null,[ke,e("p",Se,i(s.value.mobile),1)])])):w("",!0),s.value.address?(n(),r("div",Ie,[Ne,e("div",Ce,[De,e("p",je,i(s.value.address),1)])])):w("",!0)]),e("div",Ae,[Me,e("div",Le,[e("div",Be,[e("p",Ee,i(s.value.present_count||0),1),Ve]),e("div",Pe,[e("p",Re,i(s.value.absent_count||0),1),Ue]),e("div",Oe,[e("p",Te,i(s.value.leave_count||0),1),Fe])])])])])):(n(),r("div",ze,[e("div",{class:"bg-white rounded-lg shadow-sm p-8"},[Je,qe,e("button",{onClick:p,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])]))]))}};var He=E(Ge,[["__scopeId","data-v-1c7d4abe"]]);const j=x=>(P("data-v-5403aa4c"),x=x(),R(),x),We={class:"min-h-screen bg-gray-50 p-4"},Ke={class:"mb-6"},Qe=j(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Notices",-1)),Ye=j(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),Xe={key:0,class:"text-sm text-gray-500 mt-1"},Ze={key:0,class:"flex justify-center items-center py-8"},et=j(()=>e("div",{class:"spinner"},null,-1)),tt=j(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),st=[et,tt],ot={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},lt=j(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),at={key:2,class:"space-y-4"},nt=["onClick"],rt={class:"p-6"},dt={class:"flex items-start justify-between mb-3"},it={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},ct={class:"text-sm text-gray-500 whitespace-nowrap"},ut={class:"text-gray-600 line-clamp-2 mb-2"},_t={class:"text-sm text-gray-500"},mt={key:0,class:"text-center py-12"},gt=K('<div class="bg-white rounded-lg shadow-sm p-8" data-v-5403aa4c><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5403aa4c><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-5403aa4c></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-5403aa4c>No Notices Found</h3><p class="text-gray-600" data-v-5403aa4c>No notices have been published for this class yet.</p></div>',1),ht=[gt],pt={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},vt={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},bt={class:"p-6"},xt={class:"flex items-center justify-between mb-4"},ft={class:"text-xl font-bold text-gray-800"},yt=j(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),wt=[yt],$t={class:"mb-4 text-sm text-gray-500"},kt={class:"prose max-w-none mb-6"},St={class:"text-gray-700 whitespace-pre-wrap"},It={setup(x){const s=C([]),l=C(""),d=C(null),m=C(!1),f=M({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(t){console.log("Notices loaded:",t),s.value=Array.isArray(t)?t:[]},onError(t){console.error("Error fetching notices:",t),s.value=[]}}),p=()=>{try{const t=localStorage.getItem("selected_student_group");t&&(l.value=t)}catch(t){console.error("Failed to load selected student group:",t)}},a=()=>{if(!l.value)return;const t={student_group:l.value};f.fetch(t)},h=t=>{if(!t)return"No date";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(c){return t}},S=t=>{d.value=t,m.value=!0},I=()=>{m.value=!1,d.value=null};return L(()=>{p(),l.value&&a()}),T(l,t=>{t&&a()}),(t,c)=>(n(),r("div",We,[e("div",Ke,[Qe,Ye,l.value?(n(),r("p",Xe,"Class: "+i(l.value),1)):w("",!0)]),o(f).loading?(n(),r("div",Ze,st)):o(f).error?(n(),r("div",ot,[lt,e("button",{onClick:a,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(n(),r("div",at,[(n(!0),r(F,null,z(s.value,(g,y)=>(n(),r("div",{key:y,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:_=>S(g)},[e("div",rt,[e("div",dt,[e("h3",it,i(g.notice_heading||"No Title"),1),e("span",ct,i(h(g.date)),1)]),e("p",ut,i(g.notice_message||"No message content"),1),e("div",_t,[e("span",null,"By: "+i(g.owner||"System"),1)])])],8,nt))),128)),s.value.length===0?(n(),r("div",mt,ht)):w("",!0)])),d.value&&m.value?(n(),r("div",pt,[e("div",vt,[e("div",bt,[e("div",xt,[e("h2",ft,i(d.value.notice_heading),1),e("button",{onClick:I,class:"text-gray-400 hover:text-gray-600"},wt)]),e("div",$t,[e("p",null,"Published on: "+i(h(d.value.date)),1),e("p",null,"By: "+i(d.value.owner||"System"),1)]),e("div",kt,[e("p",St,i(d.value.notice_message),1)]),e("div",{class:"flex justify-end pt-4 border-t"},[e("button",{onClick:I,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Close ")])])])])):w("",!0)]))}};var Nt=E(It,[["__scopeId","data-v-5403aa4c"]]);const Ct={class:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6"},Dt={class:"mb-4 p-4 bg-blue-50 rounded-lg"},jt=e("h3",{class:"text-lg font-semibold text-blue-800 mb-2"},"Student Information",-1),At={key:0,class:"text-sm text-blue-700"},Mt=e("strong",null,"Student:",-1),Lt={key:1,class:"text-sm text-blue-700"},Bt=e("strong",null,"Group:",-1),Et={key:2,class:"text-sm text-red-600"},Vt={class:"mb-4"},Pt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"From Date *",-1),Rt={class:"mb-4"},Ut=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"To Date *",-1),Ot={key:0,class:"mb-4"},Tt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Total Days",-1),Ft=["value"],zt={class:"mb-4"},Jt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reason *",-1),qt={class:"mb-6"},Gt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload Image (Optional)",-1),Ht={key:0,class:"text-xs text-gray-500 mt-1"},Wt=["disabled"],Kt={key:0,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1),Yt=[Qt],Xt={key:1,class:"w-4 h-4 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Zt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),es=[Zt],ts={key:1,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md"},ss={class:"flex items-start"},os=e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),ls=e("p",{class:"text-red-700 text-sm font-medium"},"Unable to submit leave application",-1),as={class:"text-red-600 text-sm mt-1"},ns={key:2,class:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md"},rs={class:"flex items-start"},ds=e("svg",{class:"w-5 h-5 text-green-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),is=e("p",{class:"text-green-700 text-sm font-medium"},"Success!",-1),cs={class:"text-green-600 text-sm mt-1"},us={setup(x){const s=J({from_date:"",to_date:"",reason:"",total_days:"",image:null}),l=J({student:"",student_name:"",student_group:""}),d=C(""),m=C(""),f=V(()=>l.student&&s.from_date&&s.to_date&&s.reason&&l.student_group),p=()=>{try{const t=localStorage.getItem("selected_student"),c=localStorage.getItem("selected_student_group");if(t){let g;try{g=JSON.parse(t)}catch(y){g=t}if(typeof g=="object"&&g!==null?(l.student=g.student||g.name||"",l.student_name=g.student_name||g.name||""):(l.student=g,l.student_name=g),c)try{const y=JSON.parse(c);l.student_group=y.student_group||y.name||y}catch(y){l.student_group=c}}else d.value="Student data not found in storage. Please select a student first."}catch(t){console.error("Error loading student info:",t),d.value="Failed to load student info."}},a=t=>new Promise((c,g)=>{const y=new FileReader;y.onload=()=>{const _=y.result.split(",")[1];c(_)},y.onerror=_=>g(_),y.readAsDataURL(t)}),h=t=>{const c=t.target.files[0];c?s.image=c:s.image=null},S=M({url:"school.al_ummah.api2.submit_leave_application",method:"POST",auto:!1,onSuccess(t){if(console.log("API response:",t),t.status==="success"){const c=t.message||"Leave application submitted successfully!";m.value=c,d.value="",Object.assign(s,{from_date:"",to_date:"",reason:"",total_days:"",image:null}),setTimeout(()=>{m.value=""},5e3)}else d.value=t.message||"Failed to submit leave application."},onError(t){if(console.error("API error details:",{response:t.response,exc_type:t.exc_type,exc_message:t.exc_message,_server_messages:t._server_messages,message:t.message}),t.response&&t.response.includes("already exists against the student"))d.value="Leave already submitted for this student. You cannot submit multiple applications.";else if(t._server_messages&&t._server_messages.includes("already exists against the student"))d.value="Leave already submitted for this student.";else if(t.exc_message&&t.exc_message.includes("already exists against the student"))d.value="Leave already submitted for this student.";else if(t.exc_type==="ValidationError")t.exc_message?d.value=t.exc_message.replace("frappe.exceptions.ValidationError: ",""):d.value="Validation error occurred. Please check your input.";else if(t._server_messages)try{const c=JSON.parse(t._server_messages||"[]");if(c.length>0){const g=c[c.length-1],y=JSON.parse(g);d.value=y.message||"An error occurred while submitting the leave application."}}catch(c){d.value=t.message||"An error occurred while submitting the leave application."}else d.value=t.message||"An error occurred while submitting the leave application.";m.value=""}}),I=()=>A(this,null,function*(){if(!f.value){d.value="Please fill in all required fields.";return}d.value="",m.value="";try{let t=null;s.image&&s.image instanceof File&&(t=yield a(s.image));const c={student:l.student,from_date:s.from_date,to_date:s.to_date,student_group:l.student_group,reason:s.reason,image:t};console.log("Submitting leave application with data:",c),yield S.submit(c)}catch(t){console.error("Submission error:",t),d.value="An error occurred while processing your request."}});return L(()=>{p()}),(t,c)=>(n(),r("div",Ct,[e("div",Dt,[jt,o(l).student_name?(n(),r("p",At,[Mt,U(" "+i(o(l).student_name),1)])):w("",!0),o(l).student_group?(n(),r("p",Lt,[Bt,U(" "+i(o(l).student_group),1)])):w("",!0),o(l).student_name?w("",!0):(n(),r("p",Et," No student information found. Please select a student first. "))]),e("div",Vt,[Pt,B(e("input",{type:"date","onUpdate:modelValue":c[0]||(c[0]=g=>o(s).from_date=g),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[O,o(s).from_date]])]),e("div",Rt,[Ut,B(e("input",{type:"date","onUpdate:modelValue":c[1]||(c[1]=g=>o(s).to_date=g),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[O,o(s).to_date]])]),o(s).total_days?(n(),r("div",Ot,[Tt,e("input",{type:"text",value:o(s).total_days,readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Ft)])):w("",!0),e("div",zt,[Jt,B(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=g=>o(s).reason=g),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for leave...",required:""},null,512),[[O,o(s).reason]])]),e("div",qt,[Gt,e("input",{type:"file",onChange:h,accept:"image/*",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32),o(s).image?(n(),r("p",Ht," Image selected: "+i(o(s).image.name),1)):w("",!0)]),e("button",{onClick:I,disabled:o(S).loading||!o(f),class:D(["w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",o(S).loading||!o(f)?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"])},[o(S).loading?(n(),r("svg",Xt,es)):(n(),r("svg",Kt,Yt)),U(" "+i(o(S).loading?"Submitting...":"Appeal Leave"),1)],10,Wt),d.value?(n(),r("div",ts,[e("div",ss,[os,e("div",null,[ls,e("p",as,i(d.value),1)])])])):w("",!0),m.value?(n(),r("div",ns,[e("div",rs,[ds,e("div",null,[is,e("p",cs,i(m.value),1)])])])):w("",!0)]))}};const b=x=>(P("data-v-04e91b40"),x=x(),R(),x),_s={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},ms={key:0,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},gs=b(()=>e("div",{class:"spinner"},null,-1)),hs=[gs],ps={class:"md:hidden p-4 bg-white shadow"},vs={class:"flex items-start space-x-4 border-b pb-4"},bs={class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden"},xs=["src"],fs={key:1,class:"w-full h-full flex items-center justify-center"},ys=b(()=>e("span",{class:"text-sm text-gray-500"},"No Image",-1)),ws=[ys],$s={class:"min-w-0 flex-1"},ks={class:"text-xl font-semibold text-gray-800 break-words"},Ss=b(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Parent",-1)),Is={class:"space-y-2"},Ns=b(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Child:",-1)),Cs=["disabled"],Ds=b(()=>e("option",{value:"",disabled:""},"Select a child",-1)),js=["value"],As={class:"space-y-3"},Ms=b(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),Ls={class:"space-y-2"},Bs=b(()=>e("span",null,"Dashboard",-1)),Es=b(()=>e("span",null,"Attendance Record",-1)),Vs=b(()=>e("span",null,"Browse Notices",-1)),Ps=b(()=>e("span",null,"Appeal Leave",-1)),Rs={class:"pt-4 border-t"},Us=["disabled"],Os=b(()=>e("span",null,"Logout",-1)),Ts={class:"flex-1 p-4 md:p-8 bg-gray-50"},Fs={key:0},zs={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},Js={class:"text-2xl font-bold text-gray-800 mb-2"},qs=b(()=>e("p",{class:"text-gray-600"},"Monitor your child's activities and school records from here.",-1)),Gs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Hs={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500"},Ws={class:"flex items-center justify-between"},Ks=b(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Selected Child",-1)),Qs={class:"text-2xl font-bold text-gray-800"},Ys={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500"},Xs={class:"flex items-center justify-between"},Zs=b(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Available Children",-1)),eo={class:"text-2xl font-bold text-gray-800"},to={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500"},so={class:"flex items-center justify-between"},oo=b(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Today's Date",-1)),lo={class:"text-2xl font-bold text-gray-800"},ao={class:"bg-white rounded-lg shadow-sm p-6"},no=b(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),ro={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},io=b(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"View Attendance Record"),e("p",{class:"text-sm text-gray-600"},"Check your child's attendance history")],-1)),co=b(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"Appeal for Leave"),e("p",{class:"text-sm text-gray-600"},"Submit leave appeal for your child")],-1)),uo={key:1},_o={key:2},mo={key:3},go={setup(x){const s=Y(),l=C({}),d=C([]),m=C(null),f=C(!1),p=C("dashboard"),a=_=>{p.value=_,window.innerWidth<768&&(f.value=!1)},h=q.user,I=M({url:"school.al_ummah.api2.get_user_details",params:{role:"parent",username:h},auto:!0,onSuccess(_){var u,N;console.log("Parent user details loaded:",_),_&&_.user_details&&(l.value={name:_.user_details.name,image:_.user_details.base64profile,address:_.user_details.address},((u=_.user_details.student_list)==null?void 0:u.length)&&(d.value=_.user_details.student_list,m.value=_.user_details.student_list[0],localStorage.setItem("selected_student",JSON.stringify(_.user_details.student_list[0])),localStorage.setItem("selected_student_group",((N=_.user_details.student_list[0])==null?void 0:N.student_group)||"")),localStorage.setItem("user_details",JSON.stringify(_.user_details)))},onError(_){console.error("Error loading parent user details:",_),c()}}),t=V(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),c=()=>{var _;try{const u=localStorage.getItem("user_details");if(u){const N=JSON.parse(u);if(l.value={name:N.name,image:N.base64profile,address:N.address},(_=N.student_list)==null?void 0:_.length){d.value=N.student_list;const v=localStorage.getItem("selected_student");v?m.value=JSON.parse(v):m.value=N.student_list[0]}}}catch(u){console.error("Error loading from localStorage:",u)}},g=()=>A(this,null,function*(){m.value&&(localStorage.setItem("selected_student",JSON.stringify(m.value)),localStorage.setItem("selected_student_group",m.value.student_group||""))}),y=()=>A(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student"),localStorage.removeItem("selected_student_group"),yield q.logout.submit(),s.push({name:"Login"})}catch(_){console.error("Logout error:",_),localStorage.clear(),s.push({name:"Login"})}});return L(()=>{I.data||I.reload()}),T(()=>I.loading,_=>{!_&&I.data&&console.log("Parent data loaded successfully")}),(_,u)=>{var N;return n(),r("div",_s,[o(I).loading?(n(),r("div",ms,hs)):w("",!0),e("div",ps,[e("button",{onClick:u[0]||(u[0]=v=>f.value=!f.value),class:"px-4 py-2 bg-blue-600 text-white rounded"},i(f.value?"Close Menu":"Open Menu"),1)]),e("aside",{class:D(["bg-white shadow-md p-6 space-y-8 md:block",f.value?"block":"hidden","md:w-72"])},[e("div",vs,[e("div",bs,[l.value.image?(n(),r("img",{key:0,src:`data:image/jpeg;base64,${l.value.image}`,alt:"Parent",class:"object-cover w-full h-full"},null,8,xs)):(n(),r("div",fs,ws))]),e("div",$s,[e("h2",ks,i(l.value.name||"No Name Available"),1),Ss])]),e("div",Is,[Ns,B(e("select",{"onUpdate:modelValue":u[1]||(u[1]=v=>m.value=v),onChange:g,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o(I).loading},[Ds,(n(!0),r(F,null,z(d.value,v=>(n(),r("option",{key:v.student,value:v},i(v.student_name||"Unnamed Student"),9,js))),128))],40,Cs),[[Q,m.value]])]),e("div",As,[Ms,e("nav",Ls,[e("button",{onClick:u[2]||(u[2]=v=>a("dashboard")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",p.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"])},[$(o(X),{class:"w-5 h-5"}),Bs],2),e("button",{onClick:u[3]||(u[3]=v=>a("attendance-info")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",p.value==="attendance-info"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"])},[$(o(G),{class:"w-5 h-5"}),Es],2),e("button",{onClick:u[4]||(u[4]=v=>a("browse-notices")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",p.value==="browse-notices"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"])},[$(o(Z),{class:"w-5 h-5"}),Vs],2),e("button",{onClick:u[5]||(u[5]=v=>a("appeal-leave")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",p.value==="appeal-leave"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"])},[$(o(H),{class:"w-5 h-5"}),Ps],2)])]),e("div",Rs,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors",onClick:y,disabled:o(I).loading},[$(o(ee),{class:"w-5 h-5"}),Os],8,Us)])],2),e("main",Ts,[p.value==="dashboard"?(n(),r("div",Fs,[e("div",zs,[e("h1",Js,"Welcome, "+i(l.value.name||"Parent")+"!",1),qs]),e("div",Gs,[e("div",Hs,[e("div",Ws,[e("div",null,[Ks,e("p",Qs,i(((N=m.value)==null?void 0:N.student_name)||"None"),1)]),$(o(W),{class:"w-8 h-8 text-blue-500"})])]),e("div",Ys,[e("div",Xs,[e("div",null,[Zs,e("p",eo,i(d.value.length),1)]),$(o(W),{class:"w-8 h-8 text-green-500"})])]),e("div",to,[e("div",so,[e("div",null,[oo,e("p",lo,i(o(t)),1)]),$(o(te),{class:"w-8 h-8 text-purple-500"})])])]),e("div",ao,[no,e("div",ro,[e("button",{onClick:u[6]||(u[6]=v=>a("attendance-info")),class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer"},[$(o(G),{class:"w-6 h-6 text-blue-600 mr-3"}),io]),e("button",{onClick:u[7]||(u[7]=v=>a("appeal-leave")),class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer"},[$(o(H),{class:"w-6 h-6 text-yellow-600 mr-3"}),co])])])])):p.value==="attendance-info"?(n(),r("div",uo,[$(He,{"selected-student":m.value,onBackToDashboard:u[8]||(u[8]=v=>a("dashboard"))},null,8,["selected-student"])])):p.value==="browse-notices"?(n(),r("div",_o,[$(Nt,{"selected-student":m.value,onBackToDashboard:u[9]||(u[9]=v=>a("dashboard"))},null,8,["selected-student"])])):p.value==="appeal-leave"?(n(),r("div",mo,[$(us,{"selected-student":m.value,onBackToDashboard:u[10]||(u[10]=v=>a("dashboard"))},null,8,["selected-student"])])):w("",!0)])])}}};var xo=E(go,[["__scopeId","data-v-04e91b40"]]);export{xo as default};
