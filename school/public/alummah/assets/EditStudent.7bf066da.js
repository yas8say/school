var we=(i,e,t)=>new Promise((a,s)=>{var r=p=>{try{l(t.next(p))}catch(u){s(u)}},n=p=>{try{l(t.throw(p))}catch(u){s(u)}},l=p=>p.done?a(p.value):Promise.resolve(p.value).then(r,n);l((t=t.apply(i,e)).next())});import{q as nt,v as qt,_ as lt,r as R,u as Le,w as ke,o as dt,b as Jt,x as Kt,d as x,e as w,f as o,y as b,g as A,t as H,i as ct,p as ut,h as ht,z as Zt,A as He,n as de,C as pt,D as W,E as X,G as ft,F as Qt,H as ea,I as ta,J as aa}from"./vendor.7c60d871.js";var mt={},ia=nt(qt);/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function gt(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,a)}return t}function vt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gt(Object(t),!0).forEach(function(a){na(i,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):gt(Object(t)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(t,a))})}return i}function ra(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var a=t.call(i,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function bt(i){var e=ra(i,"string");return typeof e=="symbol"?e:e+""}function We(i){return We=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(i)}function oa(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(i,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,bt(a.key),a)}}function sa(i,e,t){return e&&_t(i.prototype,e),t&&_t(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function na(i,e,t){return e=bt(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yt(i){return la(i)||da(i)||ca(i)||ua()}function la(i){if(Array.isArray(i))return Ye(i)}function da(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function ca(i,e){if(!!i){if(typeof i=="string")return Ye(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ye(i,e)}}function Ye(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=i[t];return a}function ua(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ue=typeof window!="undefined"&&typeof window.document!="undefined",re=Ue?window:{},Ve=Ue&&re.document.documentElement?"ontouchstart"in re.document.documentElement:!1,Xe=Ue?"PointerEvent"in re:!1,U="cropper",Ge="all",xt="crop",wt="move",kt="zoom",me="e",ge="w",Ce="s",ce="n",Oe="ne",Te="nw",Re="se",Ae="sw",Fe="".concat(U,"-crop"),Ct="".concat(U,"-disabled"),q="".concat(U,"-hidden"),Dt="".concat(U,"-hide"),ha="".concat(U,"-invisible"),ze="".concat(U,"-modal"),qe="".concat(U,"-move"),Be="".concat(U,"Action"),Pe="".concat(U,"Preview"),Je="crop",Mt="move",Et="none",Ke="crop",Ze="cropend",Qe="cropmove",et="cropstart",Nt="dblclick",pa=Ve?"touchstart":"mousedown",fa=Ve?"touchmove":"mousemove",ma=Ve?"touchend touchcancel":"mouseup",St=Xe?"pointerdown":pa,Ot=Xe?"pointermove":fa,Tt=Xe?"pointerup pointercancel":ma,Rt="ready",At="resize",Bt="wheel",tt="zoom",It="image/jpeg",ga=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,va=/^data:/,ba=/^data:image\/jpeg;base64,/,_a=/^img|canvas$/i,$t=200,Lt=100,Ut={viewMode:0,dragMode:Je,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:$t,minContainerHeight:Lt,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},ya='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',xa=Number.isNaN||re.isNaN;function O(i){return typeof i=="number"&&!xa(i)}var zt=function(e){return e>0&&e<1/0};function at(i){return typeof i=="undefined"}function ve(i){return We(i)==="object"&&i!==null}var wa=Object.prototype.hasOwnProperty;function De(i){if(!ve(i))return!1;try{var e=i.constructor,t=e.prototype;return e&&t&&wa.call(t,"isPrototypeOf")}catch(a){return!1}}function J(i){return typeof i=="function"}var ka=Array.prototype.slice;function Pt(i){return Array.from?Array.from(i):ka.call(i)}function Y(i,e){return i&&J(e)&&(Array.isArray(i)||O(i.length)?Pt(i).forEach(function(t,a){e.call(i,t,a,i)}):ve(i)&&Object.keys(i).forEach(function(t){e.call(i,i[t],t,i)})),i}var z=Object.assign||function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];return ve(e)&&a.length>0&&a.forEach(function(r){ve(r)&&Object.keys(r).forEach(function(n){e[n]=r[n]})}),e},Ca=/\.\d*(?:0|9){12}\d*$/;function Me(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Ca.test(i)?Math.round(i*e)/e:i}var Da=/^width|height|left|top|marginLeft|marginTop$/;function ue(i,e){var t=i.style;Y(e,function(a,s){Da.test(s)&&O(a)&&(a="".concat(a,"px")),t[s]=a})}function Ma(i,e){return i.classList?i.classList.contains(e):i.className.indexOf(e)>-1}function G(i,e){if(!!e){if(O(i.length)){Y(i,function(a){G(a,e)});return}if(i.classList){i.classList.add(e);return}var t=i.className.trim();t?t.indexOf(e)<0&&(i.className="".concat(t," ").concat(e)):i.className=e}}function oe(i,e){if(!!e){if(O(i.length)){Y(i,function(t){oe(t,e)});return}if(i.classList){i.classList.remove(e);return}i.className.indexOf(e)>=0&&(i.className=i.className.replace(e,""))}}function Ee(i,e,t){if(!!e){if(O(i.length)){Y(i,function(a){Ee(a,e,t)});return}t?G(i,e):oe(i,e)}}var Ea=/([a-z\d])([A-Z])/g;function it(i){return i.replace(Ea,"$1-$2").toLowerCase()}function rt(i,e){return ve(i[e])?i[e]:i.dataset?i.dataset[e]:i.getAttribute("data-".concat(it(e)))}function Ie(i,e,t){ve(t)?i[e]=t:i.dataset?i.dataset[e]=t:i.setAttribute("data-".concat(it(e)),t)}function Na(i,e){if(ve(i[e]))try{delete i[e]}catch(t){i[e]=void 0}else if(i.dataset)try{delete i.dataset[e]}catch(t){i.dataset[e]=void 0}else i.removeAttribute("data-".concat(it(e)))}var jt=/\s\s*/,Ht=function(){var i=!1;if(Ue){var e=!1,t=function(){},a=Object.defineProperty({},"once",{get:function(){return i=!0,e},set:function(r){e=r}});re.addEventListener("test",t,a),re.removeEventListener("test",t,a)}return i}();function ie(i,e,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split(jt).forEach(function(r){if(!Ht){var n=i.listeners;n&&n[r]&&n[r][t]&&(s=n[r][t],delete n[r][t],Object.keys(n[r]).length===0&&delete n[r],Object.keys(n).length===0&&delete i.listeners)}i.removeEventListener(r,s,a)})}function te(i,e,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split(jt).forEach(function(r){if(a.once&&!Ht){var n=i.listeners,l=n===void 0?{}:n;s=function(){delete l[r][t],i.removeEventListener(r,s,a);for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];t.apply(i,c)},l[r]||(l[r]={}),l[r][t]&&i.removeEventListener(r,l[r][t],a),l[r][t]=s,i.listeners=l}i.addEventListener(r,s,a)})}function Ne(i,e,t){var a;return J(Event)&&J(CustomEvent)?a=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,t)),i.dispatchEvent(a)}function Wt(i){var e=i.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ot=re.location,Sa=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Yt(i){var e=i.match(Sa);return e!==null&&(e[1]!==ot.protocol||e[2]!==ot.hostname||e[3]!==ot.port)}function Vt(i){var e="timestamp=".concat(new Date().getTime());return i+(i.indexOf("?")===-1?"?":"&")+e}function $e(i){var e=i.rotate,t=i.scaleX,a=i.scaleY,s=i.translateX,r=i.translateY,n=[];O(s)&&s!==0&&n.push("translateX(".concat(s,"px)")),O(r)&&r!==0&&n.push("translateY(".concat(r,"px)")),O(e)&&e!==0&&n.push("rotate(".concat(e,"deg)")),O(t)&&t!==1&&n.push("scaleX(".concat(t,")")),O(a)&&a!==1&&n.push("scaleY(".concat(a,")"));var l=n.length?n.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function Oa(i){var e=vt({},i),t=0;return Y(i,function(a,s){delete e[s],Y(e,function(r){var n=Math.abs(a.startX-r.startX),l=Math.abs(a.startY-r.startY),p=Math.abs(a.endX-r.endX),u=Math.abs(a.endY-r.endY),c=Math.sqrt(n*n+l*l),d=Math.sqrt(p*p+u*u),f=(d-c)/c;Math.abs(f)>Math.abs(t)&&(t=f)})}),t}function je(i,e){var t=i.pageX,a=i.pageY,s={endX:t,endY:a};return e?s:vt({startX:t,startY:a},s)}function Ta(i){var e=0,t=0,a=0;return Y(i,function(s){var r=s.startX,n=s.startY;e+=r,t+=n,a+=1}),e/=a,t/=a,{pageX:e,pageY:t}}function he(i){var e=i.aspectRatio,t=i.height,a=i.width,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=zt(a),n=zt(t);if(r&&n){var l=t*e;s==="contain"&&l>a||s==="cover"&&l<a?t=a/e:a=t*e}else r?t=a/e:n&&(a=t*e);return{width:a,height:t}}function Ra(i){var e=i.width,t=i.height,a=i.degree;if(a=Math.abs(a)%180,a===90)return{width:t,height:e};var s=a%90*Math.PI/180,r=Math.sin(s),n=Math.cos(s),l=e*n+t*r,p=e*r+t*n;return a>90?{width:p,height:l}:{width:l,height:p}}function Aa(i,e,t,a){var s=e.aspectRatio,r=e.naturalWidth,n=e.naturalHeight,l=e.rotate,p=l===void 0?0:l,u=e.scaleX,c=u===void 0?1:u,d=e.scaleY,f=d===void 0?1:d,D=t.aspectRatio,M=t.naturalWidth,T=t.naturalHeight,C=a.fillColor,N=C===void 0?"transparent":C,y=a.imageSmoothingEnabled,B=y===void 0?!0:y,L=a.imageSmoothingQuality,I=L===void 0?"low":L,v=a.maxWidth,E=v===void 0?1/0:v,$=a.maxHeight,V=$===void 0?1/0:$,K=a.minWidth,ae=K===void 0?0:K,Z=a.minHeight,ee=Z===void 0?0:Z,F=document.createElement("canvas"),P=F.getContext("2d"),Q=he({aspectRatio:D,width:E,height:V}),se=he({aspectRatio:D,width:ae,height:ee},"cover"),ne=Math.min(Q.width,Math.max(se.width,M)),pe=Math.min(Q.height,Math.max(se.height,T)),le=he({aspectRatio:s,width:E,height:V}),be=he({aspectRatio:s,width:ae,height:ee},"cover"),_e=Math.min(le.width,Math.max(be.width,r)),fe=Math.min(le.height,Math.max(be.height,n)),Se=[-_e/2,-fe/2,_e,fe];return F.width=Me(ne),F.height=Me(pe),P.fillStyle=N,P.fillRect(0,0,ne,pe),P.save(),P.translate(ne/2,pe/2),P.rotate(p*Math.PI/180),P.scale(c,f),P.imageSmoothingEnabled=B,P.imageSmoothingQuality=I,P.drawImage.apply(P,[i].concat(yt(Se.map(function(ye){return Math.floor(Me(ye))})))),P.restore(),F}var Xt=String.fromCharCode;function Ba(i,e,t){var a="";t+=e;for(var s=e;s<t;s+=1)a+=Xt(i.getUint8(s));return a}var Ia=/^data:.*,/;function $a(i){var e=i.replace(Ia,""),t=atob(e),a=new ArrayBuffer(t.length),s=new Uint8Array(a);return Y(s,function(r,n){s[n]=t.charCodeAt(n)}),a}function La(i,e){for(var t=[],a=8192,s=new Uint8Array(i);s.length>0;)t.push(Xt.apply(null,Pt(s.subarray(0,a)))),s=s.subarray(a);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function Ua(i){var e=new DataView(i),t;try{var a,s,r;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var n=e.byteLength,l=2;l+1<n;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){s=l;break}l+=1}if(s){var p=s+4,u=s+10;if(Ba(e,p,4)==="Exif"){var c=e.getUint16(u);if(a=c===18761,(a||c===19789)&&e.getUint16(u+2,a)===42){var d=e.getUint32(u+4,a);d>=8&&(r=u+d)}}}if(r){var f=e.getUint16(r,a),D,M;for(M=0;M<f;M+=1)if(D=r+M*12+2,e.getUint16(D,a)===274){D+=8,t=e.getUint16(D,a),e.setUint16(D,1,a);break}}}catch(T){t=1}return t}function za(i){var e=0,t=1,a=1;switch(i){case 2:t=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:a}}var Pa={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,a=this.container,s=this.cropper,r=Number(t.minContainerWidth),n=Number(t.minContainerHeight);G(s,q),oe(e,q);var l={width:Math.max(a.offsetWidth,r>=0?r:$t),height:Math.max(a.offsetHeight,n>=0?n:Lt)};this.containerData=l,ue(s,{width:l.width,height:l.height}),G(e,q),oe(s,q)},initCanvas:function(){var e=this.containerData,t=this.imageData,a=this.options.viewMode,s=Math.abs(t.rotate)%180==90,r=s?t.naturalHeight:t.naturalWidth,n=s?t.naturalWidth:t.naturalHeight,l=r/n,p=e.width,u=e.height;e.height*l>e.width?a===3?p=e.height*l:u=e.width/l:a===3?u=e.width/l:p=e.height*l;var c={aspectRatio:l,naturalWidth:r,naturalHeight:n,width:p,height:u};this.canvasData=c,this.limited=a===1||a===2,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=z({},c)},limitCanvas:function(e,t){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=a.viewMode,p=r.aspectRatio,u=this.cropped&&n;if(e){var c=Number(a.minCanvasWidth)||0,d=Number(a.minCanvasHeight)||0;l>1?(c=Math.max(c,s.width),d=Math.max(d,s.height),l===3&&(d*p>c?c=d*p:d=c/p)):l>0&&(c?c=Math.max(c,u?n.width:0):d?d=Math.max(d,u?n.height:0):u&&(c=n.width,d=n.height,d*p>c?c=d*p:d=c/p));var f=he({aspectRatio:p,width:c,height:d});c=f.width,d=f.height,r.minWidth=c,r.minHeight=d,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(l>(u?0:1)){var D=s.width-r.width,M=s.height-r.height;r.minLeft=Math.min(0,D),r.minTop=Math.min(0,M),r.maxLeft=Math.max(0,D),r.maxTop=Math.max(0,M),u&&this.limited&&(r.minLeft=Math.min(n.left,n.left+(n.width-r.width)),r.minTop=Math.min(n.top,n.top+(n.height-r.height)),r.maxLeft=n.left,r.maxTop=n.top,l===2&&(r.width>=s.width&&(r.minLeft=Math.min(0,D),r.maxLeft=Math.max(0,D)),r.height>=s.height&&(r.minTop=Math.min(0,M),r.maxTop=Math.max(0,M))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=s.width,r.maxTop=s.height},renderCanvas:function(e,t){var a=this.canvasData,s=this.imageData;if(t){var r=Ra({width:s.naturalWidth*Math.abs(s.scaleX||1),height:s.naturalHeight*Math.abs(s.scaleY||1),degree:s.rotate||0}),n=r.width,l=r.height,p=a.width*(n/a.naturalWidth),u=a.height*(l/a.naturalHeight);a.left-=(p-a.width)/2,a.top-=(u-a.height)/2,a.width=p,a.height=u,a.aspectRatio=n/l,a.naturalWidth=n,a.naturalHeight=l,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,ue(this.canvas,z({width:a.width,height:a.height},$e({translateX:a.left,translateY:a.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,a=this.imageData,s=a.naturalWidth*(t.width/t.naturalWidth),r=a.naturalHeight*(t.height/t.naturalHeight);z(a,{width:s,height:r,left:(t.width-s)/2,top:(t.height-r)/2}),ue(this.image,z({width:a.width,height:a.height},$e(z({translateX:a.left,translateY:a.top},a)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,a=e.aspectRatio||e.initialAspectRatio,s=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};a&&(t.height*a>t.width?r.height=r.width/a:r.width=r.height*a),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*s),r.height=Math.max(r.minHeight,r.height*s),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=z({},r)},limitCropBox:function(e,t){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=this.limited,p=a.aspectRatio;if(e){var u=Number(a.minCropBoxWidth)||0,c=Number(a.minCropBoxHeight)||0,d=l?Math.min(s.width,r.width,r.width+r.left,s.width-r.left):s.width,f=l?Math.min(s.height,r.height,r.height+r.top,s.height-r.top):s.height;u=Math.min(u,s.width),c=Math.min(c,s.height),p&&(u&&c?c*p>u?c=u/p:u=c*p:u?c=u/p:c&&(u=c*p),f*p>d?f=d/p:d=f*p),n.minWidth=Math.min(u,d),n.minHeight=Math.min(c,f),n.maxWidth=d,n.maxHeight=f}t&&(l?(n.minLeft=Math.max(0,r.left),n.minTop=Math.max(0,r.top),n.maxLeft=Math.min(s.width,r.left+r.width)-n.width,n.maxTop=Math.min(s.height,r.top+r.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=s.width-n.width,n.maxTop=s.height-n.height))},renderCropBox:function(){var e=this.options,t=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,e.movable&&e.cropBoxMovable&&Ie(this.face,Be,a.width>=t.width&&a.height>=t.height?wt:Ge),ue(this.cropBox,z({width:a.width,height:a.height},$e({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ne(this.element,Ke,this.getData())}},ja={initPreview:function(){var e=this.element,t=this.crossOrigin,a=this.options.preview,s=t?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",n=document.createElement("img");if(t&&(n.crossOrigin=t),n.src=s,n.alt=r,this.viewBox.appendChild(n),this.viewBoxImage=n,!!a){var l=a;typeof a=="string"?l=e.ownerDocument.querySelectorAll(a):a.querySelector&&(l=[a]),this.previews=l,Y(l,function(p){var u=document.createElement("img");Ie(p,Pe,{width:p.offsetWidth,height:p.offsetHeight,html:p.innerHTML}),t&&(u.crossOrigin=t),u.src=s,u.alt=r,u.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',p.innerHTML="",p.appendChild(u)})}},resetPreview:function(){Y(this.previews,function(e){var t=rt(e,Pe);ue(e,{width:t.width,height:t.height}),e.innerHTML=t.html,Na(e,Pe)})},preview:function(){var e=this.imageData,t=this.canvasData,a=this.cropBoxData,s=a.width,r=a.height,n=e.width,l=e.height,p=a.left-t.left-e.left,u=a.top-t.top-e.top;!this.cropped||this.disabled||(ue(this.viewBoxImage,z({width:n,height:l},$e(z({translateX:-p,translateY:-u},e)))),Y(this.previews,function(c){var d=rt(c,Pe),f=d.width,D=d.height,M=f,T=D,C=1;s&&(C=f/s,T=r*C),r&&T>D&&(C=D/r,M=s*C,T=D),ue(c,{width:M,height:T}),ue(c.getElementsByTagName("img")[0],z({width:n*C,height:l*C},$e(z({translateX:-p*C,translateY:-u*C},e))))}))}},Ha={bind:function(){var e=this.element,t=this.options,a=this.cropper;J(t.cropstart)&&te(e,et,t.cropstart),J(t.cropmove)&&te(e,Qe,t.cropmove),J(t.cropend)&&te(e,Ze,t.cropend),J(t.crop)&&te(e,Ke,t.crop),J(t.zoom)&&te(e,tt,t.zoom),te(a,St,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&te(a,Bt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&te(a,Nt,this.onDblclick=this.dblclick.bind(this)),te(e.ownerDocument,Ot,this.onCropMove=this.cropMove.bind(this)),te(e.ownerDocument,Tt,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&te(window,At,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,a=this.cropper;J(t.cropstart)&&ie(e,et,t.cropstart),J(t.cropmove)&&ie(e,Qe,t.cropmove),J(t.cropend)&&ie(e,Ze,t.cropend),J(t.crop)&&ie(e,Ke,t.crop),J(t.zoom)&&ie(e,tt,t.zoom),ie(a,St,this.onCropStart),t.zoomable&&t.zoomOnWheel&&ie(a,Bt,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&ie(a,Nt,this.onDblclick),ie(e.ownerDocument,Ot,this.onCropMove),ie(e.ownerDocument,Tt,this.onCropEnd),t.responsive&&ie(window,At,this.onResize)}},Wa={resize:function(){if(!this.disabled){var e=this.options,t=this.container,a=this.containerData,s=t.offsetWidth/a.width,r=t.offsetHeight/a.height,n=Math.abs(s-1)>Math.abs(r-1)?s:r;if(n!==1){var l,p;e.restore&&(l=this.getCanvasData(),p=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(Y(l,function(u,c){l[c]=u*n})),this.setCropBoxData(Y(p,function(u,c){p[c]=u*n})))}}},dblclick:function(){this.disabled||this.options.dragMode===Et||this.setDragMode(Ma(this.dragBox,Fe)?Mt:Je)},wheel:function(e){var t=this,a=Number(this.options.wheelZoomRatio)||.1,s=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?s=e.deltaY>0?1:-1:e.wheelDelta?s=-e.wheelDelta/120:e.detail&&(s=e.detail>0?1:-1),this.zoom(-s*a,e)))},cropStart:function(e){var t=e.buttons,a=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(O(t)&&t!==1||O(a)&&a!==0||e.ctrlKey))){var s=this.options,r=this.pointers,n;e.changedTouches?Y(e.changedTouches,function(l){r[l.identifier]=je(l)}):r[e.pointerId||0]=je(e),Object.keys(r).length>1&&s.zoomable&&s.zoomOnTouch?n=kt:n=rt(e.target,Be),!!ga.test(n)&&Ne(this.element,et,{originalEvent:e,action:n})!==!1&&(e.preventDefault(),this.action=n,this.cropping=!1,n===xt&&(this.cropping=!0,G(this.dragBox,ze)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var a=this.pointers;e.preventDefault(),Ne(this.element,Qe,{originalEvent:e,action:t})!==!1&&(e.changedTouches?Y(e.changedTouches,function(s){z(a[s.identifier]||{},je(s,!0))}):z(a[e.pointerId||0]||{},je(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,a=this.pointers;e.changedTouches?Y(e.changedTouches,function(s){delete a[s.identifier]}):delete a[e.pointerId||0],!!t&&(e.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,Ee(this.dragBox,ze,this.cropped&&this.options.modal)),Ne(this.element,Ze,{originalEvent:e,action:t}))}}},Ya={change:function(e){var t=this.options,a=this.canvasData,s=this.containerData,r=this.cropBoxData,n=this.pointers,l=this.action,p=t.aspectRatio,u=r.left,c=r.top,d=r.width,f=r.height,D=u+d,M=c+f,T=0,C=0,N=s.width,y=s.height,B=!0,L;!p&&e.shiftKey&&(p=d&&f?d/f:1),this.limited&&(T=r.minLeft,C=r.minTop,N=T+Math.min(s.width,a.width,a.left+a.width),y=C+Math.min(s.height,a.height,a.top+a.height));var I=n[Object.keys(n)[0]],v={x:I.endX-I.startX,y:I.endY-I.startY},E=function(V){switch(V){case me:D+v.x>N&&(v.x=N-D);break;case ge:u+v.x<T&&(v.x=T-u);break;case ce:c+v.y<C&&(v.y=C-c);break;case Ce:M+v.y>y&&(v.y=y-M);break}};switch(l){case Ge:u+=v.x,c+=v.y;break;case me:if(v.x>=0&&(D>=N||p&&(c<=C||M>=y))){B=!1;break}E(me),d+=v.x,d<0&&(l=ge,d=-d,u-=d),p&&(f=d/p,c+=(r.height-f)/2);break;case ce:if(v.y<=0&&(c<=C||p&&(u<=T||D>=N))){B=!1;break}E(ce),f-=v.y,c+=v.y,f<0&&(l=Ce,f=-f,c-=f),p&&(d=f*p,u+=(r.width-d)/2);break;case ge:if(v.x<=0&&(u<=T||p&&(c<=C||M>=y))){B=!1;break}E(ge),d-=v.x,u+=v.x,d<0&&(l=me,d=-d,u-=d),p&&(f=d/p,c+=(r.height-f)/2);break;case Ce:if(v.y>=0&&(M>=y||p&&(u<=T||D>=N))){B=!1;break}E(Ce),f+=v.y,f<0&&(l=ce,f=-f,c-=f),p&&(d=f*p,u+=(r.width-d)/2);break;case Oe:if(p){if(v.y<=0&&(c<=C||D>=N)){B=!1;break}E(ce),f-=v.y,c+=v.y,d=f*p}else E(ce),E(me),v.x>=0?D<N?d+=v.x:v.y<=0&&c<=C&&(B=!1):d+=v.x,v.y<=0?c>C&&(f-=v.y,c+=v.y):(f-=v.y,c+=v.y);d<0&&f<0?(l=Ae,f=-f,d=-d,c-=f,u-=d):d<0?(l=Te,d=-d,u-=d):f<0&&(l=Re,f=-f,c-=f);break;case Te:if(p){if(v.y<=0&&(c<=C||u<=T)){B=!1;break}E(ce),f-=v.y,c+=v.y,d=f*p,u+=r.width-d}else E(ce),E(ge),v.x<=0?u>T?(d-=v.x,u+=v.x):v.y<=0&&c<=C&&(B=!1):(d-=v.x,u+=v.x),v.y<=0?c>C&&(f-=v.y,c+=v.y):(f-=v.y,c+=v.y);d<0&&f<0?(l=Re,f=-f,d=-d,c-=f,u-=d):d<0?(l=Oe,d=-d,u-=d):f<0&&(l=Ae,f=-f,c-=f);break;case Ae:if(p){if(v.x<=0&&(u<=T||M>=y)){B=!1;break}E(ge),d-=v.x,u+=v.x,f=d/p}else E(Ce),E(ge),v.x<=0?u>T?(d-=v.x,u+=v.x):v.y>=0&&M>=y&&(B=!1):(d-=v.x,u+=v.x),v.y>=0?M<y&&(f+=v.y):f+=v.y;d<0&&f<0?(l=Oe,f=-f,d=-d,c-=f,u-=d):d<0?(l=Re,d=-d,u-=d):f<0&&(l=Te,f=-f,c-=f);break;case Re:if(p){if(v.x>=0&&(D>=N||M>=y)){B=!1;break}E(me),d+=v.x,f=d/p}else E(Ce),E(me),v.x>=0?D<N?d+=v.x:v.y>=0&&M>=y&&(B=!1):d+=v.x,v.y>=0?M<y&&(f+=v.y):f+=v.y;d<0&&f<0?(l=Te,f=-f,d=-d,c-=f,u-=d):d<0?(l=Ae,d=-d,u-=d):f<0&&(l=Oe,f=-f,c-=f);break;case wt:this.move(v.x,v.y),B=!1;break;case kt:this.zoom(Oa(n),e),B=!1;break;case xt:if(!v.x||!v.y){B=!1;break}L=Wt(this.cropper),u=I.startX-L.left,c=I.startY-L.top,d=r.minWidth,f=r.minHeight,v.x>0?l=v.y>0?Re:Oe:v.x<0&&(u-=d,l=v.y>0?Ae:Te),v.y<0&&(c-=f),this.cropped||(oe(this.cropBox,q),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}B&&(r.width=d,r.height=f,r.left=u,r.top=c,this.action=l,this.renderCropBox()),Y(n,function($){$.startX=$.endX,$.startY=$.endY})}},Va={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&G(this.dragBox,ze),oe(this.cropBox,q),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=z({},this.initialImageData),this.canvasData=z({},this.initialCanvasData),this.cropBoxData=z({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(z(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),oe(this.dragBox,ze),G(this.cropBox,q)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,Y(this.previews,function(a){a.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,oe(this.cropper,Ct)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,G(this.cropper,Ct)),this},destroy:function(){var e=this.element;return e[U]?(e[U]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,s=a.left,r=a.top;return this.moveTo(at(e)?e:s+Number(e),at(t)?t:r+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(O(e)&&(a.left=e,s=!0),O(t)&&(a.top=t,s=!0),s&&this.renderCanvas(!0)),this},zoom:function(e,t){var a=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(a.width*e/a.naturalWidth,null,t)},zoomTo:function(e,t,a){var s=this.options,r=this.canvasData,n=r.width,l=r.height,p=r.naturalWidth,u=r.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&s.zoomable){var c=p*e,d=u*e;if(Ne(this.element,tt,{ratio:e,oldRatio:n/p,originalEvent:a})===!1)return this;if(a){var f=this.pointers,D=Wt(this.cropper),M=f&&Object.keys(f).length?Ta(f):{pageX:a.pageX,pageY:a.pageY};r.left-=(c-n)*((M.pageX-D.left-r.left)/n),r.top-=(d-l)*((M.pageY-D.top-r.top)/l)}else De(t)&&O(t.x)&&O(t.y)?(r.left-=(c-n)*((t.x-r.left)/n),r.top-=(d-l)*((t.y-r.top)/l)):(r.left-=(c-n)/2,r.top-=(d-l)/2);r.width=c,r.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),O(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,O(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(O(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.imageData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(O(e)&&(a.scaleX=e,s=!0),O(t)&&(a.scaleY=t,s=!0),s&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,a=this.imageData,s=this.canvasData,r=this.cropBoxData,n;if(this.ready&&this.cropped){n={x:r.left-s.left,y:r.top-s.top,width:r.width,height:r.height};var l=a.width/a.naturalWidth;if(Y(n,function(c,d){n[d]=c/l}),e){var p=Math.round(n.y+n.height),u=Math.round(n.x+n.width);n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=u-n.x,n.height=p-n.y}}else n={x:0,y:0,width:0,height:0};return t.rotatable&&(n.rotate=a.rotate||0),t.scalable&&(n.scaleX=a.scaleX||1,n.scaleY=a.scaleY||1),n},setData:function(e){var t=this.options,a=this.imageData,s=this.canvasData,r={};if(this.ready&&!this.disabled&&De(e)){var n=!1;t.rotatable&&O(e.rotate)&&e.rotate!==a.rotate&&(a.rotate=e.rotate,n=!0),t.scalable&&(O(e.scaleX)&&e.scaleX!==a.scaleX&&(a.scaleX=e.scaleX,n=!0),O(e.scaleY)&&e.scaleY!==a.scaleY&&(a.scaleY=e.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var l=a.width/a.naturalWidth;O(e.x)&&(r.left=e.x*l+s.left),O(e.y)&&(r.top=e.y*l+s.top),O(e.width)&&(r.width=e.width*l),O(e.height)&&(r.height=e.height*l),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?z({},this.containerData):{}},getImageData:function(){return this.sized?z({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&Y(["left","top","width","height","naturalWidth","naturalHeight"],function(a){t[a]=e[a]}),t},setCanvasData:function(e){var t=this.canvasData,a=t.aspectRatio;return this.ready&&!this.disabled&&De(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)?(t.width=e.width,t.height=e.width/a):O(e.height)&&(t.height=e.height,t.width=e.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,a=this.options.aspectRatio,s,r;return this.ready&&this.cropped&&!this.disabled&&De(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)&&e.width!==t.width&&(s=!0,t.width=e.width),O(e.height)&&e.height!==t.height&&(r=!0,t.height=e.height),a&&(s?t.height=t.width/a:r&&(t.width=t.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,a=Aa(this.image,this.imageData,t,e);if(!this.cropped)return a;var s=this.getData(e.rounded),r=s.x,n=s.y,l=s.width,p=s.height,u=a.width/Math.floor(t.naturalWidth);u!==1&&(r*=u,n*=u,l*=u,p*=u);var c=l/p,d=he({aspectRatio:c,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=he({aspectRatio:c,width:e.minWidth||0,height:e.minHeight||0},"cover"),D=he({aspectRatio:c,width:e.width||(u!==1?a.width:l),height:e.height||(u!==1?a.height:p)}),M=D.width,T=D.height;M=Math.min(d.width,Math.max(f.width,M)),T=Math.min(d.height,Math.max(f.height,T));var C=document.createElement("canvas"),N=C.getContext("2d");C.width=Me(M),C.height=Me(T),N.fillStyle=e.fillColor||"transparent",N.fillRect(0,0,M,T);var y=e.imageSmoothingEnabled,B=y===void 0?!0:y,L=e.imageSmoothingQuality;N.imageSmoothingEnabled=B,L&&(N.imageSmoothingQuality=L);var I=a.width,v=a.height,E=r,$=n,V,K,ae,Z,ee,F;E<=-l||E>I?(E=0,V=0,ae=0,ee=0):E<=0?(ae=-E,E=0,V=Math.min(I,l+E),ee=V):E<=I&&(ae=0,V=Math.min(l,I-E),ee=V),V<=0||$<=-p||$>v?($=0,K=0,Z=0,F=0):$<=0?(Z=-$,$=0,K=Math.min(v,p+$),F=K):$<=v&&(Z=0,K=Math.min(p,v-$),F=K);var P=[E,$,V,K];if(ee>0&&F>0){var Q=M/l;P.push(ae*Q,Z*Q,ee*Q,F*Q)}return N.drawImage.apply(N,[a].concat(yt(P.map(function(se){return Math.floor(Me(se))})))),C},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!at(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,a=this.dragBox,s=this.face;if(this.ready&&!this.disabled){var r=e===Je,n=t.movable&&e===Mt;e=r||n?e:Et,t.dragMode=e,Ie(a,Be,e),Ee(a,Fe,r),Ee(a,qe,n),t.cropBoxMovable||(Ie(s,Be,e),Ee(s,Fe,r),Ee(s,qe,n))}return this}},Xa=re.Cropper,Gt=function(){function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(oa(this,i),!e||!_a.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=z({},Ut,De(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return sa(i,[{key:"init",value:function(){var t=this.element,a=t.tagName.toLowerCase(),s;if(!t[U]){if(t[U]=this,a==="img"){if(this.isImg=!0,s=t.getAttribute("src")||"",this.originalUrl=s,!s)return;s=t.src}else a==="canvas"&&window.HTMLCanvasElement&&(s=t.toDataURL());this.load(s)}}},{key:"load",value:function(t){var a=this;if(!!t){this.url=t,this.imageData={};var s=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if(va.test(t)){ba.test(t)?this.read($a(t)):this.clone();return}var n=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=l,n.onerror=l,n.ontimeout=l,n.onprogress=function(){n.getResponseHeader("content-type")!==It&&n.abort()},n.onload=function(){a.read(n.response)},n.onloadend=function(){a.reloading=!1,a.xhr=null},r.checkCrossOrigin&&Yt(t)&&s.crossOrigin&&(t=Vt(t)),n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=s.crossOrigin==="use-credentials",n.send()}}},{key:"read",value:function(t){var a=this.options,s=this.imageData,r=Ua(t),n=0,l=1,p=1;if(r>1){this.url=La(t,It);var u=za(r);n=u.rotate,l=u.scaleX,p=u.scaleY}a.rotatable&&(s.rotate=n),a.scalable&&(s.scaleX=l,s.scaleY=p),this.clone()}},{key:"clone",value:function(){var t=this.element,a=this.url,s=t.crossOrigin,r=a;this.options.checkCrossOrigin&&Yt(a)&&(s||(s="anonymous"),r=Vt(a)),this.crossOrigin=s,this.crossOriginUrl=r;var n=document.createElement("img");s&&(n.crossOrigin=s),n.src=r||a,n.alt=t.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),G(n,Dt),t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function(){var t=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var s=re.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(re.navigator.userAgent),r=function(u,c){z(t.imageData,{naturalWidth:u,naturalHeight:c,aspectRatio:u/c}),t.initialImageData=z({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(a.naturalWidth&&!s){r(a.naturalWidth,a.naturalHeight);return}var n=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){r(n.width,n.height),s||l.removeChild(n)},n.src=a.src,s||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(n))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,a=this.options,s=this.image,r=t.parentNode,n=document.createElement("div");n.innerHTML=ya;var l=n.querySelector(".".concat(U,"-container")),p=l.querySelector(".".concat(U,"-canvas")),u=l.querySelector(".".concat(U,"-drag-box")),c=l.querySelector(".".concat(U,"-crop-box")),d=c.querySelector(".".concat(U,"-face"));this.container=r,this.cropper=l,this.canvas=p,this.dragBox=u,this.cropBox=c,this.viewBox=l.querySelector(".".concat(U,"-view-box")),this.face=d,p.appendChild(s),G(t,q),r.insertBefore(l,t.nextSibling),oe(s,Dt),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,G(c,q),a.guides||G(c.getElementsByClassName("".concat(U,"-dashed")),q),a.center||G(c.getElementsByClassName("".concat(U,"-center")),q),a.background&&G(l,"".concat(U,"-bg")),a.highlight||G(d,ha),a.cropBoxMovable&&(G(d,qe),Ie(d,Be,Ge)),a.cropBoxResizable||(G(c.getElementsByClassName("".concat(U,"-line")),q),G(c.getElementsByClassName("".concat(U,"-point")),q)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),J(a.ready)&&te(t,Rt,a.ready,{once:!0}),Ne(t,Rt)}}},{key:"unbuild",value:function(){if(!!this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),oe(this.element,q)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Xa,i}},{key:"setDefaults",value:function(t){z(Ut,De(t)&&t)}}])}();z(Gt.prototype,Pa,ja,Ha,Wa,Ya,Va);var Ga=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Gt}),Fa=nt(Ga);Object.defineProperty(mt,"__esModule",{value:!0});var Ft=ia,qa=Fa,Ja=Ka(qa);function Ka(i){return i&&i.__esModule?i:{default:i}}function Za(i,e){var t={};for(var a in i)e.indexOf(a)>=0||!Object.prototype.hasOwnProperty.call(i,a)||(t[a]=i[a]);return t}var Qa=typeof window=="undefined"?[String,Array]:[String,Array,Element,NodeList],ei=mt.default={render:function(){var e=this.crossorigin||void 0;return(0,Ft.h)("div",{style:this.containerStyle},[(0,Ft.h)("img",{ref:"img",src:this.src,alt:this.alt||"image",style:[{"max-width":"100%"},this.imgStyle],crossorigin:e})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:Qa,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var e=this.$options.props;e.containerStyle,e.src,e.alt,e.imgStyle;var t=Za(e,["containerStyle","src","alt","imgStyle"]),a={};for(var s in t)this[s]!==void 0&&(a[s]=this[s]);this.cropper=new Ja.default(this.$refs.img,a)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(e,t)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(e,t){return this.cropper.move(e,t)},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.moveTo(e,t)},relativeZoom:function(e,t){return this.cropper.zoom(e,t)},zoomTo:function(e,t){return this.cropper.zoomTo(e,t)},rotate:function(e){return this.cropper.rotate(e)},rotateTo:function(e){return this.cropper.rotateTo(e)},scaleX:function(e){return this.cropper.scaleX(e)},scaleY:function(e){return this.cropper.scaleY(e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.scale(e,t)},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(e)},setData:function(e){return this.cropper.setData(e)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(e){return this.cropper.setCanvasData(e)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(e){return this.cropper.setCropBoxData(e)},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(e)},setAspectRatio:function(e){return this.cropper.setAspectRatio(e)},setDragMode:function(e){return this.cropper.setDragMode(e)}}};const j=i=>(ut("data-v-78d457d6"),i=i(),ht(),i),ti={class:"flex items-start space-x-8"},ai={class:"flex-shrink-0"},ii=j(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Profile Image",-1)),ri={class:"relative"},oi={class:"w-24 h-24 rounded-full border-2 border-white shadow-md overflow-hidden bg-gray-100"},si=["src","alt"],ni={key:0,class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center"},li=j(()=>o("div",{class:"spinner-small !w-6 !h-6 !border-2"},null,-1)),di=[li],ci={class:"flex-1"},ui={class:"space-y-4"},hi=j(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload New Image",-1)),pi={class:"flex flex-col sm:flex-row gap-3 max-w-md"},fi=["disabled"],mi=j(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),gi=j(()=>o("span",null,"Choose File",-1)),vi=[mi,gi],bi={class:"relative"},_i=["disabled"],yi=Zt('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-78d457d6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" data-v-78d457d6></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" data-v-78d457d6></path></svg><span data-v-78d457d6>Take Photo</span><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-78d457d6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-v-78d457d6></path></svg>',3),xi=[yi],wi={key:0,class:"absolute top-full left-0 mt-1 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10"},ki=j(()=>o("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1)),Ci=j(()=>o("span",null,"Front Camera",-1)),Di=[ki,Ci],Mi=j(()=>o("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})],-1)),Ei=j(()=>o("span",null,"Rear Camera",-1)),Ni=[Mi,Ei],Si={key:0,class:"mt-3 max-w-md p-3 bg-blue-50 rounded-md border border-blue-200"},Oi={class:"text-sm text-blue-700 flex items-center space-x-2"},Ti=j(()=>o("svg",{class:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),Ri={class:"truncate"},Ai={class:"text-xs text-blue-600 mt-1"},Bi={key:0,class:"flex space-x-3 max-w-md"},Ii=["disabled"],$i={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Li=j(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Ui=[Li],zi={key:1,class:"fixed inset-0 bg-black bg-opacity-90 flex flex-col items-center justify-center z-50 p-4"},Pi={class:"bg-white rounded-lg p-6 max-w-lg w-full"},ji={class:"flex justify-between items-center mb-4"},Hi=j(()=>o("h3",{class:"text-lg font-semibold text-gray-800"},"Take Photo",-1)),Wi={class:"flex items-center space-x-2"},Yi=j(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)),Vi=[Yi],Xi=j(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Gi=[Xi],Fi={class:"relative bg-gray-100 rounded-lg overflow-hidden"},qi=j(()=>o("div",{class:"w-14 h-14 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center"},[o("div",{class:"w-12 h-12 bg-gray-800 rounded-full"})],-1)),Ji=[qi],Ki={class:"mt-3 text-center"},Zi={class:"text-sm text-gray-600"},Qi={key:2,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},er={class:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[95vh] overflow-hidden flex flex-col"},tr={class:"text-lg font-semibold text-gray-800 mb-4 flex-shrink-0"},ar={class:"flex-1 min-h-0 bg-gray-100 rounded-lg p-4 overflow-hidden"},ir={class:"flex-shrink-0 mt-4"},rr={class:"flex justify-center items-center space-x-4 mb-4"},or=j(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),sr=j(()=>o("span",{class:"text-sm"},"Rotate Left",-1)),nr=[or,sr],lr=j(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),dr=j(()=>o("span",{class:"text-sm"},"Rotate Right",-1)),cr=[lr,dr],ur=j(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),hr=j(()=>o("span",{class:"text-sm"},"Reset",-1)),pr=[ur,hr],fr={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},mr={props:{studentId:{type:String,required:!0},currentImage:{type:String,default:""},studentName:{type:String,default:""}},emits:["image-updated","error","success"],setup(i,{emit:e}){const t=i,a=R(!1),s=R(null),r=R(null),n=R(""),l=R(!1),p=R(!1),u=R(!1),c=R(""),d=R(""),f=R(null),D=R("user"),M=R([]),T=R(!1),C=R(""),N=R(null),y=R(null),B=R(null),L=()=>we(this,null,function*(){try{const h=(yield navigator.mediaDevices.enumerateDevices()).filter(m=>m.kind==="videoinput");M.value=h,T.value=h.length>1,console.log("Available cameras:",h.map(m=>({label:m.label,deviceId:m.deviceId,kind:m.kind})))}catch(g){console.error("Error enumerating cameras:",g)}}),I=(g="user")=>we(this,null,function*(){u.value=!1,p.value=!1,l.value=!0,D.value=g;try{f.value&&f.value.getTracks().forEach(m=>m.stop());const h={video:{facingMode:g,width:{ideal:1920},height:{ideal:1080}}};f.value=yield navigator.mediaDevices.getUserMedia(h),y.value&&(y.value.srcObject=f.value)}catch(h){console.error("Error accessing camera:",h),e("error","Camera access denied or not available"),l.value=!1}}),v=()=>we(this,null,function*(){const g=D.value==="user"?"environment":"user";yield I(g)}),E=()=>{u.value=!u.value},$=g=>{g.target.closest(".relative")||(u.value=!1)},V=g=>!g||g==="null"||g===""?"/assets/alummah/images/default-student.png":g.startsWith("data:")?g:/^[A-Za-z0-9+/=]+$/.test(g)?`data:image/jpeg;base64,${g}`:g,K=Le(()=>C.value?C.value:n.value?n.value:t.currentImage?V(t.currentImage):"/assets/alummah/images/default-student.png"),ae=ke({url:"school.al_ummah.api2.update_student_profile_image",auto:!1,onSuccess(g){a.value=!1,console.log("\u{1F7E2} Upload response details:",{status:g.status,message:g.message,image_url:g.image_url,full_response:g}),g.status==="success"?(console.log("\u2705 Upload successful, updating UI with image:",g.image_url),r.value?C.value=r.value:s.value&&(C.value=n.value),e("image-updated",g.image_url),e("success",g.message||"Profile image updated successfully!"),ye()):(console.error("\u274C Upload failed:",g.message),e("error",g.message||"Upload failed"))},onError(g){a.value=!1,console.error("\u{1F534} Upload error:",g),e("error",g.message||"Upload error occurred")}}),Z=()=>{var g;return(g=N.value)==null?void 0:g.click()},ee=g=>{const h=g.target.files[0];if(!h)return;if(!h.type.startsWith("image/"))return e("error","Select an image");if(h.size>5*1024*1024)return e("error","Image < 5 MB");s.value=h;const m=new FileReader;m.onload=_=>{c.value=_.target.result,d.value="file",p.value=!0},m.readAsDataURL(h)},F=()=>{if(!y.value)return;const g=document.createElement("canvas"),h=y.value;g.width=h.videoWidth,g.height=h.videoHeight,g.getContext("2d").drawImage(h,0,0),c.value=g.toDataURL("image/jpeg",.8),d.value="camera",p.value=!0,P()},P=()=>{f.value&&f.value.getTracks().forEach(g=>g.stop()),f.value=null,l.value=!1,u.value=!1},Q=g=>{var h;return(h=B.value)==null?void 0:h.rotate(g)},se=()=>{var g;return(g=B.value)==null?void 0:g.reset()},ne=()=>{if(!!B.value)try{const g=B.value.getCroppedCanvas();if(!g)throw new Error("Canvas is null - cannot crop image");if(typeof g.toBlob!="function"){const h=g.toDataURL("image/jpeg",.85),m=pe(h);le(m);return}g.toBlob(h=>{le(h)},"image/jpeg",.85)}catch(g){console.error("Error applying crop:",g),e("error","Failed to crop image. Please try again.")}},pe=g=>{const h=g.split(","),m=h[0].match(/:(.*?);/)[1],_=atob(h[1]);let S=_.length;const st=new Uint8Array(S);for(;S--;)st[S]=_.charCodeAt(S);return new Blob([st],{type:m})},le=g=>{const h=new FileReader;h.onload=m=>{var S;const _=m.target.result;C.value=_,n.value=_,r.value=_,d.value==="file"&&s.value&&(s.value=new File([g],s.value.name,{type:"image/jpeg",lastModified:Date.now()})),console.log("\u2705 Cropped image applied and stored locally:",{hasLocalImage:!!C.value,localImageLength:(S=C.value)==null?void 0:S.length})},h.readAsDataURL(g),p.value=!1,e("success",'Cropped \u2013 click "Update Profile Image" to save.')},be=()=>{p.value=!1,c.value="",s.value=null,N.value&&(N.value.value=""),d.value==="camera"&&I(D.value)},_e=()=>{let g="";if(s.value){const h=new FileReader;h.onload=m=>{g=m.target.result,fe(g)},h.readAsDataURL(s.value)}else if(r.value)g=r.value,fe(g);else{e("error","No image selected");return}},fe=g=>{a.value=!0;let h=g;if(g.startsWith("data:")){const m=g.indexOf(",");m!==-1&&(h=g.substring(m+1))}console.log("Uploading image data:",{studentId:t.studentId,dataLength:h.length,startsWith:h.substring(0,20)+"..."}),ae.fetch({student_id:t.studentId,base64_image:h})},Se=()=>ye(),ye=()=>{s.value=null,r.value=null,n.value="",p.value=!1,c.value="",u.value=!1,N.value&&(N.value.value=""),P()},xe=g=>{console.warn("Image failed to load, using default image"),g.target.src="/assets/alummah/images/default-student.png"};return dt(()=>{L(),document.addEventListener("click",$),t.currentImage&&(C.value=V(t.currentImage))}),Jt(()=>{P(),document.removeEventListener("click",$)}),Kt(()=>t.currentImage,(g,h)=>{g!==h&&(console.log("StudentProfileImage: currentImage prop changed",{hasNewImage:!!g,isBase64:g&&!g.startsWith("data:")&&!g.startsWith("/"),length:g==null?void 0:g.length}),g&&(C.value=V(g)),g&&!n.value&&(n.value=""))}),(g,h)=>(x(),w("div",null,[o("div",ti,[o("div",ai,[ii,o("div",ri,[o("div",oi,[o("img",{src:b(K),alt:i.studentName,class:"w-full h-full object-cover",onError:xe},null,40,si)]),a.value?(x(),w("div",ni,di)):A("",!0)])]),o("div",ci,[o("div",ui,[o("div",null,[hi,o("div",pi,[o("input",{type:"file",ref_key:"fileInput",ref:N,accept:"image/*",onChange:ee,class:"hidden"},null,544),o("button",{type:"button",onClick:Z,disabled:a.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 flex items-center space-x-2"},vi,8,fi),o("div",bi,[o("button",{type:"button",onClick:E,disabled:a.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},xi,8,_i),u.value?(x(),w("div",wi,[o("button",{type:"button",onClick:h[0]||(h[0]=m=>I("user")),class:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2"},Di),o("button",{type:"button",onClick:h[1]||(h[1]=m=>I("environment")),class:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2 border-t border-gray-100"},Ni)])):A("",!0)])]),s.value&&!p.value?(x(),w("div",Si,[o("p",Oi,[Ti,o("span",Ri,"Selected: "+H(s.value.name),1)]),o("p",Ai,"Size: "+H((s.value.size/1024/1024).toFixed(2))+" MB",1)])):A("",!0)]),(s.value||r.value)&&!p.value?(x(),w("div",Bi,[o("button",{type:"button",onClick:_e,disabled:a.value,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-purple-300 flex items-center space-x-2 flex-1"},[a.value?(x(),w("svg",$i,Ui)):A("",!0),o("span",null,H(a.value?"Uploading...":"Update Profile Image"),1)],8,Ii),o("button",{type:"button",onClick:Se,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex-1"}," Cancel ")])):A("",!0)])])]),l.value?(x(),w("video",{key:0,ref_key:"videoEl",ref:y,autoplay:"",playsinline:"",muted:"",class:"hidden"},null,512)):A("",!0),l.value&&!p.value?(x(),w("div",zi,[o("div",Pi,[o("div",ji,[Hi,o("div",Wi,[T.value?(x(),w("button",{key:0,type:"button",onClick:v,class:"p-2 bg-gray-200 rounded-full hover:bg-gray-300 transition-colors",title:"Switch Camera"},Vi)):A("",!0),o("button",{type:"button",onClick:P,class:"p-2 bg-gray-200 rounded-full hover:bg-gray-300 transition-colors",title:"Close Camera"},Gi)])]),o("div",Fi,[o("video",{ref_key:"videoEl",ref:y,autoplay:"",playsinline:"",muted:"",class:"w-full h-64 object-cover"},null,512),o("div",{class:"absolute bottom-4 left-1/2 transform -translate-x-1/2"},[o("button",{type:"button",onClick:F,class:"w-16 h-16 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-100 transition-colors"},Ji)])]),o("div",Ki,[o("p",Zi," Using: "+H(D.value==="user"?"Front Camera":"Rear Camera"),1)])])])):A("",!0),p.value?(x(),w("div",Qi,[o("div",er,[o("h3",tr,H(d.value==="camera"?"Crop Your Photo":"Crop Uploaded Image"),1),o("div",ar,[ct(b(ei),{ref_key:"cropper",ref:B,src:c.value,"aspect-ratio":1,"view-mode":2,guides:!0,background:!1,"auto-crop-area":.8,"min-container-width":200,"min-container-height":200,class:"cropper-container h-full w-full max-h-[50vh]"},null,8,["src","auto-crop-area"])]),o("div",ir,[o("div",rr,[o("button",{type:"button",onClick:h[2]||(h[2]=m=>Q(-90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Left"},nr),o("button",{type:"button",onClick:h[3]||(h[3]=m=>Q(90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Right"},cr),o("button",{type:"button",onClick:se,class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Reset Crop"},pr)]),o("div",fr,[o("button",{type:"button",onClick:be,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium transition-colors"},H(d.value==="camera"?"Retake Photo":"Choose Different File"),1),o("button",{type:"button",onClick:ne,class:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium transition-colors"}," Apply Crop ")])])])])):A("",!0)]))}};var gr=lt(mr,[["__scopeId","data-v-78d457d6"]]);const k=i=>(ut("data-v-318434fd"),i=i(),ht(),i),vr={class:"min-h-screen bg-gray-50 p-4"},br={class:"fixed top-4 right-4 z-50 space-y-2 w-96 max-w-full"},_r={class:"flex items-start space-x-3"},yr=k(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),xr={class:"flex-1"},wr=k(()=>o("p",{class:"text-green-800 font-medium"},"Success",-1)),kr={class:"text-green-700 text-sm mt-1"},Cr={class:"flex items-start space-x-3"},Dr=k(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),Mr={class:"flex-1"},Er=k(()=>o("p",{class:"text-red-800 font-medium"},"Error",-1)),Nr={class:"text-red-700 text-sm mt-1"},Sr={class:"mb-6"},Or={class:"text-2xl font-bold text-gray-800"},Tr={class:"text-sm text-gray-500 font-normal ml-2"},Rr={key:0,class:"text-gray-600"},Ar={key:0,class:"text-green-600 font-medium"},Br={key:1,class:"text-orange-600 font-medium"},Ir={key:0,class:"flex justify-center items-center py-8"},$r=k(()=>o("div",{class:"spinner"},null,-1)),Lr=k(()=>o("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)),Ur=[$r,Lr],zr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Pr=k(()=>o("p",{class:"text-red-800"},"Failed to load settings. Using default permissions.",-1)),jr={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Hr=k(()=>o("p",{class:"text-red-800"},"Failed to load student details.",-1)),Wr={key:3,class:"bg-white rounded-lg shadow-sm p-6"},Yr=["onSubmit"],Vr={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Xr={class:"md:col-span-2 lg:col-span-3"},Gr=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student ID",-1)),Fr=["value"],qr=k(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student ID cannot be changed",-1)),Jr={class:"md:col-span-2 lg:col-span-3"},Kr=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Group",-1)),Zr=["value"],Qr=k(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student group cannot be changed",-1)),eo={key:0,class:"md:col-span-2 lg:col-span-3"},to=k(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Personal Details",-1)),ao=[to],io={class:"md:col-span-2 lg:col-span-3"},ro={key:1},oo=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),so={key:2},no=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Middle Name",-1)),lo={key:3},co=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),uo={key:4},ho=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Date of Birth",-1)),po={key:5},fo=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"GR Number",-1)),mo={key:6},go=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Roll Number ",-1)),vo={key:0,class:"text-red-600 text-xs mt-1"},bo={key:1,class:"text-gray-500 text-xs mt-1"},_o={key:7,class:"md:col-span-2 lg:col-span-3 mt-4"},yo=k(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Contact Information",-1)),xo=[yo],wo={key:8},ko=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address",-1)),Co={key:9},Do=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),Mo={class:"mt-8 pt-6 border-t flex justify-between items-center"},Eo={class:"flex space-x-3"},No=["disabled"],So={key:0},Oo={key:1},To=k(()=>o("div",{class:"md:col-span-2 lg:col-span-3 mt-8"},[o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},[pt(" Guardian Management "),o("span",{class:"text-sm text-blue-600 font-normal ml-2"},"(Manage multiple guardians)")])],-1)),Ro={class:"md:col-span-2 lg:col-span-3"},Ao=k(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Add New Guardian",-1)),Bo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Io=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),$o=["disabled"],Lo=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),Uo=["disabled"],zo=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),Po=["disabled"],jo=k(()=>o("option",{value:"Mother"},"Mother",-1)),Ho=k(()=>o("option",{value:"Father"},"Father",-1)),Wo=k(()=>o("option",{value:"Others"},"Others",-1)),Yo=[jo,Ho,Wo],Vo={class:"mt-4 flex items-center justify-between"},Xo={key:0,class:"text-red-600 text-sm font-medium"},Go={key:1,class:"text-gray-600 text-sm"},Fo=["disabled"],qo={key:0},Jo={key:1},Ko={class:"md:col-span-2 lg:col-span-3"},Zo={class:"bg-white rounded-lg border border-gray-200 p-6"},Qo=k(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Existing Guardians",-1)),es={key:0,class:"flex justify-center py-4"},ts=k(()=>o("div",{class:"spinner-small"},null,-1)),as=k(()=>o("span",{class:"ml-2 text-gray-600"},"Loading guardians...",-1)),is=[ts,as],rs={key:1,class:"text-center py-8 text-gray-500"},os=k(()=>o("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1)),ss=k(()=>o("p",null,"No guardians added yet.",-1)),ns=[os,ss],ls={key:2,class:"space-y-4"},ds={class:"flex items-start justify-between"},cs={class:"flex items-start space-x-3 flex-1"},us=k(()=>o("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),hs={class:"flex-1 min-w-0"},ps={class:"flex items-center space-x-2 mb-1"},fs={class:"font-medium text-gray-800 text-lg"},ms={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},gs={key:0,class:"space-y-2 text-sm text-gray-600"},vs={class:"flex items-center space-x-4"},bs={class:"flex items-center space-x-1"},_s=k(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),ys=k(()=>o("span",{class:"text-gray-400"},"\u2022",-1)),xs={class:"flex items-center space-x-1"},ws=k(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})],-1)),ks={key:0,class:"flex items-center space-x-2 text-xs"},Cs={key:0},Ds={key:1,class:"text-gray-400"},Ms={key:2},Es={key:1,class:"text-xs text-gray-500"},Ns={key:1,class:"space-y-4 mt-4 p-4 bg-gray-50 rounded-lg"},Ss={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Os=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),Ts=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),Rs=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),As=k(()=>o("option",{value:"Mother"},"Mother",-1)),Bs=k(()=>o("option",{value:"Father"},"Father",-1)),Is=k(()=>o("option",{value:"Others"},"Others",-1)),$s=[As,Bs,Is],Ls=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date of Birth",-1)),Us=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),zs=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Occupation",-1)),Ps=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Designation",-1)),js={class:"md:col-span-2"},Hs=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Work Address",-1)),Ws=k(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Education",-1)),Ys={class:"flex space-x-3 pt-4"},Vs=["onClick","disabled"],Xs={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gs=k(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Fs=[Gs],qs=["onClick"],Js=k(()=>o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),Ks=[Js],Zs={class:"text-sm text-gray-600"},Qs={key:0,class:"text-green-600"},en={key:1,class:"text-orange-600"},tn={setup(i){const e=aa(),t=He({student:"",first_name:"",middle_name:"",last_name:"",student_date_of_birth:"",gr_number:"",email_address:"",phone_number:"",roll_number:""}),a=R(""),s=R(""),r=R(!0),n=R(!1),l=R(!1),p=R(""),u=R(""),c=R(""),d=R(""),f=R(""),D=R([]),M=R(null),T=R(!1),C=R(!1),N=He({guardian_name:"",phone_number:"",relation:"Mother"}),y=He({guardian_name:"",mobile_number:"",relation:"Mother",date_of_birth:"",email:"",occupation:"",designation:"",work_address:"",education:""}),B=R({allow_instructors_modify_student:0,session_expiry:"24:00"}),L=Le(()=>B.value.allow_instructors_modify_student===1),I=Le(()=>D.value.length>=3),v=Le(()=>{if(!e.query.studentData)return console.log("\u274C No studentData in route query"),"";try{const m=JSON.parse(decodeURIComponent(e.query.studentData)).base64profile||"";return console.log("\u{1F5BC}\uFE0F Image from route:",{exists:!!m,length:(m==null?void 0:m.length)||0,type:(m==null?void 0:m.startsWith("data:"))?"data-url":"base64-raw"}),m}catch(h){return console.error("Error parsing route image data:",h),""}}),E=h=>{u.value=h,c.value="",d.value="animate-slide-in-right"},$=h=>{c.value=h,u.value="",d.value="animate-slide-in-right"},V=()=>{d.value="animate-slide-out-right",setTimeout(()=>{u.value="",c.value="",d.value=""},300)},K=h=>{console.log("\u{1F4F8} Image updated in StudentProfileImage:",h)},ae=ke({url:"school.al_ummah.api3.fetch_admin_settings",auto:!1,onSuccess(h){B.value=h,r.value=!1,n.value=!1},onError(){r.value=!1,n.value=!0,B.value={allow_instructors_modify_student:0,session_expiry:"24:00"}}}),Z=ke({url:"school.al_ummah.api2.get_student_details",auto:!1,onSuccess(h){h.student_info&&Object.assign(t,h.student_info),h.guardians&&Array.isArray(h.guardians)&&(D.value=h.guardians),f.value=""},onError(){f.value="Failed to load student details.",D.value=[]}}),ee=ke({url:"school.al_ummah.api2.update_student_details",auto:!1,onSuccess(h){l.value=!1,$(h.message||"Student updated successfully!")},onError(h){var _,S;l.value=!1;const m=h._server_messages?(S=JSON.parse(((_=JSON.parse(h._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:S.message:h.message;E(m||"Update failed.")}}),F=ke({url:"school.al_ummah.api2.add_guardian_to_student",auto:!1,onSuccess(h){C.value=!1,$(h.message||"Guardian added!"),xe(),pe()},onError(h){var _,S;C.value=!1;const m=h._server_messages?(S=JSON.parse(((_=JSON.parse(h._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:S.message:h.message;E(m||"Failed to add guardian.")}}),P=ke({url:"school.al_ummah.api2.update_guardian_details",auto:!1,onSuccess(h){T.value=!1,$(h.message||"Guardian updated!"),M.value=null,le(),xe()},onError(h){var _,S;T.value=!1;const m=h._server_messages?(S=JSON.parse(((_=JSON.parse(h._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:S.message:h.message;E(m||"Failed to update guardian.")}}),Q=h=>/^[0-9]{10}$/.test(h),se=h=>{[".",",","e","E","-"].includes(h.key)&&h.preventDefault()},ne=()=>{const h=t.roll_number;if(!h&&h!==0)return p.value="";const m=Number(h);if(!Number.isInteger(m))return p.value="Must be a whole number";if(m<1)return p.value="Must be at least 1";if(m>999)return p.value="Cannot exceed 999";p.value=""},pe=()=>{N.guardian_name="",N.phone_number="",N.relation="Mother"},le=()=>{Object.keys(y).forEach(h=>{y[h]=""}),y.relation="Mother"},be=()=>we(this,null,function*(){if(!N.guardian_name.trim())return E("Guardian name required");if(!Q(N.phone_number))return E("Valid 10-digit phone required");C.value=!0,F.fetch({student_id:a.value,student_name:`${t.first_name} ${t.last_name}`.trim(),guardian_name:N.guardian_name,relation:N.relation,phone_number:N.phone_number})}),_e=h=>{M.value=h.guardian,Object.assign(y,{guardian_name:h.guardian_name||"",mobile_number:h.mobile_number||"",relation:h.relation||"Mother",date_of_birth:h.date_of_birth||"",email:h.email||"",occupation:h.occupation||"",designation:h.designation||"",work_address:h.work_address||"",education:h.education||""})},fe=()=>{M.value=null,le()},Se=h=>{if(!y.guardian_name.trim())return E("Guardian name required");if(!Q(y.mobile_number))return E("Valid 10-digit phone required");T.value=!0,P.fetch({guardian_id:h,guardian_name:y.guardian_name,phone_number:y.mobile_number,relation:y.relation,guardian_date_of_birth:y.date_of_birth,guardian_email:y.email,occupation:y.occupation,designation:y.designation,work_address:y.work_address,education:y.education})},ye=h=>we(this,null,function*(){var _;if(console.log("\u{1F6A8} updateStudent called",{eventType:h==null?void 0:h.type,target:(_=h==null?void 0:h.target)==null?void 0:_.tagName,timestamp:new Date().toISOString(),studentId:a.value}),h&&(h.preventDefault(),h.stopPropagation()),ne(),p.value){E(p.value);return}l.value=!0;const m={student_id:a.value,student_group:s.value};L.value&&Object.assign(m,{first_name:t.first_name||"",middle_name:t.middle_name||"",last_name:t.last_name||"",student_date_of_birth:t.student_date_of_birth||"",gr_number:t.gr_number||"",email_address:t.email_address||"",phone_number:t.phone_number||"",roll_number:t.roll_number||""}),console.log("Sending update data:",m),yield ee.fetch(m)}),xe=()=>{!a.value||Z.fetch({student:a.value})},g=()=>{r.value=!0,ae.fetch()};return dt(()=>{var h;if(a.value=e.query.studentId,e.query.studentData)try{const m=JSON.parse(decodeURIComponent(e.query.studentData));s.value=m.student_group||"",console.log("\u{1F3AF} Route data analysis:",{studentGroup:s.value,hasBase64profile:!!m.base64profile,base64profileLength:((h=m.base64profile)==null?void 0:h.length)||0,allKeys:Object.keys(m)})}catch(m){console.error("Error parsing student data:",m),E("Invalid student data")}g(),xe()}),(h,m)=>(x(),w("div",vr,[o("div",br,[c.value?(x(),w("div",{key:0,class:de(["bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",d.value])},[o("div",_r,[yr,o("div",xr,[wr,o("p",kr,H(c.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:V,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium"}," OK ")])],2)):A("",!0),u.value?(x(),w("div",{key:1,class:de(["bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",d.value])},[o("div",Cr,[Dr,o("div",Mr,[Er,o("p",Nr,H(u.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:V,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium"}," OK ")])],2)):A("",!0)]),o("div",Sr,[o("h1",Or,[pt(" Edit Student: "+H(b(t).student_name||a.value)+" ",1),o("span",Tr,"(ID: "+H(a.value)+")",1)]),r.value?A("",!0):(x(),w("p",Rr,[b(L)?(x(),w("span",Ar," \u2713 Full editing access enabled ")):(x(),w("span",Br," \u26A0 Limited editing access (Guardian fields only) "))]))]),b(Z).loading||r.value?(x(),w("div",Ir,Ur)):n.value?(x(),w("div",zr,[Pr,o("button",{type:"button",onClick:g,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):f.value?(x(),w("div",jr,[Hr,o("button",{type:"button",onClick:xe,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(x(),w("div",Wr,[o("form",{onSubmit:ta(ye,["prevent"])},[o("div",Vr,[o("div",Xr,[Gr,o("input",{value:a.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Fr),qr]),o("div",Jr,[Kr,o("input",{value:s.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Zr),Qr]),b(L)?(x(),w("div",eo,ao)):A("",!0),o("div",io,[ct(gr,{"student-id":a.value,"current-image":b(v),"student-name":b(t).student_name,onImageUpdated:K,onSuccess:m[0]||(m[0]=_=>$(_)),onError:m[1]||(m[1]=_=>E(_))},null,8,["student-id","current-image","student-name"])]),b(L)?(x(),w("div",ro,[oo,W(o("input",{"onUpdate:modelValue":m[2]||(m[2]=_=>b(t).first_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).first_name]])])):A("",!0),b(L)?(x(),w("div",so,[no,W(o("input",{"onUpdate:modelValue":m[3]||(m[3]=_=>b(t).middle_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).middle_name]])])):A("",!0),b(L)?(x(),w("div",lo,[co,W(o("input",{"onUpdate:modelValue":m[4]||(m[4]=_=>b(t).last_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).last_name]])])):A("",!0),b(L)?(x(),w("div",uo,[ho,W(o("input",{"onUpdate:modelValue":m[5]||(m[5]=_=>b(t).student_date_of_birth=_),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).student_date_of_birth]])])):A("",!0),b(L)?(x(),w("div",po,[fo,W(o("input",{"onUpdate:modelValue":m[6]||(m[6]=_=>b(t).gr_number=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).gr_number]])])):A("",!0),b(L)?(x(),w("div",mo,[go,W(o("input",{"onUpdate:modelValue":m[7]||(m[7]=_=>b(t).roll_number=_),type:"number",min:"1",max:"999",step:"1",placeholder:"Enter roll number",onKeypress:se,onInput:ne,class:de(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",p.value?"border-red-300 bg-red-50":"border-gray-300"])},null,34),[[X,b(t).roll_number]]),p.value?(x(),w("p",vo,H(p.value),1)):(x(),w("p",bo,"Must be a whole number between 1-999 (optional)"))])):A("",!0),b(L)?(x(),w("div",_o,xo)):A("",!0),b(L)?(x(),w("div",wo,[ko,W(o("input",{"onUpdate:modelValue":m[8]||(m[8]=_=>b(t).email_address=_),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).email_address]])])):A("",!0),b(L)?(x(),w("div",Co,[Do,W(o("input",{"onUpdate:modelValue":m[9]||(m[9]=_=>b(t).phone_number=_),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).phone_number]])])):A("",!0)]),o("div",Mo,[o("div",Eo,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",onClick:m[10]||(m[10]=_=>h.$router.back())}," Cancel "),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:l.value},[l.value?(x(),w("span",So,"Updating...")):(x(),w("span",Oo,"Update Student"))],8,No)])]),To,o("div",Ro,[o("div",{class:de(["bg-gray-50 rounded-lg p-6 border-2 border-dashed mb-6 transition-all",b(I)?"border-gray-300 opacity-50":"border-blue-200 hover:border-blue-300"])},[Ao,o("div",Bo,[o("div",null,[Io,W(o("input",{"onUpdate:modelValue":m[11]||(m[11]=_=>b(N).guardian_name=_),type:"text",placeholder:"Enter guardian name",disabled:b(I),class:de(["w-full px-3 py-2 border rounded-md",b(I)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,$o),[[X,b(N).guardian_name]])]),o("div",null,[Lo,W(o("input",{"onUpdate:modelValue":m[12]||(m[12]=_=>b(N).phone_number=_),type:"tel",placeholder:"10-digit number",disabled:b(I),class:de(["w-full px-3 py-2 border rounded-md",b(I)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,Uo),[[X,b(N).phone_number]])]),o("div",null,[zo,W(o("select",{"onUpdate:modelValue":m[13]||(m[13]=_=>b(N).relation=_),disabled:b(I),class:de(["w-full px-3 py-2 border rounded-md",b(I)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},Yo,10,Po),[[ft,b(N).relation]])])]),o("div",Vo,[o("div",null,[b(I)?(x(),w("p",Xo," \u274C Maximum of 3 guardians reached ")):(x(),w("p",Go," Guardians added: "+H(D.value.length)+"/3 ",1))]),o("button",{type:"button",onClick:be,disabled:b(I)||C.value,class:de(["px-4 py-2 rounded-md flex items-center space-x-2 transition-colors",b(I)||C.value?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[C.value?(x(),w("span",qo,"Adding...")):(x(),w("span",Jo,"Add Guardian"))],10,Fo)])],2)]),o("div",Ko,[o("div",Zo,[Qo,b(Z).loading?(x(),w("div",es,is)):D.value.length===0?(x(),w("div",rs,ns)):(x(),w("div",ls,[(x(!0),w(Qt,null,ea(D.value,_=>(x(),w("div",{key:_.guardian,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[o("div",ds,[o("div",cs,[us,o("div",hs,[o("div",ps,[o("h5",fs,H(_.guardian_name),1),o("span",ms,H(_.relation),1)]),M.value!==_.guardian?(x(),w("div",gs,[o("div",vs,[o("span",bs,[_s,o("span",null,H(_.mobile_number||"No phone"),1)]),ys,o("span",xs,[ws,o("span",null,H(_.email||"No email"),1)])]),_.occupation||_.designation?(x(),w("div",ks,[_.occupation?(x(),w("span",Cs,"\u{1F4BC} "+H(_.occupation),1)):A("",!0),_.designation?(x(),w("span",Ds,"\u2022")):A("",!0),_.designation?(x(),w("span",Ms,"\u{1F3AF} "+H(_.designation),1)):A("",!0)])):A("",!0),_.education?(x(),w("div",Es," \u{1F393} "+H(_.education),1)):A("",!0)])):A("",!0),M.value===_.guardian?(x(),w("div",Ns,[o("div",Ss,[o("div",null,[Os,W(o("input",{"onUpdate:modelValue":m[14]||(m[14]=S=>b(y).guardian_name=S),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).guardian_name]])]),o("div",null,[Ts,W(o("input",{"onUpdate:modelValue":m[15]||(m[15]=S=>b(y).mobile_number=S),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).mobile_number]])]),o("div",null,[Rs,W(o("select",{"onUpdate:modelValue":m[16]||(m[16]=S=>b(y).relation=S),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},$s,512),[[ft,b(y).relation]])]),o("div",null,[Ls,W(o("input",{"onUpdate:modelValue":m[17]||(m[17]=S=>b(y).date_of_birth=S),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).date_of_birth]])]),o("div",null,[Us,W(o("input",{"onUpdate:modelValue":m[18]||(m[18]=S=>b(y).email=S),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).email]])]),o("div",null,[zs,W(o("input",{"onUpdate:modelValue":m[19]||(m[19]=S=>b(y).occupation=S),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).occupation]])]),o("div",null,[Ps,W(o("input",{"onUpdate:modelValue":m[20]||(m[20]=S=>b(y).designation=S),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).designation]])]),o("div",js,[Hs,W(o("textarea",{"onUpdate:modelValue":m[21]||(m[21]=S=>b(y).work_address=S),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).work_address]])]),o("div",null,[Ws,W(o("input",{"onUpdate:modelValue":m[22]||(m[22]=S=>b(y).education=S),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).education]])])]),o("div",Ys,[o("button",{type:"button",onClick:S=>Se(_.guardian),disabled:T.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},[T.value?(x(),w("svg",Xs,Fs)):A("",!0),o("span",null,H(T.value?"Updating...":"Update Guardian"),1)],8,Vs),o("button",{type:"button",onClick:fe,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])):A("",!0)])]),M.value!==_.guardian?(x(),w("button",{key:0,type:"button",onClick:S=>_e(_),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit guardian details"},Ks,8,qs)):A("",!0)])]))),128))]))])]),o("div",Zs,[b(L)?(x(),w("span",Qs," \u2713 You have full editing permissions ")):(x(),w("span",en," \u26A0 You can only edit guardian information "))])],40,Yr)]))]))}};var on=lt(tn,[["__scopeId","data-v-318434fd"]]);export{on as default};
