var O=(w,x,m)=>new Promise((h,c)=>{var k=b=>{try{f(m.next(b))}catch(u){c(u)}},$=b=>{try{f(m.throw(b))}catch(u){c(u)}},f=b=>b.done?h(b.value):Promise.resolve(b.value).then(k,$);f((m=m.apply(w,x)).next())});import{d as o,e as n,f as e,_ as te,k as ue,r as y,i as R,I as G,o as X,t as r,g as A,u as a,F as Z,E as ee,n as I,J as Q,j as N,p as se,h as oe,C as le,D as he,K as _e,w as re,M as Y,H as ae,b as pe,G as fe,Q as be}from"./vendor.1f5cccb6.js";import{session as ge}from"./session.c4e99189.js";import{r as ye,A as we}from"./AttendanceRecord.409d1b45.js";import{a as ie,b as me,r as ve}from"./XMarkIcon.ffec483e.js";import{r as ke,a as $e,b as Ce,c as de,d as Se,e as je,f as Me,g as Ae}from"./InboxIcon.0cab84ff.js";import"./index.9febcd23.js";function Ne(w,x){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function ce(w,x){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function Ee(w,x){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})])}function xe(w,x){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const z=w=>(se("data-v-781e52fa"),w=w(),oe(),w),Le={class:"min-h-screen bg-gray-50 p-4"},Ie={class:"mb-6"},De=z(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Take Attendance",-1)),Te=z(()=>e("p",{class:"text-gray-600"},"Select students who are present today",-1)),Be={key:0,class:"text-sm text-gray-500 mt-1"},Pe={class:"text-sm text-gray-500"},ze={key:0,class:"flex justify-center items-center py-8"},Ve=z(()=>e("div",{class:"spinner"},null,-1)),Fe=z(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students...",-1)),Re=[Ve,Fe],Ge={key:1,class:"space-y-3"},He={class:"flex justify-between items-center mb-4"},Oe={class:"text-sm text-gray-600"},Ue=["disabled"],Je={class:"flex items-center space-x-4"},We={class:"flex-shrink-0"},qe=["src"],Qe={key:1,class:"text-white text-sm font-medium opacity-70"},Ye={class:"flex-1 min-w-0"},Ke={class:"font-medium text-gray-500 truncate"},Xe={class:"flex items-center space-x-4 text-sm text-gray-500"},Ze=z(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),et={class:"truncate"},tt={class:"flex items-center space-x-2 mt-1"},st={class:"flex-shrink-0"},ot=["onClick"],nt={class:"flex items-center space-x-4"},lt={class:"flex-shrink-0"},rt={class:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden"},at=["src"],it={key:1,class:"text-white text-sm font-medium"},dt={class:"flex-1 min-w-0"},ct={class:"font-medium text-gray-800 truncate"},ut={class:"flex items-center space-x-4 text-sm text-gray-600"},ht=z(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),_t={class:"truncate"},gt={class:"flex-shrink-0"},mt={key:2,class:"text-center py-8"},vt=z(()=>e("p",{class:"text-gray-600"},"No students available for this class",-1)),xt={key:3,class:"flex space-x-4 mt-6"},pt=z(()=>e("span",null,"Cancel",-1)),ft=["disabled"],bt={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},yt={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},wt=z(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Confirm Attendance",-1)),kt={class:"text-gray-600 mb-2"},$t={class:"text-gray-600 mb-2"},Ct={class:"text-gray-600 mb-4"},St=z(()=>e("div",{class:"text-sm text-gray-500 mb-4"},' Note: Students already marked as "Present" or "On Leave" will not be included in this attendance submission. ',-1)),jt={class:"flex space-x-3"},Mt={props:{selectedGroup:String},emits:["back-to-dashboard"],setup(w){const x=w,m=ue(),h=y([]),c=y([]),k=y(!0),$=y(!1),f=y(!1),b=R(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),u=R(()=>h.value.filter(i=>i.present===1||i.on_leave===1)),C=R(()=>h.value.filter(i=>i.present===0&&i.on_leave===0)),B=R(()=>u.value.length),L=R(()=>C.value.length===0),E=i=>i?i.startsWith("http")||i.startsWith("//")?i:i.startsWith("/")?window.location.origin+i:`${window.location.origin}/${i.replace(/^\//,"")}`:null,p=i=>i?i.split(" ").map(d=>d.charAt(0)).join("").toUpperCase().substring(0,2):"?",D=i=>{i.target.style.display="none"},T=G({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(i){return console.log("Attendance data loaded:",i),i},onError(i){console.error("Error fetching attendance:",i),alert("Failed to load student data. Please check your connection and try again.")}}),j=G({url:"school.al_ummah.api2.mark_attendance",onSuccess(i){var d;if(console.log("Attendance marked successfully:",i),f.value=!1,i.status==="success"||((d=i.message)==null?void 0:d.includes("successfully")))alert("Success! "+(i.message||"Attendance has been marked successfully.")),m.push({name:"Teacherhome"});else if(i._server_messages){try{const t=JSON.parse(i._server_messages);if(t.length>0){const _=JSON.parse(t[0]);if(_.message&&_.message.includes("successfully")){alert("Success! "+_.message),m.push({name:"Teacherhome"});return}}}catch(t){console.error("Error parsing server messages:",t)}alert("Success! Attendance has been marked successfully."),m.push({name:"Teacherhome"})}else alert("Error: "+(i.message||"There was an issue marking attendance."))},onError(i){console.error("Error marking attendance:",i),f.value=!1,i.exc_type==="PermissionError"?alert("Permission denied: You do not have permission to mark attendance. Please contact your administrator."):alert("Failed to submit attendance. Please check your connection and try again.")}}),V=()=>O(this,null,function*(){k.value=!0;try{const i=x.selectedGroup||localStorage.getItem("selected_student_group");if(!i){alert("Please select a class first."),k.value=!1;return}const d={based_on:"Batch",student_group:i},t=yield T.fetch(d);if(!t||t.length===0){alert("No students found for this class."),h.value=[];return}h.value=t,c.value=C.value.map(_=>_.student),console.log("Loaded students:",{total:h.value.length,alreadyMarked:u.value.length,available:C.value.length,presentFlag:h.value.filter(_=>_.present===1).length,onLeaveFlag:h.value.filter(_=>_.on_leave===1).length,studentsWithImages:h.value.filter(_=>_.img_url).length})}catch(i){console.error("Error fetching attendance:",i),alert("Failed to load student data.")}finally{k.value=!1}}),U=()=>{L.value||(c.value.length===C.value.length?c.value=[]:c.value=C.value.map(i=>i.student))},J=i=>{const d=h.value.find(_=>_.student===i);if(d&&(d.present===1||d.on_leave===1))return;const t=c.value.indexOf(i);t>-1?c.value.splice(t,1):c.value.push(i)},W=()=>{if(c.value.length===0){alert("Please select at least one student as present.");return}$.value=!0},K=()=>O(this,null,function*(){$.value=!1,f.value=!0;const i=C.value.filter(S=>c.value.includes(S.student)).map(S=>({student:S.student,student_name:S.student_name,group_roll_number:S.group_roll_number,disabled:!1,checked:!0})),d=C.value.filter(S=>!c.value.includes(S.student)).map(S=>({student:S.student,student_name:S.student_name,group_roll_number:S.group_roll_number,disabled:!1,checked:!1})),t=new Date().toISOString().split("T")[0],_=x.selectedGroup||localStorage.getItem("selected_student_group");console.log("Submitting attendance for:",{present:i.length,absent:d.length,alreadyMarked:u.value.length,totalStudents:h.value.length});try{yield j.submit({students_present:JSON.stringify(i),students_absent:JSON.stringify(d),student_group:_,date:t})}catch(S){console.error("Error submitting attendance:",S),f.value=!1}}),q=()=>{m.push({name:"Teacherhome"})};return X(()=>{V()}),(i,d)=>(o(),n("div",Le,[e("div",Ie,[De,Te,w.selectedGroup?(o(),n("p",Be,"Class: "+r(w.selectedGroup),1)):A("",!0),e("p",Pe,"Date: "+r(a(b)),1)]),k.value?(o(),n("div",ze,Re)):h.value&&h.value.length>0?(o(),n("div",Ge,[e("div",He,[e("p",Oe," Total: "+r(h.value.length)+" | To Mark Present: "+r(c.value.length)+" | To Mark Absent: "+r(a(C).length-c.value.length)+" | Already Marked: "+r(a(B)),1),e("button",{onClick:U,class:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300",disabled:a(L)},r(c.value.length===a(C).length?"Mark All Absent":"Mark All Present"),9,Ue)]),(o(!0),n(Z,null,ee(a(u),t=>(o(),n("div",{key:t.student,class:"bg-gray-100 rounded-lg shadow-sm p-4 border-2 border-gray-300 cursor-not-allowed"},[e("div",Je,[e("div",We,[e("div",{class:I(["w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden",t.present===1?"bg-gradient-to-br from-green-400 to-green-500":"bg-gradient-to-br from-yellow-400 to-yellow-500"])},[t.img_url?(o(),n("img",{key:0,src:E(t.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover opacity-70",onError:D,loading:"lazy"},null,40,qe)):(o(),n("span",Qe,r(p(t.student_name)),1))],2)]),e("div",Ye,[e("h3",Ke,r(t.student_name),1),e("div",Xe,[e("span",null,"Roll No: "+r(t.group_roll_number),1),Ze,e("span",et,r(t.student),1)]),e("div",tt,[t.present===1?(o(),Q(a(ce),{key:0,class:"w-4 h-4 text-green-500"})):A("",!0),t.on_leave===1?(o(),Q(a(ye),{key:1,class:"w-4 h-4 text-yellow-500"})):A("",!0),e("span",{class:I(["text-xs font-medium",t.present===1?"text-green-600":"text-yellow-600"])},r(t.present===1?"Already Marked Present":"On Leave"),3)])]),e("div",st,[e("div",{class:I(["w-6 h-6 rounded-full border-2 flex items-center justify-center",t.present===1?"bg-green-500 border-green-500":"bg-yellow-500 border-yellow-500"])},[t.present===1?(o(),Q(a(ce),{key:0,class:"w-4 h-4 text-white"})):A("",!0),t.on_leave===1?(o(),Q(a(Ee),{key:1,class:"w-4 h-4 text-white"})):A("",!0)],2)])])]))),128)),(o(!0),n(Z,null,ee(a(C),t=>(o(),n("div",{key:t.student,class:I(["bg-white rounded-lg shadow-sm p-4 border-2 transition-colors cursor-pointer hover:border-blue-300",c.value.includes(t.student)?"border-green-500 bg-green-50":"border-gray-200"]),onClick:_=>J(t.student)},[e("div",nt,[e("div",lt,[e("div",rt,[t.img_url?(o(),n("img",{key:0,src:E(t.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:D,loading:"lazy"},null,40,at)):(o(),n("span",it,r(p(t.student_name)),1))])]),e("div",dt,[e("h3",ct,r(t.student_name),1),e("div",ut,[e("span",null,"Roll No: "+r(t.group_roll_number),1),ht,e("span",_t,r(t.student),1)])]),e("div",gt,[e("div",{class:I(["w-6 h-6 rounded-full border-2 flex items-center justify-center",c.value.includes(t.student)?"bg-green-500 border-green-500":"border-gray-300"])},[c.value.includes(t.student)?(o(),Q(a(ce),{key:0,class:"w-4 h-4 text-white"})):A("",!0)],2)])])],10,ot))),128))])):(o(),n("div",mt,[vt,e("button",{onClick:V,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])),h.value.length>0?(o(),n("div",xt,[e("button",{onClick:q,class:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center space-x-2"},[N(a(ie),{class:"w-5 h-5"}),pt]),e("button",{onClick:W,disabled:f.value||a(C).length===0,class:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[N(a(Ne),{class:"w-5 h-5"}),e("span",null,r(f.value?"Submitting...":"Submit"),1)],8,ft)])):A("",!0),$.value?(o(),n("div",bt,[e("div",yt,[wt,e("p",kt,"To Mark Present: "+r(c.value.length),1),e("p",$t,"To Mark Absent: "+r(a(C).length-c.value.length),1),e("p",Ct,"Already Marked: "+r(a(B)),1),St,e("div",jt,[e("button",{onClick:d[0]||(d[0]=t=>$.value=!1),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{onClick:K,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Confirm ")])])])):A("",!0)]))}};var At=te(Mt,[["__scopeId","data-v-781e52fa"]]);const Nt={class:"min-h-screen bg-gray-50 p-4"},Et={class:"max-w-4xl mx-auto"},Lt=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Create Notice"),e("p",{class:"text-gray-600"},"Send announcements to students and parents")],-1),It={class:"bg-white rounded-lg shadow-sm p-6"},Dt={class:"mb-6"},Tt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Title * ",-1),Bt={class:"mb-6"},Pt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Message * ",-1),zt={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Vt={class:"text-sm text-blue-700"},Ft=e("span",{class:"font-medium"},"Selected Class:",-1),Rt={class:"flex justify-end"},Gt=["disabled"],Ht={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ot=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1),Ut=[Ot],Jt={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Wt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),qt=[Wt],Qt={setup(w){const x=y(""),m=y(""),h=y(""),c=G({url:"school.al_ummah.api2.submit_notice",auto:!1,onSuccess(u){console.log("Notice submission response:",u),u.message?f(u.message):typeof u=="string"&&u.includes("success")?f(u):f("Notice published successfully!"),x.value="",m.value=""},onError(u){console.error("Error submitting notice:",u),u.message?b(u.message):u.exc_type==="ValidationError"?b("Validation error: Please check your input data."):b("An error occurred while submitting the notice.")}}),k=()=>{try{const u=localStorage.getItem("selected_student_group");u&&(h.value=u)}catch(u){console.error("Failed to load selected student group:",u)}},$=()=>O(this,null,function*(){if(!x.value.trim()||!m.value.trim()){b("Please enter both title and notice message.");return}if(!h.value){b("Student group information is missing.");return}const u={notice_heading:m.value.trim(),notice_message:x.value.trim(),student_group:h.value};console.log("Submitting notice:",u),yield c.fetch(u)}),f=u=>{alert(`\u2705 Success: ${u}`)},b=u=>{alert(`\u274C Error: ${u}`)};return X(()=>{k()}),(u,C)=>(o(),n("div",Nt,[e("div",Et,[Lt,e("div",It,[e("div",Dt,[Tt,le(e("input",{"onUpdate:modelValue":C[0]||(C[0]=B=>m.value=B),type:"text",placeholder:"Enter notice title",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[he,m.value]])]),e("div",Bt,[Pt,le(e("textarea",{"onUpdate:modelValue":C[1]||(C[1]=B=>x.value=B),rows:"8",placeholder:"Enter your notice message here...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"},null,512),[[he,x.value]])]),e("div",zt,[e("p",Vt,[Ft,_e(" "+r(h.value||"No class selected"),1)])]),e("div",Rt,[e("button",{onClick:$,disabled:a(c).loading,class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors"},[a(c).loading?(o(),n("svg",Jt,qt)):(o(),n("svg",Ht,Ut)),e("span",null,r(a(c).loading?"Publishing...":"Publish Notice"),1)],8,Gt)])])])]))}};const H=w=>(se("data-v-b50e67de"),w=w(),oe(),w),Yt={class:"min-h-screen bg-gray-50 p-4"},Kt={class:"mb-6"},Xt=H(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Previous Notices",-1)),Zt=H(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),es={key:0,class:"text-sm text-gray-500 mt-1"},ts={key:0,class:"flex justify-center items-center py-8"},ss=H(()=>e("div",{class:"spinner"},null,-1)),os=H(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),ns=[ss,os],ls={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},rs=H(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),as={key:2,class:"space-y-4"},is=["onClick"],ds={class:"p-6"},cs={class:"flex items-start justify-between mb-3"},us={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},hs={class:"text-sm text-gray-500 whitespace-nowrap"},_s={class:"text-gray-600 line-clamp-2 mb-4"},gs={class:"flex items-center justify-between text-sm text-gray-500"},ms=["onClick"],vs={key:0,class:"text-center py-12"},xs=ae('<div class="bg-white rounded-lg shadow-sm p-8" data-v-b50e67de><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b50e67de><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-b50e67de></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-b50e67de>No Notices Found</h3><p class="text-gray-600" data-v-b50e67de>No notices have been published for this class yet.</p></div>',1),ps=[xs],fs={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},bs={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},ys={class:"p-6"},ws={class:"flex items-center justify-between mb-4"},ks={class:"text-xl font-bold text-gray-800"},$s=H(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Cs=[$s],Ss={class:"mb-4 text-sm text-gray-500"},js={class:"prose max-w-none mb-6"},Ms={class:"text-gray-700 whitespace-pre-wrap"},As={class:"flex space-x-3 pt-4 border-t"},Ns=H(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),Es=H(()=>e("span",null,"Delete Notice",-1)),Ls=[Ns,Es],Is={setup(w){const x=y([]),m=y(""),h=y(null),c=y(!1),k=G({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(p){console.log("Notices loaded:",p),x.value=Array.isArray(p)?p:[]},onError(p){console.error("Error fetching notices:",p),x.value=[]}}),$=G({url:"school.al_ummah.api2.delete_notice",auto:!1,onSuccess(){console.log("Notice deleted successfully"),b(),B()},onError(p){console.error("Error deleting notice:",p),E("Error","Failed to delete notice. Please try again.")}}),f=()=>{try{const p=localStorage.getItem("selected_student_group");p&&(m.value=p)}catch(p){console.error("Failed to load selected student group:",p)}},b=()=>{if(!m.value)return;const p={student_group:m.value};k.fetch(p)},u=p=>{if(!p)return"No date";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(D){return p}},C=p=>{h.value=p,c.value=!0},B=()=>{c.value=!1,h.value=null},L=p=>{if(!p){E("Error","No notice ID provided");return}confirm("Are you sure you want to delete this notice? This action cannot be undone.")&&$.fetch({name:p})},E=(p,D)=>{p==="Error"?window.alert(`Error: ${D}`):window.alert(D)};return X(()=>{f(),m.value&&b()}),re(m,p=>{p&&b()}),(p,D)=>(o(),n("div",Yt,[e("div",Kt,[Xt,Zt,m.value?(o(),n("p",es,"Class: "+r(m.value),1)):A("",!0)]),a(k).loading?(o(),n("div",ts,ns)):a(k).error?(o(),n("div",ls,[rs,e("button",{onClick:b,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(o(),n("div",as,[(o(!0),n(Z,null,ee(x.value,(T,j)=>(o(),n("div",{key:j,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:V=>C(T)},[e("div",ds,[e("div",cs,[e("h3",us,r(T.notice_heading||"No Title"),1),e("span",hs,r(u(T.date)),1)]),e("p",_s,r(T.notice_message||"No message content"),1),e("div",gs,[e("span",null,"By: "+r(T.owner||"System"),1),e("button",{onClick:Y(V=>L(T.name),["stop"]),class:"text-red-600 hover:text-red-800 font-medium"}," Delete ",8,ms)])])],8,is))),128)),x.value.length===0?(o(),n("div",vs,ps)):A("",!0)])),h.value&&c.value?(o(),n("div",fs,[e("div",bs,[e("div",ys,[e("div",ws,[e("h2",ks,r(h.value.notice_heading),1),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-600"},Cs)]),e("div",Ss,[e("p",null,"Published on: "+r(u(h.value.date)),1),e("p",null,"By: "+r(h.value.owner||"System"),1)]),e("div",js,[e("p",Ms,r(h.value.notice_message),1)]),e("div",As,[e("button",{onClick:D[0]||(D[0]=T=>L(h.value.name)),class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2"},Ls),e("button",{onClick:B,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Close ")])])])])):A("",!0)]))}};var Ds=te(Is,[["__scopeId","data-v-b50e67de"]]);const v=w=>(se("data-v-19534540"),w=w(),oe(),w),Ts={class:"min-h-screen bg-gray-50 p-4"},Bs={key:0,class:"flex justify-center items-center py-12"},Ps=v(()=>e("div",{class:"spinner"},null,-1)),zs=v(()=>e("span",{class:"ml-3 text-gray-600 text-lg"},"Loading leave applications...",-1)),Vs=[Ps,zs],Fs={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6 mb-6 max-w-4xl mx-auto"},Rs={class:"flex items-start space-x-4"},Gs=v(()=>e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),Hs={class:"flex-1"},Os=v(()=>e("p",{class:"text-red-800 font-semibold text-lg"},"Unable to Load Applications",-1)),Us={class:"text-red-700 mt-2"},Js={key:2,class:"text-center py-16"},Ws=ae('<div class="max-w-md mx-auto" data-v-19534540><div class="w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-2xl flex items-center justify-center" data-v-19534540><svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-19534540></path></svg></div><h3 class="text-xl font-semibold text-gray-700 mb-2" data-v-19534540>No Leave Applications</h3><p class="text-gray-500" data-v-19534540>There are no leave applications for this group.</p></div>',1),qs=[Ws],Qs={key:3,class:"max-w-6xl mx-auto"},Ys={class:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6"},Ks={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Xs=v(()=>e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Leave Applications"),e("p",{class:"text-gray-600 mt-1"},"Review and manage student leave requests")],-1)),Zs={class:"flex items-center space-x-4 mt-4 sm:mt-0"},eo={class:"flex items-center space-x-2"},to=v(()=>e("div",{class:"w-3 h-3 bg-yellow-500 rounded-full"},null,-1)),so={class:"text-sm text-gray-600"},oo={class:"flex items-center space-x-2"},no=v(()=>e("div",{class:"w-3 h-3 bg-green-500 rounded-full"},null,-1)),lo={class:"text-sm text-gray-600"},ro={class:"grid gap-6"},ao={class:"p-6"},io={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},co={class:"flex items-start space-x-4 flex-1 min-w-0"},uo={class:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm"},ho={class:"text-white font-semibold text-lg"},_o={class:"flex-1 min-w-0"},go={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},mo={class:"font-bold text-gray-900 text-xl"},vo={class:"text-gray-600 text-sm mt-1"},xo={class:"flex items-center space-x-3"},po=["onClick"],fo=v(()=>e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)),bo=[fo],yo={class:"flex flex-wrap items-center gap-4 mt-4"},wo={class:"flex items-center space-x-2 text-gray-700"},ko=v(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),$o={class:"text-sm font-medium"},Co={class:"flex items-center space-x-2 text-gray-700"},So=v(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),jo={class:"text-sm font-medium"},Mo={class:"flex items-center space-x-2 text-blue-700"},Ao=v(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),No={class:"text-sm font-semibold"},Eo={class:"text-gray-600 mt-3 line-clamp-2"},Lo={key:0,class:"mt-3"},Io=v(()=>e("span",{class:"inline-flex items-center px-3 py-1.5 bg-green-50 text-green-700 rounded-lg text-sm font-medium"},[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),_e(" Medical Certificate Available ")],-1)),Do=[Io],To={key:0,class:"border-t border-gray-100 p-6 bg-gray-50 rounded-b-2xl"},Bo={class:"grid grid-cols-1 xl:grid-cols-2 gap-8"},Po={class:"space-y-6"},zo={class:"bg-white rounded-xl border border-gray-200 p-6"},Vo=v(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Leave Details",-1)),Fo={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ro=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student Name",-1)),Go={class:"text-gray-900 font-semibold mt-1"},Ho=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student ID",-1)),Oo={class:"text-gray-900 font-semibold mt-1"},Uo=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Leave ID",-1)),Jo={class:"text-gray-900 font-semibold mt-1"},Wo=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Duration",-1)),qo={class:"text-gray-900 font-semibold mt-1"},Qo=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),Yo=v(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Mark as Present",-1)),Ko={class:"text-gray-900 font-semibold mt-1"},Xo={class:"bg-white rounded-xl border border-gray-200 p-6"},Zo=v(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-3"},"Reason for Leave",-1)),en={class:"text-gray-700 bg-gray-50 p-4 rounded-lg border border-gray-200"},tn={key:0,class:"bg-white rounded-xl border border-gray-200 p-6"},sn=v(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-4"},"Approve Leave",-1)),on=["onClick","disabled"],nn=v(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),ln=v(()=>e("span",null,"Approve Leave Application",-1)),rn=[nn,ln],an=v(()=>e("p",{class:"text-gray-500 text-sm mt-3 text-center"}," This will approve the leave request and notify the student ",-1)),dn={key:1,class:"bg-green-50 rounded-xl border border-green-200 p-6 text-center"},cn=ae('<div class="flex items-center justify-center space-x-2 text-green-700 mb-2" data-v-19534540><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-19534540></path></svg><span class="font-semibold" data-v-19534540>Leave Approved</span></div><p class="text-green-600 text-sm" data-v-19534540> This leave application has been approved and processed. </p>',2),un=[cn],hn={key:0,class:"space-y-6"},_n={class:"bg-white rounded-xl border border-gray-200 p-6"},gn=v(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Medical Certificate",-1)),mn={class:"space-y-4"},vn={class:"border-2 border-dashed border-gray-200 rounded-xl overflow-hidden bg-gray-50"},xn=["src","onClick"],pn={class:"grid grid-cols-2 gap-3"},fn=["onClick"],bn=v(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),yn=v(()=>e("span",null,"View Full Size",-1)),wn=[bn,yn],kn=["onClick"],$n=v(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),Cn=v(()=>e("span",null,"Download",-1)),Sn=[$n,Cn],jn={key:1,class:"flex items-center justify-center p-8 bg-white rounded-xl border border-gray-200"},Mn=v(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-gray-500 font-medium"},"No medical certificate provided")],-1)),An=[Mn],Nn={key:2,class:"flex items-center justify-center p-8 bg-green-50 rounded-xl border border-green-200"},En=v(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-green-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-green-700 font-medium"},"Approved without medical certificate")],-1)),Ln=[En],In={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Dn=v(()=>e("div",{class:"bg-white rounded-2xl p-8 flex items-center space-x-4 shadow-xl"},[e("div",{class:"spinner-small"}),e("div",null,[e("p",{class:"font-semibold text-gray-900"},"Approving Leave"),e("p",{class:"text-gray-600 text-sm mt-1"},"Please wait while we process your request...")])],-1)),Tn=[Dn],Bn={key:5,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},Pn={class:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-lg"},zn={class:"flex items-start space-x-3"},Vn=v(()=>e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),Fn={class:"flex-1"},Rn=v(()=>e("p",{class:"text-red-800 font-medium text-sm"},"Error",-1)),Gn={class:"text-red-700 text-sm mt-1"},Hn=v(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),On=[Hn],Un={key:6,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},Jn={class:"bg-green-50 border border-green-200 rounded-xl p-4 shadow-lg"},Wn={class:"flex items-start space-x-3"},qn=v(()=>e("svg",{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),Qn={class:"flex-1"},Yn=v(()=>e("p",{class:"text-green-800 font-medium text-sm"},"Success",-1)),Kn={class:"text-green-700 text-sm mt-1"},Xn=v(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Zn=[Xn],el={key:7,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},tl={class:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col shadow-2xl"},sl={class:"flex justify-between items-center p-6 border-b border-gray-200"},ol=v(()=>e("h3",{class:"text-xl font-bold text-gray-900"},"Medical Certificate",-1)),nl={class:"text-gray-600 text-sm mt-1"},ll=v(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),rl=[ll],al={class:"flex-1 p-6 overflow-auto"},il=["src"],dl=v(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),cl=v(()=>e("span",null,"Download Certificate",-1)),ul=[dl,cl],hl={setup(w){const x=y([]),m=y(""),h=y(null),c=y(!1),k=y(""),$=y(""),f=y(!1),b=y(!1),u=y(""),C=R(()=>x.value.filter(s=>s.docstatus===0).length),B=R(()=>x.value.filter(s=>s.docstatus===1).length),L=(s,g="error")=>{u.value=s,g==="success"?(b.value=!0,setTimeout(()=>{b.value=!1},5e3)):(f.value=!0,setTimeout(()=>{f.value=!1},5e3))},E=G({url:"school.al_ummah.api2.get_leave_application_list",auto:!1,onSuccess(s){console.log("Raw API response:",s),Array.isArray(s)?x.value=s:s&&typeof s=="object"?s.message&&Array.isArray(s.message)?x.value=s.message:s.appeals&&Array.isArray(s.appeals)?x.value=s.appeals:s.leave_applications&&Array.isArray(s.leave_applications)?x.value=s.leave_applications:Array.isArray(s.data)?x.value=s.data:x.value=Object.keys(s).length>0?[s]:[]:x.value=[],console.log("Processed appeals:",x.value),m.value=""},onError(s){console.error("Error fetching leave applications:",s);const g=D(s,"Failed to load leave applications.");m.value=g,x.value=[]}}),p=G({url:"school.al_ummah.api2.approve_leave",method:"POST",auto:!1,onSuccess(s){if(console.log("\u2705 Approve API Response:",s),s.success){const g=x.value.findIndex(l=>l.name===s.name);g!==-1&&(x.value[g].docstatus=1,console.log("\u{1F504} Updated appeal docstatus to approved")),L(s.message||"Leave application approved successfully.","success"),h.value=null,ne()}else console.log("\u274C API returned success: false"),L(s.message||"Failed to approve leave application.")},onError(s){console.error("\u{1F6A8} Error approving leave:",s);const g=D(s,"Failed to approve leave application.");L(g)}}),D=(s,g)=>{if(!s)return g;if(s._server_messages)try{const l=JSON.parse(s._server_messages||"[]");if(l.length>0){const F=l[l.length-1];try{const P=JSON.parse(F);return P.message||P.exc_type||g}catch(P){return F||g}}}catch(l){console.error("Error parsing server messages:",l)}return s.message?s.message:s.exc_type||s.exc_message?s.exc_message||s.exc_type||g:typeof s=="string"?s:g},T=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(g){return s||"N/A"}},j=(s,g)=>{if(!s||!g)return 0;try{const l=new Date(s),F=new Date(g),P=Math.abs(F-l);return Math.ceil(P/(1e3*60*60*24))+1}catch(l){return 0}},V=s=>s?s.split(" ").map(g=>g[0]).join("").toUpperCase().substring(0,2):"?",U=s=>s===0?"Pending":"Approved",J=s=>s===0?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",W=s=>{console.error("Image failed to load"),s.target.style.display="none"},K=s=>{console.error("Modal image failed to load"),L("Failed to load medical certificate image."),c.value=!1},q=s=>{h.value=h.value===s?null:s},i=(s,g)=>{s?(k.value=s,$.value=g,c.value=!0):L("Unable to display medical certificate.")},d=(s,g)=>{if(s){const l=document.createElement("a");l.href=s,l.download=`medical-certificate-${g||"student"}.jpg`,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)}},t=()=>{k.value&&d(k.value,$.value)},_=s=>O(this,null,function*(){if(!s){L("Cannot approve: Missing leave application ID");return}const g=x.value.find(F=>F.name===s);if(!g){L("Leave application not found.");return}if(g.docstatus!==0){L("This leave application has already been processed.");return}console.log("Approving leave:",s);const l={name:s};console.log("Sending approve data:",l),yield p.submit(l)}),S=()=>{try{const s=localStorage.getItem("selected_student_group");if(s)try{const g=JSON.parse(s);return g.student_group||g.name||g}catch(g){return s}return null}catch(s){return console.error("Error getting student group:",s),null}},ne=()=>{const s=S();if(!s){m.value="No student group found. Please select a student first.",x.value=[];return}const g={student_group:s};console.log("Fetching leave applications with params:",g),E.fetch(g)};return X(()=>{ne()}),(s,g)=>(o(),n("div",Ts,[a(E).loading?(o(),n("div",Bs,Vs)):m.value?(o(),n("div",Fs,[e("div",Rs,[Gs,e("div",Hs,[Os,e("p",Us,r(m.value),1),e("button",{onClick:ne,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors"}," Try Again ")])])])):!x.value||x.value.length===0?(o(),n("div",Js,qs)):(o(),n("div",Qs,[e("div",Ys,[e("div",Ks,[Xs,e("div",Zs,[e("div",eo,[to,e("span",so,r(a(C))+" pending",1)]),e("div",oo,[no,e("span",lo,r(a(B))+" approved",1)])])])]),e("div",ro,[(o(!0),n(Z,null,ee(x.value,(l,F)=>(o(),n("div",{key:l.name||`appeal-${F}`,class:"bg-white rounded-2xl shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300"},[e("div",ao,[e("div",io,[e("div",co,[e("div",uo,[e("span",ho,r(V(l.student_name||l.student||"Unknown")),1)]),e("div",_o,[e("div",go,[e("div",null,[e("h3",mo,r(l.student_name||l.student||"Unknown Student"),1),e("p",vo,r(l.student||"No Student ID"),1)]),e("div",xo,[e("span",{class:I(["px-3 py-1.5 rounded-full text-sm font-semibold",J(l.docstatus)])},r(U(l.docstatus)),3),e("button",{onClick:P=>q(l.name),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[(o(),n("svg",{class:I(["w-5 h-5 transition-transform duration-200",{"rotate-180":h.value===l.name}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bo,2))],8,po)])]),e("div",yo,[e("div",wo,[ko,e("span",$o,"From "+r(T(l.from_date)),1)]),e("div",Co,[So,e("span",jo,"To "+r(T(l.to_date)),1)]),e("div",Mo,[Ao,e("span",No,r(l.total_leave_days||j(l.from_date,l.to_date))+" days",1)])]),e("p",Eo,r(l.reason||"No reason provided"),1),l.img_url?(o(),n("div",Lo,Do)):A("",!0)])])])]),h.value===l.name?(o(),n("div",To,[e("div",Bo,[e("div",Po,[e("div",zo,[Vo,e("div",Fo,[e("div",null,[Ro,e("p",Go,r(l.student_name||"N/A"),1)]),e("div",null,[Ho,e("p",Oo,r(l.student||"N/A"),1)]),e("div",null,[Uo,e("p",Jo,r(l.name||"N/A"),1)]),e("div",null,[Wo,e("p",qo,r(l.total_leave_days||j(l.from_date,l.to_date))+" days",1)]),e("div",null,[Qo,e("p",{class:I([J(l.docstatus),"px-3 py-1.5 rounded-full text-sm font-semibold inline-block mt-1"])},r(U(l.docstatus)),3)]),e("div",null,[Yo,e("p",Ko,r(l.mark_as_present?"Yes":"No"),1)])])]),e("div",Xo,[Zo,e("p",en,r(l.reason||"No reason provided"),1)]),l.docstatus===0?(o(),n("div",tn,[sn,e("button",{onClick:Y(P=>_(l.name),["stop"]),disabled:a(p).loading,class:"w-full px-6 py-3 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 shadow-sm hover:shadow-md"},rn,8,on),an])):(o(),n("div",dn,un))]),l.img_url?(o(),n("div",hn,[e("div",_n,[gn,e("div",mn,[e("div",vn,[e("img",{src:l.img_url,alt:"Medical Certificate",onError:W,class:"w-full h-64 object-contain cursor-pointer transition-transform duration-200 hover:scale-105",onClick:Y(P=>i(l.img_url,l.student_name),["stop"])},null,40,xn)]),e("div",pn,[e("button",{onClick:Y(P=>i(l.img_url,l.student_name),["stop"]),class:"px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2"},wn,8,fn),e("button",{onClick:Y(P=>d(l.img_url,l.student_name),["stop"]),class:"px-4 py-2.5 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2"},Sn,8,kn)])])])])):l.docstatus===0?(o(),n("div",jn,An)):(o(),n("div",Nn,Ln))])])):A("",!0)]))),128))])])),a(p).loading?(o(),n("div",In,Tn)):A("",!0),f.value?(o(),n("div",Bn,[e("div",Pn,[e("div",zn,[Vn,e("div",Fn,[Rn,e("p",Gn,r(u.value),1)]),e("button",{onClick:g[0]||(g[0]=l=>f.value=!1),class:"text-red-400 hover:text-red-600 transition-colors"},On)])])])):A("",!0),b.value?(o(),n("div",Un,[e("div",Jn,[e("div",Wn,[qn,e("div",Qn,[Yn,e("p",Kn,r(u.value),1)]),e("button",{onClick:g[1]||(g[1]=l=>b.value=!1),class:"text-green-400 hover:text-green-600 transition-colors"},Zn)])])])):A("",!0),c.value?(o(),n("div",el,[e("div",tl,[e("div",sl,[e("div",null,[ol,e("p",nl,r($.value),1)]),e("button",{onClick:g[2]||(g[2]=l=>c.value=!1),class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"},rl)]),e("div",al,[e("img",{src:k.value,alt:"Medical Certificate Full Size",class:"w-full h-auto max-h-full object-contain mx-auto rounded-lg",onError:K},null,40,il)]),e("div",{class:"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl"},[e("div",{class:"flex justify-center"},[e("button",{onClick:t,class:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center space-x-3"},ul)])])])])):A("",!0)]))}};var _l=te(hl,[["__scopeId","data-v-19534540"]]);const M=w=>(se("data-v-1e08e8b4"),w=w(),oe(),w),gl={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},ml={class:"max-w-4xl max-h-full w-full h-full flex items-center justify-center"},vl=["src"],xl={key:1,class:"fixed inset-0 bg-red-50 bg-opacity-90 flex items-center justify-center z-50 p-4"},pl={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},fl={class:"flex items-center mb-4"},bl={class:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"},yl=M(()=>e("h3",{class:"text-lg font-semibold text-red-800"},"Something went wrong",-1)),wl={class:"text-gray-600 mb-4"},kl={key:2,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},$l=M(()=>e("div",{class:"text-center"},[e("div",{class:"spinner mb-4 mx-auto"}),e("p",{class:"text-gray-600"},"Loading your dashboard...")],-1)),Cl=[$l],Sl={key:3,class:"flex flex-col md:flex-row w-full min-h-screen"},jl={class:"md:hidden bg-white shadow-sm border-b border-gray-200 p-4 flex items-center justify-between"},Ml={class:"flex items-center space-x-3"},Al=["src"],Nl={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},El={class:"min-w-0 flex-1"},Ll={class:"text-sm font-semibold text-gray-800 truncate"},Il=M(()=>e("p",{class:"text-xs text-gray-500"},"Teacher",-1)),Dl={class:"flex items-center justify-between md:hidden pb-4 border-b border-gray-200"},Tl=M(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Menu",-1)),Bl={class:"flex-1 overflow-y-auto space-y-6 md:space-y-8"},Pl={class:"hidden md:flex items-start space-x-4 border-b pb-4"},zl=["src"],Vl={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},Fl={class:"min-w-0 flex-1"},Rl={class:"text-xl font-semibold text-gray-800 break-words"},Gl=M(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Teacher",-1)),Hl={class:"space-y-2"},Ol=M(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Class:",-1)),Ul=["disabled"],Jl=M(()=>e("option",{value:"",disabled:""},"Select a class",-1)),Wl=["value"],ql={key:0,class:"text-sm text-yellow-600"},Ql={class:"space-y-3"},Yl=M(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),Kl={class:"space-y-2"},Xl=["disabled"],Zl=M(()=>e("span",{class:"truncate"},"Dashboard",-1)),er=["disabled"],tr=M(()=>e("span",{class:"truncate"},"Take Attendance",-1)),sr=["disabled"],or=M(()=>e("span",{class:"truncate"},"Student Record",-1)),nr=["disabled"],lr=M(()=>e("span",{class:"truncate"},"Create Notice",-1)),rr=["disabled"],ar=M(()=>e("span",{class:"truncate"},"Previous Notices",-1)),ir=["disabled"],dr=M(()=>e("span",{class:"truncate"},"Browse Leave Appeals",-1)),cr={class:"pt-4 border-t border-gray-200 flex-shrink-0"},ur=["disabled"],hr=M(()=>e("span",null,"Logout",-1)),_r={key:0},gr={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 mb-4 md:mb-6"},mr={class:"text-xl md:text-2xl font-bold text-gray-800 mb-2"},vr=M(()=>e("p",{class:"text-gray-600 text-sm md:text-base"},"Manage your classroom activities and student records from here.",-1)),xr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-4 md:mb-6"},pr={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-blue-500"},fr={class:"flex items-center justify-between"},br=M(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Selected Class",-1)),yr={class:"text-lg md:text-2xl font-bold text-gray-800 truncate"},wr={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-green-500"},kr={class:"flex items-center justify-between"},$r=M(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Available Classes",-1)),Cr={class:"text-lg md:text-2xl font-bold text-gray-800"},Sr={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-purple-500"},jr={class:"flex items-center justify-between"},Mr=M(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Today's Date",-1)),Ar={class:"text-lg md:text-2xl font-bold text-gray-800"},Nr={class:"bg-white rounded-lg shadow-sm p-4 md:p-6"},Er=M(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),Lr={class:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"},Ir=["disabled"],Dr=M(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Take Today's Attendance"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Mark student attendance for today")],-1)),Tr=["disabled"],Br=M(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Create New Notice"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Send announcement to students")],-1)),Pr={key:0,class:"text-sm text-yellow-600 mt-3"},zr={key:1,class:"h-full"},Vr={setup(w){const x=ue(),m=y({}),h=y([]),c=y(""),k=y(!1),$=y("dashboard"),f=y(null),b=y(!1),u=y(!1),C=y(""),B={attendance:At,"attendance-record":we,"create-notice":Qt,"previous-notices":Ds,"leave-appeals":_l},L=()=>B[$.value]||null,E=d=>{j.loading||($.value=d,window.innerWidth<768&&(k.value=!1))},p=d=>{d&&(C.value=d,u.value=!0)},D=ge.user,T=()=>{var d;try{const t=localStorage.getItem("user_details"),_=localStorage.getItem("selected_student_group");if(t){const S=JSON.parse(t);m.value={name:S.name,img_url:S.img_url},((d=S.student_groups)==null?void 0:d.length)&&(h.value=S.student_groups,c.value=_||S.student_groups[0],b.value=!0)}}catch(t){console.warn("Error loading from localStorage:",t)}},j=G({url:"school.al_ummah.api2.get_instructor_app_data",params:{teacherID:D},auto:!1,onSuccess(d){var t;console.log("Instructor details loaded:",d),f.value=null;try{d?(m.value={name:d.name,img_url:d.img_url},((t=d.student_groups)==null?void 0:t.length)&&(h.value=d.student_groups,c.value=d.student_groups[0],localStorage.setItem("selected_student_group",d.student_groups[0])),localStorage.setItem("user_details",JSON.stringify({name:d.name,img_url:d.img_url,student_groups:d.student_groups})),b.value=!0):f.value="No user data received from server"}catch(_){console.error("Error processing user data:",_),f.value="Error processing user data"}},onError(d){console.error("Error loading instructor details:",d),f.value="Failed to load user data. Please try again.",b.value||U()}}),V=R(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),U=()=>{try{T(),(m.value.name||h.value.length)&&(b.value=!0,f.value=null)}catch(d){console.error("Error loading from localStorage:",d),f.value="Unable to load user data. Please refresh the page."}},J=()=>O(this,null,function*(){c.value&&localStorage.setItem("selected_student_group",c.value)}),W=d=>{d.target.style.display="none";const t=d.target.nextElementSibling;t&&(t.style.display="flex")},K=()=>{f.value=null,b.value=!1,j.reload()},q=()=>O(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student_group"),yield ge.logout.submit(),x.push({name:"Login"})}catch(d){console.error("Logout error:",d),localStorage.clear(),x.push({name:"Login"})}}),i=()=>{window.innerWidth>=768&&(k.value=!1)};return X(()=>{T(),window.addEventListener("resize",i),setTimeout(()=>{j.reload().catch(d=>{console.error("Failed to reload user details:",d),f.value="Network error. Please check your connection."})},100)}),pe(()=>{window.removeEventListener("resize",i)}),re(()=>j.loading,d=>{!d&&j.data&&console.log("Data loaded successfully")}),re(()=>$.value,()=>{window.innerWidth<768&&(k.value=!1)}),(d,t)=>(o(),n("div",gl,[u.value?(o(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4",onClick:t[2]||(t[2]=_=>u.value=!1)},[e("div",ml,[e("img",{src:C.value,alt:"Full size profile photo",class:"max-w-full max-h-full object-contain",onClick:t[0]||(t[0]=Y(()=>{},["stop"]))},null,8,vl),e("button",{onClick:t[1]||(t[1]=_=>u.value=!1),class:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors"},[N(a(ie),{class:"w-8 h-8"})])])])):A("",!0),f.value?(o(),n("div",xl,[e("div",pl,[e("div",fl,[e("div",bl,[N(a(ke),{class:"w-6 h-6 text-red-600"})]),yl]),e("p",wl,r(f.value),1),e("div",{class:"flex space-x-3"},[e("button",{onClick:K,class:"flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors"}," Try Again "),e("button",{onClick:q,class:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors"}," Logout ")])])])):a(j).loading&&!b.value?(o(),n("div",kl,Cl)):(o(),n("div",Sl,[e("header",jl,[e("div",Ml,[e("div",{class:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0 cursor-pointer",onClick:t[3]||(t[3]=_=>p(m.value.img_url))},[m.value.img_url?(o(),n("img",{key:0,src:m.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:W},null,40,Al)):(o(),n("div",Nl,[N(a(me),{class:"w-5 h-5 text-gray-400"})]))]),e("div",El,[e("h2",Ll,r(m.value.name||"Teacher"),1),Il])]),e("button",{onClick:t[4]||(t[4]=_=>k.value=!k.value),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[N(a($e),{class:"w-6 h-6"})])]),k.value?(o(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:t[5]||(t[5]=_=>k.value=!1)})):A("",!0),e("aside",{class:I(["bg-white shadow-md p-4 md:p-6 space-y-6 md:space-y-8 z-50","fixed md:relative inset-y-0 left-0 transform transition-transform duration-300 ease-in-out","w-72 max-w-full",k.value?"translate-x-0":"-translate-x-full md:translate-x-0","flex flex-col h-screen md:h-auto"])},[e("div",Dl,[Tl,e("button",{onClick:t[6]||(t[6]=_=>k.value=!1),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[N(a(ie),{class:"w-5 h-5"})])]),e("div",Bl,[e("div",Pl,[e("div",{class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden cursor-pointer",onClick:t[7]||(t[7]=_=>p(m.value.img_url))},[m.value.img_url?(o(),n("img",{key:0,src:m.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:W},null,40,zl)):(o(),n("div",Vl,[N(a(me),{class:"w-6 h-6 text-gray-400"})]))]),e("div",Fl,[e("h2",Rl,r(m.value.name||"Loading..."),1),Gl])]),e("div",Hl,[Ol,le(e("select",{"onUpdate:modelValue":t[8]||(t[8]=_=>c.value=_),onChange:J,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",disabled:a(j).loading||!h.value.length},[Jl,(o(!0),n(Z,null,ee(h.value,(_,S)=>(o(),n("option",{key:S,value:_},r(_),9,Wl))),128))],40,Ul),[[fe,c.value]]),h.value.length?A("",!0):(o(),n("p",ql," No classes available "))]),e("div",Ql,[Yl,e("nav",Kl,[e("button",{onClick:t[9]||(t[9]=_=>E("dashboard")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:a(j).loading},[N(a(Ce),{class:"w-5 h-5 flex-shrink-0"}),Zl],10,Xl),e("button",{onClick:t[10]||(t[10]=_=>E("attendance")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="attendance"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:!c.value||a(j).loading},[N(a(de),{class:"w-5 h-5 flex-shrink-0"}),tr],10,er),e("button",{onClick:t[11]||(t[11]=_=>E("attendance-record")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="attendance-record"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"]),disabled:!c.value||a(j).loading},[N(a(ve),{class:"w-5 h-5 flex-shrink-0"}),or],10,sr),e("button",{onClick:t[12]||(t[12]=_=>E("create-notice")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="create-notice"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"]),disabled:!c.value||a(j).loading},[N(a(xe),{class:"w-5 h-5 flex-shrink-0"}),lr],10,nr),e("button",{onClick:t[13]||(t[13]=_=>E("previous-notices")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="previous-notices"?"bg-purple-100 border border-purple-200 text-purple-800":"bg-purple-50 text-purple-800 hover:bg-purple-100"]),disabled:!c.value||a(j).loading},[N(a(Se),{class:"w-5 h-5 flex-shrink-0"}),ar],10,rr),e("button",{onClick:t[14]||(t[14]=_=>E("leave-appeals")),class:I(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",$.value==="leave-appeals"?"bg-indigo-100 border border-indigo-200 text-indigo-800":"bg-indigo-50 text-indigo-800 hover:bg-indigo-100"]),disabled:!c.value||a(j).loading},[N(a(je),{class:"w-5 h-5 flex-shrink-0"}),dr],10,ir)])]),e("div",cr,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",onClick:q,disabled:a(j).loading},[N(a(Me),{class:"w-5 h-5 flex-shrink-0"}),hr],8,ur)])])],2),e("main",{class:I(["flex-1 min-h-screen md:min-h-0 p-4 md:p-6 lg:p-8 bg-gray-50",{"opacity-50 pointer-events-none":a(j).loading}])},[$.value==="dashboard"?(o(),n("div",_r,[e("div",gr,[e("h1",mr,"Welcome, "+r(m.value.name||"Teacher")+"!",1),vr]),e("div",xr,[e("div",pr,[e("div",fr,[e("div",null,[br,e("p",yr,r(c.value||"None"),1)]),N(a(ve),{class:"w-6 h-6 md:w-8 md:h-8 text-blue-500 flex-shrink-0"})])]),e("div",wr,[e("div",kr,[e("div",null,[$r,e("p",Cr,r(h.value.length),1)]),N(a(de),{class:"w-6 h-6 md:w-8 md:h-8 text-green-500 flex-shrink-0"})])]),e("div",Sr,[e("div",jr,[e("div",null,[Mr,e("p",Ar,r(a(V)),1)]),N(a(Ae),{class:"w-6 h-6 md:w-8 md:h-8 text-purple-500 flex-shrink-0"})])])]),e("div",Nr,[Er,e("div",Lr,[e("button",{onClick:t[15]||(t[15]=_=>E("attendance")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[N(a(de),{class:"w-5 h-5 md:w-6 md:h-6 text-blue-600 mr-3 flex-shrink-0"}),Dr],8,Ir),e("button",{onClick:t[16]||(t[16]=_=>E("create-notice")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[N(a(xe),{class:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 mr-3 flex-shrink-0"}),Br],8,Tr)]),c.value?A("",!0):(o(),n("p",Pr," Please select a class to access these features "))])])):(o(),n("div",zr,[(o(),Q(be(L()),{"selected-group":c.value,onBackToDashboard:t[17]||(t[17]=_=>E("dashboard")),key:c.value+$.value},null,8,["selected-group"]))]))],2)]))]))}};var Wr=te(Vr,[["__scopeId","data-v-1e08e8b4"]]);export{Wr as default};
