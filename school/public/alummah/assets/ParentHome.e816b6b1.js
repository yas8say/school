var k=(m,x,i)=>new Promise((g,d)=>{var c=l=>{try{y(i.next(l))}catch(v){d(v)}},S=l=>{try{y(i.throw(l))}catch(v){d(v)}},y=l=>l.done?g(l.value):Promise.resolve(l.value).then(c,S);y((i=i.apply(m,x)).next())});import{_ as $,k as w,c as R,a as P,A as O,C as U,e as h,u as n,D as E,l as e,t as _,q as J,E as M,F as V,G as B,f as r,w as b,n as z,H as F,I as H,z as G,g as q,o as p}from"./vendor.3821638a.js";import{s as I}from"./index.f2b75c83.js";import{r as Q,a as C,c as T,b as N,d as W,e as L}from"./UserGroupIcon.0fa9584c.js";const o=m=>(F("data-v-3d8b978e"),m=m(),H(),m),K={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},X={key:0,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},Y=o(()=>e("div",{class:"spinner"},null,-1)),Z=[Y],ee={class:"md:hidden p-4 bg-white shadow"},te={class:"flex items-center space-x-4 border-b pb-4"},se={class:"w-16 h-16 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center"},oe=["src"],le={key:1,class:"text-sm text-gray-500"},ae={class:"text-xl font-semibold text-gray-800"},re=o(()=>e("p",{class:"text-sm text-gray-500"},"Parent",-1)),ne={class:"space-y-2"},de=o(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Child:",-1)),ie=["disabled"],ce=o(()=>e("option",{value:"",disabled:""},"Select a child",-1)),ue=["value"],_e={class:"space-y-3"},me=o(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),ge={class:"space-y-2"},he={class:"w-full text-left px-4 py-3 rounded hover:bg-blue-100 bg-blue-50 text-blue-800 font-medium flex items-center space-x-3 transition-colors"},pe=o(()=>e("span",null,"Attendance Record",-1)),ve={class:"w-full text-left px-4 py-3 rounded hover:bg-green-100 bg-green-50 text-green-800 font-medium flex items-center space-x-3 transition-colors"},fe=o(()=>e("span",null,"Browse Notices",-1)),be={class:"w-full text-left px-4 py-3 rounded hover:bg-yellow-100 bg-yellow-50 text-yellow-800 font-medium flex items-center space-x-3 transition-colors"},xe=o(()=>e("span",null,"Appeal Leave",-1)),ye={class:"pt-4 border-t"},we=["disabled"],Se=o(()=>e("span",null,"Logout",-1)),ke={class:"flex-1 p-4 md:p-8 bg-gray-50"},Ie={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},Ce={class:"text-2xl font-bold text-gray-800 mb-2"},Ne=o(()=>e("p",{class:"text-gray-600"},"Monitor your child's activities and school records from here.",-1)),Le={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Ae={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500"},De={class:"flex items-center justify-between"},je=o(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Selected Child",-1)),$e={class:"text-2xl font-bold text-gray-800"},Re={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500"},Pe={class:"flex items-center justify-between"},Oe=o(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Available Children",-1)),Ue={class:"text-2xl font-bold text-gray-800"},Ee={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500"},Je={class:"flex items-center justify-between"},Me=o(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Today's Date",-1)),Ve={class:"text-2xl font-bold text-gray-800"},Be={class:"bg-white rounded-lg shadow-sm p-6"},ze=o(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},He=o(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"View Attendance Record"),e("p",{class:"text-sm text-gray-600"},"Check your child's attendance history")],-1)),Ge=o(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"Appeal for Leave"),e("p",{class:"text-sm text-gray-600"},"Submit leave appeal for your child")],-1)),qe={setup(m){const x=G(),i=w({}),g=w([]),d=w(null),c=w(!1),S=I.user,l=R({url:"school.al_ummah.api2.get_user_details",params:{role:"parent",username:S},auto:!0,onSuccess(t){var s,a;console.log("Parent user details loaded:",t),t&&t.user_details&&(i.value={name:t.user_details.name,image:t.user_details.base64profile,address:t.user_details.address},((s=t.user_details.student_list)==null?void 0:s.length)&&(g.value=t.user_details.student_list,d.value=t.user_details.student_list[0],localStorage.setItem("selected_student",JSON.stringify(t.user_details.student_list[0])),localStorage.setItem("selected_student_group",((a=t.user_details.student_list[0])==null?void 0:a.student_group)||"")),localStorage.setItem("user_details",JSON.stringify(t.user_details)))},onError(t){console.error("Error loading parent user details:",t),A()}}),v=P(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),A=()=>{var t;try{const s=localStorage.getItem("user_details");if(s){const a=JSON.parse(s);if(i.value={name:a.name,image:a.base64profile,address:a.address},(t=a.student_list)==null?void 0:t.length){g.value=a.student_list;const f=localStorage.getItem("selected_student");f?d.value=JSON.parse(f):d.value=a.student_list[0]}}}catch(s){console.error("Error loading from localStorage:",s)}},D=()=>k(this,null,function*(){d.value&&(localStorage.setItem("selected_student",JSON.stringify(d.value)),localStorage.setItem("selected_student_group",d.value.student_group||""))}),j=()=>k(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student"),localStorage.removeItem("selected_student_group"),yield I.logout.submit(),x.push({name:"Login"})}catch(t){console.error("Logout error:",t),localStorage.clear(),x.push({name:"Login"})}});return O(()=>{l.data||l.reload()}),U(()=>l.loading,t=>{!t&&l.data&&console.log("Parent data loaded successfully")}),(t,s)=>{var f;const a=q("router-link");return p(),h("div",K,[n(l).loading?(p(),h("div",X,Z)):E("",!0),e("div",ee,[e("button",{onClick:s[0]||(s[0]=u=>c.value=!c.value),class:"px-4 py-2 bg-blue-600 text-white rounded"},_(c.value?"Close Menu":"Open Menu"),1)]),e("aside",{class:z(["bg-white shadow-md p-6 space-y-8 md:block",c.value?"block":"hidden","md:w-72"])},[e("div",te,[e("div",se,[i.value.image?(p(),h("img",{key:0,src:`data:image/jpeg;base64,${i.value.image}`,alt:"Parent",class:"object-cover w-full h-full"},null,8,oe)):(p(),h("span",le,"No Image"))]),e("div",null,[e("h2",ae,_(i.value.name||"No Name Available"),1),re])]),e("div",ne,[de,J(e("select",{"onUpdate:modelValue":s[1]||(s[1]=u=>d.value=u),onChange:D,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:n(l).loading},[ce,(p(!0),h(V,null,B(g.value,u=>(p(),h("option",{key:u.student,value:u},_(u.student_name||"Unnamed Student"),9,ue))),128))],40,ie),[[M,d.value]])]),e("nav",_e,[me,e("div",ge,[r(a,{to:{name:"AttendanceRecord"},class:"block",onClick:s[2]||(s[2]=u=>c.value=!1)},{default:b(()=>[e("div",he,[r(n(N),{class:"w-5 h-5"}),pe])]),_:1}),r(a,{to:{name:"PreviousNotices"},class:"block",onClick:s[3]||(s[3]=u=>c.value=!1)},{default:b(()=>[e("div",ve,[r(n(W),{class:"w-5 h-5"}),fe])]),_:1}),r(a,{to:{name:"AppealLeave"},class:"block",onClick:s[4]||(s[4]=u=>c.value=!1)},{default:b(()=>[e("div",be,[r(n(L),{class:"w-5 h-5"}),xe])]),_:1})])]),e("div",ye,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors",onClick:j,disabled:n(l).loading},[r(n(Q),{class:"w-5 h-5"}),Se],8,we)])],2),e("main",ke,[e("div",Ie,[e("h1",Ce,"Welcome, "+_(i.value.name||"Parent")+"!",1),Ne]),e("div",Le,[e("div",Ae,[e("div",De,[e("div",null,[je,e("p",$e,_(((f=d.value)==null?void 0:f.student_name)||"None"),1)]),r(n(C),{class:"w-8 h-8 text-blue-500"})])]),e("div",Re,[e("div",Pe,[e("div",null,[Oe,e("p",Ue,_(g.value.length),1)]),r(n(C),{class:"w-8 h-8 text-green-500"})])]),e("div",Ee,[e("div",Je,[e("div",null,[Me,e("p",Ve,_(n(v)),1)]),r(n(T),{class:"w-8 h-8 text-purple-500"})])])]),e("div",Be,[ze,e("div",Fe,[r(a,{to:{name:"AttendanceRecord"},class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors"},{default:b(()=>[r(n(N),{class:"w-6 h-6 text-blue-600 mr-3"}),He]),_:1}),r(a,{to:{name:"AppealLeave"},class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors"},{default:b(()=>[r(n(L),{class:"w-6 h-6 text-yellow-600 mr-3"}),Ge]),_:1})])])])])}}};var Xe=$(qe,[["__scopeId","data-v-3d8b978e"]]);export{Xe as default};
