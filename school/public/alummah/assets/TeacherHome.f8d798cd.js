var fe=Object.defineProperty;var ie=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var ce=(_,a,i)=>a in _?fe(_,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):_[a]=i,de=(_,a)=>{for(var i in a||(a={}))ye.call(a,i)&&ce(_,i,a[i]);if(ie)for(var i of ie(a))we.call(a,i)&&ce(_,i,a[i]);return _};var F=(_,a,i)=>new Promise((g,l)=>{var p=C=>{try{f(i.next(C))}catch(v){l(v)}},$=C=>{try{f(i.throw(C))}catch(v){l(v)}},f=C=>C.done?g(C.value):Promise.resolve(C.value).then(p,$);f((i=i.apply(_,a)).next())});import{o,e as n,m as e,_ as q,K as se,l as k,a as ue,c as U,x as J,t as r,n as E,u as m,F as K,E as Q,y as R,L as $e,f as y,p as Y,q as X,w as oe,G as O,A as ne,C as _e,z as ee,M as ke,D as Ce}from"./vendor.e48cf2aa.js";import{s as he}from"./index.5fee7170.js";import{r as re,a as Se,b as ae,c as je,d as Ae,e as Me,f as Ne}from"./UserGroupIcon.1e609207.js";function le(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function De(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function ge(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ee(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function Ie(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function me(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function pe(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function ve(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function xe(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function be(_,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const z=_=>(Y("data-v-8b1e34ae"),_=_(),X(),_),Le={class:"min-h-screen bg-gray-50 p-4"},Be={class:"mb-6"},Te=z(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Take Attendance",-1)),Pe=z(()=>e("p",{class:"text-gray-600"},"Select students who are present today",-1)),Re={key:0,class:"text-sm text-gray-500 mt-1"},Ge={class:"text-sm text-gray-500"},Ve={key:0,class:"flex justify-center items-center py-8"},Fe=z(()=>e("div",{class:"spinner"},null,-1)),Ue=z(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students...",-1)),ze=[Fe,Ue],Oe={key:1,class:"space-y-3"},He={class:"flex justify-between items-center mb-4"},Je={class:"text-sm text-gray-600"},We=["onClick"],Ze={class:"flex items-center space-x-4"},qe={class:"flex-shrink-0"},Ke={class:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden"},Qe=["src"],Ye={key:1,class:"text-white text-sm font-medium"},Xe={class:"flex-1 min-w-0"},et={class:"font-medium text-gray-800 truncate"},tt={class:"flex items-center space-x-4 text-sm text-gray-600"},st=z(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),ot={class:"truncate"},nt={class:"flex-shrink-0"},rt={key:2,class:"text-center py-8"},at=z(()=>e("p",{class:"text-gray-600"},"No students available for this class",-1)),lt={key:3,class:"flex space-x-4 mt-6"},it=z(()=>e("span",null,"Cancel",-1)),ct=["disabled"],dt=z(()=>e("span",null,"Refresh",-1)),ut={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},_t={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},ht=z(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Confirm Attendance",-1)),gt={class:"text-gray-600 mb-2"},mt={class:"text-gray-600 mb-6"},pt={class:"flex space-x-3"},vt={props:{selectedGroup:String},emits:["back-to-dashboard"],setup(_){const a=_,i=se(),g=k([]),l=k([]),p=k(!0),$=k(!1),f=k(!1),C=ue(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),v=h=>h.base64profile&&h.base64profile!=="null"?h.base64profile.startsWith("data:")?h.base64profile:`data:image/jpeg;base64,${h.base64profile}`:null,A=h=>h?h.split(" ").map(D=>D.charAt(0)).join("").toUpperCase().substring(0,2):"?",I=h=>{h.target.style.display="none"},V=U({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(h){return console.log("Attendance data loaded:",h),h},onError(h){console.error("Error fetching attendance:",h),alert("Failed to load student data. Please check your connection and try again.")}}),P=U({url:"school.al_ummah.api2.mark_attendance",onSuccess(h){var D;if(console.log("Attendance marked successfully:",h),f.value=!1,h.status==="success"||((D=h.message)==null?void 0:D.includes("successfully")))alert("Success! "+(h.message||"Attendance has been marked successfully.")),i.push({name:"Teacherhome"});else if(h._server_messages){try{const S=JSON.parse(h._server_messages);if(S.length>0){const L=JSON.parse(S[0]);if(L.message&&L.message.includes("successfully")){alert("Success! "+L.message),i.push({name:"Teacherhome"});return}}}catch(S){console.error("Error parsing server messages:",S)}alert("Success! Attendance has been marked successfully."),i.push({name:"Teacherhome"})}else alert("Error: "+(h.message||"There was an issue marking attendance."))},onError(h){console.error("Error marking attendance:",h),f.value=!1,h.exc_type==="PermissionError"?alert("Permission denied: You do not have permission to mark attendance. Please contact your administrator."):alert("Failed to submit attendance. Please check your connection and try again.")}}),x=()=>F(this,null,function*(){p.value=!0;try{const h=a.selectedGroup||localStorage.getItem("selected_student_group");if(!h){alert("Please select a class first."),p.value=!1;return}const D={based_on:"Batch",student_group:h},S=yield V.fetch(D);if(!S||S.length===0){alert("No students found for this class."),g.value=[];return}g.value=S,l.value=S.map(L=>L.student)}catch(h){console.error("Error fetching attendance:",h),alert("Failed to load student data.")}finally{p.value=!1}}),b=()=>{l.value.length===g.value.length?l.value=[]:l.value=g.value.map(h=>h.student)},c=h=>{const D=l.value.indexOf(h);D>-1?l.value.splice(D,1):l.value.push(h)},t=()=>{if(l.value.length===0){alert("Please select at least one student as present.");return}$.value=!0},M=()=>F(this,null,function*(){$.value=!1,f.value=!0;const h=g.value.filter(B=>l.value.includes(B.student)).map(B=>({student:B.student,student_name:B.student_name,group_roll_number:B.group_roll_number,disabled:!1,checked:!0})),D=g.value.filter(B=>!l.value.includes(B.student)).map(B=>({student:B.student,student_name:B.student_name,group_roll_number:B.group_roll_number,disabled:!1,checked:!1})),S=new Date().toISOString().split("T")[0],L=a.selectedGroup||localStorage.getItem("selected_student_group");try{yield P.submit({students_present:JSON.stringify(h),students_absent:JSON.stringify(D),student_group:L,date:S})}catch(B){console.error("Error submitting attendance:",B),f.value=!1}}),j=()=>{i.push({name:"Teacherhome"})};return J(()=>{x()}),(h,D)=>(o(),n("div",Le,[e("div",Be,[Te,Pe,_.selectedGroup?(o(),n("p",Re,"Class: "+r(_.selectedGroup),1)):E("",!0),e("p",Ge,"Date: "+r(m(C)),1)]),p.value?(o(),n("div",Ve,ze)):g.value&&g.value.length>0?(o(),n("div",Oe,[e("div",He,[e("p",Je," Total: "+r(g.value.length)+" | Present: "+r(l.value.length)+" | Absent: "+r(g.value.length-l.value.length),1),e("button",{onClick:b,class:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300"},r(l.value.length===g.value.length?"Mark All Absent":"Mark All Present"),1)]),(o(!0),n(K,null,Q(g.value,S=>(o(),n("div",{key:S.student,class:R(["bg-white rounded-lg shadow-sm p-4 border-2 transition-colors cursor-pointer",l.value.includes(S.student)?"border-green-500 bg-green-50":"border-gray-200"]),onClick:L=>c(S.student)},[e("div",Ze,[e("div",qe,[e("div",Ke,[S.base64profile&&S.base64profile!=="null"?(o(),n("img",{key:0,src:v(S),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:I},null,40,Qe)):(o(),n("span",Ye,r(A(S.student_name)),1))])]),e("div",Xe,[e("h3",et,r(S.student_name),1),e("div",tt,[e("span",null,"Roll No: "+r(S.group_roll_number),1),st,e("span",ot,r(S.student),1)])]),e("div",nt,[e("div",{class:R(["w-6 h-6 rounded-full border-2 flex items-center justify-center",l.value.includes(S.student)?"bg-green-500 border-green-500":"border-gray-300"])},[l.value.includes(S.student)?(o(),$e(m(Ee),{key:0,class:"w-4 h-4 text-white"})):E("",!0)],2)])])],10,We))),128))])):(o(),n("div",rt,[at,e("button",{onClick:x,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])),g.value.length>0?(o(),n("div",lt,[e("button",{onClick:j,class:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center space-x-2"},[y(m(be),{class:"w-5 h-5"}),it]),e("button",{onClick:t,disabled:f.value,class:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[y(m(De),{class:"w-5 h-5"}),e("span",null,r(f.value?"Submitting...":"Submit"),1)],8,ct),e("button",{onClick:x,class:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-2"},[y(m(le),{class:"w-5 h-5"}),dt])])):E("",!0),$.value?(o(),n("div",ut,[e("div",_t,[ht,e("p",gt,"Present: "+r(l.value.length),1),e("p",mt,"Absent: "+r(g.value.length-l.value.length),1),e("div",pt,[e("button",{onClick:D[0]||(D[0]=S=>$.value=!1),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{onClick:M,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Confirm ")])])])):E("",!0)]))}};var xt=q(vt,[["__scopeId","data-v-8b1e34ae"]]);const T=_=>(Y("data-v-33d6dd92"),_=_(),X(),_),bt={class:"min-h-screen bg-gray-50 p-4"},ft={class:"mb-6"},yt=T(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Attendance Record",-1)),wt=T(()=>e("p",{class:"text-gray-600"},"View student attendance history",-1)),$t={key:0,class:"text-sm text-gray-500 mt-1"},kt={key:0,class:"flex justify-center items-center py-8"},Ct=T(()=>e("div",{class:"spinner"},null,-1)),St=T(()=>e("span",{class:"ml-2 text-gray-600"},"Loading attendance records...",-1)),jt=[Ct,St],At={key:1,class:"space-y-3"},Mt={class:"flex justify-between items-center mb-4"},Nt={class:"text-sm text-gray-600"},Dt=T(()=>e("span",null,"Refresh",-1)),Et={class:"flex items-center space-x-4"},It=["onClick"],Lt={class:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden"},Bt=["src"],Tt={key:1,class:"text-white text-sm font-medium"},Pt=["onClick"],Rt={class:"font-medium text-gray-800 truncate"},Gt={class:"flex items-center space-x-4 text-sm text-gray-600"},Vt=T(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),Ft={class:"truncate text-xs"},Ut={class:"flex items-center space-x-4 mt-2 text-xs"},zt={class:"flex items-center space-x-1 text-green-600"},Ot={class:"flex items-center space-x-1 text-red-600"},Ht={class:"flex items-center space-x-1 text-yellow-600"},Jt={class:"flex-shrink-0 flex items-center space-x-2"},Wt=["onClick"],Zt=["onClick"],qt={key:2,class:"text-center py-8"},Kt={class:"bg-white rounded-lg shadow-sm p-8"},Qt=T(()=>e("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"No Students Found",-1)),Yt=T(()=>e("p",{class:"text-gray-600 mb-4"},"No attendance records available for this class.",-1)),Xt=T(()=>e("span",null,"Refresh Data",-1)),es={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ts={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto"},ss={class:"flex items-center justify-between mb-4"},os=T(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Student Details",-1)),ns={class:"flex items-center space-x-4 mb-6"},rs={class:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-lg relative overflow-hidden"},as=["src"],ls={key:1,class:"text-white text-lg font-medium"},is={class:"font-medium text-gray-800"},cs={class:"text-sm text-gray-600"},ds={class:"text-xs text-gray-500"},us={class:"grid grid-cols-3 gap-4 mb-6"},_s={class:"text-center p-3 bg-green-50 rounded-lg"},hs={class:"text-2xl font-bold text-green-600"},gs=T(()=>e("p",{class:"text-sm text-green-700"},"Present",-1)),ms={class:"text-center p-3 bg-red-50 rounded-lg"},ps={class:"text-2xl font-bold text-red-600"},vs=T(()=>e("p",{class:"text-sm text-red-700"},"Absent",-1)),xs={class:"text-center p-3 bg-yellow-50 rounded-lg"},bs={class:"text-2xl font-bold text-yellow-600"},fs=T(()=>e("p",{class:"text-sm text-yellow-700"},"Leave",-1)),ys={class:"border-t pt-4"},ws=T(()=>e("h5",{class:"font-medium text-gray-800 mb-2"},"Contact Information",-1)),$s={key:0,class:"text-sm text-gray-600"},ks={key:1,class:"text-sm text-gray-600"},Cs={key:2,class:"text-sm text-gray-500"},Ss={class:"flex space-x-3 mt-6"},js=T(()=>e("span",null,"Edit Student",-1)),As={setup(_){const a=se(),i=k([]),g=k(!0),l=k(""),p=k(null),$=k(!1),f=t=>t.base64profile&&t.base64profile!=="null"?t.base64profile.startsWith("data:")?t.base64profile:`data:image/jpeg;base64,${t.base64profile}`:null,C=t=>t?t.split(" ").map(M=>M.charAt(0)).join("").toUpperCase().substring(0,2):"?",v=t=>{t.target.style.display="none"},A=t=>{var j,h,D;const M=de({student_id:t.student,student_name:t.student_name,group_roll_number:t.group_roll_number,student_group:l.value,"First Name":t.first_name||((j=t.student_name)==null?void 0:j.split(" ")[0])||"","Middle Name":t.middle_name||((h=t.student_name)==null?void 0:h.split(" ")[1])||"","Last Name":t.last_name||((D=t.student_name)==null?void 0:D.split(" ")[2])||"","Student Date of Birth":t.date_of_birth||t.student_date_of_birth||"","GR Number":t.gr_number||t.group_roll_number||"","Email Address":t.email||t.email_address||"","Phone Number":t.mobile||t.phone_number||"","Guardian Name":t.guardian_name||t.parent_name||"","Guardian Number":t.guardian_number||t.parent_mobile||"",Relation:t.relation||"","Guardian Date of Birth":t.guardian_date_of_birth||"","Guardian Email":t.guardian_email||"","Guardian Occupation":t.guardian_occupation||"","Guardian Designation":t.guardian_designation||"","Guardian Work Address":t.guardian_work_address||"","Guardian Education":t.guardian_education||"",address:t.address||"",base64profile:t.base64profile||"",present_count:t.present_count||0,absent_count:t.absent_count||0,leave_count:t.leave_count||0,gender:t.gender||"",date_of_birth:t.date_of_birth||"",parent_name:t.parent_name||"",parent_mobile:t.parent_mobile||""},t);a.push({name:"EditStudent",query:{studentId:t.student,studentData:encodeURIComponent(JSON.stringify(M))}})},I=U({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(t){return t},onError(t){console.error("Error fetching attendance records:",t),x()}}),V=()=>{try{const t=localStorage.getItem("selected_student_group");t&&(l.value=t)}catch(t){console.error("Failed to load selected student group:",t)}},P=()=>F(this,null,function*(){if(!!l.value){g.value=!0;try{const t={based_on:"Student Group",student_group:l.value},M=yield I.fetch(t);M&&Array.isArray(M)&&M.length>0&&(localStorage.setItem("attendance_data",JSON.stringify(M)),i.value=M)}catch(t){console.warn("Failed to fetch data from API:",t)}finally{g.value=!1}}}),x=()=>F(this,null,function*(){try{const t=localStorage.getItem("attendance_data");t&&(i.value=JSON.parse(t))}catch(t){console.error("Failed to load attendance data from storage:",t)}finally{g.value=!1}}),b=t=>{p.value=t,$.value=!0},c=()=>{$.value=!1,p.value=null};return J(()=>{V(),l.value?(x(),P()):g.value=!1}),oe(l,t=>{t&&(x(),P())}),(t,M)=>(o(),n("div",bt,[e("div",ft,[yt,wt,l.value?(o(),n("p",$t,"Class: "+r(l.value),1)):E("",!0)]),g.value?(o(),n("div",kt,jt)):i.value&&i.value.length>0?(o(),n("div",At,[e("div",Mt,[e("p",Nt," Total Students: "+r(i.value.length),1),e("button",{onClick:P,class:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center space-x-2"},[y(m(le),{class:"w-4 h-4"}),Dt])]),(o(!0),n(K,null,Q(i.value,j=>(o(),n("div",{key:j.student,class:"bg-white rounded-lg shadow-sm p-4 border border-gray-200 hover:border-blue-300 transition-colors"},[e("div",Et,[e("div",{class:"flex-shrink-0 cursor-pointer",onClick:h=>b(j)},[e("div",Lt,[j.base64profile&&j.base64profile!=="null"?(o(),n("img",{key:0,src:f(j),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:v},null,40,Bt)):(o(),n("span",Tt,r(C(j.student_name)),1))])],8,It),e("div",{class:"flex-1 min-w-0 cursor-pointer",onClick:h=>b(j)},[e("h3",Rt,r(j.student_name),1),e("div",Gt,[e("span",null,"Roll No: "+r(j.group_roll_number),1),Vt,e("span",Ft,"ID: "+r(j.student),1)]),e("div",Ut,[e("span",zt,[y(m(ge),{class:"w-4 h-4"}),e("span",null,"Present: "+r(j.present_count||0),1)]),e("span",Ot,[y(m(xe),{class:"w-4 h-4"}),e("span",null,"Absent: "+r(j.absent_count||0),1)]),e("span",Ht,[y(m(me),{class:"w-4 h-4"}),e("span",null,"Leave: "+r(j.leave_count||0),1)])])],8,Pt),e("div",Jt,[e("button",{onClick:O(h=>A(j),["stop"]),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Student"},[y(m(pe),{class:"w-5 h-5"})],8,Wt),e("div",{class:"cursor-pointer",onClick:O(h=>b(j),["stop"])},[y(m(Ie),{class:"w-5 h-5 text-gray-400"})],8,Zt)])])]))),128))])):(o(),n("div",qt,[e("div",Kt,[y(m(re),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qt,Yt,e("button",{onClick:P,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2 mx-auto"},[y(m(le),{class:"w-4 h-4"}),Xt])])])),p.value&&$.value?(o(),n("div",es,[e("div",ts,[e("div",ss,[os,e("button",{onClick:c,class:"text-gray-400 hover:text-gray-600"},[y(m(be),{class:"w-6 h-6"})])]),e("div",ns,[e("div",rs,[p.value.base64profile&&p.value.base64profile!=="null"?(o(),n("img",{key:0,src:f(p.value),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:v},null,40,as)):(o(),n("span",ls,r(C(p.value.student_name)),1))]),e("div",null,[e("h4",is,r(p.value.student_name),1),e("p",cs,"Roll No: "+r(p.value.group_roll_number),1),e("p",ds,"ID: "+r(p.value.student),1)])]),e("div",us,[e("div",_s,[y(m(ge),{class:"w-8 h-8 text-green-600 mx-auto mb-2"}),e("p",hs,r(p.value.present_count||0),1),gs]),e("div",ms,[y(m(xe),{class:"w-8 h-8 text-red-600 mx-auto mb-2"}),e("p",ps,r(p.value.absent_count||0),1),vs]),e("div",xs,[y(m(me),{class:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),e("p",bs,r(p.value.leave_count||0),1),fs])]),e("div",ys,[ws,p.value.mobile?(o(),n("p",$s," \u{1F4F1} "+r(p.value.mobile),1)):E("",!0),p.value.address?(o(),n("p",ks," \u{1F4CD} "+r(p.value.address),1)):E("",!0),!p.value.mobile&&!p.value.address?(o(),n("p",Cs," No contact information available ")):E("",!0)]),e("div",Ss,[e("button",{onClick:M[0]||(M[0]=j=>A(p.value)),class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2"},[y(m(pe),{class:"w-4 h-4"}),js]),e("button",{onClick:c,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Close ")])])])):E("",!0)]))}};var Ms=q(As,[["__scopeId","data-v-33d6dd92"]]);const Ns={class:"min-h-screen bg-gray-50 p-4"},Ds={class:"max-w-4xl mx-auto"},Es=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Create Notice"),e("p",{class:"text-gray-600"},"Send announcements to students and parents")],-1),Is={class:"bg-white rounded-lg shadow-sm p-6"},Ls={class:"mb-6"},Bs=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Title * ",-1),Ts={class:"mb-6"},Ps=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Message * ",-1),Rs={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Gs={class:"text-sm text-blue-700"},Vs=e("span",{class:"font-medium"},"Selected Class:",-1),Fs={class:"flex justify-end"},Us=["disabled"],zs={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Os=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1),Hs=[Os],Js={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ws=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),Zs=[Ws],qs={setup(_){const a=k(""),i=k(""),g=k(""),l=U({url:"school.al_ummah.api2.submit_notice",auto:!1,onSuccess(v){console.log("Notice submission response:",v),v.message?f(v.message):typeof v=="string"&&v.includes("success")?f(v):f("Notice published successfully!"),a.value="",i.value=""},onError(v){console.error("Error submitting notice:",v),v.message?C(v.message):v.exc_type==="ValidationError"?C("Validation error: Please check your input data."):C("An error occurred while submitting the notice.")}}),p=()=>{try{const v=localStorage.getItem("selected_student_group");v&&(g.value=v)}catch(v){console.error("Failed to load selected student group:",v)}},$=()=>F(this,null,function*(){if(!a.value.trim()||!i.value.trim()){C("Please enter both title and notice message.");return}if(!g.value){C("Student group information is missing.");return}const v={notice_heading:i.value.trim(),notice_message:a.value.trim(),student_group:g.value};console.log("Submitting notice:",v),yield l.fetch(v)}),f=v=>{alert(`\u2705 Success: ${v}`)},C=v=>{alert(`\u274C Error: ${v}`)};return J(()=>{p()}),(v,A)=>(o(),n("div",Ns,[e("div",Ds,[Es,e("div",Is,[e("div",Ls,[Bs,ne(e("input",{"onUpdate:modelValue":A[0]||(A[0]=I=>i.value=I),type:"text",placeholder:"Enter notice title",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_e,i.value]])]),e("div",Ts,[Ps,ne(e("textarea",{"onUpdate:modelValue":A[1]||(A[1]=I=>a.value=I),rows:"8",placeholder:"Enter your notice message here...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"},null,512),[[_e,a.value]])]),e("div",Rs,[e("p",Gs,[Vs,ee(" "+r(g.value||"No class selected"),1)])]),e("div",Fs,[e("button",{onClick:$,disabled:m(l).loading,class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors"},[m(l).loading?(o(),n("svg",Js,Zs)):(o(),n("svg",zs,Hs)),e("span",null,r(m(l).loading?"Publishing...":"Publish Notice"),1)],8,Us)])])])]))}};const H=_=>(Y("data-v-b50e67de"),_=_(),X(),_),Ks={class:"min-h-screen bg-gray-50 p-4"},Qs={class:"mb-6"},Ys=H(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Previous Notices",-1)),Xs=H(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),eo={key:0,class:"text-sm text-gray-500 mt-1"},to={key:0,class:"flex justify-center items-center py-8"},so=H(()=>e("div",{class:"spinner"},null,-1)),oo=H(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),no=[so,oo],ro={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},ao=H(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),lo={key:2,class:"space-y-4"},io=["onClick"],co={class:"p-6"},uo={class:"flex items-start justify-between mb-3"},_o={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},ho={class:"text-sm text-gray-500 whitespace-nowrap"},go={class:"text-gray-600 line-clamp-2 mb-4"},mo={class:"flex items-center justify-between text-sm text-gray-500"},po=["onClick"],vo={key:0,class:"text-center py-12"},xo=ke('<div class="bg-white rounded-lg shadow-sm p-8" data-v-b50e67de><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b50e67de><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-b50e67de></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-b50e67de>No Notices Found</h3><p class="text-gray-600" data-v-b50e67de>No notices have been published for this class yet.</p></div>',1),bo=[xo],fo={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},yo={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},wo={class:"p-6"},$o={class:"flex items-center justify-between mb-4"},ko={class:"text-xl font-bold text-gray-800"},Co=H(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),So=[Co],jo={class:"mb-4 text-sm text-gray-500"},Ao={class:"prose max-w-none mb-6"},Mo={class:"text-gray-700 whitespace-pre-wrap"},No={class:"flex space-x-3 pt-4 border-t"},Do=H(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),Eo=H(()=>e("span",null,"Delete Notice",-1)),Io=[Do,Eo],Lo={setup(_){const a=k([]),i=k(""),g=k(null),l=k(!1),p=U({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(x){console.log("Notices loaded:",x),a.value=Array.isArray(x)?x:[]},onError(x){console.error("Error fetching notices:",x),a.value=[]}}),$=U({url:"school.al_ummah.api2.delete_notice",auto:!1,onSuccess(){console.log("Notice deleted successfully"),C(),I()},onError(x){console.error("Error deleting notice:",x),P("Error","Failed to delete notice. Please try again.")}}),f=()=>{try{const x=localStorage.getItem("selected_student_group");x&&(i.value=x)}catch(x){console.error("Failed to load selected student group:",x)}},C=()=>{if(!i.value)return;const x={student_group:i.value};p.fetch(x)},v=x=>{if(!x)return"No date";try{return new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(b){return x}},A=x=>{g.value=x,l.value=!0},I=()=>{l.value=!1,g.value=null},V=x=>{if(!x){P("Error","No notice ID provided");return}confirm("Are you sure you want to delete this notice? This action cannot be undone.")&&$.fetch({name:x})},P=(x,b)=>{x==="Error"?window.alert(`Error: ${b}`):window.alert(b)};return J(()=>{f(),i.value&&C()}),oe(i,x=>{x&&C()}),(x,b)=>(o(),n("div",Ks,[e("div",Qs,[Ys,Xs,i.value?(o(),n("p",eo,"Class: "+r(i.value),1)):E("",!0)]),m(p).loading?(o(),n("div",to,no)):m(p).error?(o(),n("div",ro,[ao,e("button",{onClick:C,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(o(),n("div",lo,[(o(!0),n(K,null,Q(a.value,(c,t)=>(o(),n("div",{key:t,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:M=>A(c)},[e("div",co,[e("div",uo,[e("h3",_o,r(c.notice_heading||"No Title"),1),e("span",ho,r(v(c.date)),1)]),e("p",go,r(c.notice_message||"No message content"),1),e("div",mo,[e("span",null,"By: "+r(c.owner||"System"),1),e("button",{onClick:O(M=>V(c.name),["stop"]),class:"text-red-600 hover:text-red-800 font-medium"}," Delete ",8,po)])])],8,io))),128)),a.value.length===0?(o(),n("div",vo,bo)):E("",!0)])),g.value&&l.value?(o(),n("div",fo,[e("div",yo,[e("div",wo,[e("div",$o,[e("h2",ko,r(g.value.notice_heading),1),e("button",{onClick:I,class:"text-gray-400 hover:text-gray-600"},So)]),e("div",jo,[e("p",null,"Published on: "+r(v(g.value.date)),1),e("p",null,"By: "+r(g.value.owner||"System"),1)]),e("div",Ao,[e("p",Mo,r(g.value.notice_message),1)]),e("div",No,[e("button",{onClick:b[0]||(b[0]=c=>V(g.value.name)),class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2"},Io),e("button",{onClick:I,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Close ")])])])])):E("",!0)]))}};var Bo=q(Lo,[["__scopeId","data-v-b50e67de"]]);const w=_=>(Y("data-v-6e006303"),_=_(),X(),_),To={class:"min-h-screen bg-gray-50 p-4"},Po={key:0,class:"flex justify-center items-center py-8"},Ro=w(()=>e("div",{class:"spinner"},null,-1)),Go=w(()=>e("span",{class:"ml-2 text-gray-600"},"Loading leave applications...",-1)),Vo=[Ro,Go],Fo={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Uo={class:"flex items-start space-x-3"},zo=w(()=>e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),Oo=w(()=>e("p",{class:"text-red-800 font-medium"},"Error",-1)),Ho={class:"text-red-700 text-sm mt-1"},Jo={key:2,class:"text-center py-12"},Wo=w(()=>e("svg",{class:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),Zo=w(()=>e("p",{class:"text-gray-500 text-lg"},"No leave applications found",-1)),qo=w(()=>e("p",{class:"text-gray-400 text-sm mt-1"},"There are no pending leave applications for this group.",-1)),Ko=[Wo,Zo,qo],Qo={key:3,class:"space-y-4"},Yo={class:"flex justify-between items-center mb-4"},Xo=w(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Leave Applications",-1)),en={class:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded"},tn=["onClick"],sn={class:"p-4"},on={class:"flex items-start space-x-3 mb-3"},nn=w(()=>e("div",{class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),rn={class:"flex-1 min-w-0"},an={class:"font-semibold text-gray-800 text-lg"},ln={class:"text-sm text-gray-500"},cn={class:"text-sm text-gray-600 mt-1"},dn={class:"flex items-center space-x-2"},un=w(()=>e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)),_n=[un],hn={class:"flex justify-between items-center"},gn={class:"flex-1"},mn={class:"text-sm text-gray-700"},pn=ee(" Total Leave Days: "),vn={class:"font-medium"},xn={class:"text-sm text-gray-600 mt-1 line-clamp-1"},bn={key:0,class:"mt-3"},fn=w(()=>e("span",{class:"inline-flex items-center px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs"},[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),ee(" Medical Certificate Available ")],-1)),yn=[fn],wn={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},$n={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},kn=w(()=>e("h4",{class:"font-semibold text-gray-800 mb-3"},"Leave Details",-1)),Cn={class:"space-y-2 text-sm"},Sn={class:"flex justify-between"},jn=w(()=>e("span",{class:"text-gray-600"},"Student Name:",-1)),An={class:"font-medium"},Mn={class:"flex justify-between"},Nn=w(()=>e("span",{class:"text-gray-600"},"Student ID:",-1)),Dn={class:"font-medium"},En={class:"flex justify-between"},In=w(()=>e("span",{class:"text-gray-600"},"Leave ID:",-1)),Ln={class:"font-medium"},Bn={class:"flex justify-between"},Tn=w(()=>e("span",{class:"text-gray-600"},"Duration:",-1)),Pn={class:"font-medium"},Rn={class:"flex justify-between"},Gn=w(()=>e("span",{class:"text-gray-600"},"Status:",-1)),Vn={class:"mt-4"},Fn=w(()=>e("h5",{class:"font-medium text-gray-700 mb-2"},"Reason for Leave",-1)),Un={class:"text-sm text-gray-600 bg-white p-3 rounded border"},zn={key:0,class:"mt-4 flex space-x-3 justify-center"},On=["onClick","disabled"],Hn=w(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Jn=[Hn],Wn=["onClick","disabled"],Zn=w(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),qn=[Zn],Kn={key:1,class:"mt-4 p-3 bg-gray-100 rounded-lg text-center"},Qn={class:"text-sm text-gray-600"},Yn=ee(" This leave application has been "),Xn={class:"font-medium"},er={key:0},tr=w(()=>e("h4",{class:"font-semibold text-gray-800 mb-3"},"Medical Certificate",-1)),sr={class:"bg-white p-4 rounded-lg border border-gray-200"},or={class:"mb-3"},nr=["src","onClick"],rr={class:"flex space-x-2"},ar=["onClick"],lr=w(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),ir=w(()=>e("span",null,"View Full Size",-1)),cr=[lr,ir],dr=["onClick"],ur=w(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),_r=w(()=>e("span",null,"Download",-1)),hr=[ur,_r],gr={key:1,class:"flex items-center justify-center p-8 bg-gray-100 rounded-lg border border-gray-200"},mr=w(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-gray-500 text-sm"},"No medical certificate provided")],-1)),pr=[mr],vr={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xr=w(()=>e("div",{class:"bg-white rounded-lg p-6 flex items-center space-x-3"},[e("div",{class:"spinner-small"}),e("span",{class:"text-gray-700"},"Updating leave application...")],-1)),br=[xr],fr={key:5,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},yr={class:"bg-white rounded-lg max-w-4xl max-h-full w-full"},wr={class:"flex justify-between items-center p-4 border-b"},$r=w(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Medical Certificate",-1)),kr=w(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Cr=[kr],Sr={class:"p-4 max-h-[80vh] overflow-auto"},jr=["src"],Ar=w(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),Mr=w(()=>e("span",null,"Download",-1)),Nr=[Ar,Mr],Dr={setup(_){const a=k([]),i=k(""),g=k(null),l=k(!1),p=k(""),$=k(""),f=k(""),C=U({url:"school.al_ummah.api2.get_leave_application_list",auto:!1,onSuccess(s){console.log("Raw API response:",s),Array.isArray(s)?a.value=s:s&&typeof s=="object"?s.message&&Array.isArray(s.message)?a.value=s.message:s.appeals&&Array.isArray(s.appeals)?a.value=s.appeals:s.leave_applications&&Array.isArray(s.leave_applications)?a.value=s.leave_applications:Array.isArray(s.data)?a.value=s.data:a.value=Object.keys(s).length>0?[s]:[]:a.value=[],console.log("Processed appeals:",a.value),i.value=""},onError(s){console.error("Error fetching leave applications:",s),i.value=s.message||"Failed to load leave applications.",a.value=[]}}),v=U({url:"school.al_ummah.api2.update_leave_status",method:"POST",auto:!1,onSuccess(s){if(console.log("\u2705 Update API Response:",s),s.success){const u=a.value.findIndex(d=>d.name===s.name);u!==-1&&(a.value[u].status=s.status,console.log("\u{1F504} Updated appeal status:",s.status)),L("Success",s.message||"Leave application updated successfully."),te()}else console.log("\u274C API returned success: false"),L("Error",s.message||"Failed to update leave application.")},onError(s){console.error("\u{1F6A8} Error updating leave status:",s);let u="Failed to update leave application.";if(s._server_messages)try{const d=JSON.parse(s._server_messages||"[]"),G=d[d.length-1];u=JSON.parse(G).message||u}catch(d){console.log("\u274C Error parsing server messages:",d),u=s.message||u}else s.message&&(u=s.message);L("Error",u)}}),A=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(u){return s||"N/A"}},I=(s,u)=>{if(!s||!u)return 0;try{const d=new Date(s),G=new Date(u),W=Math.abs(G-d);return Math.ceil(W/(1e3*60*60*24))+1}catch(d){return 0}},V=s=>{if(!s)return!0;const u=String(s).trim().toLowerCase();return!["approved","rejected"].includes(u)},P=s=>{if(!s)return"Pending";const u=String(s).trim();return u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()},x=s=>{if(!s)return"bg-yellow-100 text-yellow-800";switch(String(s).trim().toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-yellow-100 text-yellow-800"}},b=s=>{if(!s)return"";try{let u=s;return u.includes("base64,")&&(u=u.split("base64,")[1]),u=u.trim(),`data:image/jpeg;base64,${u}`}catch(u){return console.error("Error creating document URL:",u),""}},c=s=>{console.error("Image failed to load"),s.target.style.display="none"},t=s=>{console.error("Modal image failed to load"),L("Error","Failed to load medical certificate image."),l.value=!1},M=s=>{g.value=g.value===s?null:s},j=s=>{const u=b(s);u?(p.value=u,$.value=s,l.value=!0):L("Error","Unable to display medical certificate.")},h=(s,u)=>{const d=b(s);if(d){const G=document.createElement("a");G.href=d,G.download=`medical-certificate-${u||"student"}.jpg`,document.body.appendChild(G),G.click(),document.body.removeChild(G)}},D=()=>{if(p.value){const s=document.createElement("a");s.href=p.value,s.download=`medical-certificate-${f.value||"student"}.jpg`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},S=(s,u)=>F(this,null,function*(){if(!s){L("Error","Cannot update: Missing leave application ID");return}console.log("Updating leave status:",s,"to:",u);const d={name:s,status:u};console.log("Sending update data:",d),yield v.submit(d)}),L=(s,u)=>{alert(`${s}: ${u}`)},B=()=>{try{const s=localStorage.getItem("selected_student_group");if(s)try{const u=JSON.parse(s);return u.student_group||u.name||u}catch(u){return s}return null}catch(s){return console.error("Error getting student group:",s),null}},te=()=>{const s=B();if(!s){i.value="No student group found. Please select a student first.",a.value=[];return}const u={student_group:s};console.log("Fetching leave applications with params:",u),C.fetch(u)};return J(()=>{te()}),(s,u)=>(o(),n("div",To,[m(C).loading?(o(),n("div",Po,Vo)):i.value?(o(),n("div",Fo,[e("div",Uo,[zo,e("div",null,[Oo,e("p",Ho,r(i.value),1),e("button",{onClick:te,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])])])):!a.value||a.value.length===0?(o(),n("div",Jo,Ko)):(o(),n("div",Qo,[e("div",Yo,[Xo,e("span",en,r(a.value.length)+" application"+r(a.value.length!==1?"s":""),1)]),(o(!0),n(K,null,Q(a.value,(d,G)=>{var W;return o(),n("div",{key:d.name||`appeal-${G}`,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:Z=>M(d.name)},[e("div",sn,[e("div",on,[nn,e("div",rn,[e("h3",an,r(d.student_name||d.student||"Unknown Student"),1),e("p",ln,r(d.student||"No Student ID"),1),e("p",cn," From: "+r(A(d.from_date))+" - To: "+r(A(d.to_date)),1)]),e("div",dn,[e("span",{class:R(["px-3 py-1 rounded-full text-xs font-medium",x(d.status)])},r(P(d.status)),3),(o(),n("svg",{class:R(["w-5 h-5 text-gray-400 transition-transform duration-200",{"rotate-180":g.value===d.name}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_n,2))])]),e("div",hn,[e("div",gn,[e("p",mn,[pn,e("span",vn,r(d.total_leave_days||I(d.from_date,d.to_date)),1)]),e("p",xn,r(d.reason||"No reason provided"),1)])]),d.document_base64?(o(),n("div",bn,yn)):E("",!0)]),g.value===d.name?(o(),n("div",wn,[e("div",$n,[e("div",null,[kn,e("div",Cn,[e("div",Sn,[jn,e("span",An,r(d.student_name||"N/A"),1)]),e("div",Mn,[Nn,e("span",Dn,r(d.student||"N/A"),1)]),e("div",En,[In,e("span",Ln,r(d.name||"N/A"),1)]),e("div",Bn,[Tn,e("span",Pn,r(d.total_leave_days||I(d.from_date,d.to_date))+" days",1)]),e("div",Rn,[Gn,e("span",{class:R([x(d.status),"px-2 py-1 rounded-full text-xs font-medium"])},r(P(d.status)),3)])]),e("div",Vn,[Fn,e("p",Un,r(d.reason||"No reason provided"),1)]),V(d.status)?(o(),n("div",zn,[e("button",{onClick:O(Z=>S(d.name,"rejected"),["stop"]),disabled:m(v).loading,class:R(["w-12 h-12 rounded-full bg-red-500 bg-opacity-80 text-white hover:bg-red-600 hover:bg-opacity-90 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center shadow-md hover:shadow-lg transform hover:scale-105",{"opacity-60":m(v).loading}]),title:"Reject Leave Application"},Jn,10,On),e("button",{onClick:O(Z=>S(d.name,"approved"),["stop"]),disabled:m(v).loading,class:R(["w-12 h-12 rounded-full bg-green-500 bg-opacity-80 text-white hover:bg-green-600 hover:bg-opacity-90 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center shadow-md hover:shadow-lg transform hover:scale-105",{"opacity-60":m(v).loading}]),title:"Approve Leave Application"},qn,10,Wn)])):(o(),n("div",Kn,[e("p",Qn,[Yn,e("span",Xn,r(((W=d.status)==null?void 0:W.toLowerCase())||"processed"),1)])]))]),d.document_base64?(o(),n("div",er,[tr,e("div",sr,[e("div",or,[e("img",{src:b(d.document_base64),alt:"Medical Certificate",onError:c,class:"w-full h-48 object-contain border border-gray-200 rounded cursor-pointer",onClick:O(Z=>j(d.document_base64),["stop"])},null,40,nr)]),e("div",rr,[e("button",{onClick:O(Z=>j(d.document_base64),["stop"]),class:"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2"},cr,8,ar),e("button",{onClick:O(Z=>h(d.document_base64,d.student_name),["stop"]),class:"flex-1 px-3 py-2 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2"},hr,8,dr)])])])):(o(),n("div",gr,pr))])])):E("",!0)],8,tn)}),128))])),m(v).loading?(o(),n("div",vr,br)):E("",!0),l.value?(o(),n("div",fr,[e("div",yr,[e("div",wr,[$r,e("button",{onClick:u[0]||(u[0]=d=>l.value=!1),class:"text-gray-500 hover:text-gray-700 transition-colors"},Cr)]),e("div",Sr,[e("img",{src:p.value,alt:"Medical Certificate Full Size",class:"w-full h-auto object-contain max-h-[70vh] mx-auto",onError:t},null,40,jr)]),e("div",{class:"p-4 border-t flex justify-center"},[e("button",{onClick:D,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors flex items-center space-x-2"},Nr)])])])):E("",!0)]))}};var Er=q(Dr,[["__scopeId","data-v-6e006303"]]);const N=_=>(Y("data-v-057689aa"),_=_(),X(),_),Ir={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},Lr={key:0,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},Br=N(()=>e("div",{class:"spinner"},null,-1)),Tr=[Br],Pr={class:"md:hidden p-4 bg-white shadow"},Rr={class:"flex items-start space-x-4 border-b pb-4"},Gr={class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden"},Vr=["src"],Fr={key:1,class:"w-full h-full flex items-center justify-center"},Ur=N(()=>e("span",{class:"text-sm text-gray-500"},"No Image",-1)),zr=[Ur],Or={class:"min-w-0 flex-1"},Hr={class:"text-xl font-semibold text-gray-800 break-words"},Jr=N(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Teacher",-1)),Wr={class:"space-y-2"},Zr=N(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Class:",-1)),qr=["disabled"],Kr=N(()=>e("option",{value:"",disabled:""},"Select a class",-1)),Qr=["value"],Yr={class:"space-y-3"},Xr=N(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),ea={class:"space-y-2"},ta=N(()=>e("span",null,"Dashboard",-1)),sa=N(()=>e("span",null,"Take Attendance",-1)),oa=N(()=>e("span",null,"Student Record",-1)),na=N(()=>e("span",null,"Create Notice",-1)),ra=N(()=>e("span",null,"Previous Notices",-1)),aa=N(()=>e("span",null,"Browse Leave Appeals",-1)),la={class:"pt-4 border-t"},ia=["disabled"],ca=N(()=>e("span",null,"Logout",-1)),da={class:"flex-1 p-4 md:p-8 bg-gray-50"},ua={key:0},_a={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},ha={class:"text-2xl font-bold text-gray-800 mb-2"},ga=N(()=>e("p",{class:"text-gray-600"},"Manage your classroom activities and student records from here.",-1)),ma={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},pa={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500"},va={class:"flex items-center justify-between"},xa=N(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Selected Class",-1)),ba={class:"text-2xl font-bold text-gray-800"},fa={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500"},ya={class:"flex items-center justify-between"},wa=N(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Available Classes",-1)),$a={class:"text-2xl font-bold text-gray-800"},ka={class:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500"},Ca={class:"flex items-center justify-between"},Sa=N(()=>e("p",{class:"text-sm font-medium text-gray-600"},"Today's Date",-1)),ja={class:"text-2xl font-bold text-gray-800"},Aa={class:"bg-white rounded-lg shadow-sm p-6"},Ma=N(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),Na={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Da=N(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"Take Today's Attendance"),e("p",{class:"text-sm text-gray-600"},"Mark student attendance for today")],-1)),Ea=N(()=>e("div",null,[e("h3",{class:"font-medium text-gray-800"},"Create New Notice"),e("p",{class:"text-sm text-gray-600"},"Send announcement to students")],-1)),Ia={key:1},La={key:2},Ba={key:3},Ta={key:4},Pa={key:5},Ra={setup(_){const a=se(),i=k({}),g=k([]),l=k(""),p=k(!1),$=k("dashboard"),f=b=>{$.value=b,window.innerWidth<768&&(p.value=!1)},C=he.user,A=U({url:"school.al_ummah.api2.get_user_details",params:{role:"teacher",username:C},auto:!0,onSuccess(b){var c;console.log("User details loaded:",b),b&&b.user_details&&(i.value={name:b.user_details.name,image:b.user_details.base64profile},((c=b.user_details.student_groups)==null?void 0:c.length)&&(g.value=b.user_details.student_groups,l.value=b.user_details.student_groups[0],localStorage.setItem("selected_student_group",b.user_details.student_groups[0])),localStorage.setItem("user_details",JSON.stringify(b.user_details)))},onError(b){console.error("Error loading user details:",b),V()}}),I=ue(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),V=()=>{var b;try{const c=localStorage.getItem("user_details");if(c){const t=JSON.parse(c);i.value={name:t.name,image:t.base64profile},((b=t.student_groups)==null?void 0:b.length)&&(g.value=t.student_groups,l.value=t.student_groups[0])}}catch(c){console.error("Error loading from localStorage:",c)}},P=()=>F(this,null,function*(){localStorage.setItem("selected_student_group",l.value)}),x=()=>F(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student_group"),yield he.logout.submit(),a.push({name:"Login"})}catch(b){console.error("Logout error:",b),localStorage.clear(),a.push({name:"Login"})}});return J(()=>{A.data||A.reload()}),oe(()=>A.loading,b=>{!b&&A.data&&console.log("Data loaded successfully")}),(b,c)=>(o(),n("div",Ir,[m(A).loading?(o(),n("div",Lr,Tr)):E("",!0),e("div",Pr,[e("button",{onClick:c[0]||(c[0]=t=>p.value=!p.value),class:"px-4 py-2 bg-blue-600 text-white rounded"},r(p.value?"Close Menu":"Open Menu"),1)]),e("aside",{class:R(["bg-white shadow-md p-6 space-y-8 md:block",p.value?"block":"hidden","md:w-72"])},[e("div",Rr,[e("div",Gr,[i.value.image?(o(),n("img",{key:0,src:`data:image/jpeg;base64,${i.value.image}`,alt:"Teacher",class:"object-cover w-full h-full"},null,8,Vr)):(o(),n("div",Fr,zr))]),e("div",Or,[e("h2",Hr,r(i.value.name||"No Name Available"),1),Jr])]),e("div",Wr,[Zr,ne(e("select",{"onUpdate:modelValue":c[1]||(c[1]=t=>l.value=t),onChange:P,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m(A).loading},[Kr,(o(!0),n(K,null,Q(g.value,(t,M)=>(o(),n("option",{key:M,value:t},r(t),9,Qr))),128))],40,qr),[[Ce,l.value]])]),e("div",Yr,[Xr,e("nav",ea,[e("button",{onClick:c[2]||(c[2]=t=>f("dashboard")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"])},[y(m(Se),{class:"w-5 h-5"}),ta],2),e("button",{onClick:c[3]||(c[3]=t=>f("attendance")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="attendance"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"])},[y(m(ae),{class:"w-5 h-5"}),sa],2),e("button",{onClick:c[4]||(c[4]=t=>f("attendance-record")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="attendance-record"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"])},[y(m(re),{class:"w-5 h-5"}),oa],2),e("button",{onClick:c[5]||(c[5]=t=>f("create-notice")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="create-notice"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"])},[y(m(ve),{class:"w-5 h-5"}),na],2),e("button",{onClick:c[6]||(c[6]=t=>f("previous-notices")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="previous-notices"?"bg-purple-100 border border-purple-200 text-purple-800":"bg-purple-50 text-purple-800 hover:bg-purple-100"])},[y(m(je),{class:"w-5 h-5"}),ra],2),e("button",{onClick:c[7]||(c[7]=t=>f("leave-appeals")),class:R(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors",$.value==="leave-appeals"?"bg-indigo-100 border border-indigo-200 text-indigo-800":"bg-indigo-50 text-indigo-800 hover:bg-indigo-100"])},[y(m(Ae),{class:"w-5 h-5"}),aa],2)])]),e("div",la,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors",onClick:x,disabled:m(A).loading},[y(m(Me),{class:"w-5 h-5"}),ca],8,ia)])],2),e("main",da,[$.value==="dashboard"?(o(),n("div",ua,[e("div",_a,[e("h1",ha,"Welcome, "+r(i.value.name||"Teacher")+"!",1),ga]),e("div",ma,[e("div",pa,[e("div",va,[e("div",null,[xa,e("p",ba,r(l.value||"None"),1)]),y(m(re),{class:"w-8 h-8 text-blue-500"})])]),e("div",fa,[e("div",ya,[e("div",null,[wa,e("p",$a,r(g.value.length),1)]),y(m(ae),{class:"w-8 h-8 text-green-500"})])]),e("div",ka,[e("div",Ca,[e("div",null,[Sa,e("p",ja,r(m(I)),1)]),y(m(Ne),{class:"w-8 h-8 text-purple-500"})])])]),e("div",Aa,[Ma,e("div",Na,[e("button",{onClick:c[8]||(c[8]=t=>f("attendance")),class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer"},[y(m(ae),{class:"w-6 h-6 text-blue-600 mr-3"}),Da]),e("button",{onClick:c[9]||(c[9]=t=>f("create-notice")),class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer"},[y(m(ve),{class:"w-6 h-6 text-yellow-600 mr-3"}),Ea])])])])):$.value==="attendance"?(o(),n("div",Ia,[y(xt,{"selected-group":l.value,onBackToDashboard:c[10]||(c[10]=t=>f("dashboard"))},null,8,["selected-group"])])):$.value==="attendance-record"?(o(),n("div",La,[y(Ms,{"selected-group":l.value,onBackToDashboard:c[11]||(c[11]=t=>f("dashboard"))},null,8,["selected-group"])])):$.value==="create-notice"?(o(),n("div",Ba,[y(qs,{"selected-group":l.value,onBackToDashboard:c[12]||(c[12]=t=>f("dashboard"))},null,8,["selected-group"])])):$.value==="previous-notices"?(o(),n("div",Ta,[y(Bo,{"selected-group":l.value,onBackToDashboard:c[13]||(c[13]=t=>f("dashboard"))},null,8,["selected-group"])])):$.value==="leave-appeals"?(o(),n("div",Pa,[y(Er,{"selected-group":l.value,onBackToDashboard:c[14]||(c[14]=t=>f("dashboard"))},null,8,["selected-group"])])):E("",!0)])]))}};var za=q(Ra,[["__scopeId","data-v-057689aa"]]);export{za as default};
