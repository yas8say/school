var At=(i,t,e)=>new Promise((a,s)=>{var r=u=>{try{l(e.next(u))}catch(h){s(h)}},n=u=>{try{l(e.throw(u))}catch(h){s(h)}},l=u=>u.done?a(u.value):Promise.resolve(u.value).then(r,n);l((e=e.apply(i,t)).next())});import{k as se,v as Ge,_ as ne,l as B,a as Bt,c as _t,w as Fe,o as w,e as k,m as o,u as b,n as R,t as W,f as le,p as de,q as ce,r as jt,x as qe,y as ut,z as ue,A as H,C as X,D as he,F as Ke,E as Ze,G as Je,H as Qe}from"./vendor.e48cf2aa.js";var pe={},ta=se(Ge);/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function fe(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),e.push.apply(e,a)}return e}function me(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?fe(Object(e),!0).forEach(function(a){ra(i,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):fe(Object(e)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(e,a))})}return i}function ea(i,t){if(typeof i!="object"||!i)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var a=e.call(i,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function ge(i){var t=ea(i,"string");return typeof t=="symbol"?t:t+""}function Ht(i){return Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(i)}function aa(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(i,t){for(var e=0;e<t.length;e++){var a=t[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,ge(a.key),a)}}function ia(i,t,e){return t&&ve(i.prototype,t),e&&ve(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function ra(i,t,e){return t=ge(t),t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function be(i){return oa(i)||sa(i)||na(i)||la()}function oa(i){if(Array.isArray(i))return Yt(i)}function sa(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function na(i,t){if(!!i){if(typeof i=="string")return Yt(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Yt(i,t)}}function Yt(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=i[e];return a}function la(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var It=typeof window!="undefined"&&typeof window.document!="undefined",st=It?window:{},Wt=It&&st.document.documentElement?"ontouchstart"in st.document.documentElement:!1,Vt=It?"PointerEvent"in st:!1,P="cropper",Xt="all",_e="crop",ye="move",xe="zoom",gt="e",vt="w",yt="s",ht="n",Ct="ne",Mt="nw",Et="se",Nt="sw",Gt="".concat(P,"-crop"),we="".concat(P,"-disabled"),Z="".concat(P,"-hidden"),ke="".concat(P,"-hide"),da="".concat(P,"-invisible"),Lt="".concat(P,"-modal"),Ft="".concat(P,"-move"),St="".concat(P,"Action"),zt="".concat(P,"Preview"),qt="crop",De="move",Ce="none",Kt="crop",Zt="cropend",Jt="cropmove",Qt="cropstart",Me="dblclick",ca=Wt?"touchstart":"mousedown",ua=Wt?"touchmove":"mousemove",ha=Wt?"touchend touchcancel":"mouseup",Ee=Vt?"pointerdown":ca,Ne=Vt?"pointermove":ua,Se=Vt?"pointerup pointercancel":ha,Oe="ready",Te="resize",Re="wheel",te="zoom",Ae="image/jpeg",pa=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,fa=/^data:/,ma=/^data:image\/jpeg;base64,/,ga=/^img|canvas$/i,Be=200,Ie=100,Le={viewMode:0,dragMode:qt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Be,minContainerHeight:Ie,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},va='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',ba=Number.isNaN||st.isNaN;function O(i){return typeof i=="number"&&!ba(i)}var ze=function(t){return t>0&&t<1/0};function ee(i){return typeof i=="undefined"}function bt(i){return Ht(i)==="object"&&i!==null}var _a=Object.prototype.hasOwnProperty;function xt(i){if(!bt(i))return!1;try{var t=i.constructor,e=t.prototype;return t&&e&&_a.call(e,"isPrototypeOf")}catch(a){return!1}}function J(i){return typeof i=="function"}var ya=Array.prototype.slice;function $e(i){return Array.from?Array.from(i):ya.call(i)}function Y(i,t){return i&&J(t)&&(Array.isArray(i)||O(i.length)?$e(i).forEach(function(e,a){t.call(i,e,a,i)}):bt(i)&&Object.keys(i).forEach(function(e){t.call(i,i[e],e,i)})),i}var U=Object.assign||function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),s=1;s<e;s++)a[s-1]=arguments[s];return bt(t)&&a.length>0&&a.forEach(function(r){bt(r)&&Object.keys(r).forEach(function(n){t[n]=r[n]})}),t},xa=/\.\d*(?:0|9){12}\d*$/;function wt(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return xa.test(i)?Math.round(i*t)/t:i}var wa=/^width|height|left|top|marginLeft|marginTop$/;function pt(i,t){var e=i.style;Y(t,function(a,s){wa.test(s)&&O(a)&&(a="".concat(a,"px")),e[s]=a})}function ka(i,t){return i.classList?i.classList.contains(t):i.className.indexOf(t)>-1}function G(i,t){if(!!t){if(O(i.length)){Y(i,function(a){G(a,t)});return}if(i.classList){i.classList.add(t);return}var e=i.className.trim();e?e.indexOf(t)<0&&(i.className="".concat(e," ").concat(t)):i.className=t}}function nt(i,t){if(!!t){if(O(i.length)){Y(i,function(e){nt(e,t)});return}if(i.classList){i.classList.remove(t);return}i.className.indexOf(t)>=0&&(i.className=i.className.replace(t,""))}}function kt(i,t,e){if(!!t){if(O(i.length)){Y(i,function(a){kt(a,t,e)});return}e?G(i,t):nt(i,t)}}var Da=/([a-z\d])([A-Z])/g;function ae(i){return i.replace(Da,"$1-$2").toLowerCase()}function ie(i,t){return bt(i[t])?i[t]:i.dataset?i.dataset[t]:i.getAttribute("data-".concat(ae(t)))}function Ot(i,t,e){bt(e)?i[t]=e:i.dataset?i.dataset[t]=e:i.setAttribute("data-".concat(ae(t)),e)}function Ca(i,t){if(bt(i[t]))try{delete i[t]}catch(e){i[t]=void 0}else if(i.dataset)try{delete i.dataset[t]}catch(e){i.dataset[t]=void 0}else i.removeAttribute("data-".concat(ae(t)))}var Pe=/\s\s*/,Ue=function(){var i=!1;if(It){var t=!1,e=function(){},a=Object.defineProperty({},"once",{get:function(){return i=!0,t},set:function(r){t=r}});st.addEventListener("test",e,a),st.removeEventListener("test",e,a)}return i}();function ot(i,t,e){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=e;t.trim().split(Pe).forEach(function(r){if(!Ue){var n=i.listeners;n&&n[r]&&n[r][e]&&(s=n[r][e],delete n[r][e],Object.keys(n[r]).length===0&&delete n[r],Object.keys(n).length===0&&delete i.listeners)}i.removeEventListener(r,s,a)})}function rt(i,t,e){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=e;t.trim().split(Pe).forEach(function(r){if(a.once&&!Ue){var n=i.listeners,l=n===void 0?{}:n;s=function(){delete l[r][e],i.removeEventListener(r,s,a);for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];e.apply(i,d)},l[r]||(l[r]={}),l[r][e]&&i.removeEventListener(r,l[r][e],a),l[r][e]=s,i.listeners=l}i.addEventListener(r,s,a)})}function Dt(i,t,e){var a;return J(Event)&&J(CustomEvent)?a=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(t,!0,!0,e)),i.dispatchEvent(a)}function je(i){var t=i.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var re=st.location,Ma=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function He(i){var t=i.match(Ma);return t!==null&&(t[1]!==re.protocol||t[2]!==re.hostname||t[3]!==re.port)}function Ye(i){var t="timestamp=".concat(new Date().getTime());return i+(i.indexOf("?")===-1?"?":"&")+t}function Tt(i){var t=i.rotate,e=i.scaleX,a=i.scaleY,s=i.translateX,r=i.translateY,n=[];O(s)&&s!==0&&n.push("translateX(".concat(s,"px)")),O(r)&&r!==0&&n.push("translateY(".concat(r,"px)")),O(t)&&t!==0&&n.push("rotate(".concat(t,"deg)")),O(e)&&e!==1&&n.push("scaleX(".concat(e,")")),O(a)&&a!==1&&n.push("scaleY(".concat(a,")"));var l=n.length?n.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function Ea(i){var t=me({},i),e=0;return Y(i,function(a,s){delete t[s],Y(t,function(r){var n=Math.abs(a.startX-r.startX),l=Math.abs(a.startY-r.startY),u=Math.abs(a.endX-r.endX),h=Math.abs(a.endY-r.endY),d=Math.sqrt(n*n+l*l),c=Math.sqrt(u*u+h*h),p=(c-d)/d;Math.abs(p)>Math.abs(e)&&(e=p)})}),e}function $t(i,t){var e=i.pageX,a=i.pageY,s={endX:e,endY:a};return t?s:me({startX:e,startY:a},s)}function Na(i){var t=0,e=0,a=0;return Y(i,function(s){var r=s.startX,n=s.startY;t+=r,e+=n,a+=1}),t/=a,e/=a,{pageX:t,pageY:e}}function ft(i){var t=i.aspectRatio,e=i.height,a=i.width,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=ze(a),n=ze(e);if(r&&n){var l=e*t;s==="contain"&&l>a||s==="cover"&&l<a?e=a/t:a=e*t}else r?e=a/t:n&&(a=e*t);return{width:a,height:e}}function Sa(i){var t=i.width,e=i.height,a=i.degree;if(a=Math.abs(a)%180,a===90)return{width:e,height:t};var s=a%90*Math.PI/180,r=Math.sin(s),n=Math.cos(s),l=t*n+e*r,u=t*r+e*n;return a>90?{width:u,height:l}:{width:l,height:u}}function Oa(i,t,e,a){var s=t.aspectRatio,r=t.naturalWidth,n=t.naturalHeight,l=t.rotate,u=l===void 0?0:l,h=t.scaleX,d=h===void 0?1:h,c=t.scaleY,p=c===void 0?1:c,D=e.aspectRatio,C=e.naturalWidth,T=e.naturalHeight,N=a.fillColor,S=N===void 0?"transparent":N,y=a.imageSmoothingEnabled,I=y===void 0?!0:y,L=a.imageSmoothingQuality,z=L===void 0?"low":L,f=a.maxWidth,M=f===void 0?1/0:f,$=a.maxHeight,F=$===void 0?1/0:$,Q=a.minWidth,at=Q===void 0?0:Q,tt=a.minHeight,it=tt===void 0?0:tt,K=document.createElement("canvas"),V=K.getContext("2d"),et=ft({aspectRatio:D,width:M,height:F}),ct=ft({aspectRatio:D,width:at,height:it},"cover"),g=Math.min(et.width,Math.max(ct.width,C)),E=Math.min(et.height,Math.max(ct.height,T)),j=ft({aspectRatio:s,width:M,height:F}),lt=ft({aspectRatio:s,width:at,height:it},"cover"),dt=Math.min(j.width,Math.max(lt.width,r)),mt=Math.min(j.height,Math.max(lt.height,n)),Pt=[-dt/2,-mt/2,dt,mt];return K.width=wt(g),K.height=wt(E),V.fillStyle=S,V.fillRect(0,0,g,E),V.save(),V.translate(g/2,E/2),V.rotate(u*Math.PI/180),V.scale(d,p),V.imageSmoothingEnabled=I,V.imageSmoothingQuality=z,V.drawImage.apply(V,[i].concat(be(Pt.map(function(Ut){return Math.floor(wt(Ut))})))),V.restore(),K}var We=String.fromCharCode;function Ta(i,t,e){var a="";e+=t;for(var s=t;s<e;s+=1)a+=We(i.getUint8(s));return a}var Ra=/^data:.*,/;function Aa(i){var t=i.replace(Ra,""),e=atob(t),a=new ArrayBuffer(e.length),s=new Uint8Array(a);return Y(s,function(r,n){s[n]=e.charCodeAt(n)}),a}function Ba(i,t){for(var e=[],a=8192,s=new Uint8Array(i);s.length>0;)e.push(We.apply(null,$e(s.subarray(0,a)))),s=s.subarray(a);return"data:".concat(t,";base64,").concat(btoa(e.join("")))}function Ia(i){var t=new DataView(i),e;try{var a,s,r;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var n=t.byteLength,l=2;l+1<n;){if(t.getUint8(l)===255&&t.getUint8(l+1)===225){s=l;break}l+=1}if(s){var u=s+4,h=s+10;if(Ta(t,u,4)==="Exif"){var d=t.getUint16(h);if(a=d===18761,(a||d===19789)&&t.getUint16(h+2,a)===42){var c=t.getUint32(h+4,a);c>=8&&(r=h+c)}}}if(r){var p=t.getUint16(r,a),D,C;for(C=0;C<p;C+=1)if(D=r+C*12+2,t.getUint16(D,a)===274){D+=8,e=t.getUint16(D,a),t.setUint16(D,1,a);break}}}catch(T){e=1}return e}function La(i){var t=0,e=1,a=1;switch(i){case 2:e=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,e=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:e,scaleY:a}}var za={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,a=this.container,s=this.cropper,r=Number(e.minContainerWidth),n=Number(e.minContainerHeight);G(s,Z),nt(t,Z);var l={width:Math.max(a.offsetWidth,r>=0?r:Be),height:Math.max(a.offsetHeight,n>=0?n:Ie)};this.containerData=l,pt(s,{width:l.width,height:l.height}),G(t,Z),nt(s,Z)},initCanvas:function(){var t=this.containerData,e=this.imageData,a=this.options.viewMode,s=Math.abs(e.rotate)%180==90,r=s?e.naturalHeight:e.naturalWidth,n=s?e.naturalWidth:e.naturalHeight,l=r/n,u=t.width,h=t.height;t.height*l>t.width?a===3?u=t.height*l:h=t.width/l:a===3?h=t.width/l:u=t.height*l;var d={aspectRatio:l,naturalWidth:r,naturalHeight:n,width:u,height:h};this.canvasData=d,this.limited=a===1||a===2,this.limitCanvas(!0,!0),d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth),d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight),d.left=(t.width-d.width)/2,d.top=(t.height-d.height)/2,d.oldLeft=d.left,d.oldTop=d.top,this.initialCanvasData=U({},d)},limitCanvas:function(t,e){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=a.viewMode,u=r.aspectRatio,h=this.cropped&&n;if(t){var d=Number(a.minCanvasWidth)||0,c=Number(a.minCanvasHeight)||0;l>1?(d=Math.max(d,s.width),c=Math.max(c,s.height),l===3&&(c*u>d?d=c*u:c=d/u)):l>0&&(d?d=Math.max(d,h?n.width:0):c?c=Math.max(c,h?n.height:0):h&&(d=n.width,c=n.height,c*u>d?d=c*u:c=d/u));var p=ft({aspectRatio:u,width:d,height:c});d=p.width,c=p.height,r.minWidth=d,r.minHeight=c,r.maxWidth=1/0,r.maxHeight=1/0}if(e)if(l>(h?0:1)){var D=s.width-r.width,C=s.height-r.height;r.minLeft=Math.min(0,D),r.minTop=Math.min(0,C),r.maxLeft=Math.max(0,D),r.maxTop=Math.max(0,C),h&&this.limited&&(r.minLeft=Math.min(n.left,n.left+(n.width-r.width)),r.minTop=Math.min(n.top,n.top+(n.height-r.height)),r.maxLeft=n.left,r.maxTop=n.top,l===2&&(r.width>=s.width&&(r.minLeft=Math.min(0,D),r.maxLeft=Math.max(0,D)),r.height>=s.height&&(r.minTop=Math.min(0,C),r.maxTop=Math.max(0,C))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=s.width,r.maxTop=s.height},renderCanvas:function(t,e){var a=this.canvasData,s=this.imageData;if(e){var r=Sa({width:s.naturalWidth*Math.abs(s.scaleX||1),height:s.naturalHeight*Math.abs(s.scaleY||1),degree:s.rotate||0}),n=r.width,l=r.height,u=a.width*(n/a.naturalWidth),h=a.height*(l/a.naturalHeight);a.left-=(u-a.width)/2,a.top-=(h-a.height)/2,a.width=u,a.height=h,a.aspectRatio=n/l,a.naturalWidth=n,a.naturalHeight=l,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,pt(this.canvas,U({width:a.width,height:a.height},Tt({translateX:a.left,translateY:a.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,a=this.imageData,s=a.naturalWidth*(e.width/e.naturalWidth),r=a.naturalHeight*(e.height/e.naturalHeight);U(a,{width:s,height:r,left:(e.width-s)/2,top:(e.height-r)/2}),pt(this.image,U({width:a.width,height:a.height},Tt(U({translateX:a.left,translateY:a.top},a)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,a=t.aspectRatio||t.initialAspectRatio,s=Number(t.autoCropArea)||.8,r={width:e.width,height:e.height};a&&(e.height*a>e.width?r.height=r.width/a:r.width=r.height*a),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*s),r.height=Math.max(r.minHeight,r.height*s),r.left=e.left+(e.width-r.width)/2,r.top=e.top+(e.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=U({},r)},limitCropBox:function(t,e){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=this.limited,u=a.aspectRatio;if(t){var h=Number(a.minCropBoxWidth)||0,d=Number(a.minCropBoxHeight)||0,c=l?Math.min(s.width,r.width,r.width+r.left,s.width-r.left):s.width,p=l?Math.min(s.height,r.height,r.height+r.top,s.height-r.top):s.height;h=Math.min(h,s.width),d=Math.min(d,s.height),u&&(h&&d?d*u>h?d=h/u:h=d*u:h?d=h/u:d&&(h=d*u),p*u>c?p=c/u:c=p*u),n.minWidth=Math.min(h,c),n.minHeight=Math.min(d,p),n.maxWidth=c,n.maxHeight=p}e&&(l?(n.minLeft=Math.max(0,r.left),n.minTop=Math.max(0,r.top),n.maxLeft=Math.min(s.width,r.left+r.width)-n.width,n.maxTop=Math.min(s.height,r.top+r.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=s.width-n.width,n.maxTop=s.height-n.height))},renderCropBox:function(){var t=this.options,e=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,t.movable&&t.cropBoxMovable&&Ot(this.face,St,a.width>=e.width&&a.height>=e.height?ye:Xt),pt(this.cropBox,U({width:a.width,height:a.height},Tt({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Dt(this.element,Kt,this.getData())}},$a={initPreview:function(){var t=this.element,e=this.crossOrigin,a=this.options.preview,s=e?this.crossOriginUrl:this.url,r=t.alt||"The image to preview",n=document.createElement("img");if(e&&(n.crossOrigin=e),n.src=s,n.alt=r,this.viewBox.appendChild(n),this.viewBoxImage=n,!!a){var l=a;typeof a=="string"?l=t.ownerDocument.querySelectorAll(a):a.querySelector&&(l=[a]),this.previews=l,Y(l,function(u){var h=document.createElement("img");Ot(u,zt,{width:u.offsetWidth,height:u.offsetHeight,html:u.innerHTML}),e&&(h.crossOrigin=e),h.src=s,h.alt=r,h.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',u.innerHTML="",u.appendChild(h)})}},resetPreview:function(){Y(this.previews,function(t){var e=ie(t,zt);pt(t,{width:e.width,height:e.height}),t.innerHTML=e.html,Ca(t,zt)})},preview:function(){var t=this.imageData,e=this.canvasData,a=this.cropBoxData,s=a.width,r=a.height,n=t.width,l=t.height,u=a.left-e.left-t.left,h=a.top-e.top-t.top;!this.cropped||this.disabled||(pt(this.viewBoxImage,U({width:n,height:l},Tt(U({translateX:-u,translateY:-h},t)))),Y(this.previews,function(d){var c=ie(d,zt),p=c.width,D=c.height,C=p,T=D,N=1;s&&(N=p/s,T=r*N),r&&T>D&&(N=D/r,C=s*N,T=D),pt(d,{width:C,height:T}),pt(d.getElementsByTagName("img")[0],U({width:n*N,height:l*N},Tt(U({translateX:-u*N,translateY:-h*N},t))))}))}},Pa={bind:function(){var t=this.element,e=this.options,a=this.cropper;J(e.cropstart)&&rt(t,Qt,e.cropstart),J(e.cropmove)&&rt(t,Jt,e.cropmove),J(e.cropend)&&rt(t,Zt,e.cropend),J(e.crop)&&rt(t,Kt,e.crop),J(e.zoom)&&rt(t,te,e.zoom),rt(a,Ee,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&rt(a,Re,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&rt(a,Me,this.onDblclick=this.dblclick.bind(this)),rt(t.ownerDocument,Ne,this.onCropMove=this.cropMove.bind(this)),rt(t.ownerDocument,Se,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&rt(window,Te,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,a=this.cropper;J(e.cropstart)&&ot(t,Qt,e.cropstart),J(e.cropmove)&&ot(t,Jt,e.cropmove),J(e.cropend)&&ot(t,Zt,e.cropend),J(e.crop)&&ot(t,Kt,e.crop),J(e.zoom)&&ot(t,te,e.zoom),ot(a,Ee,this.onCropStart),e.zoomable&&e.zoomOnWheel&&ot(a,Re,this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&ot(a,Me,this.onDblclick),ot(t.ownerDocument,Ne,this.onCropMove),ot(t.ownerDocument,Se,this.onCropEnd),e.responsive&&ot(window,Te,this.onResize)}},Ua={resize:function(){if(!this.disabled){var t=this.options,e=this.container,a=this.containerData,s=e.offsetWidth/a.width,r=e.offsetHeight/a.height,n=Math.abs(s-1)>Math.abs(r-1)?s:r;if(n!==1){var l,u;t.restore&&(l=this.getCanvasData(),u=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(Y(l,function(h,d){l[d]=h*n})),this.setCropBoxData(Y(u,function(h,d){u[d]=h*n})))}}},dblclick:function(){this.disabled||this.options.dragMode===Ce||this.setDragMode(ka(this.dragBox,Gt)?De:qt)},wheel:function(t){var e=this,a=Number(this.options.wheelZoomRatio)||.1,s=1;this.disabled||(t.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){e.wheeling=!1},50),t.deltaY?s=t.deltaY>0?1:-1:t.wheelDelta?s=-t.wheelDelta/120:t.detail&&(s=t.detail>0?1:-1),this.zoom(-s*a,t)))},cropStart:function(t){var e=t.buttons,a=t.button;if(!(this.disabled||(t.type==="mousedown"||t.type==="pointerdown"&&t.pointerType==="mouse")&&(O(e)&&e!==1||O(a)&&a!==0||t.ctrlKey))){var s=this.options,r=this.pointers,n;t.changedTouches?Y(t.changedTouches,function(l){r[l.identifier]=$t(l)}):r[t.pointerId||0]=$t(t),Object.keys(r).length>1&&s.zoomable&&s.zoomOnTouch?n=xe:n=ie(t.target,St),!!pa.test(n)&&Dt(this.element,Qt,{originalEvent:t,action:n})!==!1&&(t.preventDefault(),this.action=n,this.cropping=!1,n===_e&&(this.cropping=!0,G(this.dragBox,Lt)))}},cropMove:function(t){var e=this.action;if(!(this.disabled||!e)){var a=this.pointers;t.preventDefault(),Dt(this.element,Jt,{originalEvent:t,action:e})!==!1&&(t.changedTouches?Y(t.changedTouches,function(s){U(a[s.identifier]||{},$t(s,!0))}):U(a[t.pointerId||0]||{},$t(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,a=this.pointers;t.changedTouches?Y(t.changedTouches,function(s){delete a[s.identifier]}):delete a[t.pointerId||0],!!e&&(t.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,kt(this.dragBox,Lt,this.cropped&&this.options.modal)),Dt(this.element,Zt,{originalEvent:t,action:e}))}}},ja={change:function(t){var e=this.options,a=this.canvasData,s=this.containerData,r=this.cropBoxData,n=this.pointers,l=this.action,u=e.aspectRatio,h=r.left,d=r.top,c=r.width,p=r.height,D=h+c,C=d+p,T=0,N=0,S=s.width,y=s.height,I=!0,L;!u&&t.shiftKey&&(u=c&&p?c/p:1),this.limited&&(T=r.minLeft,N=r.minTop,S=T+Math.min(s.width,a.width,a.left+a.width),y=N+Math.min(s.height,a.height,a.top+a.height));var z=n[Object.keys(n)[0]],f={x:z.endX-z.startX,y:z.endY-z.startY},M=function(F){switch(F){case gt:D+f.x>S&&(f.x=S-D);break;case vt:h+f.x<T&&(f.x=T-h);break;case ht:d+f.y<N&&(f.y=N-d);break;case yt:C+f.y>y&&(f.y=y-C);break}};switch(l){case Xt:h+=f.x,d+=f.y;break;case gt:if(f.x>=0&&(D>=S||u&&(d<=N||C>=y))){I=!1;break}M(gt),c+=f.x,c<0&&(l=vt,c=-c,h-=c),u&&(p=c/u,d+=(r.height-p)/2);break;case ht:if(f.y<=0&&(d<=N||u&&(h<=T||D>=S))){I=!1;break}M(ht),p-=f.y,d+=f.y,p<0&&(l=yt,p=-p,d-=p),u&&(c=p*u,h+=(r.width-c)/2);break;case vt:if(f.x<=0&&(h<=T||u&&(d<=N||C>=y))){I=!1;break}M(vt),c-=f.x,h+=f.x,c<0&&(l=gt,c=-c,h-=c),u&&(p=c/u,d+=(r.height-p)/2);break;case yt:if(f.y>=0&&(C>=y||u&&(h<=T||D>=S))){I=!1;break}M(yt),p+=f.y,p<0&&(l=ht,p=-p,d-=p),u&&(c=p*u,h+=(r.width-c)/2);break;case Ct:if(u){if(f.y<=0&&(d<=N||D>=S)){I=!1;break}M(ht),p-=f.y,d+=f.y,c=p*u}else M(ht),M(gt),f.x>=0?D<S?c+=f.x:f.y<=0&&d<=N&&(I=!1):c+=f.x,f.y<=0?d>N&&(p-=f.y,d+=f.y):(p-=f.y,d+=f.y);c<0&&p<0?(l=Nt,p=-p,c=-c,d-=p,h-=c):c<0?(l=Mt,c=-c,h-=c):p<0&&(l=Et,p=-p,d-=p);break;case Mt:if(u){if(f.y<=0&&(d<=N||h<=T)){I=!1;break}M(ht),p-=f.y,d+=f.y,c=p*u,h+=r.width-c}else M(ht),M(vt),f.x<=0?h>T?(c-=f.x,h+=f.x):f.y<=0&&d<=N&&(I=!1):(c-=f.x,h+=f.x),f.y<=0?d>N&&(p-=f.y,d+=f.y):(p-=f.y,d+=f.y);c<0&&p<0?(l=Et,p=-p,c=-c,d-=p,h-=c):c<0?(l=Ct,c=-c,h-=c):p<0&&(l=Nt,p=-p,d-=p);break;case Nt:if(u){if(f.x<=0&&(h<=T||C>=y)){I=!1;break}M(vt),c-=f.x,h+=f.x,p=c/u}else M(yt),M(vt),f.x<=0?h>T?(c-=f.x,h+=f.x):f.y>=0&&C>=y&&(I=!1):(c-=f.x,h+=f.x),f.y>=0?C<y&&(p+=f.y):p+=f.y;c<0&&p<0?(l=Ct,p=-p,c=-c,d-=p,h-=c):c<0?(l=Et,c=-c,h-=c):p<0&&(l=Mt,p=-p,d-=p);break;case Et:if(u){if(f.x>=0&&(D>=S||C>=y)){I=!1;break}M(gt),c+=f.x,p=c/u}else M(yt),M(gt),f.x>=0?D<S?c+=f.x:f.y>=0&&C>=y&&(I=!1):c+=f.x,f.y>=0?C<y&&(p+=f.y):p+=f.y;c<0&&p<0?(l=Mt,p=-p,c=-c,d-=p,h-=c):c<0?(l=Nt,c=-c,h-=c):p<0&&(l=Ct,p=-p,d-=p);break;case ye:this.move(f.x,f.y),I=!1;break;case xe:this.zoom(Ea(n),t),I=!1;break;case _e:if(!f.x||!f.y){I=!1;break}L=je(this.cropper),h=z.startX-L.left,d=z.startY-L.top,c=r.minWidth,p=r.minHeight,f.x>0?l=f.y>0?Et:Ct:f.x<0&&(h-=c,l=f.y>0?Nt:Mt),f.y<0&&(d-=p),this.cropped||(nt(this.cropBox,Z),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}I&&(r.width=c,r.height=p,r.left=h,r.top=d,this.action=l,this.renderCropBox()),Y(n,function($){$.startX=$.endX,$.startY=$.endY})}},Ha={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&G(this.dragBox,Lt),nt(this.cropBox,Z),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=U({},this.initialImageData),this.canvasData=U({},this.initialCanvasData),this.cropBoxData=U({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(U(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),nt(this.dragBox,Lt),G(this.cropBox,Z)),this},replace:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,Y(this.previews,function(a){a.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,nt(this.cropper,we)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,G(this.cropper,we)),this},destroy:function(){var t=this.element;return t[P]?(t[P]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,s=a.left,r=a.top;return this.moveTo(ee(t)?t:s+Number(t),ee(e)?e:r+Number(e))},moveTo:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,s=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(O(t)&&(a.left=t,s=!0),O(e)&&(a.top=e,s=!0),s&&this.renderCanvas(!0)),this},zoom:function(t,e){var a=this.canvasData;return t=Number(t),t<0?t=1/(1-t):t=1+t,this.zoomTo(a.width*t/a.naturalWidth,null,e)},zoomTo:function(t,e,a){var s=this.options,r=this.canvasData,n=r.width,l=r.height,u=r.naturalWidth,h=r.naturalHeight;if(t=Number(t),t>=0&&this.ready&&!this.disabled&&s.zoomable){var d=u*t,c=h*t;if(Dt(this.element,te,{ratio:t,oldRatio:n/u,originalEvent:a})===!1)return this;if(a){var p=this.pointers,D=je(this.cropper),C=p&&Object.keys(p).length?Na(p):{pageX:a.pageX,pageY:a.pageY};r.left-=(d-n)*((C.pageX-D.left-r.left)/n),r.top-=(c-l)*((C.pageY-D.top-r.top)/l)}else xt(e)&&O(e.x)&&O(e.y)?(r.left-=(d-n)*((e.x-r.left)/n),r.top-=(c-l)*((e.y-r.top)/l)):(r.left-=(d-n)/2,r.top-=(c-l)/2);r.width=d,r.height=c,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return t=Number(t),O(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,O(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(O(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.imageData,s=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(O(t)&&(a.scaleX=t,s=!0),O(e)&&(a.scaleY=e,s=!0),s&&this.renderCanvas(!0,!0)),this},getData:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.options,a=this.imageData,s=this.canvasData,r=this.cropBoxData,n;if(this.ready&&this.cropped){n={x:r.left-s.left,y:r.top-s.top,width:r.width,height:r.height};var l=a.width/a.naturalWidth;if(Y(n,function(d,c){n[c]=d/l}),t){var u=Math.round(n.y+n.height),h=Math.round(n.x+n.width);n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=h-n.x,n.height=u-n.y}}else n={x:0,y:0,width:0,height:0};return e.rotatable&&(n.rotate=a.rotate||0),e.scalable&&(n.scaleX=a.scaleX||1,n.scaleY=a.scaleY||1),n},setData:function(t){var e=this.options,a=this.imageData,s=this.canvasData,r={};if(this.ready&&!this.disabled&&xt(t)){var n=!1;e.rotatable&&O(t.rotate)&&t.rotate!==a.rotate&&(a.rotate=t.rotate,n=!0),e.scalable&&(O(t.scaleX)&&t.scaleX!==a.scaleX&&(a.scaleX=t.scaleX,n=!0),O(t.scaleY)&&t.scaleY!==a.scaleY&&(a.scaleY=t.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var l=a.width/a.naturalWidth;O(t.x)&&(r.left=t.x*l+s.left),O(t.y)&&(r.top=t.y*l+s.top),O(t.width)&&(r.width=t.width*l),O(t.height)&&(r.height=t.height*l),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?U({},this.containerData):{}},getImageData:function(){return this.sized?U({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&Y(["left","top","width","height","naturalWidth","naturalHeight"],function(a){e[a]=t[a]}),e},setCanvasData:function(t){var e=this.canvasData,a=e.aspectRatio;return this.ready&&!this.disabled&&xt(t)&&(O(t.left)&&(e.left=t.left),O(t.top)&&(e.top=t.top),O(t.width)?(e.width=t.width,e.height=t.width/a):O(t.height)&&(e.height=t.height,e.width=t.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var t=this.cropBoxData,e;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(t){var e=this.cropBoxData,a=this.options.aspectRatio,s,r;return this.ready&&this.cropped&&!this.disabled&&xt(t)&&(O(t.left)&&(e.left=t.left),O(t.top)&&(e.top=t.top),O(t.width)&&t.width!==e.width&&(s=!0,e.width=t.width),O(t.height)&&t.height!==e.height&&(r=!0,e.height=t.height),a&&(s?e.height=e.width/a:r&&(e.width=e.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,a=Oa(this.image,this.imageData,e,t);if(!this.cropped)return a;var s=this.getData(t.rounded),r=s.x,n=s.y,l=s.width,u=s.height,h=a.width/Math.floor(e.naturalWidth);h!==1&&(r*=h,n*=h,l*=h,u*=h);var d=l/u,c=ft({aspectRatio:d,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),p=ft({aspectRatio:d,width:t.minWidth||0,height:t.minHeight||0},"cover"),D=ft({aspectRatio:d,width:t.width||(h!==1?a.width:l),height:t.height||(h!==1?a.height:u)}),C=D.width,T=D.height;C=Math.min(c.width,Math.max(p.width,C)),T=Math.min(c.height,Math.max(p.height,T));var N=document.createElement("canvas"),S=N.getContext("2d");N.width=wt(C),N.height=wt(T),S.fillStyle=t.fillColor||"transparent",S.fillRect(0,0,C,T);var y=t.imageSmoothingEnabled,I=y===void 0?!0:y,L=t.imageSmoothingQuality;S.imageSmoothingEnabled=I,L&&(S.imageSmoothingQuality=L);var z=a.width,f=a.height,M=r,$=n,F,Q,at,tt,it,K;M<=-l||M>z?(M=0,F=0,at=0,it=0):M<=0?(at=-M,M=0,F=Math.min(z,l+M),it=F):M<=z&&(at=0,F=Math.min(l,z-M),it=F),F<=0||$<=-u||$>f?($=0,Q=0,tt=0,K=0):$<=0?(tt=-$,$=0,Q=Math.min(f,u+$),K=Q):$<=f&&(tt=0,Q=Math.min(u,f-$),K=Q);var V=[M,$,F,Q];if(it>0&&K>0){var et=C/l;V.push(at*et,tt*et,it*et,K*et)}return S.drawImage.apply(S,[a].concat(be(V.map(function(ct){return Math.floor(wt(ct))})))),N},setAspectRatio:function(t){var e=this.options;return!this.disabled&&!ee(t)&&(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,a=this.dragBox,s=this.face;if(this.ready&&!this.disabled){var r=t===qt,n=e.movable&&t===De;t=r||n?t:Ce,e.dragMode=t,Ot(a,St,t),kt(a,Gt,r),kt(a,Ft,n),e.cropBoxMovable||(Ot(s,St,t),kt(s,Gt,r),kt(s,Ft,n))}return this}},Ya=st.Cropper,Ve=function(){function i(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(aa(this,i),!t||!ga.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=U({},Le,xt(e)&&e),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return ia(i,[{key:"init",value:function(){var e=this.element,a=e.tagName.toLowerCase(),s;if(!e[P]){if(e[P]=this,a==="img"){if(this.isImg=!0,s=e.getAttribute("src")||"",this.originalUrl=s,!s)return;s=e.src}else a==="canvas"&&window.HTMLCanvasElement&&(s=e.toDataURL());this.load(s)}}},{key:"load",value:function(e){var a=this;if(!!e){this.url=e,this.imageData={};var s=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if(fa.test(e)){ma.test(e)?this.read(Aa(e)):this.clone();return}var n=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=l,n.onerror=l,n.ontimeout=l,n.onprogress=function(){n.getResponseHeader("content-type")!==Ae&&n.abort()},n.onload=function(){a.read(n.response)},n.onloadend=function(){a.reloading=!1,a.xhr=null},r.checkCrossOrigin&&He(e)&&s.crossOrigin&&(e=Ye(e)),n.open("GET",e,!0),n.responseType="arraybuffer",n.withCredentials=s.crossOrigin==="use-credentials",n.send()}}},{key:"read",value:function(e){var a=this.options,s=this.imageData,r=Ia(e),n=0,l=1,u=1;if(r>1){this.url=Ba(e,Ae);var h=La(r);n=h.rotate,l=h.scaleX,u=h.scaleY}a.rotatable&&(s.rotate=n),a.scalable&&(s.scaleX=l,s.scaleY=u),this.clone()}},{key:"clone",value:function(){var e=this.element,a=this.url,s=e.crossOrigin,r=a;this.options.checkCrossOrigin&&He(a)&&(s||(s="anonymous"),r=Ye(a)),this.crossOrigin=s,this.crossOriginUrl=r;var n=document.createElement("img");s&&(n.crossOrigin=s),n.src=r||a,n.alt=e.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),G(n,ke),e.parentNode.insertBefore(n,e.nextSibling)}},{key:"start",value:function(){var e=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var s=st.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(st.navigator.userAgent),r=function(h,d){U(e.imageData,{naturalWidth:h,naturalHeight:d,aspectRatio:h/d}),e.initialImageData=U({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(a.naturalWidth&&!s){r(a.naturalWidth,a.naturalHeight);return}var n=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){r(n.width,n.height),s||l.removeChild(n)},n.src=a.src,s||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(n))}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var e=this.element,a=this.options,s=this.image,r=e.parentNode,n=document.createElement("div");n.innerHTML=va;var l=n.querySelector(".".concat(P,"-container")),u=l.querySelector(".".concat(P,"-canvas")),h=l.querySelector(".".concat(P,"-drag-box")),d=l.querySelector(".".concat(P,"-crop-box")),c=d.querySelector(".".concat(P,"-face"));this.container=r,this.cropper=l,this.canvas=u,this.dragBox=h,this.cropBox=d,this.viewBox=l.querySelector(".".concat(P,"-view-box")),this.face=c,u.appendChild(s),G(e,Z),r.insertBefore(l,e.nextSibling),nt(s,ke),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,G(d,Z),a.guides||G(d.getElementsByClassName("".concat(P,"-dashed")),Z),a.center||G(d.getElementsByClassName("".concat(P,"-center")),Z),a.background&&G(l,"".concat(P,"-bg")),a.highlight||G(c,da),a.cropBoxMovable&&(G(c,Ft),Ot(c,St,Xt)),a.cropBoxResizable||(G(d.getElementsByClassName("".concat(P,"-line")),Z),G(d.getElementsByClassName("".concat(P,"-point")),Z)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),J(a.ready)&&rt(e,Oe,a.ready,{once:!0}),Dt(e,Oe)}}},{key:"unbuild",value:function(){if(!!this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),nt(this.element,Z)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Ya,i}},{key:"setDefaults",value:function(e){U(Le,xt(e)&&e)}}])}();U(Ve.prototype,za,$a,Pa,Ua,ja,Ha);var Wa=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ve}),Va=se(Wa);Object.defineProperty(pe,"__esModule",{value:!0});var Xe=ta,Xa=Va,Ga=Fa(Xa);function Fa(i){return i&&i.__esModule?i:{default:i}}function qa(i,t){var e={};for(var a in i)t.indexOf(a)>=0||!Object.prototype.hasOwnProperty.call(i,a)||(e[a]=i[a]);return e}var Ka=typeof window=="undefined"?[String,Array]:[String,Array,Element,NodeList],Za=pe.default={render:function(){var t=this.crossorigin||void 0;return(0,Xe.h)("div",{style:this.containerStyle},[(0,Xe.h)("img",{ref:"img",src:this.src,alt:this.alt||"image",style:[{"max-width":"100%"},this.imgStyle],crossorigin:t})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:Ka,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var t=this.$options.props;t.containerStyle,t.src,t.alt,t.imgStyle;var e=qa(t,["containerStyle","src","alt","imgStyle"]),a={};for(var s in e)this[s]!==void 0&&(a[s]=this[s]);this.cropper=new Ga.default(this.$refs.img,a)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(t,e)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(t,e){return this.cropper.move(t,e)},moveTo:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return this.cropper.moveTo(t,e)},relativeZoom:function(t,e){return this.cropper.zoom(t,e)},zoomTo:function(t,e){return this.cropper.zoomTo(t,e)},rotate:function(t){return this.cropper.rotate(t)},rotateTo:function(t){return this.cropper.rotateTo(t)},scaleX:function(t){return this.cropper.scaleX(t)},scaleY:function(t){return this.cropper.scaleY(t)},scale:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return this.cropper.scale(t,e)},getData:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(t)},setData:function(t){return this.cropper.setData(t)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(t){return this.cropper.setCanvasData(t)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(t){return this.cropper.setCropBoxData(t)},getCroppedCanvas:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(t)},setAspectRatio:function(t){return this.cropper.setAspectRatio(t)},setDragMode:function(t){return this.cropper.setDragMode(t)}}};const q=i=>(de("data-v-15c48f20"),i=i(),ce(),i),Ja={class:"flex items-start space-x-8"},Qa={class:"flex-shrink-0"},ti=q(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Profile Image",-1)),ei={class:"relative"},ai={class:"w-24 h-24 rounded-full border-2 border-white shadow-md overflow-hidden bg-gray-100"},ii=["src","alt"],ri={key:0,class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center"},oi=q(()=>o("div",{class:"spinner-small !w-6 !h-6 !border-2"},null,-1)),si=[oi],ni={class:"flex-1"},li={class:"space-y-4"},di=q(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload New Image",-1)),ci={class:"flex flex-col sm:flex-row gap-3 max-w-md"},ui=["disabled"],hi=q(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),pi=q(()=>o("span",null,"Choose File",-1)),fi=[hi,pi],mi=["disabled"],gi=q(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),vi=q(()=>o("span",null,"Take Photo",-1)),bi=[gi,vi],_i={key:0,class:"mt-3 max-w-md p-3 bg-blue-50 rounded-md border border-blue-200"},yi={class:"text-sm text-blue-700 flex items-center space-x-2"},xi=q(()=>o("svg",{class:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),wi={class:"truncate"},ki={class:"text-xs text-blue-600 mt-1"},Di={key:0,class:"flex space-x-3 max-w-md"},Ci=["disabled"],Mi={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ei=q(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Ni=[Ei],Si={key:1,class:"fixed inset-0 bg-black bg-opacity-90 flex flex-col items-center justify-center z-50 p-4"},Oi={class:"bg-white rounded-lg p-6 max-w-lg w-full"},Ti=q(()=>o("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Take Photo",-1)),Ri={class:"relative bg-gray-100 rounded-lg overflow-hidden"},Ai=q(()=>o("svg",{class:"w-8 h-8 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),Bi=[Ai],Ii={key:2,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},Li={class:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[95vh] overflow-hidden flex flex-col"},zi={class:"text-lg font-semibold text-gray-800 mb-4 flex-shrink-0"},$i={class:"flex-1 min-h-0 bg-gray-100 rounded-lg p-4 overflow-hidden"},Pi={class:"flex-shrink-0 mt-4"},Ui={class:"flex justify-center items-center space-x-4 mb-4"},ji=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Hi=q(()=>o("span",{class:"text-sm"},"Rotate Left",-1)),Yi=[ji,Hi],Wi=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Vi=q(()=>o("span",{class:"text-sm"},"Rotate Right",-1)),Xi=[Wi,Vi],Gi=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Fi=q(()=>o("span",{class:"text-sm"},"Reset",-1)),qi=[Gi,Fi],Ki={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},Zi={props:{studentId:{type:String,required:!0},currentImage:{type:String,default:""},studentName:{type:String,default:""}},emits:["image-updated","error","success"],setup(i,{emit:t}){const e=i,a=B(!1),s=B(null),r=B(null),n=B(""),l=B(!1),u=B(!1),h=B(""),d=B(""),c=B(null),p=B(null),D=B(null),C=B(null),T=g=>!g||g==="null"||g===""?"/assets/alummah/images/default-student.png":g.startsWith("data:")?g:/^[A-Za-z0-9+/=]+$/.test(g)?`data:image/jpeg;base64,${g}`:g,N=Bt(()=>n.value?n.value:e.currentImage?T(e.currentImage):"/assets/alummah/images/default-student.png"),S=_t({url:"school.al_ummah.api2.update_student_profile_image",auto:!1,onSuccess(g){a.value=!1,g.status==="success"?(t("image-updated",g.image_url),t("success",g.message||"Profile image updated!"),et()):t("error",g.message||"Upload failed")},onError(g){a.value=!1,t("error",g.message||"Upload error")}}),y=()=>{var g;return(g=p.value)==null?void 0:g.click()},I=g=>{const E=g.target.files[0];if(!E)return;if(!E.type.startsWith("image/"))return t("error","Select an image");if(E.size>5*1024*1024)return t("error","Image < 5 MB");s.value=E;const j=new FileReader;j.onload=lt=>{h.value=lt.target.result,d.value="file",u.value=!0},j.readAsDataURL(E)},L=()=>At(this,null,function*(){u.value=!1,l.value=!0;try{c.value=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),D.value&&(D.value.srcObject=c.value)}catch(g){t("error","Camera access denied"),l.value=!1}}),z=()=>{if(!D.value)return;const g=document.createElement("canvas"),E=D.value;g.width=E.videoWidth,g.height=E.videoHeight,g.getContext("2d").drawImage(E,0,0),h.value=g.toDataURL("image/jpeg",.8),d.value="camera",u.value=!0,f()},f=()=>{c.value&&c.value.getTracks().forEach(g=>g.stop()),c.value=null,l.value=!1},M=g=>{var E;return(E=C.value)==null?void 0:E.rotate(g)},$=()=>{var g;return(g=C.value)==null?void 0:g.reset()},F=()=>{if(!!C.value)try{const g=C.value.getCroppedCanvas();if(!g)throw new Error("Canvas is null - cannot crop image");if(typeof g.toBlob!="function"){const E=g.toDataURL("image/jpeg",.85),j=Q(E);at(j);return}g.toBlob(E=>{at(E)},"image/jpeg",.85)}catch(g){console.error("Error applying crop:",g),t("error","Failed to crop image. Please try again.")}},Q=g=>{const E=g.split(","),j=E[0].match(/:(.*?);/)[1],lt=atob(E[1]);let dt=lt.length;const mt=new Uint8Array(dt);for(;dt--;)mt[dt]=lt.charCodeAt(dt);return new Blob([mt],{type:j})},at=g=>{const E=new FileReader;E.onload=j=>{n.value=j.target.result,r.value=j.target.result,d.value==="file"&&s.value&&(s.value=new File([g],s.value.name,{type:"image/jpeg",lastModified:Date.now()}))},E.readAsDataURL(g),u.value=!1,t("success",'Cropped \u2013 click "Update Profile Image" to save.')},tt=()=>{u.value=!1,h.value="",s.value=null,p.value&&(p.value.value=""),d.value==="camera"&&L()},it=()=>{let g="";if(s.value){const E=new FileReader;E.onload=j=>{g=j.target.result,K(g)},E.readAsDataURL(s.value)}else if(r.value)g=r.value,K(g);else{t("error","No image selected");return}},K=g=>{a.value=!0;let E=g;if(g.startsWith("data:")){const j=g.indexOf(",");j!==-1&&(E=g.substring(j+1))}S.fetch({student_id:e.studentId,base64_image:E})},V=()=>et(),et=()=>{s.value=null,r.value=null,n.value="",u.value=!1,h.value="",p.value&&(p.value.value=""),f()},ct=g=>{console.warn("Image failed to load, using default image"),g.target.src="/assets/alummah/images/default-student.png"};return Fe(()=>e.currentImage,(g,E)=>{g!==E&&(console.log("StudentProfileImage: currentImage prop changed",{hasNewImage:!!g,isBase64:g&&!g.startsWith("data:")&&!g.startsWith("/"),length:g==null?void 0:g.length}),g&&!n.value&&(n.value=""))}),(g,E)=>(w(),k("div",null,[o("div",Ja,[o("div",Qa,[ti,o("div",ei,[o("div",ai,[o("img",{src:b(N),alt:i.studentName,class:"w-full h-full object-cover",onError:ct},null,40,ii)]),a.value?(w(),k("div",ri,si)):R("",!0)])]),o("div",ni,[o("div",li,[o("div",null,[di,o("div",ci,[o("input",{type:"file",ref_key:"fileInput",ref:p,accept:"image/*",onChange:I,class:"hidden"},null,544),o("button",{type:"button",onClick:y,disabled:a.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 flex items-center space-x-2"},fi,8,ui),o("button",{type:"button",onClick:L,disabled:a.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},bi,8,mi)]),s.value&&!u.value?(w(),k("div",_i,[o("p",yi,[xi,o("span",wi,"Selected: "+W(s.value.name),1)]),o("p",ki,"Size: "+W((s.value.size/1024/1024).toFixed(2))+" MB",1)])):R("",!0)]),(s.value||r.value)&&!u.value?(w(),k("div",Di,[o("button",{type:"button",onClick:it,disabled:a.value,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-purple-300 flex items-center space-x-2 flex-1"},[a.value?(w(),k("svg",Mi,Ni)):R("",!0),o("span",null,W(a.value?"Uploading...":"Update Profile Image"),1)],8,Ci),o("button",{type:"button",onClick:V,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex-1"}," Cancel ")])):R("",!0)])])]),l.value?(w(),k("video",{key:0,ref_key:"videoEl",ref:D,autoplay:"",playsinline:"",class:"hidden"},null,512)):R("",!0),l.value&&!u.value?(w(),k("div",Si,[o("div",Oi,[Ti,o("div",Ri,[o("video",{ref_key:"videoEl",ref:D,autoplay:"",playsinline:"",class:"w-full h-64 object-cover"},null,512),o("div",{class:"absolute bottom-4 left-1/2 transform -translate-x-1/2"},[o("button",{type:"button",onClick:z,class:"w-16 h-16 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-100"},Bi)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:f,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])])):R("",!0),u.value?(w(),k("div",Ii,[o("div",Li,[o("h3",zi,W(d.value==="camera"?"Crop Your Photo":"Crop Uploaded Image"),1),o("div",$i,[le(b(Za),{ref_key:"cropper",ref:C,src:h.value,"aspect-ratio":1,"view-mode":2,guides:!0,background:!1,"auto-crop-area":.8,"min-container-width":200,"min-container-height":200,class:"cropper-container h-full w-full max-h-[50vh]"},null,8,["src","auto-crop-area"])]),o("div",Pi,[o("div",Ui,[o("button",{type:"button",onClick:E[0]||(E[0]=j=>M(-90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Left"},Yi),o("button",{type:"button",onClick:E[1]||(E[1]=j=>M(90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Right"},Xi),o("button",{type:"button",onClick:$,class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Reset Crop"},qi)]),o("div",Ki,[o("button",{type:"button",onClick:tt,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium transition-colors"},W(d.value==="camera"?"Retake Photo":"Choose Different File"),1),o("button",{type:"button",onClick:F,class:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium transition-colors"}," Apply Crop ")])])])])):R("",!0)]))}};var Ji=ne(Zi,[["__scopeId","data-v-15c48f20"]]);const x=i=>(de("data-v-318434fd"),i=i(),ce(),i),Qi={class:"min-h-screen bg-gray-50 p-4"},tr={class:"fixed top-4 right-4 z-50 space-y-2 w-96 max-w-full"},er={class:"flex items-start space-x-3"},ar=x(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),ir={class:"flex-1"},rr=x(()=>o("p",{class:"text-green-800 font-medium"},"Success",-1)),or={class:"text-green-700 text-sm mt-1"},sr={class:"flex items-start space-x-3"},nr=x(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),lr={class:"flex-1"},dr=x(()=>o("p",{class:"text-red-800 font-medium"},"Error",-1)),cr={class:"text-red-700 text-sm mt-1"},ur={class:"mb-6"},hr={class:"text-2xl font-bold text-gray-800"},pr={class:"text-sm text-gray-500 font-normal ml-2"},fr={key:0,class:"text-gray-600"},mr={key:0,class:"text-green-600 font-medium"},gr={key:1,class:"text-orange-600 font-medium"},vr={key:0,class:"flex justify-center items-center py-8"},br=x(()=>o("div",{class:"spinner"},null,-1)),_r=x(()=>o("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)),yr=[br,_r],xr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},wr=x(()=>o("p",{class:"text-red-800"},"Failed to load settings. Using default permissions.",-1)),kr={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Dr=x(()=>o("p",{class:"text-red-800"},"Failed to load student details.",-1)),Cr={key:3,class:"bg-white rounded-lg shadow-sm p-6"},Mr=["onSubmit"],Er={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Nr={class:"md:col-span-2 lg:col-span-3"},Sr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student ID",-1)),Or=["value"],Tr=x(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student ID cannot be changed",-1)),Rr={class:"md:col-span-2 lg:col-span-3"},Ar=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Group",-1)),Br=["value"],Ir=x(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student group cannot be changed",-1)),Lr={key:0,class:"md:col-span-2 lg:col-span-3"},zr=x(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Personal Details",-1)),$r=[zr],Pr={class:"md:col-span-2 lg:col-span-3"},Ur={key:1},jr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),Hr={key:2},Yr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Middle Name",-1)),Wr={key:3},Vr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),Xr={key:4},Gr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Date of Birth",-1)),Fr={key:5},qr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"GR Number",-1)),Kr={key:6},Zr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Roll Number ",-1)),Jr={key:0,class:"text-red-600 text-xs mt-1"},Qr={key:1,class:"text-gray-500 text-xs mt-1"},to={key:7,class:"md:col-span-2 lg:col-span-3 mt-4"},eo=x(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Contact Information",-1)),ao=[eo],io={key:8},ro=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address",-1)),oo={key:9},so=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),no={class:"mt-8 pt-6 border-t flex justify-between items-center"},lo={class:"flex space-x-3"},co=["disabled"],uo={key:0},ho={key:1},po=x(()=>o("div",{class:"md:col-span-2 lg:col-span-3 mt-8"},[o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},[ue(" Guardian Management "),o("span",{class:"text-sm text-blue-600 font-normal ml-2"},"(Manage multiple guardians)")])],-1)),fo={class:"md:col-span-2 lg:col-span-3"},mo=x(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Add New Guardian",-1)),go={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},vo=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),bo=["disabled"],_o=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),yo=["disabled"],xo=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),wo=["disabled"],ko=x(()=>o("option",{value:"Mother"},"Mother",-1)),Do=x(()=>o("option",{value:"Father"},"Father",-1)),Co=x(()=>o("option",{value:"Others"},"Others",-1)),Mo=[ko,Do,Co],Eo={class:"mt-4 flex items-center justify-between"},No={key:0,class:"text-red-600 text-sm font-medium"},So={key:1,class:"text-gray-600 text-sm"},Oo=["disabled"],To={key:0},Ro={key:1},Ao={class:"md:col-span-2 lg:col-span-3"},Bo={class:"bg-white rounded-lg border border-gray-200 p-6"},Io=x(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Existing Guardians",-1)),Lo={key:0,class:"flex justify-center py-4"},zo=x(()=>o("div",{class:"spinner-small"},null,-1)),$o=x(()=>o("span",{class:"ml-2 text-gray-600"},"Loading guardians...",-1)),Po=[zo,$o],Uo={key:1,class:"text-center py-8 text-gray-500"},jo=x(()=>o("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1)),Ho=x(()=>o("p",null,"No guardians added yet.",-1)),Yo=[jo,Ho],Wo={key:2,class:"space-y-4"},Vo={class:"flex items-start justify-between"},Xo={class:"flex items-start space-x-3 flex-1"},Go=x(()=>o("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),Fo={class:"flex-1 min-w-0"},qo={class:"flex items-center space-x-2 mb-1"},Ko={class:"font-medium text-gray-800 text-lg"},Zo={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},Jo={key:0,class:"space-y-2 text-sm text-gray-600"},Qo={class:"flex items-center space-x-4"},ts={class:"flex items-center space-x-1"},es=x(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),as=x(()=>o("span",{class:"text-gray-400"},"\u2022",-1)),is={class:"flex items-center space-x-1"},rs=x(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})],-1)),os={key:0,class:"flex items-center space-x-2 text-xs"},ss={key:0},ns={key:1,class:"text-gray-400"},ls={key:2},ds={key:1,class:"text-xs text-gray-500"},cs={key:1,class:"space-y-4 mt-4 p-4 bg-gray-50 rounded-lg"},us={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},hs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),ps=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),fs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),ms=x(()=>o("option",{value:"Mother"},"Mother",-1)),gs=x(()=>o("option",{value:"Father"},"Father",-1)),vs=x(()=>o("option",{value:"Others"},"Others",-1)),bs=[ms,gs,vs],_s=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date of Birth",-1)),ys=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),xs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Occupation",-1)),ws=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Designation",-1)),ks={class:"md:col-span-2"},Ds=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Work Address",-1)),Cs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Education",-1)),Ms={class:"flex space-x-3 pt-4"},Es=["onClick","disabled"],Ns={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ss=x(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Os=[Ss],Ts=["onClick"],Rs=x(()=>o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),As=[Rs],Bs={class:"text-sm text-gray-600"},Is={key:0,class:"text-green-600"},Ls={key:1,class:"text-orange-600"},zs={setup(i){const t=Qe(),e=jt({student:"",first_name:"",middle_name:"",last_name:"",student_date_of_birth:"",gr_number:"",email_address:"",phone_number:"",roll_number:""}),a=B(""),s=B(""),r=B(!0),n=B(!1),l=B(!1),u=B(""),h=B(""),d=B(""),c=B(""),p=B(""),D=B([]),C=B(null),T=B(!1),N=B(!1),S=jt({guardian_name:"",phone_number:"",relation:"Mother"}),y=jt({guardian_name:"",mobile_number:"",relation:"Mother",date_of_birth:"",email:"",occupation:"",designation:"",work_address:"",education:""}),I=B({allow_instructors_modify_student:0,session_expiry:"24:00"}),L=Bt(()=>I.value.allow_instructors_modify_student===1),z=Bt(()=>D.value.length>=3),f=Bt(()=>{if(!t.query.studentData)return console.log("\u274C No studentData in route query"),"";try{const m=JSON.parse(decodeURIComponent(t.query.studentData)).base64profile||"";return console.log("\u{1F5BC}\uFE0F Image from route:",{exists:!!m,length:(m==null?void 0:m.length)||0,type:(m==null?void 0:m.startsWith("data:"))?"data-url":"base64-raw"}),m}catch(v){return console.error("Error parsing route image data:",v),""}}),M=v=>{h.value=v,d.value="",c.value="animate-slide-in-right"},$=v=>{d.value=v,h.value="",c.value="animate-slide-in-right"},F=()=>{c.value="animate-slide-out-right",setTimeout(()=>{h.value="",d.value="",c.value=""},300)},Q=v=>{console.log("\u{1F4F8} Image updated in StudentProfileImage:",v)},at=_t({url:"school.al_ummah.api3.fetch_admin_settings",auto:!1,onSuccess(v){I.value=v,r.value=!1,n.value=!1},onError(){r.value=!1,n.value=!0,I.value={allow_instructors_modify_student:0,session_expiry:"24:00"}}}),tt=_t({url:"school.al_ummah.api2.get_student_details",auto:!1,onSuccess(v){v.student_info&&Object.assign(e,v.student_info),v.guardians&&Array.isArray(v.guardians)&&(D.value=v.guardians),p.value=""},onError(){p.value="Failed to load student details.",D.value=[]}}),it=_t({url:"school.al_ummah.api2.update_student_details",auto:!1,onSuccess(v){l.value=!1,$(v.message||"Student updated successfully!")},onError(v){var _,A;l.value=!1;const m=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(m||"Update failed.")}}),K=_t({url:"school.al_ummah.api2.add_guardian_to_student",auto:!1,onSuccess(v){N.value=!1,$(v.message||"Guardian added!"),Rt(),E()},onError(v){var _,A;N.value=!1;const m=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(m||"Failed to add guardian.")}}),V=_t({url:"school.al_ummah.api2.update_guardian_details",auto:!1,onSuccess(v){T.value=!1,$(v.message||"Guardian updated!"),C.value=null,j(),Rt()},onError(v){var _,A;T.value=!1;const m=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(m||"Failed to update guardian.")}}),et=v=>/^[0-9]{10}$/.test(v),ct=v=>{[".",",","e","E","-"].includes(v.key)&&v.preventDefault()},g=()=>{const v=e.roll_number;if(!v&&v!==0)return u.value="";const m=Number(v);if(!Number.isInteger(m))return u.value="Must be a whole number";if(m<1)return u.value="Must be at least 1";if(m>999)return u.value="Cannot exceed 999";u.value=""},E=()=>{S.guardian_name="",S.phone_number="",S.relation="Mother"},j=()=>{Object.keys(y).forEach(v=>{y[v]=""}),y.relation="Mother"},lt=()=>At(this,null,function*(){if(!S.guardian_name.trim())return M("Guardian name required");if(!et(S.phone_number))return M("Valid 10-digit phone required");N.value=!0,K.fetch({student_id:a.value,student_name:`${e.first_name} ${e.last_name}`.trim(),guardian_name:S.guardian_name,relation:S.relation,phone_number:S.phone_number})}),dt=v=>{C.value=v.guardian,Object.assign(y,{guardian_name:v.guardian_name||"",mobile_number:v.mobile_number||"",relation:v.relation||"Mother",date_of_birth:v.date_of_birth||"",email:v.email||"",occupation:v.occupation||"",designation:v.designation||"",work_address:v.work_address||"",education:v.education||""})},mt=()=>{C.value=null,j()},Pt=v=>{if(!y.guardian_name.trim())return M("Guardian name required");if(!et(y.mobile_number))return M("Valid 10-digit phone required");T.value=!0,V.fetch({guardian_id:v,guardian_name:y.guardian_name,phone_number:y.mobile_number,relation:y.relation,guardian_date_of_birth:y.date_of_birth,guardian_email:y.email,occupation:y.occupation,designation:y.designation,work_address:y.work_address,education:y.education})},Ut=v=>At(this,null,function*(){var _;if(console.log("\u{1F6A8} updateStudent called",{eventType:v==null?void 0:v.type,target:(_=v==null?void 0:v.target)==null?void 0:_.tagName,timestamp:new Date().toISOString(),studentId:a.value}),v&&(v.preventDefault(),v.stopPropagation()),g(),u.value){M(u.value);return}l.value=!0;const m={student_id:a.value,student_group:s.value};L.value&&Object.assign(m,{first_name:e.first_name||"",middle_name:e.middle_name||"",last_name:e.last_name||"",student_date_of_birth:e.student_date_of_birth||"",gr_number:e.gr_number||"",email_address:e.email_address||"",phone_number:e.phone_number||"",roll_number:e.roll_number||""}),console.log("Sending update data:",m),yield it.fetch(m)}),Rt=()=>{!a.value||tt.fetch({student:a.value})},oe=()=>{r.value=!0,at.fetch()};return qe(()=>{var v;if(a.value=t.query.studentId,t.query.studentData)try{const m=JSON.parse(decodeURIComponent(t.query.studentData));s.value=m.student_group||"",console.log("\u{1F3AF} Route data analysis:",{studentGroup:s.value,hasBase64profile:!!m.base64profile,base64profileLength:((v=m.base64profile)==null?void 0:v.length)||0,allKeys:Object.keys(m)})}catch(m){console.error("Error parsing student data:",m),M("Invalid student data")}oe(),Rt()}),(v,m)=>(w(),k("div",Qi,[o("div",tr,[d.value?(w(),k("div",{key:0,class:ut(["bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",c.value])},[o("div",er,[ar,o("div",ir,[rr,o("p",or,W(d.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:F,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium"}," OK ")])],2)):R("",!0),h.value?(w(),k("div",{key:1,class:ut(["bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",c.value])},[o("div",sr,[nr,o("div",lr,[dr,o("p",cr,W(h.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:F,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium"}," OK ")])],2)):R("",!0)]),o("div",ur,[o("h1",hr,[ue(" Edit Student: "+W(b(e).student_name||a.value)+" ",1),o("span",pr,"(ID: "+W(a.value)+")",1)]),r.value?R("",!0):(w(),k("p",fr,[b(L)?(w(),k("span",mr," \u2713 Full editing access enabled ")):(w(),k("span",gr," \u26A0 Limited editing access (Guardian fields only) "))]))]),b(tt).loading||r.value?(w(),k("div",vr,yr)):n.value?(w(),k("div",xr,[wr,o("button",{type:"button",onClick:oe,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):p.value?(w(),k("div",kr,[Dr,o("button",{type:"button",onClick:Rt,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(w(),k("div",Cr,[o("form",{onSubmit:Je(Ut,["prevent"])},[o("div",Er,[o("div",Nr,[Sr,o("input",{value:a.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Or),Tr]),o("div",Rr,[Ar,o("input",{value:s.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Br),Ir]),b(L)?(w(),k("div",Lr,$r)):R("",!0),o("div",Pr,[le(Ji,{"student-id":a.value,"current-image":b(f),"student-name":b(e).student_name,onImageUpdated:Q,onSuccess:m[0]||(m[0]=_=>$(_)),onError:m[1]||(m[1]=_=>M(_))},null,8,["student-id","current-image","student-name"])]),b(L)?(w(),k("div",Ur,[jr,H(o("input",{"onUpdate:modelValue":m[2]||(m[2]=_=>b(e).first_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).first_name]])])):R("",!0),b(L)?(w(),k("div",Hr,[Yr,H(o("input",{"onUpdate:modelValue":m[3]||(m[3]=_=>b(e).middle_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).middle_name]])])):R("",!0),b(L)?(w(),k("div",Wr,[Vr,H(o("input",{"onUpdate:modelValue":m[4]||(m[4]=_=>b(e).last_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).last_name]])])):R("",!0),b(L)?(w(),k("div",Xr,[Gr,H(o("input",{"onUpdate:modelValue":m[5]||(m[5]=_=>b(e).student_date_of_birth=_),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).student_date_of_birth]])])):R("",!0),b(L)?(w(),k("div",Fr,[qr,H(o("input",{"onUpdate:modelValue":m[6]||(m[6]=_=>b(e).gr_number=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).gr_number]])])):R("",!0),b(L)?(w(),k("div",Kr,[Zr,H(o("input",{"onUpdate:modelValue":m[7]||(m[7]=_=>b(e).roll_number=_),type:"number",min:"1",max:"999",step:"1",placeholder:"Enter roll number",onKeypress:ct,onInput:g,class:ut(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",u.value?"border-red-300 bg-red-50":"border-gray-300"])},null,34),[[X,b(e).roll_number]]),u.value?(w(),k("p",Jr,W(u.value),1)):(w(),k("p",Qr,"Must be a whole number between 1-999 (optional)"))])):R("",!0),b(L)?(w(),k("div",to,ao)):R("",!0),b(L)?(w(),k("div",io,[ro,H(o("input",{"onUpdate:modelValue":m[8]||(m[8]=_=>b(e).email_address=_),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).email_address]])])):R("",!0),b(L)?(w(),k("div",oo,[so,H(o("input",{"onUpdate:modelValue":m[9]||(m[9]=_=>b(e).phone_number=_),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(e).phone_number]])])):R("",!0)]),o("div",no,[o("div",lo,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",onClick:m[10]||(m[10]=_=>v.$router.back())}," Cancel "),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:l.value},[l.value?(w(),k("span",uo,"Updating...")):(w(),k("span",ho,"Update Student"))],8,co)])]),po,o("div",fo,[o("div",{class:ut(["bg-gray-50 rounded-lg p-6 border-2 border-dashed mb-6 transition-all",b(z)?"border-gray-300 opacity-50":"border-blue-200 hover:border-blue-300"])},[mo,o("div",go,[o("div",null,[vo,H(o("input",{"onUpdate:modelValue":m[11]||(m[11]=_=>b(S).guardian_name=_),type:"text",placeholder:"Enter guardian name",disabled:b(z),class:ut(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,bo),[[X,b(S).guardian_name]])]),o("div",null,[_o,H(o("input",{"onUpdate:modelValue":m[12]||(m[12]=_=>b(S).phone_number=_),type:"tel",placeholder:"10-digit number",disabled:b(z),class:ut(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,yo),[[X,b(S).phone_number]])]),o("div",null,[xo,H(o("select",{"onUpdate:modelValue":m[13]||(m[13]=_=>b(S).relation=_),disabled:b(z),class:ut(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},Mo,10,wo),[[he,b(S).relation]])])]),o("div",Eo,[o("div",null,[b(z)?(w(),k("p",No," \u274C Maximum of 3 guardians reached ")):(w(),k("p",So," Guardians added: "+W(D.value.length)+"/3 ",1))]),o("button",{type:"button",onClick:lt,disabled:b(z)||N.value,class:ut(["px-4 py-2 rounded-md flex items-center space-x-2 transition-colors",b(z)||N.value?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[N.value?(w(),k("span",To,"Adding...")):(w(),k("span",Ro,"Add Guardian"))],10,Oo)])],2)]),o("div",Ao,[o("div",Bo,[Io,b(tt).loading?(w(),k("div",Lo,Po)):D.value.length===0?(w(),k("div",Uo,Yo)):(w(),k("div",Wo,[(w(!0),k(Ke,null,Ze(D.value,_=>(w(),k("div",{key:_.guardian,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[o("div",Vo,[o("div",Xo,[Go,o("div",Fo,[o("div",qo,[o("h5",Ko,W(_.guardian_name),1),o("span",Zo,W(_.relation),1)]),C.value!==_.guardian?(w(),k("div",Jo,[o("div",Qo,[o("span",ts,[es,o("span",null,W(_.mobile_number||"No phone"),1)]),as,o("span",is,[rs,o("span",null,W(_.email||"No email"),1)])]),_.occupation||_.designation?(w(),k("div",os,[_.occupation?(w(),k("span",ss,"\u{1F4BC} "+W(_.occupation),1)):R("",!0),_.designation?(w(),k("span",ns,"\u2022")):R("",!0),_.designation?(w(),k("span",ls,"\u{1F3AF} "+W(_.designation),1)):R("",!0)])):R("",!0),_.education?(w(),k("div",ds," \u{1F393} "+W(_.education),1)):R("",!0)])):R("",!0),C.value===_.guardian?(w(),k("div",cs,[o("div",us,[o("div",null,[hs,H(o("input",{"onUpdate:modelValue":m[14]||(m[14]=A=>b(y).guardian_name=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).guardian_name]])]),o("div",null,[ps,H(o("input",{"onUpdate:modelValue":m[15]||(m[15]=A=>b(y).mobile_number=A),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).mobile_number]])]),o("div",null,[fs,H(o("select",{"onUpdate:modelValue":m[16]||(m[16]=A=>b(y).relation=A),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},bs,512),[[he,b(y).relation]])]),o("div",null,[_s,H(o("input",{"onUpdate:modelValue":m[17]||(m[17]=A=>b(y).date_of_birth=A),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).date_of_birth]])]),o("div",null,[ys,H(o("input",{"onUpdate:modelValue":m[18]||(m[18]=A=>b(y).email=A),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).email]])]),o("div",null,[xs,H(o("input",{"onUpdate:modelValue":m[19]||(m[19]=A=>b(y).occupation=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).occupation]])]),o("div",null,[ws,H(o("input",{"onUpdate:modelValue":m[20]||(m[20]=A=>b(y).designation=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).designation]])]),o("div",ks,[Ds,H(o("textarea",{"onUpdate:modelValue":m[21]||(m[21]=A=>b(y).work_address=A),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).work_address]])]),o("div",null,[Cs,H(o("input",{"onUpdate:modelValue":m[22]||(m[22]=A=>b(y).education=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).education]])])]),o("div",Ms,[o("button",{type:"button",onClick:A=>Pt(_.guardian),disabled:T.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},[T.value?(w(),k("svg",Ns,Os)):R("",!0),o("span",null,W(T.value?"Updating...":"Update Guardian"),1)],8,Es),o("button",{type:"button",onClick:mt,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])):R("",!0)])]),C.value!==_.guardian?(w(),k("button",{key:0,type:"button",onClick:A=>dt(_),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit guardian details"},As,8,Ts)):R("",!0)])]))),128))]))])]),o("div",Bs,[b(L)?(w(),k("span",Is," \u2713 You have full editing permissions ")):(w(),k("span",Ls," \u26A0 You can only edit guardian information "))])],40,Mr)]))]))}};var Us=ne(zs,[["__scopeId","data-v-318434fd"]]);export{Us as default};
