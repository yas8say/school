var T=(e,s,t)=>new Promise((n,o)=>{var r=l=>{try{u(t.next(l))}catch(g){o(g)}},i=l=>{try{u(t.throw(l))}catch(g){o(g)}},u=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);u((t=t.apply(e,s)).next())});import{c as J,a as K,_ as $,r as v,o as q,b as Q,d as p,e as m,f as c,n as X,t as R,F as G,g as y,p as V,h as U,i as w,w as Z,u as k,j as F,k as ee,l as te,m as oe,q as ne,s as re,v as se,x as ae,B as ce,y as ie}from"./vendor.1f5cccb6.js";const le=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}};le();const ue="modulepreload",N={},de="/assets/school/alummah/",f=function(s,t){return!t||t.length===0?s():Promise.all(t.map(n=>{if(n=`${de}${n}`,n in N)return;N[n]=!0;const o=n.endsWith(".css"),r=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${r}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":ue,o||(i.as="script",i.crossOrigin=""),i.href=n,document.head.appendChild(i),o)return new Promise((u,l)=>{i.addEventListener("load",u),i.addEventListener("error",l)})})).then(()=>s())},he=[{path:"/edit-student",name:"EditStudent",component:()=>f(()=>import("./EditStudent.9d5b8f97.js"),["assets/EditStudent.9d5b8f97.js","assets/EditStudent.9b3487b1.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"])},{path:"/attendance-record",name:"AttendanceRecord",component:()=>f(()=>import("./AttendanceRecord.1eacaf3d.js").then(function(e){return e.c}),["assets/AttendanceRecord.1eacaf3d.js","assets/AttendanceRecord.18877177.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css","assets/XMarkIcon.ffec483e.js"])},{path:"/",name:"Home",redirect:{name:"Login"}},{name:"Login",path:"/account/login",component:()=>f(()=>import("./Login.38545eb9.js"),["assets/Login.38545eb9.js","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css","assets/session.60eb9438.js"]),meta:{requiresAuth:!1}},{name:"Teacherhome",path:"/teacher-home",component:()=>f(()=>import("./TeacherHome.b702b0de.js"),["assets/TeacherHome.b702b0de.js","assets/TeacherHome.614f4dba.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css","assets/session.60eb9438.js","assets/AttendanceRecord.1eacaf3d.js","assets/AttendanceRecord.18877177.css","assets/XMarkIcon.ffec483e.js","assets/InboxIcon.0cab84ff.js"]),meta:{requiresAuth:!0,requiredRole:"instructor"}},{name:"Parenthome",path:"/parent-home",component:()=>f(()=>import("./ParentHome.0ffa7431.js"),["assets/ParentHome.0ffa7431.js","assets/ParentHome.185fa05d.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css","assets/session.60eb9438.js","assets/XMarkIcon.ffec483e.js","assets/InboxIcon.0cab84ff.js"]),meta:{requiresAuth:!0,requiredRole:"guardian"}},{name:"ForgotPassword",path:"/forgot-password",component:()=>f(()=>import("./ForgotPassword.5985b067.js"),["assets/ForgotPassword.5985b067.js","assets/ForgotPassword.407b63ac.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"OTPLogin",path:"/otp-login",component:()=>f(()=>import("./OTPLogin.d64bc935.js"),["assets/OTPLogin.d64bc935.js","assets/OTPLogin.14ebff1b.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"SignInScreen",path:"/google-signin",component:()=>f(()=>import("./SignInScreen.43d791ff.js"),["assets/SignInScreen.43d791ff.js","assets/SignInScreen.8683290f.css","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"TeacherSignup",path:"/teacher/signup",component:()=>f(()=>import("./TeacherSignup.55126139.js"),["assets/TeacherSignup.55126139.js","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}},{name:"ParentSignup",path:"/parent/signup",component:()=>f(()=>import("./ParentSignup.4109beb4.js"),["assets/ParentSignup.4109beb4.js","assets/vendor.1f5cccb6.js","assets/vendor.1f7d581e.css"]),meta:{requiresAuth:!1}}],I=J({history:K("/alummah"),routes:he});function pe(){const s=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return s&&s!=="Guest"&&s!=="undefined"}function A(){try{const e=localStorage.getItem("userRoles");return e?JSON.parse(e):[]}catch(e){return[]}}function b(e){return A().includes(e)}function M(){return A(),b("Instructor")||b("Guardian")}function B(){const e=localStorage.getItem("logout_clicked_timestamp");return e?Date.now()-parseInt(e)<5e3:!1}function me(){const e=localStorage.getItem("logout_clicked_timestamp");if(!e)return;Date.now()-parseInt(e)>5e3&&localStorage.removeItem("logout_clicked_timestamp")}function j(e,s,t){e==="role"&&B()||window.dispatchEvent(new CustomEvent("show-api-message-popup",{detail:{type:e||"info",title:s||"Information",message:t}}))}function P(){const e=localStorage.getItem("selectedLoginRole");return A(),e==="teacher"&&b("Instructor")?{name:"Teacherhome"}:e==="parent"&&b("Guardian")?{name:"Parenthome"}:b("Instructor")?(localStorage.setItem("selectedLoginRole","teacher"),{name:"Teacherhome"}):b("Guardian")?(localStorage.setItem("selectedLoginRole","parent"),{name:"Parenthome"}):(B()||j("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),{name:"Login"})}window.addEventListener("login-success",()=>{const e=P();I.replace(e)});window.addEventListener("otp-verification-success",()=>{const e=P();I.replace(e)});window.addEventListener("google-auth-success",()=>{const e=P();I.replace(e)});I.beforeEach((e,s,t)=>T(void 0,null,function*(){me();const n=pe(),o=["ForgotPassword","OTPLogin","SignInScreen","TeacherSignup","ParentSignup"],r="Login";if(o.includes(e.name)){t();return}if(e.name===r){if(n)if(M()){const u=P();t(u)}else B()||j("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),t();else t();return}if(!n){t({name:"Login"});return}const i=localStorage.getItem("selectedLoginRole");if(A(),!M()){B()||j("role","Access Restricted","Your account does not have the required permissions (Instructor or Guardian role) to access this application."),t({name:"Login"});return}if(e.meta.requiredRole){const u=e.meta.requiredRole;if(u==="instructor"&&i==="teacher"&&b("Instructor"))t();else if(u==="guardian"&&i==="parent"&&b("Guardian"))t();else{const l=P();t(l)}return}t()}));const x=e=>(V("data-v-542e69f0"),e=e(),U(),e),ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},_e={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},fe={class:"text-center"},ve={key:0,class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},we=x(()=>c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)),be=[we],ke={key:1,class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Re=x(()=>c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)),ye=[Re],Le={key:2,class:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Se=x(()=>c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)),Ie=[Se],Pe={class:"text-lg font-semibold text-gray-800 mb-2"},xe={class:"text-gray-600 mb-4"},Ee={class:"flex space-x-3"},Te=["disabled"],Ae={key:0},Be=x(()=>c("div",{class:"spinner-small"},null,-1)),Oe=[Be],Ce=["disabled"],je={key:0},De=x(()=>c("div",{class:"spinner-small"},null,-1)),$e=[De],qe={setup(e){const s=v(!1),t=v(!1),n=v("csrf"),o=v(""),r=v("");function i(){const d=window.location.origin;try{const h=new URL(d);return`${h.protocol}//${h.hostname}`}catch(h){return d.replace(/:\d+$/,"")}}const u=d=>{const{type:h,title:C,message:S}=d.detail||{};n.value=h||"csrf",o.value=C||"Session Conflict",r.value=S||"It seems you're already logged in. Please logout from other session to continue.",s.value=!0},l=()=>{s.value=!1,g()},g=()=>{n.value="csrf",o.value="",r.value=""},L=()=>T(this,null,function*(){localStorage.setItem("logout_clicked_timestamp",Date.now().toString()),t.value=!0;try{const d=i(),h=`${d}/alummah/account/login`;console.log("Logout redirect:",{originalOrigin:window.location.origin,cleanOrigin:d,vueLoginUrl:h}),window.location.href=`/logout?redirect-to=${encodeURIComponent(h)}`}catch(d){console.error("Logout failed:",d);const h=i();window.location.href=`${h}/alummah/account/login`}finally{t.value=!1,s.value=!1}});return q(()=>{window.addEventListener("show-api-message-popup",u)}),Q(()=>{window.removeEventListener("show-api-message-popup",u)}),(d,h)=>s.value?(p(),m("div",ge,[c("div",_e,[c("div",fe,[c("div",{class:X(["mx-auto flex items-center justify-center h-12 w-12 rounded-full mb-4",n.value==="csrf"?"bg-red-100":n.value==="role"?"bg-yellow-100":"bg-blue-100"])},[n.value==="csrf"?(p(),m("svg",ve,be)):n.value==="role"?(p(),m("svg",ke,ye)):(p(),m("svg",Le,Ie))],2),c("h3",Pe,R(o.value),1),c("p",xe,R(r.value),1),c("div",Ee,[n.value==="info"?(p(),m("button",{key:0,onClick:l,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," OK ")):n.value==="role"?(p(),m(G,{key:1},[c("button",{onClick:l,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),c("button",{onClick:L,class:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2",disabled:t.value},[t.value?(p(),m("span",Ae,Oe)):y("",!0),c("span",null,R(t.value?"Logging out...":"Logout"),1)],8,Te)],64)):(p(),m(G,{key:2},[c("button",{onClick:l,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),c("button",{onClick:L,class:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center justify-center space-x-2",disabled:t.value},[t.value?(p(),m("span",je,$e)):y("",!0),c("span",null,R(t.value?"Logging out...":"Logout"),1)],8,Ce)],64))])])])])):y("",!0)}};var Ge=$(qe,[["__scopeId","data-v-542e69f0"]]);const z=e=>(V("data-v-dc0f4410"),e=e(),U(),e),Ve={id:"app"},Ue={key:0,class:"global-nav-buttons"},Fe=["title"],Ne=z(()=>c("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),Me={class:"btn-text"},ze=["title"],He=z(()=>c("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)),We={class:"btn-text"},Ye={setup(e){const s=ee(),t=te(),n=v(localStorage.getItem("selectedLoginRole")||""),o=v(S()),r=v(""),i=w(()=>o.value),u=w(()=>i.value.includes("Instructor")&&i.value.includes("Guardian")),l=w(()=>n.value==="teacher"?"Parent":"Teacher"),g=w(()=>{const a=["Login","ForgotPassword","OTPLogin","SignInScreen","TeacherSignup","ParentSignup"],_=r.value||t.name;return!a.includes(_)&&H()}),L=w(()=>{const a=["EditStudent","AttendanceRecord"],_=r.value||t.name,E=g.value&&a.includes(_);return console.log("\u{1F519} Back Button Check:",{currentRoute:_,showGlobalButtons:g.value,isBackRoute:a.includes(_),shouldShowBack:E}),E}),d=w(()=>{const a=r.value||t.name;return g.value&&u.value&&["Teacherhome","Parenthome"].includes(a)}),h=w(()=>{const a=r.value||t.name;return a==="EditStudent"?"Back to Attendance":a==="AttendanceRecord"?"Back to Dashboard":"Back"}),C=w(()=>{const a=r.value||t.name;return a==="EditStudent"?"Return to Attendance Record":a==="AttendanceRecord"?"Return to Teacher Dashboard":"Go back to previous page"});function S(){try{const a=localStorage.getItem("userRoles");return a?JSON.parse(a):[]}catch(a){return[]}}function H(){const _=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return _&&_!=="Guest"&&_!=="undefined"}const W=()=>{const a=r.value||t.name;console.log("Back button clicked from route:",a),a==="EditStudent"?s.push({name:"AttendanceRecord"}):a==="AttendanceRecord"?s.push({name:"Teacherhome"}):window.history.length>1&&s.go(-1)},Y=()=>T(this,null,function*(){const a=n.value==="teacher"?"parent":"teacher";localStorage.setItem("selectedLoginRole",a),n.value=a,D.value++,yield oe(),a==="teacher"?s.push({name:"Teacherhome"}):s.push({name:"Parenthome"})});Z(()=>t.name,a=>{console.log("\u{1F504} Route changed to:",a),r.value=a,n.value=localStorage.getItem("selectedLoginRole")||"",o.value=S(),D.value++},{immediate:!0});const D=v(0);return q(()=>{n.value=localStorage.getItem("selectedLoginRole")||"",o.value=S(),r.value=t.name,console.log("\u{1F3AF} Global navigation initialized",{currentRoute:r.value,currentRole:n.value,showBackButton:L.value,showSwitchButton:d.value})}),(a,_)=>{const E=ne("router-view");return p(),m("div",Ve,[k(g)?(p(),m("div",Ue,[k(L)?(p(),m("button",{key:0,onClick:W,class:"global-nav-btn global-back-btn",title:k(C)},[Ne,c("span",Me,R(k(h)),1)],8,Fe)):y("",!0),k(d)?(p(),m("button",{key:1,onClick:Y,class:"global-nav-btn global-switch-btn",title:`Switch to ${k(l)} dashboard`},[He,c("span",We,"Switch to "+R(k(l)),1)],8,ze)):y("",!0)])):y("",!0),F(E),F(Ge)])}}};var Je=$(Ye,[["__scopeId","data-v-dc0f4410"]]);let O=re(Je);se("resourceFetcher",ie);O.use(I);O.use(ae);O.component("Button",ce);O.mount("#app");export{f as _,I as r};
