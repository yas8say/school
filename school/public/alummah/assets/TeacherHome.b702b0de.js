var H=(C,m,p)=>new Promise((_,c)=>{var y=$=>{try{j(p.next($))}catch(u){c(u)}},M=$=>{try{j(p.throw($))}catch(u){c(u)}},j=$=>$.done?_($.value):Promise.resolve($.value).then(y,M);j((p=p.apply(C,m)).next())});import{d as o,e as l,f as e,_ as ce,k as fe,r as S,i as U,w as de,I as J,o as re,t as n,g as A,u as a,n as D,J as Y,j as P,K as q,F as te,E as ae,p as ue,h as _e,C as me,D as be,M as ne,H as he,b as Te,G as De,Q as Le}from"./vendor.1f5cccb6.js";import{session as ye}from"./session.60eb9438.js";import{r as Ie,a as Be,b as ze,A as Fe}from"./AttendanceRecord.1eacaf3d.js";import{a as ie,b as we,r as ke}from"./XMarkIcon.ffec483e.js";import{r as $e,a as Ve,b as Re,c as ge,d as Ge,e as Oe,f as He,g as Ue}from"./InboxIcon.0cab84ff.js";import"./index.fb2b3e70.js";function Je(C,m){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function ve(C,m){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function qe(C,m){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})])}function Se(C,m){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const L=C=>(ue("data-v-51db23b1"),C=C(),_e(),C),We={class:"min-h-screen bg-gray-50 p-4"},Ye={class:"mb-6"},Ke={class:"flex justify-between items-start"},Qe={class:"text-2xl font-bold text-gray-800"},Xe={class:"text-gray-600"},Ze={key:0,class:"text-sm text-gray-500 mt-1"},et={class:"text-sm text-gray-500"},tt={class:"flex flex-col items-end space-y-2"},st={class:"bg-white rounded-lg border border-gray-300 p-1 flex"},ot={key:0,class:"text-sm bg-green-50 px-3 py-2 rounded-lg border border-green-200 max-w-xs"},nt=L(()=>e("div",{class:"font-semibold text-green-800 mb-1"},"Promotion Details:",-1)),lt={class:"text-green-700"},rt=q("From: "),at={class:"font-medium"},it=q("To: "),ct={class:"font-medium"},dt=q("Program: "),ut={class:"font-medium"},_t=q("Academic Year: "),mt={class:"font-medium"},ht={key:1,class:"text-sm bg-red-50 px-3 py-2 rounded-lg border border-red-200 max-w-xs"},gt=L(()=>e("div",{class:"font-semibold text-red-800 mb-1"},"Cannot Promote:",-1)),vt={class:"text-red-700"},pt={class:"flex items-start"},xt={class:"flex-shrink-0"},ft={class:"ml-3 flex-1"},bt={class:"text-sm font-medium"},yt={class:"text-sm mt-1"},wt={key:1,class:"flex justify-center items-center py-8"},kt=L(()=>e("div",{class:"spinner"},null,-1)),$t=L(()=>e("span",{class:"ml-2 text-gray-600"},"Loading students...",-1)),St=[kt,$t],Ct={key:2,class:"space-y-3"},jt={class:"flex justify-between items-center mb-4"},At={key:0,class:"text-sm text-gray-600"},Mt={key:1,class:"text-sm text-gray-600"},Nt={key:0,class:"ml-2 text-green-600 font-semibold"},Et=["disabled"],Pt={key:0},Tt={key:1},Dt={class:"flex items-center space-x-4"},Lt={class:"flex-shrink-0"},It=["src"],Bt={key:1,class:"text-white text-sm font-medium opacity-70"},zt={class:"flex-1 min-w-0"},Ft={class:"font-medium text-gray-500 truncate"},Vt={class:"flex items-center space-x-4 text-sm text-gray-500"},Rt=L(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),Gt={class:"truncate"},Ot={class:"flex items-center space-x-2 mt-1"},Ht={class:"flex-shrink-0"},Ut=["onClick"],Jt={class:"flex items-center space-x-4"},qt={class:"flex-shrink-0"},Wt=["src"],Yt={key:1,class:"text-white text-sm font-medium"},Kt={class:"flex-1 min-w-0"},Qt={class:"font-medium text-gray-800 truncate"},Xt={class:"flex items-center space-x-4 text-sm text-gray-600"},Zt=L(()=>e("span",{class:"text-gray-400"},"\u2022",-1)),es={class:"truncate"},ts={key:0,class:"mt-1"},ss={class:"text-xs text-gray-500"},os={key:0,class:"ml-2 text-xs text-green-600 font-semibold"},ns={class:"flex-shrink-0"},ls={key:3,class:"text-center py-8"},rs=L(()=>e("p",{class:"text-gray-600"},"No students available for this class",-1)),as={key:4,class:"flex space-x-4 mt-6"},is=L(()=>e("span",null,"Cancel",-1)),cs=["disabled"],ds={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},us={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},_s={class:"text-lg font-semibold text-gray-800 mb-4"},ms={class:"space-y-2 mb-4"},hs={class:"flex justify-between"},gs=L(()=>e("span",{class:"text-gray-600"},"To Mark Present:",-1)),vs={class:"font-semibold"},ps={class:"flex justify-between"},xs=L(()=>e("span",{class:"text-gray-600"},"To Mark Absent:",-1)),fs={class:"font-semibold"},bs={class:"flex justify-between"},ys=L(()=>e("span",{class:"text-gray-600"},"Already Marked:",-1)),ws={class:"font-semibold"},ks=L(()=>e("div",{class:"text-sm text-gray-500 bg-blue-50 p-3 rounded mb-4"},' Note: Students already marked as "Present" or "On Leave" will not be included in this attendance submission. ',-1)),$s={class:"space-y-3 mb-4"},Ss={class:"flex justify-between"},Cs=L(()=>e("span",{class:"text-gray-600"},"Students to Promote:",-1)),js={class:"font-semibold text-green-600"},As={class:"flex justify-between"},Ms=L(()=>e("span",{class:"text-gray-600"},"Not Promoting:",-1)),Ns={class:"font-semibold"},Es={class:"border-t pt-3"},Ps=L(()=>e("div",{class:"text-sm text-gray-600 mb-2"},"Promotion Details:",-1)),Ts={class:"grid grid-cols-2 gap-2 text-sm"},Ds=L(()=>e("div",{class:"text-gray-500"},"From:",-1)),Ls={class:"font-medium"},Is=L(()=>e("div",{class:"text-gray-500"},"To:",-1)),Bs={class:"font-medium text-green-600"},zs=L(()=>e("div",{class:"text-gray-500"},"Program:",-1)),Fs={class:"font-medium"},Vs=L(()=>e("div",{class:"text-gray-500"},"Academic Year:",-1)),Rs={class:"font-medium"},Gs={key:0,class:"text-sm bg-yellow-50 p-3 rounded mb-4 border border-yellow-200"},Os={class:"flex items-start"},Hs=L(()=>e("p",{class:"font-medium text-yellow-800"},"Target Group Not Found",-1)),Us={class:"text-yellow-700 mt-1"},Js=q(" The student group "),qs={class:"font-semibold"},Ws=q(" does not exist in the system yet. Please contact administrator. "),Ys={class:"flex space-x-3"},Ks=["disabled"],Qs={key:6,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Xs={class:"bg-white rounded-lg p-6 max-w-sm w-full mx-4"},Zs={class:"text-center"},eo={class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},to=L(()=>e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Permission Denied",-1)),so=L(()=>e("p",{class:"text-gray-600 mb-4"}," You are not allowed to promote students. Please contact your administrator to enable this feature. ",-1)),oo={props:{selectedGroup:String},emits:["back-to-dashboard"],setup(C){const m=C,p=fe(),_=S([]),c=S([]),y=S([]),M=S(!0),j=S(!1),$=S(!1),u=S(!1),g=S("attendance"),h=S({success:!1,allowed:!1,message:"",current_group:"",next_group:"",next_academic_year:"",next_program:"",group_exists:!1}),T=S({show:!1,type:"success",title:"",message:""}),B=t=>{if(!t)return"N/A";const f=t.match(/\(([^)]+)\)/);return f?f[1]:"N/A"},k=U(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),z=U(()=>_.value.filter(t=>t.present===1||t.on_leave===1)),N=U(()=>_.value.filter(t=>t.present===0&&t.on_leave===0)),E=U(()=>z.value.length),W=U(()=>N.value.length===0),Q=U(()=>g.value==="attendance"?N.value.length>0:y.value.length>0&&h.value.success&&h.value.allowed&&h.value.group_exists),se=U(()=>u.value?g.value==="attendance"?"Submitting...":"Promoting...":g.value==="attendance"?"Submit":"Promote Students"),X=t=>t?t.startsWith("http")||t.startsWith("//")?t:t.startsWith("/")?window.location.origin+t:`${window.location.origin}/${t.replace(/^\//,"")}`:null,oe=t=>t?t.split(" ").map(f=>f.charAt(0)).join("").toUpperCase().substring(0,2):"?",Z=t=>{t.target.style.display="none"},ee=t=>g.value==="attendance"?c.value.includes(t.student)?"border-green-500 bg-green-50":"border-gray-200":y.value.includes(t.student)?"border-green-500 bg-green-50":"border-gray-200",w=t=>g.value==="attendance"?c.value.includes(t.student)?"bg-green-500 border-green-500":"border-gray-300":y.value.includes(t.student)?"bg-green-500 border-green-500":"border-gray-300",d=t=>g.value==="attendance"?c.value.includes(t.student):y.value.includes(t.student),x=(t,f,i)=>{T.value={show:!0,type:t,title:f,message:i},setTimeout(()=>{T.value.show=!1},5e3)};de(()=>m.selectedGroup,t=>{t&&g.value==="promotion"&&pe(t)});const G=t=>H(this,null,function*(){if(t==="promotion"){const f=m.selectedGroup||localStorage.getItem("selected_student_group");if(!f){x("error","Selection Required","Please select a class first.");return}if(yield pe(f),!h.value.allowed){$.value=!0;return}g.value=t,y.value=[]}else g.value=t}),le=J({url:"school.al_ummah.api2.get_student_attendance_records",onSuccess(t){return console.log("Attendance data loaded:",t),t},onError(t){console.error("Error fetching attendance:",t),x("error","Load Failed","Failed to load student data. Please check your connection and try again.")}}),s=J({url:"school.al_ummah.api2.mark_attendance",onSuccess(t){console.log("Attendance marked successfully:",t),u.value=!1,O(t,"Attendance marked successfully!")},onError(t){console.error("Error marking attendance:",t),u.value=!1,V(t,"attendance")}}),v=J({url:"school.al_ummah.api6.promote_students",onSuccess(t){console.log("Students promoted successfully:",t),u.value=!1,t.success===!1?V({message:t.message},"promotion"):O(t,"Students promoted successfully!")},onError(t){console.error("Error promoting students:",t),u.value=!1,V(t,"promotion")}}),r=J({url:"school.al_ummah.api3.fetch_student_group",onSuccess(t){return console.log("Student group info loaded:",t),h.value=t,t},onError(t){console.error("Error fetching student group info:",t),h.value={success:!1,allowed:!1,message:"Failed to load promotion information"}}}),O=(t,f)=>{var i;if(console.log("Success response data:",t),t.success===!0||t.status==="success"||((i=t.message)==null?void 0:i.includes("successfully"))){const R=t.message||f;x("success","Success!",R),setTimeout(()=>{p.push({name:"Teacherhome"})},2e3)}else if(t._server_messages){try{const R=JSON.parse(t._server_messages);if(R.length>0){const F=JSON.parse(R[0]);if(F.message){x("success","Success!",F.message),setTimeout(()=>{p.push({name:"Teacherhome"})},2e3);return}}}catch(R){console.error("Error parsing server messages:",R)}x("success","Success!",f),setTimeout(()=>{p.push({name:"Teacherhome"})},2e3)}else x("success","Success!",f),setTimeout(()=>{p.push({name:"Teacherhome"})},2e3)},V=(t,f)=>{console.error("Error response:",t),t.exc_type==="PermissionError"?x("error","Permission Denied",`You do not have permission to ${f==="attendance"?"mark attendance":"promote students"}. Please contact your administrator.`):t.messages&&t.messages.length>0?x("error","Operation Failed",t.messages[0]):t.message?x("error","Operation Failed",t.message):x("error","Operation Failed",`Failed to ${f==="attendance"?"submit attendance":"promote students"}. Please check your connection and try again.`)},pe=t=>H(this,null,function*(){try{yield r.submit({current_group_name:t})}catch(f){console.error("Error fetching student group info:",f)}}),xe=()=>H(this,null,function*(){M.value=!0;try{const t=m.selectedGroup||localStorage.getItem("selected_student_group");if(!t){x("error","Selection Required","Please select a class first."),M.value=!1;return}const f={based_on:"Batch",student_group:t},i=yield le.fetch(f);if(!i||i.length===0){x("error","No Students","No students found for this class."),_.value=[];return}_.value=i,c.value=N.value.map(R=>R.student),console.log("Loaded students:",{total:_.value.length,alreadyMarked:z.value.length,available:N.value.length})}catch(t){console.error("Error fetching attendance:",t),x("error","Load Failed","Failed to load student data.")}finally{M.value=!1}}),Ce=()=>{if(g.value==="attendance"){if(W.value)return;c.value.length===N.value.length?c.value=[]:c.value=N.value.map(t=>t.student)}else y.value.length===_.value.length?y.value=[]:y.value=_.value.map(t=>t.student)},je=t=>{if(g.value==="attendance"){const f=_.value.find(R=>R.student===t);if(f&&(f.present===1||f.on_leave===1))return;const i=c.value.indexOf(t);i>-1?c.value.splice(i,1):c.value.push(t)}else{const f=y.value.indexOf(t);f>-1?y.value.splice(f,1):y.value.push(t)}},Ae=()=>{if(g.value==="promotion"){if(!h.value.allowed){$.value=!0;return}if(!h.value.success){x("error","Cannot Promote",h.value.message||"Unknown error");return}if(y.value.length===0){x("error","Selection Required","Please select at least one student to promote.");return}}if(g.value==="attendance"&&c.value.length===0){x("error","Selection Required","Please select at least one student as present.");return}j.value=!0},Me=()=>H(this,null,function*(){j.value=!1,u.value=!0,g.value==="attendance"?yield Ne():yield Ee()}),Ne=()=>H(this,null,function*(){const t=N.value.filter(F=>c.value.includes(F.student)).map(F=>({student:F.student,student_name:F.student_name,group_roll_number:F.group_roll_number,disabled:!1,checked:!0})),f=N.value.filter(F=>!c.value.includes(F.student)).map(F=>({student:F.student,student_name:F.student_name,group_roll_number:F.group_roll_number,disabled:!1,checked:!1})),i=new Date().toISOString().split("T")[0],R=m.selectedGroup||localStorage.getItem("selected_student_group");try{yield s.submit({students_present:JSON.stringify(t),students_absent:JSON.stringify(f),student_group:R,date:i})}catch(F){console.error("Error submitting attendance:",F),u.value=!1}}),Ee=()=>H(this,null,function*(){const t=_.value.filter(i=>y.value.includes(i.student)).map(i=>({student:i.student,student_name:i.student_name,current_academic_year:i.academic_year,group_roll_number:i.group_roll_number,current_group:m.selectedGroup,next_group:h.value.next_group}));console.log("Students to promote:",t),console.log("Promotion details:",{student_group:m.selectedGroup,next_academic_year:h.value.next_academic_year,next_student_group:h.value.next_group,next_program:h.value.next_program});const f=m.selectedGroup||localStorage.getItem("selected_student_group");try{yield v.submit({students:JSON.stringify(t),student_group:f,next_academic_year:h.value.next_academic_year,next_student_group:h.value.next_group,next_program:h.value.next_program})}catch(i){console.error("Error promoting students:",i),u.value=!1}}),Pe=()=>{p.push({name:"Teacherhome"})};return re(()=>{xe()}),(t,f)=>(o(),l("div",We,[e("div",Ye,[e("div",Ke,[e("div",null,[e("h1",Qe,n(g.value==="attendance"?"Take Attendance":"Promote Students"),1),e("p",Xe,n(g.value==="attendance"?"Select students who are present today":"Select students to promote to next academic year"),1),C.selectedGroup?(o(),l("p",Ze,"Current Class: "+n(C.selectedGroup),1)):A("",!0),e("p",et,"Date: "+n(a(k)),1)]),e("div",tt,[e("div",st,[e("button",{onClick:f[0]||(f[0]=i=>G("attendance")),class:D(["px-3 py-1 text-sm font-medium rounded-md transition-colors",g.value==="attendance"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"])}," Take Attendance ",2),e("button",{onClick:f[1]||(f[1]=i=>G("promotion")),class:D(["px-3 py-1 text-sm font-medium rounded-md transition-colors",g.value==="promotion"?"bg-green-600 text-white":"text-gray-600 hover:text-gray-800"])}," Promote Students ",2)]),g.value==="promotion"&&h.value.success?(o(),l("div",ot,[nt,e("div",lt,[e("div",null,[rt,e("span",at,n(C.selectedGroup),1)]),e("div",null,[it,e("span",ct,n(h.value.next_group),1)]),e("div",null,[dt,e("span",ut,n(h.value.next_program),1)]),e("div",null,[_t,e("span",mt,n(h.value.next_academic_year),1)])])])):A("",!0),g.value==="promotion"&&!h.value.success&&h.value.message?(o(),l("div",ht,[gt,e("div",vt,n(h.value.message),1)])):A("",!0)])])]),T.value.show?(o(),l("div",{key:0,class:D(["fixed top-4 right-4 z-50 max-w-sm p-4 rounded-lg shadow-lg border-l-4 transition-all duration-300",T.value.type==="success"?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"])},[e("div",pt,[e("div",xt,[T.value.type==="success"?(o(),Y(a(Ie),{key:0,class:"w-5 h-5 text-green-500"})):(o(),Y(a(Be),{key:1,class:"w-5 h-5 text-red-500"}))]),e("div",ft,[e("p",bt,n(T.value.title),1),e("p",yt,n(T.value.message),1)]),e("button",{onClick:f[2]||(f[2]=i=>T.value.show=!1),class:"ml-4 flex-shrink-0 text-gray-400 hover:text-gray-600"},[P(a(ie),{class:"w-4 h-4"})])])],2)):A("",!0),M.value?(o(),l("div",wt,St)):_.value&&_.value.length>0?(o(),l("div",Ct,[e("div",jt,[g.value==="attendance"?(o(),l("p",At," Total: "+n(_.value.length)+" | To Mark Present: "+n(c.value.length)+" | To Mark Absent: "+n(a(N).length-c.value.length)+" | Already Marked: "+n(a(E)),1)):(o(),l("p",Mt,[q(" Total: "+n(_.value.length)+" | Selected for Promotion: "+n(y.value.length)+" | Not Selected: "+n(_.value.length-y.value.length)+" ",1),h.value.success?(o(),l("span",Nt," \u2192 To: "+n(h.value.next_group),1)):A("",!0)])),e("button",{onClick:Ce,class:"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300",disabled:g.value==="attendance"?a(W):!1},[g.value==="attendance"?(o(),l("span",Pt,n(c.value.length===a(N).length?"Mark All Absent":"Mark All Present"),1)):(o(),l("span",Tt,n(y.value.length===_.value.length?"Deselect All":"Select All"),1))],8,Et)]),g.value==="attendance"?(o(!0),l(te,{key:0},ae(a(z),i=>(o(),l("div",{key:i.student,class:"bg-gray-100 rounded-lg shadow-sm p-4 border-2 border-gray-300 cursor-not-allowed"},[e("div",Dt,[e("div",Lt,[e("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden",i.present===1?"bg-gradient-to-br from-green-400 to-green-500":"bg-gradient-to-br from-yellow-400 to-yellow-500"])},[i.img_url?(o(),l("img",{key:0,src:X(i.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover opacity-70",onError:Z,loading:"lazy"},null,40,It)):(o(),l("span",Bt,n(oe(i.student_name)),1))],2)]),e("div",zt,[e("h3",Ft,n(i.student_name),1),e("div",Vt,[e("span",null,"Roll No: "+n(i.group_roll_number),1),Rt,e("span",Gt,n(i.student),1)]),e("div",Ot,[i.present===1?(o(),Y(a(ve),{key:0,class:"w-4 h-4 text-green-500"})):A("",!0),i.on_leave===1?(o(),Y(a(ze),{key:1,class:"w-4 h-4 text-yellow-500"})):A("",!0),e("span",{class:D(["text-xs font-medium",i.present===1?"text-green-600":"text-yellow-600"])},n(i.present===1?"Already Marked Present":"On Leave"),3)])]),e("div",Ht,[e("div",{class:D(["w-6 h-6 rounded-full border-2 flex items-center justify-center",i.present===1?"bg-green-500 border-green-500":"bg-yellow-500 border-yellow-500"])},[i.present===1?(o(),Y(a(ve),{key:0,class:"w-4 h-4 text-white"})):A("",!0),i.on_leave===1?(o(),Y(a(qe),{key:1,class:"w-4 h-4 text-white"})):A("",!0)],2)])])]))),128)):A("",!0),(o(!0),l(te,null,ae(g.value==="attendance"?a(N):_.value,i=>(o(),l("div",{key:i.student,class:D(["bg-white rounded-lg shadow-sm p-4 border-2 transition-colors cursor-pointer hover:border-blue-300",ee(i)]),onClick:R=>je(i.student)},[e("div",Jt,[e("div",qt,[e("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm relative overflow-hidden",g.value==="attendance"?"bg-gradient-to-br from-blue-500 to-purple-600":"bg-gradient-to-br from-green-500 to-green-600"])},[i.img_url?(o(),l("img",{key:0,src:X(i.img_url),alt:"Student",class:"absolute inset-0 w-full h-full object-cover",onError:Z,loading:"lazy"},null,40,Wt)):(o(),l("span",Yt,n(oe(i.student_name)),1))],2)]),e("div",Kt,[e("h3",Qt,n(i.student_name),1),e("div",Xt,[e("span",null,"Roll No: "+n(i.group_roll_number),1),Zt,e("span",es,n(i.student),1)]),g.value==="promotion"?(o(),l("div",ts,[e("span",ss," Current Year: "+n(B(C.selectedGroup)),1),h.value.success&&d(i)?(o(),l("span",os," \u2192 "+n(h.value.next_group)+" ("+n(h.value.next_program)+") ",1)):A("",!0)])):A("",!0)]),e("div",ns,[e("div",{class:D(["w-6 h-6 rounded-full border-2 flex items-center justify-center",w(i)])},[d(i)?(o(),Y(a(ve),{key:0,class:"w-4 h-4 text-white"})):A("",!0)],2)])])],10,Ut))),128))])):(o(),l("div",ls,[rs,e("button",{onClick:xe,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Try Again ")])),_.value.length>0?(o(),l("div",as,[e("button",{onClick:Pe,class:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center space-x-2"},[P(a(ie),{class:"w-5 h-5"}),is]),e("button",{onClick:Ae,disabled:u.value||!a(Q),class:D(["flex-1 px-4 py-3 text-white rounded-lg font-medium transition-colors flex items-center justify-center space-x-2",u.value||!a(Q)?"bg-gray-400 cursor-not-allowed":g.value==="attendance"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"])},[P(a(Je),{class:"w-5 h-5"}),e("span",null,n(a(se)),1)],10,cs)])):A("",!0),j.value?(o(),l("div",ds,[e("div",us,[e("h3",_s,n(g.value==="attendance"?"Confirm Attendance":"Confirm Promotion"),1),g.value==="attendance"?(o(),l(te,{key:0},[e("div",ms,[e("div",hs,[gs,e("span",vs,n(c.value.length),1)]),e("div",ps,[xs,e("span",fs,n(a(N).length-c.value.length),1)]),e("div",bs,[ys,e("span",ws,n(a(E)),1)])]),ks],64)):(o(),l(te,{key:1},[e("div",$s,[e("div",Ss,[Cs,e("span",js,n(y.value.length),1)]),e("div",As,[Ms,e("span",Ns,n(_.value.length-y.value.length),1)]),e("div",Es,[Ps,e("div",Ts,[Ds,e("div",Ls,n(C.selectedGroup),1),Is,e("div",Bs,n(h.value.next_group),1),zs,e("div",Fs,n(h.value.next_program),1),Vs,e("div",Rs,n(h.value.next_academic_year),1)])])]),h.value.group_exists?A("",!0):(o(),l("div",Gs,[e("div",Os,[P(a($e),{class:"w-5 h-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),e("div",null,[Hs,e("p",Us,[Js,e("span",qs,n(h.value.next_group),1),Ws])])])]))],64)),e("div",Ys,[e("button",{onClick:f[3]||(f[3]=i=>j.value=!1),class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:Me,class:D(["flex-1 px-4 py-2 text-white rounded-lg font-medium transition-colors",g.value==="attendance"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"]),disabled:g.value==="promotion"&&!h.value.group_exists},n(g.value==="attendance"?"Confirm Attendance":"Promote Students"),11,Ks)])])])):A("",!0),$.value?(o(),l("div",Qs,[e("div",Xs,[e("div",Zs,[e("div",eo,[P(a(ie),{class:"w-6 h-6 text-red-600"})]),to,so,e("button",{onClick:f[4]||(f[4]=i=>$.value=!1),class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," OK ")])])])):A("",!0)]))}};var no=ce(oo,[["__scopeId","data-v-51db23b1"]]);const lo={class:"min-h-screen bg-gray-50 p-4"},ro={class:"max-w-4xl mx-auto"},ao=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Create Notice"),e("p",{class:"text-gray-600"},"Send announcements to students and parents")],-1),io={class:"bg-white rounded-lg shadow-sm p-6"},co={class:"mb-6"},uo=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Title * ",-1),_o={class:"mb-6"},mo=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notice Message * ",-1),ho={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},go={class:"text-sm text-blue-700"},vo=e("span",{class:"font-medium"},"Selected Class:",-1),po={class:"flex justify-end"},xo=["disabled"],fo={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bo=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1),yo=[bo],wo={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ko=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1),$o=[ko],So={setup(C){const m=S(""),p=S(""),_=S(""),c=J({url:"school.al_ummah.api2.submit_notice",auto:!1,onSuccess(u){console.log("Notice submission response:",u),u.message?j(u.message):typeof u=="string"&&u.includes("success")?j(u):j("Notice published successfully!"),m.value="",p.value=""},onError(u){console.error("Error submitting notice:",u),u.message?$(u.message):u.exc_type==="ValidationError"?$("Validation error: Please check your input data."):$("An error occurred while submitting the notice.")}}),y=()=>{try{const u=localStorage.getItem("selected_student_group");u&&(_.value=u)}catch(u){console.error("Failed to load selected student group:",u)}},M=()=>H(this,null,function*(){if(!m.value.trim()||!p.value.trim()){$("Please enter both title and notice message.");return}if(!_.value){$("Student group information is missing.");return}const u={notice_heading:p.value.trim(),notice_message:m.value.trim(),student_group:_.value};console.log("Submitting notice:",u),yield c.fetch(u)}),j=u=>{alert(`\u2705 Success: ${u}`)},$=u=>{alert(`\u274C Error: ${u}`)};return re(()=>{y()}),(u,g)=>(o(),l("div",lo,[e("div",ro,[ao,e("div",io,[e("div",co,[uo,me(e("input",{"onUpdate:modelValue":g[0]||(g[0]=h=>p.value=h),type:"text",placeholder:"Enter notice title",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[be,p.value]])]),e("div",_o,[mo,me(e("textarea",{"onUpdate:modelValue":g[1]||(g[1]=h=>m.value=h),rows:"8",placeholder:"Enter your notice message here...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"},null,512),[[be,m.value]])]),e("div",ho,[e("p",go,[vo,q(" "+n(_.value||"No class selected"),1)])]),e("div",po,[e("button",{onClick:M,disabled:a(c).loading,class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors"},[a(c).loading?(o(),l("svg",wo,$o)):(o(),l("svg",fo,yo)),e("span",null,n(a(c).loading?"Publishing...":"Publish Notice"),1)],8,xo)])])])]))}};const K=C=>(ue("data-v-b50e67de"),C=C(),_e(),C),Co={class:"min-h-screen bg-gray-50 p-4"},jo={class:"mb-6"},Ao=K(()=>e("h1",{class:"text-2xl font-bold text-gray-800"},"Previous Notices",-1)),Mo=K(()=>e("p",{class:"text-gray-600"},"View all published notices",-1)),No={key:0,class:"text-sm text-gray-500 mt-1"},Eo={key:0,class:"flex justify-center items-center py-8"},Po=K(()=>e("div",{class:"spinner"},null,-1)),To=K(()=>e("span",{class:"ml-2 text-gray-600"},"Loading notices...",-1)),Do=[Po,To],Lo={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Io=K(()=>e("p",{class:"text-red-800"},"Failed to load notices.",-1)),Bo={key:2,class:"space-y-4"},zo=["onClick"],Fo={class:"p-6"},Vo={class:"flex items-start justify-between mb-3"},Ro={class:"text-lg font-semibold text-gray-800 flex-1 pr-4"},Go={class:"text-sm text-gray-500 whitespace-nowrap"},Oo={class:"text-gray-600 line-clamp-2 mb-4"},Ho={class:"flex items-center justify-between text-sm text-gray-500"},Uo=["onClick"],Jo={key:0,class:"text-center py-12"},qo=he('<div class="bg-white rounded-lg shadow-sm p-8" data-v-b50e67de><svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b50e67de><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-b50e67de></path></svg><h3 class="text-lg font-medium text-gray-800 mb-2" data-v-b50e67de>No Notices Found</h3><p class="text-gray-600" data-v-b50e67de>No notices have been published for this class yet.</p></div>',1),Wo=[qo],Yo={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Ko={class:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto"},Qo={class:"p-6"},Xo={class:"flex items-center justify-between mb-4"},Zo={class:"text-xl font-bold text-gray-800"},en=K(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),tn=[en],sn={class:"mb-4 text-sm text-gray-500"},on={class:"prose max-w-none mb-6"},nn={class:"text-gray-700 whitespace-pre-wrap"},ln={class:"flex space-x-3 pt-4 border-t"},rn=K(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),an=K(()=>e("span",null,"Delete Notice",-1)),cn=[rn,an],dn={setup(C){const m=S([]),p=S(""),_=S(null),c=S(!1),y=J({url:"school.al_ummah.api2.get_notice_list",auto:!1,onSuccess(k){console.log("Notices loaded:",k),m.value=Array.isArray(k)?k:[]},onError(k){console.error("Error fetching notices:",k),m.value=[]}}),M=J({url:"school.al_ummah.api2.delete_notice",auto:!1,onSuccess(){console.log("Notice deleted successfully"),$(),h()},onError(k){console.error("Error deleting notice:",k),B("Error","Failed to delete notice. Please try again.")}}),j=()=>{try{const k=localStorage.getItem("selected_student_group");k&&(p.value=k)}catch(k){console.error("Failed to load selected student group:",k)}},$=()=>{if(!p.value)return;const k={student_group:p.value};y.fetch(k)},u=k=>{if(!k)return"No date";try{return new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(z){return k}},g=k=>{_.value=k,c.value=!0},h=()=>{c.value=!1,_.value=null},T=k=>{if(!k){B("Error","No notice ID provided");return}confirm("Are you sure you want to delete this notice? This action cannot be undone.")&&M.fetch({name:k})},B=(k,z)=>{k==="Error"?window.alert(`Error: ${z}`):window.alert(z)};return re(()=>{j(),p.value&&$()}),de(p,k=>{k&&$()}),(k,z)=>(o(),l("div",Co,[e("div",jo,[Ao,Mo,p.value?(o(),l("p",No,"Class: "+n(p.value),1)):A("",!0)]),a(y).loading?(o(),l("div",Eo,Do)):a(y).error?(o(),l("div",Lo,[Io,e("button",{onClick:$,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(o(),l("div",Bo,[(o(!0),l(te,null,ae(m.value,(N,E)=>(o(),l("div",{key:E,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer",onClick:W=>g(N)},[e("div",Fo,[e("div",Vo,[e("h3",Ro,n(N.notice_heading||"No Title"),1),e("span",Go,n(u(N.date)),1)]),e("p",Oo,n(N.notice_message||"No message content"),1),e("div",Ho,[e("span",null,"By: "+n(N.owner||"System"),1),e("button",{onClick:ne(W=>T(N.name),["stop"]),class:"text-red-600 hover:text-red-800 font-medium"}," Delete ",8,Uo)])])],8,zo))),128)),m.value.length===0?(o(),l("div",Jo,Wo)):A("",!0)])),_.value&&c.value?(o(),l("div",Yo,[e("div",Ko,[e("div",Qo,[e("div",Xo,[e("h2",Zo,n(_.value.notice_heading),1),e("button",{onClick:h,class:"text-gray-400 hover:text-gray-600"},tn)]),e("div",sn,[e("p",null,"Published on: "+n(u(_.value.date)),1),e("p",null,"By: "+n(_.value.owner||"System"),1)]),e("div",on,[e("p",nn,n(_.value.notice_message),1)]),e("div",ln,[e("button",{onClick:z[0]||(z[0]=N=>T(_.value.name)),class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center space-x-2"},cn),e("button",{onClick:h,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Close ")])])])])):A("",!0)]))}};var un=ce(dn,[["__scopeId","data-v-b50e67de"]]);const b=C=>(ue("data-v-19534540"),C=C(),_e(),C),_n={class:"min-h-screen bg-gray-50 p-4"},mn={key:0,class:"flex justify-center items-center py-12"},hn=b(()=>e("div",{class:"spinner"},null,-1)),gn=b(()=>e("span",{class:"ml-3 text-gray-600 text-lg"},"Loading leave applications...",-1)),vn=[hn,gn],pn={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6 mb-6 max-w-4xl mx-auto"},xn={class:"flex items-start space-x-4"},fn=b(()=>e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),bn={class:"flex-1"},yn=b(()=>e("p",{class:"text-red-800 font-semibold text-lg"},"Unable to Load Applications",-1)),wn={class:"text-red-700 mt-2"},kn={key:2,class:"text-center py-16"},$n=he('<div class="max-w-md mx-auto" data-v-19534540><div class="w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-2xl flex items-center justify-center" data-v-19534540><svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-19534540></path></svg></div><h3 class="text-xl font-semibold text-gray-700 mb-2" data-v-19534540>No Leave Applications</h3><p class="text-gray-500" data-v-19534540>There are no leave applications for this group.</p></div>',1),Sn=[$n],Cn={key:3,class:"max-w-6xl mx-auto"},jn={class:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6"},An={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Mn=b(()=>e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Leave Applications"),e("p",{class:"text-gray-600 mt-1"},"Review and manage student leave requests")],-1)),Nn={class:"flex items-center space-x-4 mt-4 sm:mt-0"},En={class:"flex items-center space-x-2"},Pn=b(()=>e("div",{class:"w-3 h-3 bg-yellow-500 rounded-full"},null,-1)),Tn={class:"text-sm text-gray-600"},Dn={class:"flex items-center space-x-2"},Ln=b(()=>e("div",{class:"w-3 h-3 bg-green-500 rounded-full"},null,-1)),In={class:"text-sm text-gray-600"},Bn={class:"grid gap-6"},zn={class:"p-6"},Fn={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},Vn={class:"flex items-start space-x-4 flex-1 min-w-0"},Rn={class:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm"},Gn={class:"text-white font-semibold text-lg"},On={class:"flex-1 min-w-0"},Hn={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},Un={class:"font-bold text-gray-900 text-xl"},Jn={class:"text-gray-600 text-sm mt-1"},qn={class:"flex items-center space-x-3"},Wn=["onClick"],Yn=b(()=>e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)),Kn=[Yn],Qn={class:"flex flex-wrap items-center gap-4 mt-4"},Xn={class:"flex items-center space-x-2 text-gray-700"},Zn=b(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),el={class:"text-sm font-medium"},tl={class:"flex items-center space-x-2 text-gray-700"},sl=b(()=>e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),ol={class:"text-sm font-medium"},nl={class:"flex items-center space-x-2 text-blue-700"},ll=b(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),rl={class:"text-sm font-semibold"},al={class:"text-gray-600 mt-3 line-clamp-2"},il={key:0,class:"mt-3"},cl=b(()=>e("span",{class:"inline-flex items-center px-3 py-1.5 bg-green-50 text-green-700 rounded-lg text-sm font-medium"},[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),q(" Medical Certificate Available ")],-1)),dl=[cl],ul={key:0,class:"border-t border-gray-100 p-6 bg-gray-50 rounded-b-2xl"},_l={class:"grid grid-cols-1 xl:grid-cols-2 gap-8"},ml={class:"space-y-6"},hl={class:"bg-white rounded-xl border border-gray-200 p-6"},gl=b(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Leave Details",-1)),vl={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},pl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student Name",-1)),xl={class:"text-gray-900 font-semibold mt-1"},fl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Student ID",-1)),bl={class:"text-gray-900 font-semibold mt-1"},yl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Leave ID",-1)),wl={class:"text-gray-900 font-semibold mt-1"},kl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Duration",-1)),$l={class:"text-gray-900 font-semibold mt-1"},Sl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),Cl=b(()=>e("label",{class:"text-sm font-medium text-gray-500"},"Mark as Present",-1)),jl={class:"text-gray-900 font-semibold mt-1"},Al={class:"bg-white rounded-xl border border-gray-200 p-6"},Ml=b(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-3"},"Reason for Leave",-1)),Nl={class:"text-gray-700 bg-gray-50 p-4 rounded-lg border border-gray-200"},El={key:0,class:"bg-white rounded-xl border border-gray-200 p-6"},Pl=b(()=>e("h5",{class:"font-bold text-gray-900 text-lg mb-4"},"Approve Leave",-1)),Tl=["onClick","disabled"],Dl=b(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),Ll=b(()=>e("span",null,"Approve Leave Application",-1)),Il=[Dl,Ll],Bl=b(()=>e("p",{class:"text-gray-500 text-sm mt-3 text-center"}," This will approve the leave request and notify the student ",-1)),zl={key:1,class:"bg-green-50 rounded-xl border border-green-200 p-6 text-center"},Fl=he('<div class="flex items-center justify-center space-x-2 text-green-700 mb-2" data-v-19534540><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-19534540><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-19534540></path></svg><span class="font-semibold" data-v-19534540>Leave Approved</span></div><p class="text-green-600 text-sm" data-v-19534540> This leave application has been approved and processed. </p>',2),Vl=[Fl],Rl={key:0,class:"space-y-6"},Gl={class:"bg-white rounded-xl border border-gray-200 p-6"},Ol=b(()=>e("h4",{class:"font-bold text-gray-900 text-lg mb-4"},"Medical Certificate",-1)),Hl={class:"space-y-4"},Ul={class:"border-2 border-dashed border-gray-200 rounded-xl overflow-hidden bg-gray-50"},Jl=["src","onClick"],ql={class:"grid grid-cols-2 gap-3"},Wl=["onClick"],Yl=b(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),Kl=b(()=>e("span",null,"View Full Size",-1)),Ql=[Yl,Kl],Xl=["onClick"],Zl=b(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),er=b(()=>e("span",null,"Download",-1)),tr=[Zl,er],sr={key:1,class:"flex items-center justify-center p-8 bg-white rounded-xl border border-gray-200"},or=b(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-gray-500 font-medium"},"No medical certificate provided")],-1)),nr=[or],lr={key:2,class:"flex items-center justify-center p-8 bg-green-50 rounded-xl border border-green-200"},rr=b(()=>e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-green-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-green-700 font-medium"},"Approved without medical certificate")],-1)),ar=[rr],ir={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},cr=b(()=>e("div",{class:"bg-white rounded-2xl p-8 flex items-center space-x-4 shadow-xl"},[e("div",{class:"spinner-small"}),e("div",null,[e("p",{class:"font-semibold text-gray-900"},"Approving Leave"),e("p",{class:"text-gray-600 text-sm mt-1"},"Please wait while we process your request...")])],-1)),dr=[cr],ur={key:5,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},_r={class:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-lg"},mr={class:"flex items-start space-x-3"},hr=b(()=>e("svg",{class:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),gr={class:"flex-1"},vr=b(()=>e("p",{class:"text-red-800 font-medium text-sm"},"Error",-1)),pr={class:"text-red-700 text-sm mt-1"},xr=b(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),fr=[xr],br={key:6,class:"fixed top-4 right-4 z-50 max-w-sm w-full"},yr={class:"bg-green-50 border border-green-200 rounded-xl p-4 shadow-lg"},wr={class:"flex items-start space-x-3"},kr=b(()=>e("svg",{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),$r={class:"flex-1"},Sr=b(()=>e("p",{class:"text-green-800 font-medium text-sm"},"Success",-1)),Cr={class:"text-green-700 text-sm mt-1"},jr=b(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Ar=[jr],Mr={key:7,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},Nr={class:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col shadow-2xl"},Er={class:"flex justify-between items-center p-6 border-b border-gray-200"},Pr=b(()=>e("h3",{class:"text-xl font-bold text-gray-900"},"Medical Certificate",-1)),Tr={class:"text-gray-600 text-sm mt-1"},Dr=b(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Lr=[Dr],Ir={class:"flex-1 p-6 overflow-auto"},Br=["src"],zr=b(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),Fr=b(()=>e("span",null,"Download Certificate",-1)),Vr=[zr,Fr],Rr={setup(C){const m=S([]),p=S(""),_=S(null),c=S(!1),y=S(""),M=S(""),j=S(!1),$=S(!1),u=S(""),g=U(()=>m.value.filter(s=>s.docstatus===0).length),h=U(()=>m.value.filter(s=>s.docstatus===1).length),T=(s,v="error")=>{u.value=s,v==="success"?($.value=!0,setTimeout(()=>{$.value=!1},5e3)):(j.value=!0,setTimeout(()=>{j.value=!1},5e3))},B=J({url:"school.al_ummah.api2.get_leave_application_list",auto:!1,onSuccess(s){console.log("Raw API response:",s),Array.isArray(s)?m.value=s:s&&typeof s=="object"?s.message&&Array.isArray(s.message)?m.value=s.message:s.appeals&&Array.isArray(s.appeals)?m.value=s.appeals:s.leave_applications&&Array.isArray(s.leave_applications)?m.value=s.leave_applications:Array.isArray(s.data)?m.value=s.data:m.value=Object.keys(s).length>0?[s]:[]:m.value=[],console.log("Processed appeals:",m.value),p.value=""},onError(s){console.error("Error fetching leave applications:",s);const v=z(s,"Failed to load leave applications.");p.value=v,m.value=[]}}),k=J({url:"school.al_ummah.api2.approve_leave",method:"POST",auto:!1,onSuccess(s){if(console.log("\u2705 Approve API Response:",s),s.success){const v=m.value.findIndex(r=>r.name===s.name);v!==-1&&(m.value[v].docstatus=1,console.log("\u{1F504} Updated appeal docstatus to approved")),T(s.message||"Leave application approved successfully.","success"),_.value=null,le()}else console.log("\u274C API returned success: false"),T(s.message||"Failed to approve leave application.")},onError(s){console.error("\u{1F6A8} Error approving leave:",s);const v=z(s,"Failed to approve leave application.");T(v)}}),z=(s,v)=>{if(!s)return v;if(s._server_messages)try{const r=JSON.parse(s._server_messages||"[]");if(r.length>0){const O=r[r.length-1];try{const V=JSON.parse(O);return V.message||V.exc_type||v}catch(V){return O||v}}}catch(r){console.error("Error parsing server messages:",r)}return s.message?s.message:s.exc_type||s.exc_message?s.exc_message||s.exc_type||v:typeof s=="string"?s:v},N=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(v){return s||"N/A"}},E=(s,v)=>{if(!s||!v)return 0;try{const r=new Date(s),O=new Date(v),V=Math.abs(O-r);return Math.ceil(V/(1e3*60*60*24))+1}catch(r){return 0}},W=s=>s?s.split(" ").map(v=>v[0]).join("").toUpperCase().substring(0,2):"?",Q=s=>s===0?"Pending":"Approved",se=s=>s===0?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",X=s=>{console.error("Image failed to load"),s.target.style.display="none"},oe=s=>{console.error("Modal image failed to load"),T("Failed to load medical certificate image."),c.value=!1},Z=s=>{_.value=_.value===s?null:s},ee=(s,v)=>{s?(y.value=s,M.value=v,c.value=!0):T("Unable to display medical certificate.")},w=(s,v)=>{if(s){const r=document.createElement("a");r.href=s,r.download=`medical-certificate-${v||"student"}.jpg`,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},d=()=>{y.value&&w(y.value,M.value)},x=s=>H(this,null,function*(){if(!s){T("Cannot approve: Missing leave application ID");return}const v=m.value.find(O=>O.name===s);if(!v){T("Leave application not found.");return}if(v.docstatus!==0){T("This leave application has already been processed.");return}console.log("Approving leave:",s);const r={name:s};console.log("Sending approve data:",r),yield k.submit(r)}),G=()=>{try{const s=localStorage.getItem("selected_student_group");if(s)try{const v=JSON.parse(s);return v.student_group||v.name||v}catch(v){return s}return null}catch(s){return console.error("Error getting student group:",s),null}},le=()=>{const s=G();if(!s){p.value="No student group found. Please select a student first.",m.value=[];return}const v={student_group:s};console.log("Fetching leave applications with params:",v),B.fetch(v)};return re(()=>{le()}),(s,v)=>(o(),l("div",_n,[a(B).loading?(o(),l("div",mn,vn)):p.value?(o(),l("div",pn,[e("div",xn,[fn,e("div",bn,[yn,e("p",wn,n(p.value),1),e("button",{onClick:le,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors"}," Try Again ")])])])):!m.value||m.value.length===0?(o(),l("div",kn,Sn)):(o(),l("div",Cn,[e("div",jn,[e("div",An,[Mn,e("div",Nn,[e("div",En,[Pn,e("span",Tn,n(a(g))+" pending",1)]),e("div",Dn,[Ln,e("span",In,n(a(h))+" approved",1)])])])]),e("div",Bn,[(o(!0),l(te,null,ae(m.value,(r,O)=>(o(),l("div",{key:r.name||`appeal-${O}`,class:"bg-white rounded-2xl shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300"},[e("div",zn,[e("div",Fn,[e("div",Vn,[e("div",Rn,[e("span",Gn,n(W(r.student_name||r.student||"Unknown")),1)]),e("div",On,[e("div",Hn,[e("div",null,[e("h3",Un,n(r.student_name||r.student||"Unknown Student"),1),e("p",Jn,n(r.student||"No Student ID"),1)]),e("div",qn,[e("span",{class:D(["px-3 py-1.5 rounded-full text-sm font-semibold",se(r.docstatus)])},n(Q(r.docstatus)),3),e("button",{onClick:V=>Z(r.name),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[(o(),l("svg",{class:D(["w-5 h-5 transition-transform duration-200",{"rotate-180":_.value===r.name}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Kn,2))],8,Wn)])]),e("div",Qn,[e("div",Xn,[Zn,e("span",el,"From "+n(N(r.from_date)),1)]),e("div",tl,[sl,e("span",ol,"To "+n(N(r.to_date)),1)]),e("div",nl,[ll,e("span",rl,n(r.total_leave_days||E(r.from_date,r.to_date))+" days",1)])]),e("p",al,n(r.reason||"No reason provided"),1),r.img_url?(o(),l("div",il,dl)):A("",!0)])])])]),_.value===r.name?(o(),l("div",ul,[e("div",_l,[e("div",ml,[e("div",hl,[gl,e("div",vl,[e("div",null,[pl,e("p",xl,n(r.student_name||"N/A"),1)]),e("div",null,[fl,e("p",bl,n(r.student||"N/A"),1)]),e("div",null,[yl,e("p",wl,n(r.name||"N/A"),1)]),e("div",null,[kl,e("p",$l,n(r.total_leave_days||E(r.from_date,r.to_date))+" days",1)]),e("div",null,[Sl,e("p",{class:D([se(r.docstatus),"px-3 py-1.5 rounded-full text-sm font-semibold inline-block mt-1"])},n(Q(r.docstatus)),3)]),e("div",null,[Cl,e("p",jl,n(r.mark_as_present?"Yes":"No"),1)])])]),e("div",Al,[Ml,e("p",Nl,n(r.reason||"No reason provided"),1)]),r.docstatus===0?(o(),l("div",El,[Pl,e("button",{onClick:ne(V=>x(r.name),["stop"]),disabled:a(k).loading,class:"w-full px-6 py-3 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 shadow-sm hover:shadow-md"},Il,8,Tl),Bl])):(o(),l("div",zl,Vl))]),r.img_url?(o(),l("div",Rl,[e("div",Gl,[Ol,e("div",Hl,[e("div",Ul,[e("img",{src:r.img_url,alt:"Medical Certificate",onError:X,class:"w-full h-64 object-contain cursor-pointer transition-transform duration-200 hover:scale-105",onClick:ne(V=>ee(r.img_url,r.student_name),["stop"])},null,40,Jl)]),e("div",ql,[e("button",{onClick:ne(V=>ee(r.img_url,r.student_name),["stop"]),class:"px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2"},Ql,8,Wl),e("button",{onClick:ne(V=>w(r.img_url,r.student_name),["stop"]),class:"px-4 py-2.5 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2"},tr,8,Xl)])])])])):r.docstatus===0?(o(),l("div",sr,nr)):(o(),l("div",lr,ar))])])):A("",!0)]))),128))])])),a(k).loading?(o(),l("div",ir,dr)):A("",!0),j.value?(o(),l("div",ur,[e("div",_r,[e("div",mr,[hr,e("div",gr,[vr,e("p",pr,n(u.value),1)]),e("button",{onClick:v[0]||(v[0]=r=>j.value=!1),class:"text-red-400 hover:text-red-600 transition-colors"},fr)])])])):A("",!0),$.value?(o(),l("div",br,[e("div",yr,[e("div",wr,[kr,e("div",$r,[Sr,e("p",Cr,n(u.value),1)]),e("button",{onClick:v[1]||(v[1]=r=>$.value=!1),class:"text-green-400 hover:text-green-600 transition-colors"},Ar)])])])):A("",!0),c.value?(o(),l("div",Mr,[e("div",Nr,[e("div",Er,[e("div",null,[Pr,e("p",Tr,n(M.value),1)]),e("button",{onClick:v[2]||(v[2]=r=>c.value=!1),class:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"},Lr)]),e("div",Ir,[e("img",{src:y.value,alt:"Medical Certificate Full Size",class:"w-full h-auto max-h-full object-contain mx-auto rounded-lg",onError:oe},null,40,Br)]),e("div",{class:"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl"},[e("div",{class:"flex justify-center"},[e("button",{onClick:d,class:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center space-x-3"},Vr)])])])])):A("",!0)]))}};var Gr=ce(Rr,[["__scopeId","data-v-19534540"]]);const I=C=>(ue("data-v-1e08e8b4"),C=C(),_e(),C),Or={class:"flex min-h-screen bg-gray-50 flex-col md:flex-row"},Hr={class:"max-w-4xl max-h-full w-full h-full flex items-center justify-center"},Ur=["src"],Jr={key:1,class:"fixed inset-0 bg-red-50 bg-opacity-90 flex items-center justify-center z-50 p-4"},qr={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},Wr={class:"flex items-center mb-4"},Yr={class:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"},Kr=I(()=>e("h3",{class:"text-lg font-semibold text-red-800"},"Something went wrong",-1)),Qr={class:"text-gray-600 mb-4"},Xr={key:2,class:"fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50"},Zr=I(()=>e("div",{class:"text-center"},[e("div",{class:"spinner mb-4 mx-auto"}),e("p",{class:"text-gray-600"},"Loading your dashboard...")],-1)),ea=[Zr],ta={key:3,class:"flex flex-col md:flex-row w-full min-h-screen"},sa={class:"md:hidden bg-white shadow-sm border-b border-gray-200 p-4 flex items-center justify-between"},oa={class:"flex items-center space-x-3"},na=["src"],la={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},ra={class:"min-w-0 flex-1"},aa={class:"text-sm font-semibold text-gray-800 truncate"},ia=I(()=>e("p",{class:"text-xs text-gray-500"},"Teacher",-1)),ca={class:"flex items-center justify-between md:hidden pb-4 border-b border-gray-200"},da=I(()=>e("h3",{class:"text-lg font-semibold text-gray-800"},"Menu",-1)),ua={class:"flex-1 overflow-y-auto space-y-6 md:space-y-8"},_a={class:"hidden md:flex items-start space-x-4 border-b pb-4"},ma=["src"],ha={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},ga={class:"min-w-0 flex-1"},va={class:"text-xl font-semibold text-gray-800 break-words"},pa=I(()=>e("p",{class:"text-sm text-gray-500 mt-1"},"Teacher",-1)),xa={class:"space-y-2"},fa=I(()=>e("label",{class:"block text-sm font-medium text-gray-700"},"Select Class:",-1)),ba=["disabled"],ya=I(()=>e("option",{value:"",disabled:""},"Select a class",-1)),wa=["value"],ka={key:0,class:"text-sm text-yellow-600"},$a={class:"space-y-3"},Sa=I(()=>e("h3",{class:"text-sm font-medium text-gray-700"},"Navigation",-1)),Ca={class:"space-y-2"},ja=["disabled"],Aa=I(()=>e("span",{class:"truncate"},"Dashboard",-1)),Ma=["disabled"],Na=I(()=>e("span",{class:"truncate"},"Take Attendance",-1)),Ea=["disabled"],Pa=I(()=>e("span",{class:"truncate"},"Student Record",-1)),Ta=["disabled"],Da=I(()=>e("span",{class:"truncate"},"Create Notice",-1)),La=["disabled"],Ia=I(()=>e("span",{class:"truncate"},"Previous Notices",-1)),Ba=["disabled"],za=I(()=>e("span",{class:"truncate"},"Browse Leave Appeals",-1)),Fa={class:"pt-4 border-t border-gray-200 flex-shrink-0"},Va=["disabled"],Ra=I(()=>e("span",null,"Logout",-1)),Ga={key:0},Oa={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 mb-4 md:mb-6"},Ha={class:"text-xl md:text-2xl font-bold text-gray-800 mb-2"},Ua=I(()=>e("p",{class:"text-gray-600 text-sm md:text-base"},"Manage your classroom activities and student records from here.",-1)),Ja={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-4 md:mb-6"},qa={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-blue-500"},Wa={class:"flex items-center justify-between"},Ya=I(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Selected Class",-1)),Ka={class:"text-lg md:text-2xl font-bold text-gray-800 truncate"},Qa={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-green-500"},Xa={class:"flex items-center justify-between"},Za=I(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Available Classes",-1)),ei={class:"text-lg md:text-2xl font-bold text-gray-800"},ti={class:"bg-white rounded-lg shadow-sm p-4 md:p-6 border-l-4 border-purple-500"},si={class:"flex items-center justify-between"},oi=I(()=>e("p",{class:"text-xs md:text-sm font-medium text-gray-600"},"Today's Date",-1)),ni={class:"text-lg md:text-2xl font-bold text-gray-800"},li={class:"bg-white rounded-lg shadow-sm p-4 md:p-6"},ri=I(()=>e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Quick Actions",-1)),ai={class:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"},ii=["disabled"],ci=I(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Take Today's Attendance"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Mark student attendance for today")],-1)),di=["disabled"],ui=I(()=>e("div",{class:"min-w-0 flex-1"},[e("h3",{class:"font-medium text-gray-800 text-sm md:text-base"},"Create New Notice"),e("p",{class:"text-xs md:text-sm text-gray-600 truncate"},"Send announcement to students")],-1)),_i={key:0,class:"text-sm text-yellow-600 mt-3"},mi={key:1,class:"h-full"},hi={setup(C){const m=fe(),p=S({}),_=S([]),c=S(""),y=S(!1),M=S("dashboard"),j=S(null),$=S(!1),u=S(!1),g=S(""),h={attendance:no,"attendance-record":Fe,"create-notice":So,"previous-notices":un,"leave-appeals":Gr},T=()=>h[M.value]||null,B=w=>{E.loading||(M.value=w,window.innerWidth<768&&(y.value=!1))},k=w=>{w&&(g.value=w,u.value=!0)},z=ye.user,N=()=>{var w;try{const d=localStorage.getItem("user_details"),x=localStorage.getItem("selected_student_group");if(d){const G=JSON.parse(d);p.value={name:G.name,img_url:G.img_url},((w=G.student_groups)==null?void 0:w.length)&&(_.value=G.student_groups,c.value=x||G.student_groups[0],$.value=!0)}}catch(d){console.warn("Error loading from localStorage:",d)}},E=J({url:"school.al_ummah.api2.get_instructor_app_data",params:{teacherID:z},auto:!1,onSuccess(w){var d;console.log("Instructor details loaded:",w),j.value=null;try{w?(p.value={name:w.name,img_url:w.img_url},((d=w.student_groups)==null?void 0:d.length)&&(_.value=w.student_groups,c.value=w.student_groups[0],localStorage.setItem("selected_student_group",w.student_groups[0])),localStorage.setItem("user_details",JSON.stringify({name:w.name,img_url:w.img_url,student_groups:w.student_groups})),$.value=!0):j.value="No user data received from server"}catch(x){console.error("Error processing user data:",x),j.value="Error processing user data"}},onError(w){console.error("Error loading instructor details:",w),j.value="Failed to load user data. Please try again.",$.value||Q()}}),W=U(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),Q=()=>{try{N(),(p.value.name||_.value.length)&&($.value=!0,j.value=null)}catch(w){console.error("Error loading from localStorage:",w),j.value="Unable to load user data. Please refresh the page."}},se=()=>H(this,null,function*(){c.value&&localStorage.setItem("selected_student_group",c.value)}),X=w=>{w.target.style.display="none";const d=w.target.nextElementSibling;d&&(d.style.display="flex")},oe=()=>{j.value=null,$.value=!1,E.reload()},Z=()=>H(this,null,function*(){try{localStorage.removeItem("user_details"),localStorage.removeItem("user"),localStorage.removeItem("selected_student_group"),yield ye.logout.submit(),m.push({name:"Login"})}catch(w){console.error("Logout error:",w),localStorage.clear(),m.push({name:"Login"})}}),ee=()=>{window.innerWidth>=768&&(y.value=!1)};return re(()=>{N(),window.addEventListener("resize",ee),setTimeout(()=>{E.reload().catch(w=>{console.error("Failed to reload user details:",w),j.value="Network error. Please check your connection."})},100)}),Te(()=>{window.removeEventListener("resize",ee)}),de(()=>E.loading,w=>{!w&&E.data&&console.log("Data loaded successfully")}),de(()=>M.value,()=>{window.innerWidth<768&&(y.value=!1)}),(w,d)=>(o(),l("div",Or,[u.value?(o(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4",onClick:d[2]||(d[2]=x=>u.value=!1)},[e("div",Hr,[e("img",{src:g.value,alt:"Full size profile photo",class:"max-w-full max-h-full object-contain",onClick:d[0]||(d[0]=ne(()=>{},["stop"]))},null,8,Ur),e("button",{onClick:d[1]||(d[1]=x=>u.value=!1),class:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors"},[P(a(ie),{class:"w-8 h-8"})])])])):A("",!0),j.value?(o(),l("div",Jr,[e("div",qr,[e("div",Wr,[e("div",Yr,[P(a($e),{class:"w-6 h-6 text-red-600"})]),Kr]),e("p",Qr,n(j.value),1),e("div",{class:"flex space-x-3"},[e("button",{onClick:oe,class:"flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors"}," Try Again "),e("button",{onClick:Z,class:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors"}," Logout ")])])])):a(E).loading&&!$.value?(o(),l("div",Xr,ea)):(o(),l("div",ta,[e("header",sa,[e("div",oa,[e("div",{class:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0 cursor-pointer",onClick:d[3]||(d[3]=x=>k(p.value.img_url))},[p.value.img_url?(o(),l("img",{key:0,src:p.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:X},null,40,na)):(o(),l("div",la,[P(a(we),{class:"w-5 h-5 text-gray-400"})]))]),e("div",ra,[e("h2",aa,n(p.value.name||"Teacher"),1),ia])]),e("button",{onClick:d[4]||(d[4]=x=>y.value=!y.value),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[P(a(Ve),{class:"w-6 h-6"})])]),y.value?(o(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:d[5]||(d[5]=x=>y.value=!1)})):A("",!0),e("aside",{class:D(["bg-white shadow-md p-4 md:p-6 space-y-6 md:space-y-8 z-50","fixed md:relative inset-y-0 left-0 transform transition-transform duration-300 ease-in-out","w-72 max-w-full",y.value?"translate-x-0":"-translate-x-full md:translate-x-0","flex flex-col h-screen md:h-auto"])},[e("div",ca,[da,e("button",{onClick:d[6]||(d[6]=x=>y.value=!1),class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 transition-colors"},[P(a(ie),{class:"w-5 h-5"})])]),e("div",ua,[e("div",_a,[e("div",{class:"flex-shrink-0 w-16 h-16 rounded-full bg-gray-200 overflow-hidden cursor-pointer",onClick:d[7]||(d[7]=x=>k(p.value.img_url))},[p.value.img_url?(o(),l("img",{key:0,src:p.value.img_url,alt:"Teacher",class:"object-cover w-full h-full",onError:X},null,40,ma)):(o(),l("div",ha,[P(a(we),{class:"w-6 h-6 text-gray-400"})]))]),e("div",ga,[e("h2",va,n(p.value.name||"Loading..."),1),pa])]),e("div",xa,[fa,me(e("select",{"onUpdate:modelValue":d[8]||(d[8]=x=>c.value=x),onChange:se,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm md:text-base",disabled:a(E).loading||!_.value.length},[ya,(o(!0),l(te,null,ae(_.value,(x,G)=>(o(),l("option",{key:G,value:x},n(x),9,wa))),128))],40,ba),[[De,c.value]]),_.value.length?A("",!0):(o(),l("p",ka," No classes available "))]),e("div",$a,[Sa,e("nav",Ca,[e("button",{onClick:d[9]||(d[9]=x=>B("dashboard")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="dashboard"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:a(E).loading},[P(a(Re),{class:"w-5 h-5 flex-shrink-0"}),Aa],10,ja),e("button",{onClick:d[10]||(d[10]=x=>B("attendance")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="attendance"?"bg-blue-100 border border-blue-200 text-blue-800":"bg-blue-50 text-blue-800 hover:bg-blue-100"]),disabled:!c.value||a(E).loading},[P(a(ge),{class:"w-5 h-5 flex-shrink-0"}),Na],10,Ma),e("button",{onClick:d[11]||(d[11]=x=>B("attendance-record")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="attendance-record"?"bg-green-100 border border-green-200 text-green-800":"bg-green-50 text-green-800 hover:bg-green-100"]),disabled:!c.value||a(E).loading},[P(a(ke),{class:"w-5 h-5 flex-shrink-0"}),Pa],10,Ea),e("button",{onClick:d[12]||(d[12]=x=>B("create-notice")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="create-notice"?"bg-yellow-100 border border-yellow-200 text-yellow-800":"bg-yellow-50 text-yellow-800 hover:bg-yellow-100"]),disabled:!c.value||a(E).loading},[P(a(Se),{class:"w-5 h-5 flex-shrink-0"}),Da],10,Ta),e("button",{onClick:d[13]||(d[13]=x=>B("previous-notices")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="previous-notices"?"bg-purple-100 border border-purple-200 text-purple-800":"bg-purple-50 text-purple-800 hover:bg-purple-100"]),disabled:!c.value||a(E).loading},[P(a(Ge),{class:"w-5 h-5 flex-shrink-0"}),Ia],10,La),e("button",{onClick:d[14]||(d[14]=x=>B("leave-appeals")),class:D(["w-full text-left px-4 py-3 rounded font-medium flex items-center space-x-3 transition-colors text-sm md:text-base",M.value==="leave-appeals"?"bg-indigo-100 border border-indigo-200 text-indigo-800":"bg-indigo-50 text-indigo-800 hover:bg-indigo-100"]),disabled:!c.value||a(E).loading},[P(a(Oe),{class:"w-5 h-5 flex-shrink-0"}),za],10,Ba)])]),e("div",Fa,[e("button",{class:"w-full px-4 py-3 rounded bg-red-100 text-red-600 font-medium hover:bg-red-200 flex items-center justify-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",onClick:Z,disabled:a(E).loading},[P(a(He),{class:"w-5 h-5 flex-shrink-0"}),Ra],8,Va)])])],2),e("main",{class:D(["flex-1 min-h-screen md:min-h-0 p-4 md:p-6 lg:p-8 bg-gray-50",{"opacity-50 pointer-events-none":a(E).loading}])},[M.value==="dashboard"?(o(),l("div",Ga,[e("div",Oa,[e("h1",Ha,"Welcome, "+n(p.value.name||"Teacher")+"!",1),Ua]),e("div",Ja,[e("div",qa,[e("div",Wa,[e("div",null,[Ya,e("p",Ka,n(c.value||"None"),1)]),P(a(ke),{class:"w-6 h-6 md:w-8 md:h-8 text-blue-500 flex-shrink-0"})])]),e("div",Qa,[e("div",Xa,[e("div",null,[Za,e("p",ei,n(_.value.length),1)]),P(a(ge),{class:"w-6 h-6 md:w-8 md:h-8 text-green-500 flex-shrink-0"})])]),e("div",ti,[e("div",si,[e("div",null,[oi,e("p",ni,n(a(W)),1)]),P(a(Ue),{class:"w-6 h-6 md:w-8 md:h-8 text-purple-500 flex-shrink-0"})])])]),e("div",li,[ri,e("div",ai,[e("button",{onClick:d[15]||(d[15]=x=>B("attendance")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[P(a(ge),{class:"w-5 h-5 md:w-6 md:h-6 text-blue-600 mr-3 flex-shrink-0"}),ci],8,ii),e("button",{onClick:d[16]||(d[16]=x=>B("create-notice")),disabled:!c.value,class:"flex items-center p-3 md:p-4 border border-gray-200 rounded-lg hover:border-yellow-500 hover:bg-yellow-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed text-left"},[P(a(Se),{class:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 mr-3 flex-shrink-0"}),ui],8,di)]),c.value?A("",!0):(o(),l("p",_i," Please select a class to access these features "))])])):(o(),l("div",mi,[(o(),Y(Le(T()),{"selected-group":c.value,onBackToDashboard:d[17]||(d[17]=x=>B("dashboard")),key:c.value+M.value},null,8,["selected-group"]))]))],2)]))]))}};var wi=ce(hi,[["__scopeId","data-v-1e08e8b4"]]);export{wi as default};
