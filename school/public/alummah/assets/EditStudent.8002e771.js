var Ae=(i,e,t)=>new Promise((a,s)=>{var r=u=>{try{l(t.next(u))}catch(h){s(h)}},n=u=>{try{l(t.throw(u))}catch(h){s(h)}},l=u=>u.done?a(u.value):Promise.resolve(u.value).then(r,n);l((t=t.apply(i,e)).next())});import{q as st,v as Gt,_ as nt,r as B,u as Be,w as _e,x as Ft,d as w,e as k,f as o,y as b,g as R,t as Y,i as lt,p as dt,h as ct,z as je,o as qt,n as ue,A as ut,C as H,D as X,E as ht,F as Kt,G as Zt,H as Jt,I as Qt}from"./vendor.206e735d.js";var pt={},ea=st(Gt);/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function ft(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,a)}return t}function mt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ft(Object(t),!0).forEach(function(a){ra(i,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):ft(Object(t)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(t,a))})}return i}function ta(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var a=t.call(i,e||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function gt(i){var e=ta(i,"string");return typeof e=="symbol"?e:e+""}function He(i){return He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(i)}function aa(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function vt(i,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,gt(a.key),a)}}function ia(i,e,t){return e&&vt(i.prototype,e),t&&vt(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function ra(i,e,t){return e=gt(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function bt(i){return oa(i)||sa(i)||na(i)||la()}function oa(i){if(Array.isArray(i))return We(i)}function sa(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function na(i,e){if(!!i){if(typeof i=="string")return We(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return We(i,e)}}function We(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=i[t];return a}function la(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ie=typeof window!="undefined"&&typeof window.document!="undefined",se=Ie?window:{},Ye=Ie&&se.document.documentElement?"ontouchstart"in se.document.documentElement:!1,Ve=Ie?"PointerEvent"in se:!1,$="cropper",Xe="all",_t="crop",yt="move",xt="zoom",ge="e",ve="w",ye="s",he="n",Ce="ne",Me="nw",Ee="se",Ne="sw",Ge="".concat($,"-crop"),wt="".concat($,"-disabled"),Z="".concat($,"-hidden"),kt="".concat($,"-hide"),da="".concat($,"-invisible"),Le="".concat($,"-modal"),Fe="".concat($,"-move"),Se="".concat($,"Action"),ze="".concat($,"Preview"),qe="crop",Dt="move",Ct="none",Ke="crop",Ze="cropend",Je="cropmove",Qe="cropstart",Mt="dblclick",ca=Ye?"touchstart":"mousedown",ua=Ye?"touchmove":"mousemove",ha=Ye?"touchend touchcancel":"mouseup",Et=Ve?"pointerdown":ca,Nt=Ve?"pointermove":ua,St=Ve?"pointerup pointercancel":ha,Ot="ready",Tt="resize",Rt="wheel",et="zoom",At="image/jpeg",pa=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,fa=/^data:/,ma=/^data:image\/jpeg;base64,/,ga=/^img|canvas$/i,Bt=200,It=100,Lt={viewMode:0,dragMode:qe,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Bt,minContainerHeight:It,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},va='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',ba=Number.isNaN||se.isNaN;function O(i){return typeof i=="number"&&!ba(i)}var zt=function(e){return e>0&&e<1/0};function tt(i){return typeof i=="undefined"}function be(i){return He(i)==="object"&&i!==null}var _a=Object.prototype.hasOwnProperty;function xe(i){if(!be(i))return!1;try{var e=i.constructor,t=e.prototype;return e&&t&&_a.call(t,"isPrototypeOf")}catch(a){return!1}}function J(i){return typeof i=="function"}var ya=Array.prototype.slice;function Ut(i){return Array.from?Array.from(i):ya.call(i)}function W(i,e){return i&&J(e)&&(Array.isArray(i)||O(i.length)?Ut(i).forEach(function(t,a){e.call(i,t,a,i)}):be(i)&&Object.keys(i).forEach(function(t){e.call(i,i[t],t,i)})),i}var P=Object.assign||function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];return be(e)&&a.length>0&&a.forEach(function(r){be(r)&&Object.keys(r).forEach(function(n){e[n]=r[n]})}),e},xa=/\.\d*(?:0|9){12}\d*$/;function we(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return xa.test(i)?Math.round(i*e)/e:i}var wa=/^width|height|left|top|marginLeft|marginTop$/;function pe(i,e){var t=i.style;W(e,function(a,s){wa.test(s)&&O(a)&&(a="".concat(a,"px")),t[s]=a})}function ka(i,e){return i.classList?i.classList.contains(e):i.className.indexOf(e)>-1}function G(i,e){if(!!e){if(O(i.length)){W(i,function(a){G(a,e)});return}if(i.classList){i.classList.add(e);return}var t=i.className.trim();t?t.indexOf(e)<0&&(i.className="".concat(t," ").concat(e)):i.className=e}}function ne(i,e){if(!!e){if(O(i.length)){W(i,function(t){ne(t,e)});return}if(i.classList){i.classList.remove(e);return}i.className.indexOf(e)>=0&&(i.className=i.className.replace(e,""))}}function ke(i,e,t){if(!!e){if(O(i.length)){W(i,function(a){ke(a,e,t)});return}t?G(i,e):ne(i,e)}}var Da=/([a-z\d])([A-Z])/g;function at(i){return i.replace(Da,"$1-$2").toLowerCase()}function it(i,e){return be(i[e])?i[e]:i.dataset?i.dataset[e]:i.getAttribute("data-".concat(at(e)))}function Oe(i,e,t){be(t)?i[e]=t:i.dataset?i.dataset[e]=t:i.setAttribute("data-".concat(at(e)),t)}function Ca(i,e){if(be(i[e]))try{delete i[e]}catch(t){i[e]=void 0}else if(i.dataset)try{delete i.dataset[e]}catch(t){i.dataset[e]=void 0}else i.removeAttribute("data-".concat(at(e)))}var $t=/\s\s*/,Pt=function(){var i=!1;if(Ie){var e=!1,t=function(){},a=Object.defineProperty({},"once",{get:function(){return i=!0,e},set:function(r){e=r}});se.addEventListener("test",t,a),se.removeEventListener("test",t,a)}return i}();function oe(i,e,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split($t).forEach(function(r){if(!Pt){var n=i.listeners;n&&n[r]&&n[r][t]&&(s=n[r][t],delete n[r][t],Object.keys(n[r]).length===0&&delete n[r],Object.keys(n).length===0&&delete i.listeners)}i.removeEventListener(r,s,a)})}function re(i,e,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=t;e.trim().split($t).forEach(function(r){if(a.once&&!Pt){var n=i.listeners,l=n===void 0?{}:n;s=function(){delete l[r][t],i.removeEventListener(r,s,a);for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];t.apply(i,d)},l[r]||(l[r]={}),l[r][t]&&i.removeEventListener(r,l[r][t],a),l[r][t]=s,i.listeners=l}i.addEventListener(r,s,a)})}function De(i,e,t){var a;return J(Event)&&J(CustomEvent)?a=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,t)),i.dispatchEvent(a)}function jt(i){var e=i.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var rt=se.location,Ma=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ht(i){var e=i.match(Ma);return e!==null&&(e[1]!==rt.protocol||e[2]!==rt.hostname||e[3]!==rt.port)}function Wt(i){var e="timestamp=".concat(new Date().getTime());return i+(i.indexOf("?")===-1?"?":"&")+e}function Te(i){var e=i.rotate,t=i.scaleX,a=i.scaleY,s=i.translateX,r=i.translateY,n=[];O(s)&&s!==0&&n.push("translateX(".concat(s,"px)")),O(r)&&r!==0&&n.push("translateY(".concat(r,"px)")),O(e)&&e!==0&&n.push("rotate(".concat(e,"deg)")),O(t)&&t!==1&&n.push("scaleX(".concat(t,")")),O(a)&&a!==1&&n.push("scaleY(".concat(a,")"));var l=n.length?n.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function Ea(i){var e=mt({},i),t=0;return W(i,function(a,s){delete e[s],W(e,function(r){var n=Math.abs(a.startX-r.startX),l=Math.abs(a.startY-r.startY),u=Math.abs(a.endX-r.endX),h=Math.abs(a.endY-r.endY),d=Math.sqrt(n*n+l*l),c=Math.sqrt(u*u+h*h),p=(c-d)/d;Math.abs(p)>Math.abs(t)&&(t=p)})}),t}function Ue(i,e){var t=i.pageX,a=i.pageY,s={endX:t,endY:a};return e?s:mt({startX:t,startY:a},s)}function Na(i){var e=0,t=0,a=0;return W(i,function(s){var r=s.startX,n=s.startY;e+=r,t+=n,a+=1}),e/=a,t/=a,{pageX:e,pageY:t}}function fe(i){var e=i.aspectRatio,t=i.height,a=i.width,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=zt(a),n=zt(t);if(r&&n){var l=t*e;s==="contain"&&l>a||s==="cover"&&l<a?t=a/e:a=t*e}else r?t=a/e:n&&(a=t*e);return{width:a,height:t}}function Sa(i){var e=i.width,t=i.height,a=i.degree;if(a=Math.abs(a)%180,a===90)return{width:t,height:e};var s=a%90*Math.PI/180,r=Math.sin(s),n=Math.cos(s),l=e*n+t*r,u=e*r+t*n;return a>90?{width:u,height:l}:{width:l,height:u}}function Oa(i,e,t,a){var s=e.aspectRatio,r=e.naturalWidth,n=e.naturalHeight,l=e.rotate,u=l===void 0?0:l,h=e.scaleX,d=h===void 0?1:h,c=e.scaleY,p=c===void 0?1:c,D=t.aspectRatio,C=t.naturalWidth,T=t.naturalHeight,N=a.fillColor,S=N===void 0?"transparent":N,y=a.imageSmoothingEnabled,I=y===void 0?!0:y,L=a.imageSmoothingQuality,z=L===void 0?"low":L,f=a.maxWidth,M=f===void 0?1/0:f,U=a.maxHeight,F=U===void 0?1/0:U,Q=a.minWidth,ae=Q===void 0?0:Q,ee=a.minHeight,ie=ee===void 0?0:ee,K=document.createElement("canvas"),V=K.getContext("2d"),te=fe({aspectRatio:D,width:M,height:F}),ce=fe({aspectRatio:D,width:ae,height:ie},"cover"),m=Math.min(te.width,Math.max(ce.width,C)),E=Math.min(te.height,Math.max(ce.height,T)),j=fe({aspectRatio:s,width:M,height:F}),le=fe({aspectRatio:s,width:ae,height:ie},"cover"),de=Math.min(j.width,Math.max(le.width,r)),me=Math.min(j.height,Math.max(le.height,n)),$e=[-de/2,-me/2,de,me];return K.width=we(m),K.height=we(E),V.fillStyle=S,V.fillRect(0,0,m,E),V.save(),V.translate(m/2,E/2),V.rotate(u*Math.PI/180),V.scale(d,p),V.imageSmoothingEnabled=I,V.imageSmoothingQuality=z,V.drawImage.apply(V,[i].concat(bt($e.map(function(Pe){return Math.floor(we(Pe))})))),V.restore(),K}var Yt=String.fromCharCode;function Ta(i,e,t){var a="";t+=e;for(var s=e;s<t;s+=1)a+=Yt(i.getUint8(s));return a}var Ra=/^data:.*,/;function Aa(i){var e=i.replace(Ra,""),t=atob(e),a=new ArrayBuffer(t.length),s=new Uint8Array(a);return W(s,function(r,n){s[n]=t.charCodeAt(n)}),a}function Ba(i,e){for(var t=[],a=8192,s=new Uint8Array(i);s.length>0;)t.push(Yt.apply(null,Ut(s.subarray(0,a)))),s=s.subarray(a);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function Ia(i){var e=new DataView(i),t;try{var a,s,r;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var n=e.byteLength,l=2;l+1<n;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){s=l;break}l+=1}if(s){var u=s+4,h=s+10;if(Ta(e,u,4)==="Exif"){var d=e.getUint16(h);if(a=d===18761,(a||d===19789)&&e.getUint16(h+2,a)===42){var c=e.getUint32(h+4,a);c>=8&&(r=h+c)}}}if(r){var p=e.getUint16(r,a),D,C;for(C=0;C<p;C+=1)if(D=r+C*12+2,e.getUint16(D,a)===274){D+=8,t=e.getUint16(D,a),e.setUint16(D,1,a);break}}}catch(T){t=1}return t}function La(i){var e=0,t=1,a=1;switch(i){case 2:t=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:a}}var za={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,a=this.container,s=this.cropper,r=Number(t.minContainerWidth),n=Number(t.minContainerHeight);G(s,Z),ne(e,Z);var l={width:Math.max(a.offsetWidth,r>=0?r:Bt),height:Math.max(a.offsetHeight,n>=0?n:It)};this.containerData=l,pe(s,{width:l.width,height:l.height}),G(e,Z),ne(s,Z)},initCanvas:function(){var e=this.containerData,t=this.imageData,a=this.options.viewMode,s=Math.abs(t.rotate)%180==90,r=s?t.naturalHeight:t.naturalWidth,n=s?t.naturalWidth:t.naturalHeight,l=r/n,u=e.width,h=e.height;e.height*l>e.width?a===3?u=e.height*l:h=e.width/l:a===3?h=e.width/l:u=e.height*l;var d={aspectRatio:l,naturalWidth:r,naturalHeight:n,width:u,height:h};this.canvasData=d,this.limited=a===1||a===2,this.limitCanvas(!0,!0),d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth),d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight),d.left=(e.width-d.width)/2,d.top=(e.height-d.height)/2,d.oldLeft=d.left,d.oldTop=d.top,this.initialCanvasData=P({},d)},limitCanvas:function(e,t){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=a.viewMode,u=r.aspectRatio,h=this.cropped&&n;if(e){var d=Number(a.minCanvasWidth)||0,c=Number(a.minCanvasHeight)||0;l>1?(d=Math.max(d,s.width),c=Math.max(c,s.height),l===3&&(c*u>d?d=c*u:c=d/u)):l>0&&(d?d=Math.max(d,h?n.width:0):c?c=Math.max(c,h?n.height:0):h&&(d=n.width,c=n.height,c*u>d?d=c*u:c=d/u));var p=fe({aspectRatio:u,width:d,height:c});d=p.width,c=p.height,r.minWidth=d,r.minHeight=c,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(l>(h?0:1)){var D=s.width-r.width,C=s.height-r.height;r.minLeft=Math.min(0,D),r.minTop=Math.min(0,C),r.maxLeft=Math.max(0,D),r.maxTop=Math.max(0,C),h&&this.limited&&(r.minLeft=Math.min(n.left,n.left+(n.width-r.width)),r.minTop=Math.min(n.top,n.top+(n.height-r.height)),r.maxLeft=n.left,r.maxTop=n.top,l===2&&(r.width>=s.width&&(r.minLeft=Math.min(0,D),r.maxLeft=Math.max(0,D)),r.height>=s.height&&(r.minTop=Math.min(0,C),r.maxTop=Math.max(0,C))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=s.width,r.maxTop=s.height},renderCanvas:function(e,t){var a=this.canvasData,s=this.imageData;if(t){var r=Sa({width:s.naturalWidth*Math.abs(s.scaleX||1),height:s.naturalHeight*Math.abs(s.scaleY||1),degree:s.rotate||0}),n=r.width,l=r.height,u=a.width*(n/a.naturalWidth),h=a.height*(l/a.naturalHeight);a.left-=(u-a.width)/2,a.top-=(h-a.height)/2,a.width=u,a.height=h,a.aspectRatio=n/l,a.naturalWidth=n,a.naturalHeight=l,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,pe(this.canvas,P({width:a.width,height:a.height},Te({translateX:a.left,translateY:a.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,a=this.imageData,s=a.naturalWidth*(t.width/t.naturalWidth),r=a.naturalHeight*(t.height/t.naturalHeight);P(a,{width:s,height:r,left:(t.width-s)/2,top:(t.height-r)/2}),pe(this.image,P({width:a.width,height:a.height},Te(P({translateX:a.left,translateY:a.top},a)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,a=e.aspectRatio||e.initialAspectRatio,s=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};a&&(t.height*a>t.width?r.height=r.width/a:r.width=r.height*a),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*s),r.height=Math.max(r.minHeight,r.height*s),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=P({},r)},limitCropBox:function(e,t){var a=this.options,s=this.containerData,r=this.canvasData,n=this.cropBoxData,l=this.limited,u=a.aspectRatio;if(e){var h=Number(a.minCropBoxWidth)||0,d=Number(a.minCropBoxHeight)||0,c=l?Math.min(s.width,r.width,r.width+r.left,s.width-r.left):s.width,p=l?Math.min(s.height,r.height,r.height+r.top,s.height-r.top):s.height;h=Math.min(h,s.width),d=Math.min(d,s.height),u&&(h&&d?d*u>h?d=h/u:h=d*u:h?d=h/u:d&&(h=d*u),p*u>c?p=c/u:c=p*u),n.minWidth=Math.min(h,c),n.minHeight=Math.min(d,p),n.maxWidth=c,n.maxHeight=p}t&&(l?(n.minLeft=Math.max(0,r.left),n.minTop=Math.max(0,r.top),n.maxLeft=Math.min(s.width,r.left+r.width)-n.width,n.maxTop=Math.min(s.height,r.top+r.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=s.width-n.width,n.maxTop=s.height-n.height))},renderCropBox:function(){var e=this.options,t=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,e.movable&&e.cropBoxMovable&&Oe(this.face,Se,a.width>=t.width&&a.height>=t.height?yt:Xe),pe(this.cropBox,P({width:a.width,height:a.height},Te({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),De(this.element,Ke,this.getData())}},Ua={initPreview:function(){var e=this.element,t=this.crossOrigin,a=this.options.preview,s=t?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",n=document.createElement("img");if(t&&(n.crossOrigin=t),n.src=s,n.alt=r,this.viewBox.appendChild(n),this.viewBoxImage=n,!!a){var l=a;typeof a=="string"?l=e.ownerDocument.querySelectorAll(a):a.querySelector&&(l=[a]),this.previews=l,W(l,function(u){var h=document.createElement("img");Oe(u,ze,{width:u.offsetWidth,height:u.offsetHeight,html:u.innerHTML}),t&&(h.crossOrigin=t),h.src=s,h.alt=r,h.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',u.innerHTML="",u.appendChild(h)})}},resetPreview:function(){W(this.previews,function(e){var t=it(e,ze);pe(e,{width:t.width,height:t.height}),e.innerHTML=t.html,Ca(e,ze)})},preview:function(){var e=this.imageData,t=this.canvasData,a=this.cropBoxData,s=a.width,r=a.height,n=e.width,l=e.height,u=a.left-t.left-e.left,h=a.top-t.top-e.top;!this.cropped||this.disabled||(pe(this.viewBoxImage,P({width:n,height:l},Te(P({translateX:-u,translateY:-h},e)))),W(this.previews,function(d){var c=it(d,ze),p=c.width,D=c.height,C=p,T=D,N=1;s&&(N=p/s,T=r*N),r&&T>D&&(N=D/r,C=s*N,T=D),pe(d,{width:C,height:T}),pe(d.getElementsByTagName("img")[0],P({width:n*N,height:l*N},Te(P({translateX:-u*N,translateY:-h*N},e))))}))}},$a={bind:function(){var e=this.element,t=this.options,a=this.cropper;J(t.cropstart)&&re(e,Qe,t.cropstart),J(t.cropmove)&&re(e,Je,t.cropmove),J(t.cropend)&&re(e,Ze,t.cropend),J(t.crop)&&re(e,Ke,t.crop),J(t.zoom)&&re(e,et,t.zoom),re(a,Et,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&re(a,Rt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&re(a,Mt,this.onDblclick=this.dblclick.bind(this)),re(e.ownerDocument,Nt,this.onCropMove=this.cropMove.bind(this)),re(e.ownerDocument,St,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&re(window,Tt,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,a=this.cropper;J(t.cropstart)&&oe(e,Qe,t.cropstart),J(t.cropmove)&&oe(e,Je,t.cropmove),J(t.cropend)&&oe(e,Ze,t.cropend),J(t.crop)&&oe(e,Ke,t.crop),J(t.zoom)&&oe(e,et,t.zoom),oe(a,Et,this.onCropStart),t.zoomable&&t.zoomOnWheel&&oe(a,Rt,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&oe(a,Mt,this.onDblclick),oe(e.ownerDocument,Nt,this.onCropMove),oe(e.ownerDocument,St,this.onCropEnd),t.responsive&&oe(window,Tt,this.onResize)}},Pa={resize:function(){if(!this.disabled){var e=this.options,t=this.container,a=this.containerData,s=t.offsetWidth/a.width,r=t.offsetHeight/a.height,n=Math.abs(s-1)>Math.abs(r-1)?s:r;if(n!==1){var l,u;e.restore&&(l=this.getCanvasData(),u=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(W(l,function(h,d){l[d]=h*n})),this.setCropBoxData(W(u,function(h,d){u[d]=h*n})))}}},dblclick:function(){this.disabled||this.options.dragMode===Ct||this.setDragMode(ka(this.dragBox,Ge)?Dt:qe)},wheel:function(e){var t=this,a=Number(this.options.wheelZoomRatio)||.1,s=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?s=e.deltaY>0?1:-1:e.wheelDelta?s=-e.wheelDelta/120:e.detail&&(s=e.detail>0?1:-1),this.zoom(-s*a,e)))},cropStart:function(e){var t=e.buttons,a=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(O(t)&&t!==1||O(a)&&a!==0||e.ctrlKey))){var s=this.options,r=this.pointers,n;e.changedTouches?W(e.changedTouches,function(l){r[l.identifier]=Ue(l)}):r[e.pointerId||0]=Ue(e),Object.keys(r).length>1&&s.zoomable&&s.zoomOnTouch?n=xt:n=it(e.target,Se),!!pa.test(n)&&De(this.element,Qe,{originalEvent:e,action:n})!==!1&&(e.preventDefault(),this.action=n,this.cropping=!1,n===_t&&(this.cropping=!0,G(this.dragBox,Le)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var a=this.pointers;e.preventDefault(),De(this.element,Je,{originalEvent:e,action:t})!==!1&&(e.changedTouches?W(e.changedTouches,function(s){P(a[s.identifier]||{},Ue(s,!0))}):P(a[e.pointerId||0]||{},Ue(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,a=this.pointers;e.changedTouches?W(e.changedTouches,function(s){delete a[s.identifier]}):delete a[e.pointerId||0],!!t&&(e.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,ke(this.dragBox,Le,this.cropped&&this.options.modal)),De(this.element,Ze,{originalEvent:e,action:t}))}}},ja={change:function(e){var t=this.options,a=this.canvasData,s=this.containerData,r=this.cropBoxData,n=this.pointers,l=this.action,u=t.aspectRatio,h=r.left,d=r.top,c=r.width,p=r.height,D=h+c,C=d+p,T=0,N=0,S=s.width,y=s.height,I=!0,L;!u&&e.shiftKey&&(u=c&&p?c/p:1),this.limited&&(T=r.minLeft,N=r.minTop,S=T+Math.min(s.width,a.width,a.left+a.width),y=N+Math.min(s.height,a.height,a.top+a.height));var z=n[Object.keys(n)[0]],f={x:z.endX-z.startX,y:z.endY-z.startY},M=function(F){switch(F){case ge:D+f.x>S&&(f.x=S-D);break;case ve:h+f.x<T&&(f.x=T-h);break;case he:d+f.y<N&&(f.y=N-d);break;case ye:C+f.y>y&&(f.y=y-C);break}};switch(l){case Xe:h+=f.x,d+=f.y;break;case ge:if(f.x>=0&&(D>=S||u&&(d<=N||C>=y))){I=!1;break}M(ge),c+=f.x,c<0&&(l=ve,c=-c,h-=c),u&&(p=c/u,d+=(r.height-p)/2);break;case he:if(f.y<=0&&(d<=N||u&&(h<=T||D>=S))){I=!1;break}M(he),p-=f.y,d+=f.y,p<0&&(l=ye,p=-p,d-=p),u&&(c=p*u,h+=(r.width-c)/2);break;case ve:if(f.x<=0&&(h<=T||u&&(d<=N||C>=y))){I=!1;break}M(ve),c-=f.x,h+=f.x,c<0&&(l=ge,c=-c,h-=c),u&&(p=c/u,d+=(r.height-p)/2);break;case ye:if(f.y>=0&&(C>=y||u&&(h<=T||D>=S))){I=!1;break}M(ye),p+=f.y,p<0&&(l=he,p=-p,d-=p),u&&(c=p*u,h+=(r.width-c)/2);break;case Ce:if(u){if(f.y<=0&&(d<=N||D>=S)){I=!1;break}M(he),p-=f.y,d+=f.y,c=p*u}else M(he),M(ge),f.x>=0?D<S?c+=f.x:f.y<=0&&d<=N&&(I=!1):c+=f.x,f.y<=0?d>N&&(p-=f.y,d+=f.y):(p-=f.y,d+=f.y);c<0&&p<0?(l=Ne,p=-p,c=-c,d-=p,h-=c):c<0?(l=Me,c=-c,h-=c):p<0&&(l=Ee,p=-p,d-=p);break;case Me:if(u){if(f.y<=0&&(d<=N||h<=T)){I=!1;break}M(he),p-=f.y,d+=f.y,c=p*u,h+=r.width-c}else M(he),M(ve),f.x<=0?h>T?(c-=f.x,h+=f.x):f.y<=0&&d<=N&&(I=!1):(c-=f.x,h+=f.x),f.y<=0?d>N&&(p-=f.y,d+=f.y):(p-=f.y,d+=f.y);c<0&&p<0?(l=Ee,p=-p,c=-c,d-=p,h-=c):c<0?(l=Ce,c=-c,h-=c):p<0&&(l=Ne,p=-p,d-=p);break;case Ne:if(u){if(f.x<=0&&(h<=T||C>=y)){I=!1;break}M(ve),c-=f.x,h+=f.x,p=c/u}else M(ye),M(ve),f.x<=0?h>T?(c-=f.x,h+=f.x):f.y>=0&&C>=y&&(I=!1):(c-=f.x,h+=f.x),f.y>=0?C<y&&(p+=f.y):p+=f.y;c<0&&p<0?(l=Ce,p=-p,c=-c,d-=p,h-=c):c<0?(l=Ee,c=-c,h-=c):p<0&&(l=Me,p=-p,d-=p);break;case Ee:if(u){if(f.x>=0&&(D>=S||C>=y)){I=!1;break}M(ge),c+=f.x,p=c/u}else M(ye),M(ge),f.x>=0?D<S?c+=f.x:f.y>=0&&C>=y&&(I=!1):c+=f.x,f.y>=0?C<y&&(p+=f.y):p+=f.y;c<0&&p<0?(l=Me,p=-p,c=-c,d-=p,h-=c):c<0?(l=Ne,c=-c,h-=c):p<0&&(l=Ce,p=-p,d-=p);break;case yt:this.move(f.x,f.y),I=!1;break;case xt:this.zoom(Ea(n),e),I=!1;break;case _t:if(!f.x||!f.y){I=!1;break}L=jt(this.cropper),h=z.startX-L.left,d=z.startY-L.top,c=r.minWidth,p=r.minHeight,f.x>0?l=f.y>0?Ee:Ce:f.x<0&&(h-=c,l=f.y>0?Ne:Me),f.y<0&&(d-=p),this.cropped||(ne(this.cropBox,Z),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}I&&(r.width=c,r.height=p,r.left=h,r.top=d,this.action=l,this.renderCropBox()),W(n,function(U){U.startX=U.endX,U.startY=U.endY})}},Ha={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&G(this.dragBox,Le),ne(this.cropBox,Z),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=P({},this.initialImageData),this.canvasData=P({},this.initialCanvasData),this.cropBoxData=P({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(P(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ne(this.dragBox,Le),G(this.cropBox,Z)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,W(this.previews,function(a){a.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ne(this.cropper,wt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,G(this.cropper,wt)),this},destroy:function(){var e=this.element;return e[$]?(e[$]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,s=a.left,r=a.top;return this.moveTo(tt(e)?e:s+Number(e),tt(t)?t:r+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(O(e)&&(a.left=e,s=!0),O(t)&&(a.top=t,s=!0),s&&this.renderCanvas(!0)),this},zoom:function(e,t){var a=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(a.width*e/a.naturalWidth,null,t)},zoomTo:function(e,t,a){var s=this.options,r=this.canvasData,n=r.width,l=r.height,u=r.naturalWidth,h=r.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&s.zoomable){var d=u*e,c=h*e;if(De(this.element,et,{ratio:e,oldRatio:n/u,originalEvent:a})===!1)return this;if(a){var p=this.pointers,D=jt(this.cropper),C=p&&Object.keys(p).length?Na(p):{pageX:a.pageX,pageY:a.pageY};r.left-=(d-n)*((C.pageX-D.left-r.left)/n),r.top-=(c-l)*((C.pageY-D.top-r.top)/l)}else xe(t)&&O(t.x)&&O(t.y)?(r.left-=(d-n)*((t.x-r.left)/n),r.top-=(c-l)*((t.y-r.top)/l)):(r.left-=(d-n)/2,r.top-=(c-l)/2);r.width=d,r.height=c,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),O(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,O(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(O(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.imageData,s=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(O(e)&&(a.scaleX=e,s=!0),O(t)&&(a.scaleY=t,s=!0),s&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,a=this.imageData,s=this.canvasData,r=this.cropBoxData,n;if(this.ready&&this.cropped){n={x:r.left-s.left,y:r.top-s.top,width:r.width,height:r.height};var l=a.width/a.naturalWidth;if(W(n,function(d,c){n[c]=d/l}),e){var u=Math.round(n.y+n.height),h=Math.round(n.x+n.width);n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=h-n.x,n.height=u-n.y}}else n={x:0,y:0,width:0,height:0};return t.rotatable&&(n.rotate=a.rotate||0),t.scalable&&(n.scaleX=a.scaleX||1,n.scaleY=a.scaleY||1),n},setData:function(e){var t=this.options,a=this.imageData,s=this.canvasData,r={};if(this.ready&&!this.disabled&&xe(e)){var n=!1;t.rotatable&&O(e.rotate)&&e.rotate!==a.rotate&&(a.rotate=e.rotate,n=!0),t.scalable&&(O(e.scaleX)&&e.scaleX!==a.scaleX&&(a.scaleX=e.scaleX,n=!0),O(e.scaleY)&&e.scaleY!==a.scaleY&&(a.scaleY=e.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var l=a.width/a.naturalWidth;O(e.x)&&(r.left=e.x*l+s.left),O(e.y)&&(r.top=e.y*l+s.top),O(e.width)&&(r.width=e.width*l),O(e.height)&&(r.height=e.height*l),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?P({},this.containerData):{}},getImageData:function(){return this.sized?P({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&W(["left","top","width","height","naturalWidth","naturalHeight"],function(a){t[a]=e[a]}),t},setCanvasData:function(e){var t=this.canvasData,a=t.aspectRatio;return this.ready&&!this.disabled&&xe(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)?(t.width=e.width,t.height=e.width/a):O(e.height)&&(t.height=e.height,t.width=e.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,a=this.options.aspectRatio,s,r;return this.ready&&this.cropped&&!this.disabled&&xe(e)&&(O(e.left)&&(t.left=e.left),O(e.top)&&(t.top=e.top),O(e.width)&&e.width!==t.width&&(s=!0,t.width=e.width),O(e.height)&&e.height!==t.height&&(r=!0,t.height=e.height),a&&(s?t.height=t.width/a:r&&(t.width=t.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,a=Oa(this.image,this.imageData,t,e);if(!this.cropped)return a;var s=this.getData(e.rounded),r=s.x,n=s.y,l=s.width,u=s.height,h=a.width/Math.floor(t.naturalWidth);h!==1&&(r*=h,n*=h,l*=h,u*=h);var d=l/u,c=fe({aspectRatio:d,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),p=fe({aspectRatio:d,width:e.minWidth||0,height:e.minHeight||0},"cover"),D=fe({aspectRatio:d,width:e.width||(h!==1?a.width:l),height:e.height||(h!==1?a.height:u)}),C=D.width,T=D.height;C=Math.min(c.width,Math.max(p.width,C)),T=Math.min(c.height,Math.max(p.height,T));var N=document.createElement("canvas"),S=N.getContext("2d");N.width=we(C),N.height=we(T),S.fillStyle=e.fillColor||"transparent",S.fillRect(0,0,C,T);var y=e.imageSmoothingEnabled,I=y===void 0?!0:y,L=e.imageSmoothingQuality;S.imageSmoothingEnabled=I,L&&(S.imageSmoothingQuality=L);var z=a.width,f=a.height,M=r,U=n,F,Q,ae,ee,ie,K;M<=-l||M>z?(M=0,F=0,ae=0,ie=0):M<=0?(ae=-M,M=0,F=Math.min(z,l+M),ie=F):M<=z&&(ae=0,F=Math.min(l,z-M),ie=F),F<=0||U<=-u||U>f?(U=0,Q=0,ee=0,K=0):U<=0?(ee=-U,U=0,Q=Math.min(f,u+U),K=Q):U<=f&&(ee=0,Q=Math.min(u,f-U),K=Q);var V=[M,U,F,Q];if(ie>0&&K>0){var te=C/l;V.push(ae*te,ee*te,ie*te,K*te)}return S.drawImage.apply(S,[a].concat(bt(V.map(function(ce){return Math.floor(we(ce))})))),N},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!tt(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,a=this.dragBox,s=this.face;if(this.ready&&!this.disabled){var r=e===qe,n=t.movable&&e===Dt;e=r||n?e:Ct,t.dragMode=e,Oe(a,Se,e),ke(a,Ge,r),ke(a,Fe,n),t.cropBoxMovable||(Oe(s,Se,e),ke(s,Ge,r),ke(s,Fe,n))}return this}},Wa=se.Cropper,Vt=function(){function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(aa(this,i),!e||!ga.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=P({},Lt,xe(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return ia(i,[{key:"init",value:function(){var t=this.element,a=t.tagName.toLowerCase(),s;if(!t[$]){if(t[$]=this,a==="img"){if(this.isImg=!0,s=t.getAttribute("src")||"",this.originalUrl=s,!s)return;s=t.src}else a==="canvas"&&window.HTMLCanvasElement&&(s=t.toDataURL());this.load(s)}}},{key:"load",value:function(t){var a=this;if(!!t){this.url=t,this.imageData={};var s=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if(fa.test(t)){ma.test(t)?this.read(Aa(t)):this.clone();return}var n=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=l,n.onerror=l,n.ontimeout=l,n.onprogress=function(){n.getResponseHeader("content-type")!==At&&n.abort()},n.onload=function(){a.read(n.response)},n.onloadend=function(){a.reloading=!1,a.xhr=null},r.checkCrossOrigin&&Ht(t)&&s.crossOrigin&&(t=Wt(t)),n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=s.crossOrigin==="use-credentials",n.send()}}},{key:"read",value:function(t){var a=this.options,s=this.imageData,r=Ia(t),n=0,l=1,u=1;if(r>1){this.url=Ba(t,At);var h=La(r);n=h.rotate,l=h.scaleX,u=h.scaleY}a.rotatable&&(s.rotate=n),a.scalable&&(s.scaleX=l,s.scaleY=u),this.clone()}},{key:"clone",value:function(){var t=this.element,a=this.url,s=t.crossOrigin,r=a;this.options.checkCrossOrigin&&Ht(a)&&(s||(s="anonymous"),r=Wt(a)),this.crossOrigin=s,this.crossOriginUrl=r;var n=document.createElement("img");s&&(n.crossOrigin=s),n.src=r||a,n.alt=t.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),G(n,kt),t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function(){var t=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var s=se.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(se.navigator.userAgent),r=function(h,d){P(t.imageData,{naturalWidth:h,naturalHeight:d,aspectRatio:h/d}),t.initialImageData=P({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(a.naturalWidth&&!s){r(a.naturalWidth,a.naturalHeight);return}var n=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){r(n.width,n.height),s||l.removeChild(n)},n.src=a.src,s||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(n))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,a=this.options,s=this.image,r=t.parentNode,n=document.createElement("div");n.innerHTML=va;var l=n.querySelector(".".concat($,"-container")),u=l.querySelector(".".concat($,"-canvas")),h=l.querySelector(".".concat($,"-drag-box")),d=l.querySelector(".".concat($,"-crop-box")),c=d.querySelector(".".concat($,"-face"));this.container=r,this.cropper=l,this.canvas=u,this.dragBox=h,this.cropBox=d,this.viewBox=l.querySelector(".".concat($,"-view-box")),this.face=c,u.appendChild(s),G(t,Z),r.insertBefore(l,t.nextSibling),ne(s,kt),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,G(d,Z),a.guides||G(d.getElementsByClassName("".concat($,"-dashed")),Z),a.center||G(d.getElementsByClassName("".concat($,"-center")),Z),a.background&&G(l,"".concat($,"-bg")),a.highlight||G(c,da),a.cropBoxMovable&&(G(c,Fe),Oe(c,Se,Xe)),a.cropBoxResizable||(G(d.getElementsByClassName("".concat($,"-line")),Z),G(d.getElementsByClassName("".concat($,"-point")),Z)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),J(a.ready)&&re(t,Ot,a.ready,{once:!0}),De(t,Ot)}}},{key:"unbuild",value:function(){if(!!this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),ne(this.element,Z)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Wa,i}},{key:"setDefaults",value:function(t){P(Lt,xe(t)&&t)}}])}();P(Vt.prototype,za,Ua,$a,Pa,ja,Ha);var Ya=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Vt}),Va=st(Ya);Object.defineProperty(pt,"__esModule",{value:!0});var Xt=ea,Xa=Va,Ga=Fa(Xa);function Fa(i){return i&&i.__esModule?i:{default:i}}function qa(i,e){var t={};for(var a in i)e.indexOf(a)>=0||!Object.prototype.hasOwnProperty.call(i,a)||(t[a]=i[a]);return t}var Ka=typeof window=="undefined"?[String,Array]:[String,Array,Element,NodeList],Za=pt.default={render:function(){var e=this.crossorigin||void 0;return(0,Xt.h)("div",{style:this.containerStyle},[(0,Xt.h)("img",{ref:"img",src:this.src,alt:this.alt||"image",style:[{"max-width":"100%"},this.imgStyle],crossorigin:e})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:Ka,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var e=this.$options.props;e.containerStyle,e.src,e.alt,e.imgStyle;var t=qa(e,["containerStyle","src","alt","imgStyle"]),a={};for(var s in t)this[s]!==void 0&&(a[s]=this[s]);this.cropper=new Ga.default(this.$refs.img,a)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(e,t)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(e,t){return this.cropper.move(e,t)},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.moveTo(e,t)},relativeZoom:function(e,t){return this.cropper.zoom(e,t)},zoomTo:function(e,t){return this.cropper.zoomTo(e,t)},rotate:function(e){return this.cropper.rotate(e)},rotateTo:function(e){return this.cropper.rotateTo(e)},scaleX:function(e){return this.cropper.scaleX(e)},scaleY:function(e){return this.cropper.scaleY(e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.scale(e,t)},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(e)},setData:function(e){return this.cropper.setData(e)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(e){return this.cropper.setCanvasData(e)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(e){return this.cropper.setCropBoxData(e)},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(e)},setAspectRatio:function(e){return this.cropper.setAspectRatio(e)},setDragMode:function(e){return this.cropper.setDragMode(e)}}};const q=i=>(dt("data-v-21bd5e75"),i=i(),ct(),i),Ja={class:"flex items-start space-x-8"},Qa={class:"flex-shrink-0"},ei=q(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Profile Image",-1)),ti={class:"relative"},ai={class:"w-24 h-24 rounded-full border-2 border-white shadow-md overflow-hidden bg-gray-100"},ii=["src","alt"],ri={key:0,class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center"},oi=q(()=>o("div",{class:"spinner-small !w-6 !h-6 !border-2"},null,-1)),si=[oi],ni={class:"flex-1"},li={class:"space-y-4"},di=q(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload New Image",-1)),ci={class:"flex flex-col sm:flex-row gap-3 max-w-md"},ui=["disabled"],hi=q(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),pi=q(()=>o("span",null,"Choose File",-1)),fi=[hi,pi],mi=["disabled"],gi=q(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),vi=q(()=>o("span",null,"Take Photo",-1)),bi=[gi,vi],_i={key:0,class:"mt-3 max-w-md p-3 bg-blue-50 rounded-md border border-blue-200"},yi={class:"text-sm text-blue-700 flex items-center space-x-2"},xi=q(()=>o("svg",{class:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),wi={class:"truncate"},ki={class:"text-xs text-blue-600 mt-1"},Di={key:0,class:"flex space-x-3 max-w-md"},Ci=["disabled"],Mi={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ei=q(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Ni=[Ei],Si={key:1,class:"fixed inset-0 bg-black bg-opacity-90 flex flex-col items-center justify-center z-50 p-4"},Oi={class:"bg-white rounded-lg p-6 max-w-lg w-full"},Ti=q(()=>o("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Take Photo",-1)),Ri={class:"relative bg-gray-100 rounded-lg overflow-hidden"},Ai=q(()=>o("svg",{class:"w-8 h-8 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),Bi=[Ai],Ii={key:2,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"},Li={class:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[95vh] overflow-hidden flex flex-col"},zi={class:"text-lg font-semibold text-gray-800 mb-4 flex-shrink-0"},Ui={class:"flex-1 min-h-0 bg-gray-100 rounded-lg p-4 overflow-hidden"},$i={class:"flex-shrink-0 mt-4"},Pi={class:"flex justify-center items-center space-x-4 mb-4"},ji=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Hi=q(()=>o("span",{class:"text-sm"},"Rotate Left",-1)),Wi=[ji,Hi],Yi=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Vi=q(()=>o("span",{class:"text-sm"},"Rotate Right",-1)),Xi=[Yi,Vi],Gi=q(()=>o("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),Fi=q(()=>o("span",{class:"text-sm"},"Reset",-1)),qi=[Gi,Fi],Ki={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},Zi={props:{studentId:{type:String,required:!0},currentImage:{type:String,default:""},studentName:{type:String,default:""}},emits:["image-updated","error","success"],setup(i,{emit:e}){const t=i,a=B(!1),s=B(null),r=B(null),n=B(""),l=B(!1),u=B(!1),h=B(""),d=B(""),c=B(null),p=B(null),D=B(null),C=B(null),T=m=>!m||m==="null"||m===""?"/assets/alummah/images/default-student.png":m.startsWith("data:")?m:/^[A-Za-z0-9+/=]+$/.test(m)?`data:image/jpeg;base64,${m}`:m,N=Be(()=>n.value?n.value:t.currentImage?T(t.currentImage):"/assets/alummah/images/default-student.png"),S=_e({url:"school.al_ummah.api2.update_student_profile_image",auto:!1,onSuccess(m){a.value=!1,console.log("\u{1F7E2} Upload response details:",{status:m.status,message:m.message,image_url:m.image_url,full_response:m}),m.status==="success"?(console.log("\u2705 Upload successful, updating UI with image:",m.image_url),e("image-updated",m.image_url),e("success",m.message||"Profile image updated successfully!"),te(),setTimeout(()=>{window.location.reload()},1e3)):(console.error("\u274C Upload failed:",m.message),e("error",m.message||"Upload failed"))},onError(m){a.value=!1,console.error("\u{1F534} Upload error:",m),e("error",m.message||"Upload error occurred")}}),y=()=>{var m;return(m=p.value)==null?void 0:m.click()},I=m=>{const E=m.target.files[0];if(!E)return;if(!E.type.startsWith("image/"))return e("error","Select an image");if(E.size>5*1024*1024)return e("error","Image < 5 MB");s.value=E;const j=new FileReader;j.onload=le=>{h.value=le.target.result,d.value="file",u.value=!0},j.readAsDataURL(E)},L=()=>Ae(this,null,function*(){u.value=!1,l.value=!0;try{c.value=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),D.value&&(D.value.srcObject=c.value)}catch(m){e("error","Camera access denied"),l.value=!1}}),z=()=>{if(!D.value)return;const m=document.createElement("canvas"),E=D.value;m.width=E.videoWidth,m.height=E.videoHeight,m.getContext("2d").drawImage(E,0,0),h.value=m.toDataURL("image/jpeg",.8),d.value="camera",u.value=!0,f()},f=()=>{c.value&&c.value.getTracks().forEach(m=>m.stop()),c.value=null,l.value=!1},M=m=>{var E;return(E=C.value)==null?void 0:E.rotate(m)},U=()=>{var m;return(m=C.value)==null?void 0:m.reset()},F=()=>{if(!!C.value)try{const m=C.value.getCroppedCanvas();if(!m)throw new Error("Canvas is null - cannot crop image");if(typeof m.toBlob!="function"){const E=m.toDataURL("image/jpeg",.85),j=Q(E);ae(j);return}m.toBlob(E=>{ae(E)},"image/jpeg",.85)}catch(m){console.error("Error applying crop:",m),e("error","Failed to crop image. Please try again.")}},Q=m=>{const E=m.split(","),j=E[0].match(/:(.*?);/)[1],le=atob(E[1]);let de=le.length;const me=new Uint8Array(de);for(;de--;)me[de]=le.charCodeAt(de);return new Blob([me],{type:j})},ae=m=>{const E=new FileReader;E.onload=j=>{n.value=j.target.result,r.value=j.target.result,d.value==="file"&&s.value&&(s.value=new File([m],s.value.name,{type:"image/jpeg",lastModified:Date.now()}))},E.readAsDataURL(m),u.value=!1,e("success",'Cropped \u2013 click "Update Profile Image" to save.')},ee=()=>{u.value=!1,h.value="",s.value=null,p.value&&(p.value.value=""),d.value==="camera"&&L()},ie=()=>{let m="";if(s.value){const E=new FileReader;E.onload=j=>{m=j.target.result,K(m)},E.readAsDataURL(s.value)}else if(r.value)m=r.value,K(m);else{e("error","No image selected");return}},K=m=>{a.value=!0;let E=m;if(m.startsWith("data:")){const j=m.indexOf(",");j!==-1&&(E=m.substring(j+1))}console.log("Uploading image data:",{studentId:t.studentId,dataLength:E.length,startsWith:E.substring(0,20)+"..."}),S.fetch({student_id:t.studentId,base64_image:E})},V=()=>te(),te=()=>{s.value=null,r.value=null,n.value="",u.value=!1,h.value="",p.value&&(p.value.value=""),f()},ce=m=>{console.warn("Image failed to load, using default image"),m.target.src="/assets/alummah/images/default-student.png"};return Ft(()=>t.currentImage,(m,E)=>{m!==E&&(console.log("StudentProfileImage: currentImage prop changed",{hasNewImage:!!m,isBase64:m&&!m.startsWith("data:")&&!m.startsWith("/"),length:m==null?void 0:m.length}),m&&!n.value&&(n.value=""))}),(m,E)=>(w(),k("div",null,[o("div",Ja,[o("div",Qa,[ei,o("div",ti,[o("div",ai,[o("img",{src:b(N),alt:i.studentName,class:"w-full h-full object-cover",onError:ce},null,40,ii)]),a.value?(w(),k("div",ri,si)):R("",!0)])]),o("div",ni,[o("div",li,[o("div",null,[di,o("div",ci,[o("input",{type:"file",ref_key:"fileInput",ref:p,accept:"image/*",onChange:I,class:"hidden"},null,544),o("button",{type:"button",onClick:y,disabled:a.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 flex items-center space-x-2"},fi,8,ui),o("button",{type:"button",onClick:L,disabled:a.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},bi,8,mi)]),s.value&&!u.value?(w(),k("div",_i,[o("p",yi,[xi,o("span",wi,"Selected: "+Y(s.value.name),1)]),o("p",ki,"Size: "+Y((s.value.size/1024/1024).toFixed(2))+" MB",1)])):R("",!0)]),(s.value||r.value)&&!u.value?(w(),k("div",Di,[o("button",{type:"button",onClick:ie,disabled:a.value,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-purple-300 flex items-center space-x-2 flex-1"},[a.value?(w(),k("svg",Mi,Ni)):R("",!0),o("span",null,Y(a.value?"Uploading...":"Update Profile Image"),1)],8,Ci),o("button",{type:"button",onClick:V,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex-1"}," Cancel ")])):R("",!0)])])]),l.value?(w(),k("video",{key:0,ref_key:"videoEl",ref:D,autoplay:"",playsinline:"",class:"hidden"},null,512)):R("",!0),l.value&&!u.value?(w(),k("div",Si,[o("div",Oi,[Ti,o("div",Ri,[o("video",{ref_key:"videoEl",ref:D,autoplay:"",playsinline:"",class:"w-full h-64 object-cover"},null,512),o("div",{class:"absolute bottom-4 left-1/2 transform -translate-x-1/2"},[o("button",{type:"button",onClick:z,class:"w-16 h-16 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-100"},Bi)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:f,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])])):R("",!0),u.value?(w(),k("div",Ii,[o("div",Li,[o("h3",zi,Y(d.value==="camera"?"Crop Your Photo":"Crop Uploaded Image"),1),o("div",Ui,[lt(b(Za),{ref_key:"cropper",ref:C,src:h.value,"aspect-ratio":1,"view-mode":2,guides:!0,background:!1,"auto-crop-area":.8,"min-container-width":200,"min-container-height":200,class:"cropper-container h-full w-full max-h-[50vh]"},null,8,["src","auto-crop-area"])]),o("div",$i,[o("div",Pi,[o("button",{type:"button",onClick:E[0]||(E[0]=j=>M(-90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Left"},Wi),o("button",{type:"button",onClick:E[1]||(E[1]=j=>M(90)),class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Rotate Right"},Xi),o("button",{type:"button",onClick:U,class:"p-2 border rounded hover:bg-gray-100 flex items-center space-x-2",title:"Reset Crop"},qi)]),o("div",Ki,[o("button",{type:"button",onClick:ee,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 font-medium transition-colors"},Y(d.value==="camera"?"Retake Photo":"Choose Different File"),1),o("button",{type:"button",onClick:F,class:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium transition-colors"}," Apply Crop ")])])])])):R("",!0)]))}};var Ji=nt(Zi,[["__scopeId","data-v-21bd5e75"]]);const x=i=>(dt("data-v-318434fd"),i=i(),ct(),i),Qi={class:"min-h-screen bg-gray-50 p-4"},er={class:"fixed top-4 right-4 z-50 space-y-2 w-96 max-w-full"},tr={class:"flex items-start space-x-3"},ar=x(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),ir={class:"flex-1"},rr=x(()=>o("p",{class:"text-green-800 font-medium"},"Success",-1)),or={class:"text-green-700 text-sm mt-1"},sr={class:"flex items-start space-x-3"},nr=x(()=>o("div",{class:"flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),lr={class:"flex-1"},dr=x(()=>o("p",{class:"text-red-800 font-medium"},"Error",-1)),cr={class:"text-red-700 text-sm mt-1"},ur={class:"mb-6"},hr={class:"text-2xl font-bold text-gray-800"},pr={class:"text-sm text-gray-500 font-normal ml-2"},fr={key:0,class:"text-gray-600"},mr={key:0,class:"text-green-600 font-medium"},gr={key:1,class:"text-orange-600 font-medium"},vr={key:0,class:"flex justify-center items-center py-8"},br=x(()=>o("div",{class:"spinner"},null,-1)),_r=x(()=>o("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)),yr=[br,_r],xr={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},wr=x(()=>o("p",{class:"text-red-800"},"Failed to load settings. Using default permissions.",-1)),kr={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Dr=x(()=>o("p",{class:"text-red-800"},"Failed to load student details.",-1)),Cr={key:3,class:"bg-white rounded-lg shadow-sm p-6"},Mr=["onSubmit"],Er={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Nr={class:"md:col-span-2 lg:col-span-3"},Sr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student ID",-1)),Or=["value"],Tr=x(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student ID cannot be changed",-1)),Rr={class:"md:col-span-2 lg:col-span-3"},Ar=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Group",-1)),Br=["value"],Ir=x(()=>o("p",{class:"text-xs text-gray-500 mt-1"},"Student group cannot be changed",-1)),Lr={key:0,class:"md:col-span-2 lg:col-span-3"},zr=x(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Personal Details",-1)),Ur=[zr],$r={class:"md:col-span-2 lg:col-span-3"},Pr={key:1},jr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),Hr={key:2},Wr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Middle Name",-1)),Yr={key:3},Vr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),Xr={key:4},Gr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Date of Birth",-1)),Fr={key:5},qr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"GR Number",-1)),Kr={key:6},Zr=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Roll Number ",-1)),Jr={key:0,class:"text-red-600 text-xs mt-1"},Qr={key:1,class:"text-gray-500 text-xs mt-1"},eo={key:7,class:"md:col-span-2 lg:col-span-3 mt-4"},to=x(()=>o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Contact Information",-1)),ao=[to],io={key:8},ro=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address",-1)),oo={key:9},so=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),no={class:"mt-8 pt-6 border-t flex justify-between items-center"},lo={class:"flex space-x-3"},co=["disabled"],uo={key:0},ho={key:1},po=x(()=>o("div",{class:"md:col-span-2 lg:col-span-3 mt-8"},[o("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},[ut(" Guardian Management "),o("span",{class:"text-sm text-blue-600 font-normal ml-2"},"(Manage multiple guardians)")])],-1)),fo={class:"md:col-span-2 lg:col-span-3"},mo=x(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Add New Guardian",-1)),go={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},vo=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),bo=["disabled"],_o=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),yo=["disabled"],xo=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),wo=["disabled"],ko=x(()=>o("option",{value:"Mother"},"Mother",-1)),Do=x(()=>o("option",{value:"Father"},"Father",-1)),Co=x(()=>o("option",{value:"Others"},"Others",-1)),Mo=[ko,Do,Co],Eo={class:"mt-4 flex items-center justify-between"},No={key:0,class:"text-red-600 text-sm font-medium"},So={key:1,class:"text-gray-600 text-sm"},Oo=["disabled"],To={key:0},Ro={key:1},Ao={class:"md:col-span-2 lg:col-span-3"},Bo={class:"bg-white rounded-lg border border-gray-200 p-6"},Io=x(()=>o("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Existing Guardians",-1)),Lo={key:0,class:"flex justify-center py-4"},zo=x(()=>o("div",{class:"spinner-small"},null,-1)),Uo=x(()=>o("span",{class:"ml-2 text-gray-600"},"Loading guardians...",-1)),$o=[zo,Uo],Po={key:1,class:"text-center py-8 text-gray-500"},jo=x(()=>o("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1)),Ho=x(()=>o("p",null,"No guardians added yet.",-1)),Wo=[jo,Ho],Yo={key:2,class:"space-y-4"},Vo={class:"flex items-start justify-between"},Xo={class:"flex items-start space-x-3 flex-1"},Go=x(()=>o("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},[o("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),Fo={class:"flex-1 min-w-0"},qo={class:"flex items-center space-x-2 mb-1"},Ko={class:"font-medium text-gray-800 text-lg"},Zo={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},Jo={key:0,class:"space-y-2 text-sm text-gray-600"},Qo={class:"flex items-center space-x-4"},es={class:"flex items-center space-x-1"},ts=x(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),as=x(()=>o("span",{class:"text-gray-400"},"\u2022",-1)),is={class:"flex items-center space-x-1"},rs=x(()=>o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})],-1)),os={key:0,class:"flex items-center space-x-2 text-xs"},ss={key:0},ns={key:1,class:"text-gray-400"},ls={key:2},ds={key:1,class:"text-xs text-gray-500"},cs={key:1,class:"space-y-4 mt-4 p-4 bg-gray-50 rounded-lg"},us={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},hs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),ps=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),fs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),ms=x(()=>o("option",{value:"Mother"},"Mother",-1)),gs=x(()=>o("option",{value:"Father"},"Father",-1)),vs=x(()=>o("option",{value:"Others"},"Others",-1)),bs=[ms,gs,vs],_s=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date of Birth",-1)),ys=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),xs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Occupation",-1)),ws=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Designation",-1)),ks={class:"md:col-span-2"},Ds=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Work Address",-1)),Cs=x(()=>o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Education",-1)),Ms={class:"flex space-x-3 pt-4"},Es=["onClick","disabled"],Ns={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ss=x(()=>o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)),Os=[Ss],Ts=["onClick"],Rs=x(()=>o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),As=[Rs],Bs={class:"text-sm text-gray-600"},Is={key:0,class:"text-green-600"},Ls={key:1,class:"text-orange-600"},zs={setup(i){const e=Qt(),t=je({student:"",first_name:"",middle_name:"",last_name:"",student_date_of_birth:"",gr_number:"",email_address:"",phone_number:"",roll_number:""}),a=B(""),s=B(""),r=B(!0),n=B(!1),l=B(!1),u=B(""),h=B(""),d=B(""),c=B(""),p=B(""),D=B([]),C=B(null),T=B(!1),N=B(!1),S=je({guardian_name:"",phone_number:"",relation:"Mother"}),y=je({guardian_name:"",mobile_number:"",relation:"Mother",date_of_birth:"",email:"",occupation:"",designation:"",work_address:"",education:""}),I=B({allow_instructors_modify_student:0,session_expiry:"24:00"}),L=Be(()=>I.value.allow_instructors_modify_student===1),z=Be(()=>D.value.length>=3),f=Be(()=>{if(!e.query.studentData)return console.log("\u274C No studentData in route query"),"";try{const g=JSON.parse(decodeURIComponent(e.query.studentData)).base64profile||"";return console.log("\u{1F5BC}\uFE0F Image from route:",{exists:!!g,length:(g==null?void 0:g.length)||0,type:(g==null?void 0:g.startsWith("data:"))?"data-url":"base64-raw"}),g}catch(v){return console.error("Error parsing route image data:",v),""}}),M=v=>{h.value=v,d.value="",c.value="animate-slide-in-right"},U=v=>{d.value=v,h.value="",c.value="animate-slide-in-right"},F=()=>{c.value="animate-slide-out-right",setTimeout(()=>{h.value="",d.value="",c.value=""},300)},Q=v=>{console.log("\u{1F4F8} Image updated in StudentProfileImage:",v)},ae=_e({url:"school.al_ummah.api3.fetch_admin_settings",auto:!1,onSuccess(v){I.value=v,r.value=!1,n.value=!1},onError(){r.value=!1,n.value=!0,I.value={allow_instructors_modify_student:0,session_expiry:"24:00"}}}),ee=_e({url:"school.al_ummah.api2.get_student_details",auto:!1,onSuccess(v){v.student_info&&Object.assign(t,v.student_info),v.guardians&&Array.isArray(v.guardians)&&(D.value=v.guardians),p.value=""},onError(){p.value="Failed to load student details.",D.value=[]}}),ie=_e({url:"school.al_ummah.api2.update_student_details",auto:!1,onSuccess(v){l.value=!1,U(v.message||"Student updated successfully!")},onError(v){var _,A;l.value=!1;const g=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(g||"Update failed.")}}),K=_e({url:"school.al_ummah.api2.add_guardian_to_student",auto:!1,onSuccess(v){N.value=!1,U(v.message||"Guardian added!"),Re(),E()},onError(v){var _,A;N.value=!1;const g=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(g||"Failed to add guardian.")}}),V=_e({url:"school.al_ummah.api2.update_guardian_details",auto:!1,onSuccess(v){T.value=!1,U(v.message||"Guardian updated!"),C.value=null,j(),Re()},onError(v){var _,A;T.value=!1;const g=v._server_messages?(A=JSON.parse(((_=JSON.parse(v._server_messages.at(-1)))==null?void 0:_.message)||"{}"))==null?void 0:A.message:v.message;M(g||"Failed to update guardian.")}}),te=v=>/^[0-9]{10}$/.test(v),ce=v=>{[".",",","e","E","-"].includes(v.key)&&v.preventDefault()},m=()=>{const v=t.roll_number;if(!v&&v!==0)return u.value="";const g=Number(v);if(!Number.isInteger(g))return u.value="Must be a whole number";if(g<1)return u.value="Must be at least 1";if(g>999)return u.value="Cannot exceed 999";u.value=""},E=()=>{S.guardian_name="",S.phone_number="",S.relation="Mother"},j=()=>{Object.keys(y).forEach(v=>{y[v]=""}),y.relation="Mother"},le=()=>Ae(this,null,function*(){if(!S.guardian_name.trim())return M("Guardian name required");if(!te(S.phone_number))return M("Valid 10-digit phone required");N.value=!0,K.fetch({student_id:a.value,student_name:`${t.first_name} ${t.last_name}`.trim(),guardian_name:S.guardian_name,relation:S.relation,phone_number:S.phone_number})}),de=v=>{C.value=v.guardian,Object.assign(y,{guardian_name:v.guardian_name||"",mobile_number:v.mobile_number||"",relation:v.relation||"Mother",date_of_birth:v.date_of_birth||"",email:v.email||"",occupation:v.occupation||"",designation:v.designation||"",work_address:v.work_address||"",education:v.education||""})},me=()=>{C.value=null,j()},$e=v=>{if(!y.guardian_name.trim())return M("Guardian name required");if(!te(y.mobile_number))return M("Valid 10-digit phone required");T.value=!0,V.fetch({guardian_id:v,guardian_name:y.guardian_name,phone_number:y.mobile_number,relation:y.relation,guardian_date_of_birth:y.date_of_birth,guardian_email:y.email,occupation:y.occupation,designation:y.designation,work_address:y.work_address,education:y.education})},Pe=v=>Ae(this,null,function*(){var _;if(console.log("\u{1F6A8} updateStudent called",{eventType:v==null?void 0:v.type,target:(_=v==null?void 0:v.target)==null?void 0:_.tagName,timestamp:new Date().toISOString(),studentId:a.value}),v&&(v.preventDefault(),v.stopPropagation()),m(),u.value){M(u.value);return}l.value=!0;const g={student_id:a.value,student_group:s.value};L.value&&Object.assign(g,{first_name:t.first_name||"",middle_name:t.middle_name||"",last_name:t.last_name||"",student_date_of_birth:t.student_date_of_birth||"",gr_number:t.gr_number||"",email_address:t.email_address||"",phone_number:t.phone_number||"",roll_number:t.roll_number||""}),console.log("Sending update data:",g),yield ie.fetch(g)}),Re=()=>{!a.value||ee.fetch({student:a.value})},ot=()=>{r.value=!0,ae.fetch()};return qt(()=>{var v;if(a.value=e.query.studentId,e.query.studentData)try{const g=JSON.parse(decodeURIComponent(e.query.studentData));s.value=g.student_group||"",console.log("\u{1F3AF} Route data analysis:",{studentGroup:s.value,hasBase64profile:!!g.base64profile,base64profileLength:((v=g.base64profile)==null?void 0:v.length)||0,allKeys:Object.keys(g)})}catch(g){console.error("Error parsing student data:",g),M("Invalid student data")}ot(),Re()}),(v,g)=>(w(),k("div",Qi,[o("div",er,[d.value?(w(),k("div",{key:0,class:ue(["bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",c.value])},[o("div",tr,[ar,o("div",ir,[rr,o("p",or,Y(d.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:F,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium"}," OK ")])],2)):R("",!0),h.value?(w(),k("div",{key:1,class:ue(["bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",c.value])},[o("div",sr,[nr,o("div",lr,[dr,o("p",cr,Y(h.value),1)])]),o("div",{class:"mt-4 flex justify-end"},[o("button",{type:"button",onClick:F,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium"}," OK ")])],2)):R("",!0)]),o("div",ur,[o("h1",hr,[ut(" Edit Student: "+Y(b(t).student_name||a.value)+" ",1),o("span",pr,"(ID: "+Y(a.value)+")",1)]),r.value?R("",!0):(w(),k("p",fr,[b(L)?(w(),k("span",mr," \u2713 Full editing access enabled ")):(w(),k("span",gr," \u26A0 Limited editing access (Guardian fields only) "))]))]),b(ee).loading||r.value?(w(),k("div",vr,yr)):n.value?(w(),k("div",xr,[wr,o("button",{type:"button",onClick:ot,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):p.value?(w(),k("div",kr,[Dr,o("button",{type:"button",onClick:Re,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(w(),k("div",Cr,[o("form",{onSubmit:Jt(Pe,["prevent"])},[o("div",Er,[o("div",Nr,[Sr,o("input",{value:a.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Or),Tr]),o("div",Rr,[Ar,o("input",{value:s.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Br),Ir]),b(L)?(w(),k("div",Lr,Ur)):R("",!0),o("div",$r,[lt(Ji,{"student-id":a.value,"current-image":b(f),"student-name":b(t).student_name,onImageUpdated:Q,onSuccess:g[0]||(g[0]=_=>U(_)),onError:g[1]||(g[1]=_=>M(_))},null,8,["student-id","current-image","student-name"])]),b(L)?(w(),k("div",Pr,[jr,H(o("input",{"onUpdate:modelValue":g[2]||(g[2]=_=>b(t).first_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).first_name]])])):R("",!0),b(L)?(w(),k("div",Hr,[Wr,H(o("input",{"onUpdate:modelValue":g[3]||(g[3]=_=>b(t).middle_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).middle_name]])])):R("",!0),b(L)?(w(),k("div",Yr,[Vr,H(o("input",{"onUpdate:modelValue":g[4]||(g[4]=_=>b(t).last_name=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).last_name]])])):R("",!0),b(L)?(w(),k("div",Xr,[Gr,H(o("input",{"onUpdate:modelValue":g[5]||(g[5]=_=>b(t).student_date_of_birth=_),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).student_date_of_birth]])])):R("",!0),b(L)?(w(),k("div",Fr,[qr,H(o("input",{"onUpdate:modelValue":g[6]||(g[6]=_=>b(t).gr_number=_),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).gr_number]])])):R("",!0),b(L)?(w(),k("div",Kr,[Zr,H(o("input",{"onUpdate:modelValue":g[7]||(g[7]=_=>b(t).roll_number=_),type:"number",min:"1",max:"999",step:"1",placeholder:"Enter roll number",onKeypress:ce,onInput:m,class:ue(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",u.value?"border-red-300 bg-red-50":"border-gray-300"])},null,34),[[X,b(t).roll_number]]),u.value?(w(),k("p",Jr,Y(u.value),1)):(w(),k("p",Qr,"Must be a whole number between 1-999 (optional)"))])):R("",!0),b(L)?(w(),k("div",eo,ao)):R("",!0),b(L)?(w(),k("div",io,[ro,H(o("input",{"onUpdate:modelValue":g[8]||(g[8]=_=>b(t).email_address=_),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).email_address]])])):R("",!0),b(L)?(w(),k("div",oo,[so,H(o("input",{"onUpdate:modelValue":g[9]||(g[9]=_=>b(t).phone_number=_),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(t).phone_number]])])):R("",!0)]),o("div",no,[o("div",lo,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",onClick:g[10]||(g[10]=_=>v.$router.back())}," Cancel "),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:l.value},[l.value?(w(),k("span",uo,"Updating...")):(w(),k("span",ho,"Update Student"))],8,co)])]),po,o("div",fo,[o("div",{class:ue(["bg-gray-50 rounded-lg p-6 border-2 border-dashed mb-6 transition-all",b(z)?"border-gray-300 opacity-50":"border-blue-200 hover:border-blue-300"])},[mo,o("div",go,[o("div",null,[vo,H(o("input",{"onUpdate:modelValue":g[11]||(g[11]=_=>b(S).guardian_name=_),type:"text",placeholder:"Enter guardian name",disabled:b(z),class:ue(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,bo),[[X,b(S).guardian_name]])]),o("div",null,[_o,H(o("input",{"onUpdate:modelValue":g[12]||(g[12]=_=>b(S).phone_number=_),type:"tel",placeholder:"10-digit number",disabled:b(z),class:ue(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,yo),[[X,b(S).phone_number]])]),o("div",null,[xo,H(o("select",{"onUpdate:modelValue":g[13]||(g[13]=_=>b(S).relation=_),disabled:b(z),class:ue(["w-full px-3 py-2 border rounded-md",b(z)?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},Mo,10,wo),[[ht,b(S).relation]])])]),o("div",Eo,[o("div",null,[b(z)?(w(),k("p",No," \u274C Maximum of 3 guardians reached ")):(w(),k("p",So," Guardians added: "+Y(D.value.length)+"/3 ",1))]),o("button",{type:"button",onClick:le,disabled:b(z)||N.value,class:ue(["px-4 py-2 rounded-md flex items-center space-x-2 transition-colors",b(z)||N.value?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[N.value?(w(),k("span",To,"Adding...")):(w(),k("span",Ro,"Add Guardian"))],10,Oo)])],2)]),o("div",Ao,[o("div",Bo,[Io,b(ee).loading?(w(),k("div",Lo,$o)):D.value.length===0?(w(),k("div",Po,Wo)):(w(),k("div",Yo,[(w(!0),k(Kt,null,Zt(D.value,_=>(w(),k("div",{key:_.guardian,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[o("div",Vo,[o("div",Xo,[Go,o("div",Fo,[o("div",qo,[o("h5",Ko,Y(_.guardian_name),1),o("span",Zo,Y(_.relation),1)]),C.value!==_.guardian?(w(),k("div",Jo,[o("div",Qo,[o("span",es,[ts,o("span",null,Y(_.mobile_number||"No phone"),1)]),as,o("span",is,[rs,o("span",null,Y(_.email||"No email"),1)])]),_.occupation||_.designation?(w(),k("div",os,[_.occupation?(w(),k("span",ss,"\u{1F4BC} "+Y(_.occupation),1)):R("",!0),_.designation?(w(),k("span",ns,"\u2022")):R("",!0),_.designation?(w(),k("span",ls,"\u{1F3AF} "+Y(_.designation),1)):R("",!0)])):R("",!0),_.education?(w(),k("div",ds," \u{1F393} "+Y(_.education),1)):R("",!0)])):R("",!0),C.value===_.guardian?(w(),k("div",cs,[o("div",us,[o("div",null,[hs,H(o("input",{"onUpdate:modelValue":g[14]||(g[14]=A=>b(y).guardian_name=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).guardian_name]])]),o("div",null,[ps,H(o("input",{"onUpdate:modelValue":g[15]||(g[15]=A=>b(y).mobile_number=A),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).mobile_number]])]),o("div",null,[fs,H(o("select",{"onUpdate:modelValue":g[16]||(g[16]=A=>b(y).relation=A),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},bs,512),[[ht,b(y).relation]])]),o("div",null,[_s,H(o("input",{"onUpdate:modelValue":g[17]||(g[17]=A=>b(y).date_of_birth=A),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).date_of_birth]])]),o("div",null,[ys,H(o("input",{"onUpdate:modelValue":g[18]||(g[18]=A=>b(y).email=A),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).email]])]),o("div",null,[xs,H(o("input",{"onUpdate:modelValue":g[19]||(g[19]=A=>b(y).occupation=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).occupation]])]),o("div",null,[ws,H(o("input",{"onUpdate:modelValue":g[20]||(g[20]=A=>b(y).designation=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).designation]])]),o("div",ks,[Ds,H(o("textarea",{"onUpdate:modelValue":g[21]||(g[21]=A=>b(y).work_address=A),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).work_address]])]),o("div",null,[Cs,H(o("input",{"onUpdate:modelValue":g[22]||(g[22]=A=>b(y).education=A),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[X,b(y).education]])])]),o("div",Ms,[o("button",{type:"button",onClick:A=>$e(_.guardian),disabled:T.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2"},[T.value?(w(),k("svg",Ns,Os)):R("",!0),o("span",null,Y(T.value?"Updating...":"Update Guardian"),1)],8,Es),o("button",{type:"button",onClick:me,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])):R("",!0)])]),C.value!==_.guardian?(w(),k("button",{key:0,type:"button",onClick:A=>de(_),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit guardian details"},As,8,Ts)):R("",!0)])]))),128))]))])]),o("div",Bs,[b(L)?(w(),k("span",Is," \u2713 You have full editing permissions ")):(w(),k("span",Ls," \u26A0 You can only edit guardian information "))])],40,Mr)]))]))}};var Ps=nt(zs,[["__scopeId","data-v-318434fd"]]);export{Ps as default};
