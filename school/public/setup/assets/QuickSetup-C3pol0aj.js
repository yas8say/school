var ne=Object.defineProperty,le=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var se=(o,e,a)=>e in o?ne(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a,V=(o,e)=>{for(var a in e||(e={}))ue.call(e,a)&&se(o,a,e[a]);if(te)for(var a of te(e))ce.call(e,a)&&se(o,a,e[a]);return o},F=(o,e)=>le(o,de(e));var oe=(o,e,a)=>new Promise((i,c)=>{var r=n=>{try{l(a.next(n))}catch(b){c(b)}},s=n=>{try{l(a.throw(n))}catch(b){c(b)}},l=n=>n.done?i(n.value):Promise.resolve(n.value).then(r,s);l((a=a.apply(o,e)).next())});import{_ as O,o as d,a as u,b as t,x as h,y as C,z as q,F as S,l as w,t as f,h as T,r as y,A as M,j as ee,i as _,n as j,B as W,g as ie,c as X,d as me,C as pe,q as ge,v as ve,e as fe,f as be}from"./index-4saVcCb_.js";const he={props:{values:Object},computed:{email:{get(){return this.values.email},set(o){this.$emit("update-field",{field:"email",value:o})}},googleAppPassword:{get(){return this.values.googleAppPassword},set(o){this.$emit("update-field",{field:"googleAppPassword",value:o})}}},methods:{updateField(o,e){this.$emit("update-field",{field:o,value:e})}}},xe={class:"card"},ye={class:"field"},Ce={class:"field"};function Se(o,e,a,i,c,r){return d(),u("div",xe,[t("div",ye,[e[5]||(e[5]=t("label",null,"Email Address",-1)),h(t("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=s=>r.email=s),placeholder:"Enter your email address",onInput:e[1]||(e[1]=s=>r.updateField("email",s.target.value))},null,544),[[C,r.email]])]),t("div",Ce,[e[6]||(e[6]=t("label",null,"Google App Password",-1)),h(t("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=s=>r.googleAppPassword=s),placeholder:"Enter your Google app password",onInput:e[3]||(e[3]=s=>r.updateField("googleAppPassword",s.target.value))},null,544),[[C,r.googleAppPassword]])]),t("button",{onClick:e[4]||(e[4]=s=>o.$emit("submit-email"))},"Submit Email Account")])}const we=O(he,[["render",Se],["__scopeId","data-v-a1f91314"]]),_e={props:{values:Object},data(){return{selectedTerm:"",lastValidTermCount:0}},computed:{academicYear:{get(){return this.values.academicYear},set(o){this.$emit("update-field",{field:"academicYear",value:o})}},academicYearStart:{get(){return this.values.academicYearStart},set(o){this.$emit("update-field",{field:"academicYearStart",value:o})}},academicYearEnd:{get(){return this.values.academicYearEnd},set(o){this.$emit("update-field",{field:"academicYearEnd",value:o})}},numberOfTerms:{get(){return this.values.numberOfTerms},set(o){this.$emit("update-field",{field:"numberOfTerms",value:o})}}},methods:{handleNumberOfTermsChange(o){const e=parseInt(o.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.adjustTermsToMatchCount()):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.adjustTermsToMatchCount()},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.adjustTermsToMatchCount())},adjustTermsToMatchCount(){const o=this.values.terms.length,e=this.numberOfTerms;if(e>o){const a=e-o,i=[...this.values.terms];for(let c=0;c<a;c++){const r=o+c+1,{startDate:s,endDate:l}=this.calculateTermDates(r,e);i.push({name:`Term ${r}`,startDate:s,endDate:l})}this.$emit("update-field-array",{field:"terms",value:i})}else if(e<o){const a=o-e,i=[...this.values.terms];i.splice(-a,a),this.$emit("update-field-array",{field:"terms",value:i})}},calculateTermDates(o,e){if(!this.academicYearStart||!this.academicYearEnd)return{startDate:"",endDate:""};const a=new Date(this.academicYearStart),r=(new Date(this.academicYearEnd)-a)/e,s=new Date(a.getTime()+r*(o-1)),l=new Date(a.getTime()+r*o-1),n=b=>b.toISOString().split("T")[0];return{startDate:n(s),endDate:n(l)}},formatDate(o){if(!o)return"";const e={year:"numeric",month:"short",day:"numeric"};return new Date(o).toLocaleDateString(void 0,e)},updateField(o,e){this.$emit("update-field",{field:o,value:e})},updateTermField(o,e,a){this.$emit("update-field-array",{field:"terms",index:o,subField:e,value:a})},addTerm(){const o={name:"",startDate:"",endDate:""};this.$emit("update-field-array",{field:"terms",value:[...this.values.terms,o]}),this.numberOfTerms=this.values.terms.length},removeTerm(o){const e=[...this.values.terms];e.splice(o,1),this.$emit("update-field-array",{field:"terms",value:e}),this.numberOfTerms=e.length},handleTermsInput(o){const e=parseInt(o.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.$emit("auto-create-terms")):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.$emit("auto-create-terms")},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.$emit("auto-create-terms"))}},mounted(){this.lastValidTermCount=this.numberOfTerms||1}},De={class:"academic-year-form"},Te={class:"form-grid"},ke={class:"form-row"},je={class:"form-group full-width"},Pe={class:"form-row date-range-row"},Ae={class:"form-group"},Ne={class:"form-group"},Oe={class:"form-row"},Ge={class:"form-group full-width"},Ue={class:"number-input-group"},Ee={class:"number-input-buttons"},Ve=["disabled"],Fe={class:"form-row"},Me={class:"form-group full-width"},Le=["value"],Ye={class:"terms-list"},Ie={class:"term-header"},Be={class:"term-title"},Re=["onClick"],$e={class:"term-body"},We={class:"form-group"},qe=["onUpdate:modelValue","placeholder","onInput"],Ke={class:"form-row term-dates-row"},He={class:"form-group"},ze=["onUpdate:modelValue","onInput"],Je={class:"form-group"},Qe=["onUpdate:modelValue","onInput"],Ze={class:"form-actions"};function Xe(o,e,a,i,c,r){return d(),u("div",De,[e[23]||(e[23]=t("div",{class:"form-header"},[t("h3",{class:"form-title"},"Academic Year Setup"),t("p",{class:"form-subtitle"}," Provide details about the academic year, its duration, and terms. ")],-1)),t("div",Te,[t("div",ke,[t("div",je,[e[13]||(e[13]=t("label",{class:"form-label"},"Academic Year",-1)),h(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r.academicYear=s),class:"form-input",placeholder:"e.g., 2023-2024",onInput:e[1]||(e[1]=s=>r.updateField("academicYear",s.target.value))},null,544),[[C,r.academicYear]])])]),t("div",Pe,[t("div",Ae,[e[14]||(e[14]=t("label",{class:"form-label"},"Start Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>r.academicYearStart=s),class:"form-input",onInput:e[3]||(e[3]=s=>r.updateField("academicYearStart",s.target.value))},null,544),[[C,r.academicYearStart]])]),t("div",Ne,[e[15]||(e[15]=t("label",{class:"form-label"},"End Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=s=>r.academicYearEnd=s),class:"form-input",onInput:e[5]||(e[5]=s=>r.updateField("academicYearEnd",s.target.value))},null,544),[[C,r.academicYearEnd]])])]),t("div",Oe,[t("div",Ge,[e[16]||(e[16]=t("label",{class:"form-label"},"Number of Terms",-1)),t("div",Ue,[h(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>r.numberOfTerms=s),class:"form-input number-input",placeholder:"e.g., 3",min:"1",onInput:e[7]||(e[7]=(...s)=>r.handleNumberOfTermsChange&&r.handleNumberOfTermsChange(...s))},null,544),[[C,r.numberOfTerms,void 0,{number:!0}]]),t("div",Ee,[t("button",{class:"number-input-btn minus-btn",onClick:e[8]||(e[8]=(...s)=>r.decrementTerms&&r.decrementTerms(...s)),disabled:r.numberOfTerms<=1}," − ",8,Ve),t("button",{class:"number-input-btn plus-btn",onClick:e[9]||(e[9]=(...s)=>r.incrementTerms&&r.incrementTerms(...s))}," + ")])])])]),t("div",Fe,[t("div",Me,[e[18]||(e[18]=t("label",{class:"form-label"},"Current Academic Term",-1)),h(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>c.selectedTerm=s),class:"form-select",onChange:e[11]||(e[11]=s=>r.updateField("selectedTerm",s.target.value))},[e[17]||(e[17]=t("option",{value:""},"-- Select a Term --",-1)),(d(!0),u(S,null,w(a.values.terms,(s,l)=>(d(),u("option",{key:l,value:s.name},f(s.name)+" ("+f(r.formatDate(s.startDate))+" - "+f(r.formatDate(s.endDate))+") ",9,Le))),128))],544),[[q,c.selectedTerm]])])])]),t("div",Ye,[(d(!0),u(S,null,w(a.values.terms,(s,l)=>(d(),u("div",{key:l,class:"term-card"},[t("div",Ie,[t("h4",Be,"Term "+f(l+1),1),t("button",{class:"btn-icon",onClick:n=>r.removeTerm(l),title:"Remove term"}," ✕ ",8,Re)]),t("div",$e,[t("div",We,[e[19]||(e[19]=t("label",{class:"form-label"},"Term Name",-1)),h(t("input",{type:"text","onUpdate:modelValue":n=>s.name=n,class:"form-input",placeholder:`e.g., Spring ${l+1}`,onInput:n=>r.updateTermField(l,"name",n.target.value)},null,40,qe),[[C,s.name]])]),t("div",Ke,[t("div",He,[e[20]||(e[20]=t("label",{class:"form-label"},"Start Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":n=>s.startDate=n,class:"form-input",onInput:n=>r.updateTermField(l,"startDate",n.target.value)},null,40,ze),[[C,s.startDate]])]),t("div",Je,[e[21]||(e[21]=t("label",{class:"form-label"},"End Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":n=>s.endDate=n,class:"form-input",onInput:n=>r.updateTermField(l,"endDate",n.target.value)},null,40,Qe),[[C,s.endDate]])])])])]))),128))]),t("div",Ze,[t("button",{class:"btn btn-primary",onClick:e[12]||(e[12]=(...s)=>r.addTerm&&r.addTerm(...s))},e[22]||(e[22]=[t("span",{class:"icon"},"+",-1),T(" Add Term ")]))])])}const et=O(_e,[["render",Xe],["__scopeId","data-v-401732b4"]]),tt={props:{values:Object,previousDataList:Array},emits:["update-field","use-previous-data"],setup(o,{emit:e}){const a=y(null),i=y(o.values.dontCreateClasses||!1),c=y(!1),r=y(""),s=M({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:b=>{console.log("Previous data loaded successfully")},onError:b=>{console.error("Error fetching previous data:",b)}}),l=()=>{if(!a.value){console.warn("No data selected");return}e("use-previous-data",a.value),r.value=a.value.academicYear,c.value=!0,setTimeout(()=>{c.value=!1},5e3)},n=()=>{e("update-field",{field:"dontCreateClasses",value:i.value})};return ee(()=>{(!o.previousDataList||o.previousDataList.length===0)&&s.reload()}),{selectedPreviousData:a,dontCreateClasses:i,showSuccessMessage:c,usedPreviousYear:r,previousDataResource:s,handleUsePreviousData:l,updateDontCreateClasses:n}}},st={class:"card"},ot={key:0,class:"loading"},it={key:1},at={key:0,class:"success-message"},rt={class:"field"},nt=["value"],lt=["disabled"];function dt(o,e,a,i,c,r){return d(),u("div",st,[e[3]||(e[3]=t("h3",{class:"section-title"},"Use Previous Data",-1)),i.previousDataResource.loading?(d(),u("div",ot,"Loading previous data...")):(d(),u("div",it,[i.showSuccessMessage?(d(),u("div",at," ✓ Previous data from "+f(i.usedPreviousYear)+" has been successfully loaded ",1)):_("",!0),t("div",rt,[h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.selectedPreviousData=s)},[e[2]||(e[2]=t("option",{value:null},"Select a year",-1)),(d(!0),u(S,null,w(a.previousDataList,(s,l)=>(d(),u("option",{key:l,value:s},f(s.academicYear),9,nt))),128))],512),[[q,i.selectedPreviousData]])]),t("button",{onClick:e[1]||(e[1]=(...s)=>i.handleUsePreviousData&&i.handleUsePreviousData(...s)),disabled:!i.selectedPreviousData}," Use Previous Data ",8,lt)]))])}const ut=O(tt,[["render",dt],["__scopeId","data-v-b5328e59"]]),ct=[{id:1,name:"Pre-K"},{id:2,name:"Kindergarten"},{id:3,name:"1st Grade"},{id:4,name:"2nd Grade"},{id:5,name:"3rd Grade"},{id:6,name:"4th Grade"},{id:7,name:"5th Grade"},{id:8,name:"6th Grade"},{id:9,name:"7th Grade"},{id:10,name:"8th Grade"},{id:11,name:"9th Grade"},{id:12,name:"10th Grade"},{id:13,name:"11th Grade"},{id:14,name:"12th Grade"},{id:15,name:"Other"}],mt={school:["Nursery","Jr KG","Sr KG","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th"],college:["FY BSc","SY BSc","TY BSc","FY BCA","SY BCA","TY BCA","FY BTech","SY BTech","TY BTech","Final Year BTech","FY BCom","SY BCom","TY BCom","MBA"]},pt={props:{values:Object},data(){return{selectedInstitution:"",editablePrograms:[],availablePrograms:ct}},watch:{"values.classes":{immediate:!0,handler(o){o&&o.length>0&&(this.editablePrograms=[...o])}}},computed:{selectedPrograms(){return this.values.classes||[]}},methods:{isSelected(o){return this.selectedPrograms.some(e=>e.id===o.id)},toggleProgram(o){let e;this.isSelected(o)?e=this.selectedPrograms.filter(a=>a.id!==o.id):e=[...this.selectedPrograms,{id:o.id,className:o.name,subjects:[],divisions:[]}],this.updatePrograms(e)},handleEditProgram(o,e){const a=this.editablePrograms.map(i=>i.id===o?F(V({},i),{className:e}):i);this.updatePrograms(a)},handleDeleteProgram(o){const e=this.editablePrograms.filter(a=>a.id!==o);this.updatePrograms(e)},handleAddProgram(){const o={id:Math.random().toString(),className:"",subjects:[],divisions:[]},e=[...this.editablePrograms,o];this.updatePrograms(e)},handleInstitutionChange(){const o=(mt[this.selectedInstitution]||[]).map(e=>({id:Math.random().toString(),className:e,subjects:[],divisions:[]}));this.updatePrograms(o)},updatePrograms(o){this.editablePrograms=o,this.$emit("update-field-array",{field:"classes",value:o})}}},gt={class:"program-selector-container"},vt={class:"institution-selector"},ft={key:0,class:"programs-list"},bt=["onUpdate:modelValue","onInput"],ht=["onClick"],xt={key:1,class:"quick-select"},yt={class:"program-grid"},Ct=["onClick"];function St(o,e,a,i,c,r){return d(),u("div",gt,[t("div",vt,[e[4]||(e[4]=t("label",{class:"form-label"},"Select Institution Type",-1)),h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.selectedInstitution=s),class:"form-select",onChange:e[1]||(e[1]=(...s)=>r.handleInstitutionChange&&r.handleInstitutionChange(...s))},e[3]||(e[3]=[t("option",{value:""},"Select Institution",-1),t("option",{value:"school"},"School",-1),t("option",{value:"college"},"College",-1)]),544),[[q,c.selectedInstitution]])]),c.editablePrograms.length>0?(d(),u("div",ft,[e[6]||(e[6]=t("h3",{class:"section-title"},"Classes List",-1)),(d(!0),u(S,null,w(c.editablePrograms,s=>(d(),u("div",{key:s.id,class:"program-item"},[h(t("input",{type:"text","onUpdate:modelValue":l=>s.className=l,class:"program-input",onInput:l=>r.handleEditProgram(s.id,l.target.value)},null,40,bt),[[C,s.className]]),t("button",{class:"delete-btn",onClick:l=>r.handleDeleteProgram(s.id),title:"Remove class"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]),8,ht)]))),128))])):_("",!0),c.selectedInstitution===""?(d(),u("div",xt,[e[7]||(e[7]=t("h3",{class:"section-title"},"Quick Select Programs",-1)),t("div",yt,[(d(!0),u(S,null,w(c.availablePrograms,s=>(d(),u("div",{key:s.id,class:j(["program-card",{selected:r.isSelected(s)}]),onClick:l=>r.toggleProgram(s)},f(s.name),11,Ct))),128))])])):_("",!0),t("button",{class:"add-btn",onClick:e[2]||(e[2]=(...s)=>r.handleAddProgram&&r.handleAddProgram(...s))},e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),T(" Add Class ")]))])}const wt=O(pt,[["render",St],["__scopeId","data-v-f6b17094"]]),_t={props:{values:Object},data(){return{newCommonSubject:"",newCommonDivision:"",commonSubjectsList:[],commonDivisionsList:[],classesWithText:[],commonSubjects:["Math","Social Studies","Science","English","History","Geography","Physics","Chemistry","Biology","Computer","Civics","Hindi","Marathi","Arabic","Play"],commonDivisions:["A","B","C","D","E","F"]}},created(){this.values.commonSubjects&&(this.commonSubjectsList=[...this.values.commonSubjects]),this.values.commonDivisions&&(this.commonDivisionsList=[...this.values.commonDivisions])},watch:{"values.classes":{immediate:!0,deep:!0,handler(o){this.classesWithText=o.map(e=>F(V({},e),{subjectsText:"",divisionsText:"",specificSubjects:e.subjects?e.subjects.filter(a=>!this.commonSubjectsList.includes(a)):[],specificDivisions:e.divisions?e.divisions.filter(a=>{const i=a.divisionName.split("-").slice(1).join("-");return!this.commonDivisionsList.includes(i)}):[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}))}},commonSubjectsList:{handler(o){this.$emit("update-field",{field:"commonSubjects",value:o}),this.updateAllClassesWithCommonData()},deep:!0},commonDivisionsList:{handler(o){this.$emit("update-field",{field:"commonDivisions",value:o}),this.updateAllClassesWithCommonData()},deep:!0}},methods:{addCommonSubject(){this.newCommonSubject.trim()&&!this.commonSubjectsList.includes(this.newCommonSubject.trim())&&(this.commonSubjectsList.push(this.newCommonSubject.trim()),this.newCommonSubject="")},removeCommonSubject(o){this.commonSubjectsList.splice(o,1)},isCommonSubjectSelected(o){return this.commonSubjectsList.includes(o)},toggleCommonSubject(o){this.isCommonSubjectSelected(o)?this.removeCommonSubject(this.commonSubjectsList.indexOf(o)):(this.newCommonSubject=o,this.addCommonSubject())},addCommonDivision(){this.newCommonDivision.trim()&&!this.commonDivisionsList.includes(this.newCommonDivision.trim())&&(this.commonDivisionsList.push(this.newCommonDivision.trim()),this.newCommonDivision="")},removeCommonDivision(o){this.commonDivisionsList.splice(o,1)},isCommonDivisionSelected(o){return this.commonDivisionsList.includes(o)},toggleCommonDivision(o){this.isCommonDivisionSelected(o)?this.removeCommonDivision(this.commonDivisionsList.indexOf(o)):(this.newCommonDivision=o,this.addCommonDivision())},addSpecificSubject(o){if(this.classesWithText[o].subjectsText.trim()){const e=[...this.classesWithText];e[o].specificSubjects=[...e[o].specificSubjects,e[o].subjectsText.trim()],e[o].subjectsText="",this.emitUpdatedClasses(e)}},removeSpecificSubject(o,e){const a=[...this.classesWithText];a[o].specificSubjects.splice(e,1),this.emitUpdatedClasses(a)},addSpecificDivision(o){if(this.classesWithText[o].divisionsText.trim()){const e=[...this.classesWithText],a=e[o].className||"Class";e[o].specificDivisions=[...e[o].specificDivisions,{divisionName:`${a}-${e[o].divisionsText.trim()}`}],e[o].divisionsText="",this.emitUpdatedClasses(e)}},removeSpecificDivision(o,e){const a=[...this.classesWithText];a[o].specificDivisions.splice(e,1),this.emitUpdatedClasses(a)},updateClassName(o,e){const a=[...this.classesWithText],i=a[o].className;a[o].className=e,a[o].specificDivisions&&(a[o].specificDivisions=a[o].specificDivisions.map(c=>{const r=c.divisionName.replace(`${i}-`,"");return{divisionName:`${e}-${r}`}})),this.emitUpdatedClasses(a)},updateAllClassesWithCommonData(){const o=this.classesWithText.map(e=>F(V({},e),{specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}));this.emitUpdatedClasses(o)},isCommonSubjectExcluded(o,e){var i;return((i=this.classesWithText[o].excludedCommonSubjects)==null?void 0:i.includes(e))||!1},toggleExcludeCommonSubject(o,e){const a=[...this.classesWithText];a[o].excludedCommonSubjects||(a[o].excludedCommonSubjects=[]);const i=a[o].excludedCommonSubjects.indexOf(e);i>=0?a[o].excludedCommonSubjects.splice(i,1):a[o].excludedCommonSubjects.push(e),this.emitUpdatedClasses(a)},isCommonDivisionExcluded(o,e){var i;return((i=this.classesWithText[o].excludedCommonDivisions)==null?void 0:i.includes(e))||!1},toggleExcludeCommonDivision(o,e){const a=[...this.classesWithText];a[o].excludedCommonDivisions||(a[o].excludedCommonDivisions=[]);const i=a[o].excludedCommonDivisions.indexOf(e);i>=0?a[o].excludedCommonDivisions.splice(i,1):a[o].excludedCommonDivisions.push(e),this.emitUpdatedClasses(a)},emitUpdatedClasses(o){this.$emit("update-field-array",{field:"classes",value:o.map(e=>({className:e.className,subjects:[...this.commonSubjectsList.filter(a=>{var i;return!((i=e.excludedCommonSubjects)!=null&&i.includes(a))}),...e.specificSubjects||[]],divisions:[...this.commonDivisionsList.filter(a=>{var i;return!((i=e.excludedCommonDivisions)!=null&&i.includes(a))}).map(a=>({divisionName:`${e.className}-${a}`})),...e.specificDivisions||[]],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[],specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[]}))})}}},Dt={class:"bg-white shadow rounded-lg p-6 space-y-6"},Tt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},kt=["onClick"],jt={class:"quick-select mt-3"},Pt={class:"subject-grid grid grid-cols-3 gap-2"},At=["onClick"],Nt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Ot=["onClick"],Gt={class:"quick-select mt-3"},Ut={class:"division-grid grid grid-cols-6 gap-2"},Et=["onClick"],Vt={class:"overflow-x-auto"},Ft={class:"min-w-full text-sm text-left text-gray-700"},Mt={class:"px-4 py-2"},Lt={class:"px-4 py-2"},Yt=["onUpdate:modelValue","onInput"],It={class:"px-4 py-2 w-[300px]"},Bt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Rt=["onClick"],$t=["onClick"],Wt={class:"flex gap-2"},qt=["onUpdate:modelValue","onKeydown"],Kt=["onClick"],Ht={class:"px-4 py-2"},zt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Jt=["onClick"],Qt=["onClick"],Zt={class:"flex gap-2"},Xt=["onUpdate:modelValue","onKeydown"],es=["onClick"];function ts(o,e,a,i,c,r){return d(),u("div",Dt,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Subjects for All Classes",-1)),t("div",Tt,[(d(!0),u(S,null,w(c.commonSubjectsList,(s,l)=>(d(),u("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm"},[T(f(s)+" ",1),t("button",{onClick:n=>r.removeCommonSubject(l),class:"ml-1.5 text-blue-500 hover:text-blue-700"}," × ",8,kt)]))),128)),h(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>c.newCommonSubject=s),onKeydown:e[1]||(e[1]=W((...s)=>r.addCommonSubject&&r.addCommonSubject(...s),["enter"])),onBlur:e[2]||(e[2]=(...s)=>r.addCommonSubject&&r.addCommonSubject(...s)),placeholder:"Add subjects...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[C,c.newCommonSubject]])]),t("div",jt,[e[6]||(e[6]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Subjects",-1)),t("div",Pt,[(d(!0),u(S,null,w(c.commonSubjects,s=>(d(),u("div",{key:s,class:j(["subject-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-blue-100 border-blue-300":r.isCommonSubjectSelected(s),"bg-gray-50 hover:bg-gray-100":!r.isCommonSubjectSelected(s)}]),onClick:l=>r.toggleCommonSubject(s)},f(s),11,At))),128))])])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Divisions for All Classes",-1)),t("div",Nt,[(d(!0),u(S,null,w(c.commonDivisionsList,(s,l)=>(d(),u("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm"},[T(f(s)+" ",1),t("button",{onClick:n=>r.removeCommonDivision(l),class:"ml-1.5 text-green-500 hover:text-green-700"}," × ",8,Ot)]))),128)),h(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>c.newCommonDivision=s),onKeydown:e[4]||(e[4]=W((...s)=>r.addCommonDivision&&r.addCommonDivision(...s),["enter"])),onBlur:e[5]||(e[5]=(...s)=>r.addCommonDivision&&r.addCommonDivision(...s)),placeholder:"Add divisions...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[C,c.newCommonDivision]])]),t("div",Gt,[e[8]||(e[8]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Divisions",-1)),t("div",Ut,[(d(!0),u(S,null,w(c.commonDivisions,s=>(d(),u("div",{key:s,class:j(["division-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-green-100 border-green-300":r.isCommonDivisionSelected(s),"bg-gray-50 hover:bg-gray-100":!r.isCommonDivisionSelected(s)}]),onClick:l=>r.toggleCommonDivision(s)},f(s),11,Et))),128))])])]),e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-2"},"Classes Overview",-1)),t("div",Vt,[t("table",Ft,[e[10]||(e[10]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-2 font-medium"},"#"),t("th",{class:"px-4 py-2 font-medium"},"Class Name / Programs"),t("th",{class:"px-4 py-2 font-medium"},"Subjects / Courses"),t("th",{class:"px-4 py-2 font-medium"},"Divisions / Student Groups")])],-1)),t("tbody",null,[(d(!0),u(S,null,w(c.classesWithText,(s,l)=>(d(),u("tr",{key:l,class:"border-t hover:bg-gray-50"},[t("td",Mt,f(l+1),1),t("td",Lt,[h(t("input",{type:"text","onUpdate:modelValue":n=>s.className=n,onInput:n=>r.updateClassName(l,n.target.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Yt),[[C,s.className]])]),t("td",It,[t("div",Bt,[(d(!0),u(S,null,w(c.commonSubjectsList,(n,b)=>(d(),u("span",{key:"common-"+b,class:j(["inline-flex items-center px-2 py-1 rounded-full text-xs",r.isCommonSubjectExcluded(l,n)?"bg-red-100 text-red-600":"bg-blue-50 text-blue-600"])},[T(f(n)+" ",1),t("button",{onClick:ie(G=>r.toggleExcludeCommonSubject(l,n),["stop"]),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"},f(r.isCommonSubjectExcluded(l,n)?"+":"×"),9,Rt)],2))),128)),(d(!0),u(S,null,w(s.specificSubjects,(n,b)=>(d(),u("span",{key:"specific-"+b,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs"},[T(f(n)+" ",1),t("button",{onClick:G=>r.removeSpecificSubject(l,b),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"}," × ",8,$t)]))),128))]),t("div",Wt,[h(t("input",{type:"text","onUpdate:modelValue":n=>s.subjectsText=n,onKeydown:W(n=>r.addSpecificSubject(l),["enter"]),placeholder:"Add class-specific subject...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,qt),[[C,s.subjectsText]]),t("button",{onClick:n=>r.addSpecificSubject(l),class:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs"}," Add ",8,Kt)])]),t("td",Ht,[t("div",zt,[(d(!0),u(S,null,w(c.commonDivisionsList,(n,b)=>(d(),u("span",{key:"common-"+b,class:j(["inline-flex items-center px-2 py-1 rounded-full text-xs",r.isCommonDivisionExcluded(l,n)?"bg-red-100 text-red-600 border border-red-300":"bg-green-50 text-green-600"])},[T(f(n)+" ",1),t("button",{onClick:ie(G=>r.toggleExcludeCommonDivision(l,n),["stop"]),class:"ml-1 text-green-500 hover:text-green-700 text-xs"},f(r.isCommonDivisionExcluded(l,n)?"+":"×"),9,Jt)],2))),128)),(d(!0),u(S,null,w(s.specificDivisions,(n,b)=>(d(),u("span",{key:"specific-"+b,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800 text-xs"},[T(f(n.divisionName.split("-").slice(1).join("-"))+" ",1),t("button",{onClick:G=>r.removeSpecificDivision(l,b),class:"ml-1 text-green-500 hover:text-green-700 text-xs"}," × ",8,Qt)]))),128))]),t("div",Zt,[h(t("input",{type:"text","onUpdate:modelValue":n=>s.divisionsText=n,onKeydown:W(n=>r.addSpecificDivision(l),["enter"]),placeholder:"Add class-specific division...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Xt),[[C,s.divisionsText]]),t("button",{onClick:n=>r.addSpecificDivision(l),class:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-xs"}," Add ",8,es)])])]))),128))])])])])}const ss=O(_t,[["render",ts],["__scopeId","data-v-9515f27e"]]),os={name:"GradingSystem",emits:["update-field","grading-completed"],props:{values:{type:Object,required:!0}},setup(o,{emit:e}){var P,m,p,x;const a=y(((P=o.values.gradingSystem)==null?void 0:P.selectedOption)||""),i=y(((m=o.values.gradingSystem)==null?void 0:m.scaleName)||""),c=y(((p=o.values.gradingSystem)==null?void 0:p.previousScaleName)||""),r=y(((x=o.values.gradingSystem)==null?void 0:x.gradeData)||[{grade_code:"",threshold:"",description:""}]),s=y([]),l=y(!1),n=y(!1);let b=null;const G=M({url:"school.al_ummah.api3.fetch_grading_scales",onSuccess:g=>{g.success&&(s.value=g.grading_scales||[]),l.value=!1},onError:g=>{console.error("Error fetching grading scales:",g),l.value=!1}}),L=y([{value:"school",label:"School (K-12)",grades:[{grade_code:"A+",threshold:95,description:"Outstanding"},{grade_code:"A",threshold:90,description:"Excellent"},{grade_code:"B+",threshold:85,description:"Very Good"},{grade_code:"B",threshold:80,description:"Good"},{grade_code:"C+",threshold:75,description:"Above Average"},{grade_code:"C",threshold:70,description:"Average"},{grade_code:"D",threshold:60,description:"Below Average"},{grade_code:"F",threshold:0,description:"Fail"}]},{value:"college",label:"College/University",grades:[{grade_code:"A",threshold:90,description:"Excellent"},{grade_code:"B",threshold:80,description:"Good"},{grade_code:"C",threshold:70,description:"Satisfactory"},{grade_code:"D",threshold:60,description:"Pass"},{grade_code:"F",threshold:0,description:"Fail"}]}]),U=X(()=>r.value.length>0&&r.value.every(g=>{var v;return((v=g.grade_code)==null?void 0:v.trim())&&Z(g.threshold)})),K=X(()=>!i.value||!U.value),Y=X(()=>{var g;return a.value==="previous"?!!c.value:a.value==="manual"?((g=i.value)==null?void 0:g.trim())&&U.value:!0});function I(){l.value=!0,G.fetch()}function H(g){a.value=g,k()}function z(g){r.value=JSON.parse(JSON.stringify(g.grades)),i.value||(i.value=`${g.label} Grading Scale`),k()}function J(){r.value.push({grade_code:"",threshold:"",description:""}),k()}function Q(g){r.value.length>1&&(r.value.splice(g,1),k())}function Z(g){const v=parseFloat(g);return!isNaN(v)&&v>=0&&v<=100&&g!==""}function B(){clearTimeout(b),b=setTimeout(k,300)}function k(){clearTimeout(b);const g=a.value==="manual"?r.value.map(v=>({grade_code:(v.grade_code||"").trim(),threshold:parseFloat(v.threshold)||0,description:(v.description||"").trim()})).filter(v=>v.grade_code&&!isNaN(v.threshold)):null;e("update-field",{field:"gradingSystem",value:{selectedOption:a.value,scaleName:i.value,previousScaleName:c.value,gradeData:g}})}function R(){n.value=!0,!(!Y.value&&a.value!=="")&&(k(),e("grading-completed"))}function $(){a.value="",i.value="",c.value="",r.value=[{grade_code:"",threshold:"",description:""}],n.value=!1,e("update-field",{field:"gradingSystem",value:{selectedOption:"",scaleName:"",previousScaleName:"",gradeData:null}}),e("grading-completed")}return ee(()=>{I(),k()}),{selectedOption:a,scaleName:i,previousScaleName:c,manualGrades:r,gradingScales:s,loadingScales:l,instituteTypes:L,showValidation:n,hasValidManualGrades:U,hasManualValidationErrors:K,isFormValid:Y,selectOption:H,applyTemplate:z,addGrade:J,removeGrade:Q,submitGrading:R,skipGrading:$,debouncedUpdate:B}}},is={class:"grading-system-container"},as={class:"mb-8"},rs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ns={class:"flex items-start space-x-4"},ls={class:"flex-1"},ds=["disabled"],us=["value"],cs={key:0,class:"mt-2 text-sm text-gray-500"},ms={key:1,class:"mt-2 text-sm text-gray-500"},ps={key:0,class:"space-y-6"},gs={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},vs=["onClick"],fs={class:"flex items-center space-x-3"},bs={class:"font-medium text-gray-900"},hs={class:"text-xs text-gray-500 mt-1"},xs={class:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden"},ys={class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},Cs={class:"flex items-center justify-between"},Ss={class:"overflow-x-auto"},ws={class:"w-full"},_s={class:"bg-white divide-y divide-gray-200"},Ds={class:"px-6 py-4 whitespace-nowrap"},Ts=["onUpdate:modelValue"],ks={class:"px-6 py-4 whitespace-nowrap"},js={class:"flex items-center space-x-2"},Ps=["onUpdate:modelValue"],As={class:"px-6 py-4"},Ns=["onUpdate:modelValue"],Os={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Gs=["onClick","disabled"],Us={key:0,class:"text-center py-12"},Es={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Vs={class:"mt-2 text-sm text-red-600 list-disc list-inside space-y-1"},Fs={key:0},Ms={key:1},Ls={class:"mt-8 flex justify-between items-center pt-6 border-t border-gray-200"},Ys={class:"flex space-x-3"},Is=["disabled"];function Bs(o,e,a,i,c,r){return d(),u("div",is,[e[28]||(e[28]=t("div",{class:"mb-8"},[t("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Grading System Setup"),t("p",{class:"text-gray-600"},"Configure your institution's grading system. This step is optional.")],-1)),t("div",as,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Select Grading System Option ",-1)),t("div",rs,[t("div",{onClick:e[1]||(e[1]=s=>i.selectOption("previous")),class:j(["p-6 border-2 rounded-lg cursor-pointer transition-all duration-200",i.selectedOption==="previous"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-300 bg-white hover:border-gray-400"])},[t("div",ns,[e[14]||(e[14]=t("div",{class:"flex-shrink-0 w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",ls,[e[12]||(e[12]=t("h4",{class:"font-semibold text-gray-900 mb-2"},"Use Existing Grading Scale",-1)),e[13]||(e[13]=t("p",{class:"text-sm text-gray-600 mb-3"},"Select from previously created grading scales",-1)),h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.previousScaleName=s),disabled:i.selectedOption!=="previous",class:j(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"bg-gray-100":i.selectedOption!=="previous"}])},[e[11]||(e[11]=t("option",{value:""},"Select a grading scale",-1)),(d(!0),u(S,null,w(i.gradingScales,s=>(d(),u("option",{key:s,value:s},f(s),9,us))),128))],10,ds),[[q,i.previousScaleName]]),i.loadingScales?(d(),u("div",cs," Loading grading scales... ")):i.gradingScales.length===0?(d(),u("div",ms," No previous grading scales found ")):_("",!0)])])],2),t("div",{onClick:e[2]||(e[2]=s=>i.selectOption("manual")),class:j(["p-6 border-2 rounded-lg cursor-pointer transition-all duration-200",i.selectedOption==="manual"?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-gray-300 bg-white hover:border-gray-400"])},e[15]||(e[15]=[me('<div class="flex items-start space-x-4" data-v-d1923fe5><div class="flex-shrink-0 w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center" data-v-d1923fe5><svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d1923fe5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-d1923fe5></path></svg></div><div class="flex-1" data-v-d1923fe5><h4 class="font-semibold text-gray-900 mb-2" data-v-d1923fe5>Create New Grading Scale</h4><p class="text-sm text-gray-600" data-v-d1923fe5>Manually define your grading system</p></div></div>',1)]),2)])]),i.selectedOption==="manual"?(d(),u("div",ps,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Grading Scale Name "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>i.scaleName=s),type:"text",placeholder:"e.g., Standard Grading Scale",class:j(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"border-red-300":!i.scaleName&&i.showValidation}])},null,2),[[C,i.scaleName]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Quick Templates (Optional) ",-1)),t("div",gs,[(d(!0),u(S,null,w(i.instituteTypes,s=>(d(),u("button",{key:s.value,onClick:l=>i.applyTemplate(s),class:"p-4 border border-gray-300 rounded-lg text-left bg-white hover:border-gray-400 transition-colors"},[t("div",fs,[e[18]||(e[18]=t("div",{class:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),t("div",null,[t("h4",bs,f(s.label),1),t("p",hs,f(s.grades.length)+" pre-defined grades",1)])])],8,vs))),128))])]),t("div",xs,[t("div",ys,[t("div",Cs,[e[21]||(e[21]=t("h4",{class:"text-lg font-semibold text-gray-800"},"Grading Scale",-1)),t("button",{onClick:e[4]||(e[4]=(...s)=>i.addGrade&&i.addGrade(...s)),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2 text-sm"},e[20]||(e[20]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",null,"Add Grade",-1)]))])]),t("div",Ss,[t("table",ws,[e[24]||(e[24]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Grade Code"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Threshold (%)"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",_s,[(d(!0),u(S,null,w(i.manualGrades,(s,l)=>(d(),u("tr",{key:l,class:"hover:bg-gray-50 transition-colors"},[t("td",Ds,[h(t("input",{"onUpdate:modelValue":n=>s.grade_code=n,type:"text",placeholder:"e.g., A, B, C",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[5]||(e[5]=(...n)=>i.debouncedUpdate&&i.debouncedUpdate(...n))},null,40,Ts),[[C,s.grade_code]])]),t("td",ks,[t("div",js,[h(t("input",{"onUpdate:modelValue":n=>s.threshold=n,type:"number",min:"0",max:"100",step:"0.1",placeholder:"0-100",class:"w-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[6]||(e[6]=(...n)=>i.debouncedUpdate&&i.debouncedUpdate(...n))},null,40,Ps),[[C,s.threshold]]),e[22]||(e[22]=t("span",{class:"text-gray-500 text-sm"},"%",-1))])]),t("td",As,[h(t("input",{"onUpdate:modelValue":n=>s.description=n,type:"text",placeholder:"e.g., Excellent, Good, Average",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[7]||(e[7]=(...n)=>i.debouncedUpdate&&i.debouncedUpdate(...n))},null,40,Ns),[[C,s.description]])]),t("td",Os,[t("button",{onClick:n=>i.removeGrade(l),class:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",disabled:i.manualGrades.length<=1},e[23]||(e[23]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Gs)])]))),128))])])]),i.manualGrades.length===0?(d(),u("div",Us,[e[25]||(e[25]=t("p",{class:"text-gray-500 mb-4"},"No grades added yet.",-1)),t("button",{onClick:e[8]||(e[8]=(...s)=>i.addGrade&&i.addGrade(...s)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Add First Grade ")])):_("",!0)]),i.showValidation&&i.hasManualValidationErrors?(d(),u("div",Es,[e[26]||(e[26]=t("div",{class:"flex items-center space-x-2 text-red-700"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("span",{class:"font-medium"},"Please fix the following issues:")],-1)),t("ul",Vs,[i.scaleName?_("",!0):(d(),u("li",Fs,"Grading scale name is required")),i.hasValidManualGrades?_("",!0):(d(),u("li",Ms,"All grades must have a code and valid threshold (0-100)"))])])):_("",!0)])):_("",!0),t("div",Ls,[e[27]||(e[27]=t("div",{class:"text-sm text-gray-500"}," This step is optional. ",-1)),t("div",Ys,[t("button",{onClick:e[9]||(e[9]=(...s)=>i.skipGrading&&i.skipGrading(...s)),class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Skip Grading "),t("button",{onClick:e[10]||(e[10]=(...s)=>i.submitGrading&&i.submitGrading(...s)),disabled:!i.isFormValid&&i.selectedOption!=="",class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors"}," Continue ",8,Is)])])])}const Rs=O(os,[["render",Bs],["__scopeId","data-v-d1923fe5"]]),$s={name:"MultiStepForm",components:{EmailAccountSetup:we,AcademicYearTerms:et,UsePreviousData:ut,ProgramSelection:wt,SubjectsDivisions:ss,GradingSystem:Rs},setup(){const o=y(0),e=y([]),a=y(!1),i=y(!1),c=y(!1),r=y(""),s=y([]),l=y(!1),n=pe({email:"",googleAppPassword:"",academicYear:"",academicYearStart:"",academicYearEnd:"",numberOfTerms:"",terms:[],selectedTerm:"",classes:[],subjects:[],divisions:[],commonSubjects:[],commonDivisions:[],dontCreateClasses:!1,gradingSystem:{selectedOption:"",scaleName:"",previousScaleName:"",gradeData:null},gradingCompleted:!1}),b=y([{title:"Email Account Setup (Optional)",component:"EmailAccountSetup"},{title:"Academic Year & Terms",component:"AcademicYearTerms"},{title:"Grading System (Optional)",component:"GradingSystem"},{title:"Use Previous Data",component:"UsePreviousData"},{title:"Select Institution Type & Classes",component:"ProgramSelection"},{title:"Subjects and Divisions",component:"SubjectsDivisions"}]),G=M({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:m=>{e.value=Array.isArray(m)?m.map(p=>F(V({},p),{academicYear:p.json_data?JSON.parse(p.json_data).academicYear:""})):[]},onError:m=>{console.error("Error fetching previous data:",m),e.value=[]}}),L=M({url:"school.al_ummah.api3.create_email_account",params:{email_id:"",password:""},onSuccess:()=>{alert("Email account setup successfully!")},onError:m=>{console.error("Error setting up email account:",m),alert("Error setting up email account.")}}),U=M({url:"school.al_ummah.api3.quick_setup",params:{values:{}},onSuccess:()=>{c.value=!0,o.value++,a.value=!1,i.value=!0},onError:m=>{var p;c.value=!1,r.value=((p=m.messages)==null?void 0:p[0])||"An error occurred while submitting the form.",console.error("Submission error:",m),a.value=!1,i.value=!0}});function K(){n.gradingCompleted=!0,B()}function Y({classNames:m}){const p=[...n.classes],x=p.reduce((v,D)=>Math.max(v,D.classIndex||0),0),g=m.map((v,D)=>({className:v,subjects:[],divisions:[{divisionName:""}],classIndex:x+D+1}));n.classes=[...p,...g]}function I(){G.reload()}function H({field:m,value:p,parent:x=null}){x&&n[x]?n[x][m]=p:n[m]=p}function z({field:m,index:p,subField:x,value:g}){p!==void 0&&x?n[m][p][x]=g:p!==void 0?n[m][p]=g:n[m]=g}function J(){return oe(this,null,function*(){const{email:m,googleAppPassword:p}=n;if(!m||!p){alert("Please provide both email and Google app password.");return}L.update({params:{email_id:m,password:p}}),L.submit()})}function Q(){const m=parseInt(n.numberOfTerms,10),p=new Date(n.academicYearStart),x=new Date(n.academicYearEnd);if(!m||m<=0){alert("Please enter a valid number of terms.");return}if(isNaN(p.getTime())){alert("Please enter valid 'From' date.");return}if(isNaN(x.getTime())){alert("Please enter valid 'To' date.");return}if(p>=x){alert("'From' date must be before 'To' date.");return}const g=Math.ceil((x-p)/(1e3*60*60*24)),v=Math.floor(g/m),D=[];let A=new Date(p);for(let E=0;E<m;E++){const N=new Date(A);N.setDate(A.getDate()+v-1),E===m-1&&N.setTime(x.getTime()),D.push({name:`Term ${E+1}`,startDate:A.toISOString().split("T")[0],endDate:N.toISOString().split("T")[0]}),A=new Date(N),A.setDate(A.getDate()+1)}n.terms=D}function Z(m){if(!(m!=null&&m.json_data)){console.error("Invalid or missing previous data");return}try{const p=JSON.parse(m.json_data);n.classes=p.classes||[],n.subjects=p.subjects||[]}catch(p){console.error("Error parsing previous data:",p),alert("Failed to load previous data. Please try another selection.")}}function B(){o.value<b.value.length-1?(o.value++,l.value=!1):R()}function k(){o.value>0&&(o.value--,l.value=!1)}function R(){a.value=!0,i.value=!1,c.value=!1,r.value="",l.value=!1;const p=$(n,["selectedTerm","commonSubjects","commonDivisions","divisions","institutionName","logo","dontCreateClasses","subjects","terms","email","googleAppPassword","classes","gradingSystem","gradingCompleted"]);if(p.length>0){s.value=p,l.value=!0,a.value=!1,window.scrollTo({top:0,behavior:"smooth"});return}U.update({params:{values:V({},n)}}),U.submit()}function $(m,p){const x=[];return Object.entries(m).forEach(([g,v])=>{if(!p.includes(g)){if(Array.isArray(v))if(v.length===0){const D=P(g);x.push(`${D} list is empty`)}else v.forEach((D,A)=>{typeof D=="object"&&D!==null&&Object.entries(D).forEach(([E,N])=>{if(!N||typeof N=="string"&&N.trim()===""){const ae=P(E),re=P(g);x.push(`${re} ${A+1}: ${ae} is required`)}})});else if(!v||typeof v=="string"&&v.trim()===""){const D=P(g);x.push(`${D} is required`)}}}),x}function P(m){return m.replace(/([A-Z])/g," $1").replace(/^./,p=>p.toUpperCase()).replace(/([A-Z])/g," $1").trim()}return ee(()=>{I()}),{currentStep:o,previousDataList:e,isSubmitting:a,showResultMessage:i,submitSuccess:c,errorMessage:r,missingFields:s,showMissingFields:l,formValues:n,steps:b,quickSetupResource:U,autoCreateClasses:Y,fetchPreviousData:I,updateField:H,updateFieldArray:z,submitEmailAccount:J,autoCreateTerms:Q,usePreviousData:Z,handleGradingCompleted:K,nextStep:B,prevStep:k,submitForm:R,checkMissingFields:$,formatFieldName:P}}},Ws={class:"p-4 max-w-4xl mx-auto"},qs={key:0},Ks={class:"text-2xl font-semibold mb-6"},Hs={key:0,class:"missing-fields-alert"},zs={class:"alert-header"},Js={class:"alert-content"},Qs={class:"missing-fields-list"},Zs={class:"flex justify-between gap-4"},Xs=["disabled"],eo={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},to={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},so={class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},oo={key:0,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},io={key:1,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},ao={class:"mt-3 text-lg font-medium text-gray-900"},ro={class:"mt-2 text-sm text-gray-500"},no={class:"mt-5"},lo={key:3,class:"text-center mt-10"};function uo(o,e,a,i,c,r){return d(),u("div",Ws,[i.currentStep<i.steps.length?(d(),u("div",qs,[t("h2",Ks,f(i.steps[i.currentStep].title),1),i.missingFields.length>0&&i.showMissingFields?(d(),u("div",Hs,[t("div",zs,[e[5]||(e[5]=t("div",{class:"alert-icon"},[t("svg",{class:"icon",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})])],-1)),e[6]||(e[6]=t("h3",{class:"alert-title"},"Required Information Missing",-1)),t("button",{onClick:e[0]||(e[0]=s=>i.showMissingFields=!1),class:"close-button"},e[4]||(e[4]=[t("svg",{class:"close-icon",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1)]))]),t("div",Js,[e[8]||(e[8]=t("p",{class:"alert-description"},"Please fill in the following required fields before proceeding:",-1)),t("ul",Qs,[(d(!0),u(S,null,w(i.missingFields,(s,l)=>(d(),u("li",{key:l,class:"missing-field-item"},[e[7]||(e[7]=t("span",{class:"field-bullet"},"•",-1)),T(" "+f(s),1)]))),128))])])])):_("",!0),(d(),ge(ve(i.steps[i.currentStep].component),{values:i.formValues,previousDataList:i.previousDataList,onUpdateField:i.updateField,onUpdateFieldArray:i.updateFieldArray,onSubmitEmail:i.submitEmailAccount,onAutoCreateTerms:i.autoCreateTerms,onAutoCreateClasses:i.autoCreateClasses,onUsePreviousData:i.usePreviousData,onGradingCompleted:i.handleGradingCompleted,class:"mb-6"},null,40,["values","previousDataList","onUpdateField","onUpdateFieldArray","onSubmitEmail","onAutoCreateTerms","onAutoCreateClasses","onUsePreviousData","onGradingCompleted"])),t("div",Zs,[i.currentStep>0?(d(),u("button",{key:0,onClick:e[1]||(e[1]=(...s)=>i.prevStep&&i.prevStep(...s)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"}," Back ")):_("",!0),t("button",{onClick:e[2]||(e[2]=(...s)=>i.nextStep&&i.nextStep(...s)),class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:i.isSubmitting||i.quickSetupResource.loading},f(i.currentStep===i.steps.length-1?i.isSubmitting?"Submitting...":"Submit":"Next"),9,Xs)])])):_("",!0),i.isSubmitting?(d(),u("div",eo,e[9]||(e[9]=[t("div",{class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),t("h3",{class:"text-lg font-medium text-gray-900"},"Submitting your data..."),t("p",{class:"mt-2 text-sm text-gray-500"},"Please wait while we process your information.")],-1)]))):_("",!0),i.showResultMessage?(d(),u("div",to,[t("div",so,[i.submitSuccess?(d(),u("div",oo,e[10]||(e[10]=[t("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(d(),u("div",io,e[11]||(e[11]=[t("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),t("h3",ao,f(i.submitSuccess?"Form Submitted Successfully!":"Submission Failed"),1),t("p",ro,f(i.submitSuccess?"Your data has been successfully processed.":i.errorMessage||"An error occurred while submitting the form."),1),t("div",no,[t("button",{onClick:e[3]||(e[3]=s=>i.showResultMessage=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," OK ")])])])):_("",!0),i.currentStep>=i.steps.length&&!i.isSubmitting&&!i.showResultMessage?(d(),u("div",lo,e[12]||(e[12]=[t("h2",{class:"text-2xl font-semibold text-green-600"},"Form Submitted Successfully!",-1)]))):_("",!0)])}const co=O($s,[["render",uo],["__scopeId","data-v-fa8ae0bd"]]),mo={components:{MultiStepForm:co}},po={class:"app-container"};function go(o,e,a,i,c,r){const s=be("MultiStepForm");return d(),u("div",po,[fe(s)])}const bo=O(mo,[["render",go]]);export{bo as default};
