var ea=Object.defineProperty;var Q=Object.getOwnPropertySymbols;var sa=Object.prototype.hasOwnProperty,ta=Object.prototype.propertyIsEnumerable;var T=(o,a,g)=>a in o?ea(o,a,{enumerable:!0,configurable:!0,writable:!0,value:g}):o[a]=g,j=(o,a)=>{for(var g in a||(a={}))sa.call(a,g)&&T(o,g,a[g]);if(Q)for(var g of Q(a))ta.call(a,g)&&T(o,g,a[g]);return o};import{_ as ra,I,r as v,c as W,y as k,j as oa,a as n,b as s,i as c,t as m,z as d,A as G,F as A,l as R,C as f,d as na,B as ia,h as C,n as la,o as i}from"./index-DaBUP9Lm.js";/* empty css             */const da={setup(){const o=I({academicYear:null,className:null,divisionName:null,generateQRCode:!1,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Aadhar Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),a=v([]),g=W(()=>a.value.map((r,l)=>({original:r,display:l===0?`${r} - Current Year`:r}))),e=v([]),b=v([]),N=v(!1),t=v(null),u=I({}),_=v(!1),h=v(!1),x=v(""),V=v(""),Y=k({url:"school.al_ummah.api3.get_academic_years",params:{values:{}},onSuccess:r=>{a.value=Array.isArray(r)?r:[],a.value.length>0&&(o.academicYear=a.value[0]),a.value.length||D("No academic years available","error")},onError:r=>{var l;console.error("Error fetching academic years:",r),a.value=[],D(`Error fetching academic years: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),M=k({url:"school.al_ummah.api3.get_classes",params:{values:{}},onSuccess:r=>{e.value=Array.isArray(r)?r:[],console.log("Classes loaded:",e.value),e.value.length||D("No classes available","error")},onError:r=>{var l;console.error("Error fetching classes:",r),e.value=[],D(`Error fetching classes: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),E=k({url:"school.al_ummah.api3.get_divisions2",params:{values:{classId:o.className,academicYear:o.academicYear}},onSuccess:r=>{b.value=Array.isArray(r)?r:[],console.log("Divisions loaded:",b.value)},onError:r=>{var l;console.error("Error fetching divisions:",r),b.value=[],D(`Error fetching divisions: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),S=k({url:"school.al_ummah.api4.enroll_single_student",params:W(()=>({academic_year:o.academicYear,class_name:o.className,division_name:o.divisionName,generate_qr_code:o.generateQRCode,student_data:o.student_data})),onSuccess:r=>{N.value=!1,h.value=!0,V.value=`Student ${o.student_data["First Name"]} ${o.student_data["Last Name"]} has been successfully enrolled in ${o.className} - ${o.divisionName} for the ${o.academicYear} academic year.`,_.value=!0},onError:r=>{var l;N.value=!1,h.value=!1,x.value=((l=r.messages)==null?void 0:l[0])||"An unexpected error occurred while enrolling the student. Please try again.",_.value=!0}});oa(()=>{Y.reload(),M.reload()});function z(){o.className=null,o.divisionName=null,b.value=[],u.className="",u.divisionName="",w()}function w(){o.divisionName=null,u.divisionName="",o.className&&o.academicYear?(E.update({params:{values:{classId:o.className,academicYear:o.academicYear}}}),E.reload()):b.value=[]}function Z(r){return r?/^[0-9]{12}$/.test(r):!0}function J(){Object.assign(u,{});let r=!0;const l=o.student_data["Aadhar Number"].trim();l&&!Z(l)&&(u.aadharNumber="Please enter a valid 12-digit Aadhar number",r=!1),o.academicYear||(u.academicYear="Please select an academic year",r=!1),o.className||(u.className="Please select a class",r=!1),o.divisionName||(u.divisionName="Please select a division",r=!1),o.student_data["First Name"].trim()||(u.firstName="First name is required",r=!1),o.student_data["Last Name"].trim()||(u.lastName="Last name is required",r=!1),o.student_data["GR Number"].trim()||(u.grNumber="GR number is required",r=!1);const p=o.student_data["Student Date of Birth"];p&&!P(p)&&(u.studentDob="Student date of birth cannot be in the future",r=!1);const y=o.student_data["Guardian Date of Birth"];y&&!P(y)&&(u.guardianDob="Guardian date of birth cannot be in the future",r=!1);const q=o.student_data["Email Address"].trim();q&&!U(q)&&(u.email="Please enter a valid email",r=!1);const L=o.student_data["Phone Number"].trim();L&&!B(L)&&(u.phone="Please enter a valid phone number (10-15 digits)",r=!1);const O=o.student_data["Guardian Number"].trim();O&&!B(O)&&(u.guardianNumber="Please enter a valid guardian phone number (10-15 digits)",r=!1);const H=o.student_data["Guardian Email"].trim();return H?U(H)||(u.guardianEmail="Please enter a valid guardian email",r=!1):(u.guardianEmail="Guardian email is required",r=!1),r}function U(r){return r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r):!0}function B(r){return r?/^[0-9]{10,15}$/.test(r):!0}function P(r){if(!r)return!0;const l=new Date(r),p=new Date;return p.setHours(0,0,0,0),l.setHours(0,0,0,0),l<=p}function K(){const r=new Date,l=r.getFullYear(),p=String(r.getMonth()+1).padStart(2,"0"),y=String(r.getDate()).padStart(2,"0");return`${l}-${p}-${y}`}function X(){J()&&$()}function $(){N.value=!0,S.update({params:{academicYear:o.academicYear,className:o.className,divisionName:o.divisionName,generate_qr_code:o.generateQRCode,student_data:j({},o.student_data)}}),S.submit()}function F(){Object.assign(o,{academicYear:a.value.length>0?a.value[0]:null,className:null,divisionName:null,generateQRCode:!1,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Aadhar Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),b.value=[],Object.assign(u,{}),t.value=null}function aa(){F(),_.value=!1,h.value=!1}function D(r,l="info"){t.value={text:r,type:l},l!=="error"&&setTimeout(()=>t.value=null,5e3)}return{formData:o,academicYears:a,displayYears:g,classes:e,divisions:b,isSubmitting:N,message:t,errors:u,academicYearsResource:Y,classesResource:M,divisionsResource:E,enrollStudentResource:S,showResultMessage:_,submitSuccess:h,errorMessage:x,successMessage:V,onYearChange:z,onClassChange:w,validateAndSubmit:X,resetForm:F,resetAndClose:aa,getTodayDate:K}}},ua={class:"enrollment-form"},ma={key:0,class:"loading-overlay"},ca={key:1,class:"modal-overlay"},fa={class:"result-modal"},ga={key:0,class:"success-icon"},va={key:1,class:"error-icon"},ba={class:"result-title"},pa={class:"result-description"},Na={class:"modal-actions"},Da={class:"form-card"},_a={class:"form-grid"},ha={class:"form-group required"},ya=["disabled"],ka=["value"],Ga={key:0,class:"error-message"},Ea={class:"form-group required"},Sa=["disabled"],Aa=["value"],Ra={key:0,class:"error-message"},Ca={key:0,class:"form-group required"},xa=["disabled"],Va=["value"],Ya={key:0,class:"error-message"},Ma={class:"form-section"},wa={class:"form-grid"},Ua={class:"form-group required"},Ba={key:0,class:"error-message"},Pa={class:"form-group"},Fa={class:"form-group required"},qa={key:0,class:"error-message"},La={class:"form-group"},Oa=["max"],Ha={key:0,class:"error-message"},Qa={class:"form-group required"},Ta={key:0,class:"error-message"},ja={class:"form-group required"},Ia={key:0,class:"error-message"},Wa={class:"form-group"},za={key:0,class:"error-message"},Za={class:"form-group"},Ja={key:0,class:"error-message"},Ka={class:"form-section"},Xa={class:"form-grid"},$a={class:"form-group"},ae={class:"form-group"},ee={key:0,class:"error-message"},se={class:"form-group"},te={class:"form-group"},re=["max"],oe={key:0,class:"error-message"},ne={class:"form-group required"},ie={key:0,class:"error-message"},le={class:"form-group"},de={class:"form-group"},ue={class:"form-group"},me={class:"form-group"},ce={class:"form-section"},fe={class:"form-group checkbox-group"},ge={class:"checkbox-label"},ve={class:"form-actions"},be=["disabled"],pe={key:0,class:"button-content"},Ne={key:1,class:"button-content"},De=["disabled"];function _e(o,a,g,e,b,N){return i(),n("div",ua,[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("div",ma,a[28]||(a[28]=[s("div",{class:"loading-modal"},[s("div",{class:"loading-spinner"}),s("h3",{class:"loading-title"},"Enrolling Student..."),s("p",{class:"loading-description"},"Please wait while we process the student information.")],-1)]))):c("",!0),e.showResultMessage?(i(),n("div",ca,[s("div",fa,[e.submitSuccess?(i(),n("div",ga,a[29]||(a[29]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(i(),n("div",va,a[30]||(a[30]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",ba,m(e.submitSuccess?"Student Enrolled Successfully!":"Enrollment Failed"),1),s("p",pa,m(e.submitSuccess?e.successMessage:e.errorMessage),1),s("div",Na,[e.submitSuccess?(i(),n("button",{key:0,onClick:a[0]||(a[0]=(...t)=>e.resetAndClose&&e.resetAndClose(...t)),class:"success-button"}," Add Another Student ")):(i(),n("button",{key:1,onClick:a[1]||(a[1]=t=>e.showResultMessage=!1),class:"primary-button"}," Try Again ")),e.submitSuccess?(i(),n("button",{key:2,onClick:a[2]||(a[2]=t=>e.showResultMessage=!1),class:"secondary-button"}," Close ")):c("",!0)])])])):c("",!0),a[64]||(a[64]=s("div",{class:"header"},[s("h1",{class:"title"},"Student Enrollment"),s("p",{class:"subtitle"},"Add new student to the system")],-1)),s("div",Da,[a[63]||(a[63]=s("h2",{class:"form-title"},"Student Information",-1)),s("div",_a,[s("div",ha,[a[32]||(a[32]=s("label",null,"Academic Year",-1)),d(s("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.formData.academicYear=t),class:"picker",onChange:a[4]||(a[4]=(...t)=>e.onYearChange&&e.onYearChange(...t)),disabled:e.academicYearsResource.loading},[a[31]||(a[31]=s("option",{value:null},"Select Academic Year",-1)),(i(!0),n(A,null,R(e.displayYears,t=>(i(),n("option",{key:t,value:t.original},m(t.display),9,ka))),128))],40,ya),[[G,e.formData.academicYear]]),e.errors.academicYear?(i(),n("span",Ga,m(e.errors.academicYear),1)):c("",!0)]),s("div",Ea,[a[34]||(a[34]=s("label",null,"Class / Program",-1)),d(s("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>e.formData.className=t),class:"picker",onChange:a[6]||(a[6]=(...t)=>e.onClassChange&&e.onClassChange(...t)),disabled:!e.formData.academicYear||e.classesResource.loading},[a[33]||(a[33]=s("option",{value:null},"Select Class / Program",-1)),(i(!0),n(A,null,R(e.classes,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,Aa))),128))],40,Sa),[[G,e.formData.className]]),e.errors.className?(i(),n("span",Ra,m(e.errors.className),1)):c("",!0)]),e.divisions.length>0?(i(),n("div",Ca,[a[36]||(a[36]=s("label",null,"Division / Student Group",-1)),d(s("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>e.formData.divisionName=t),class:"picker",disabled:!e.formData.className||e.divisionsResource.loading},[a[35]||(a[35]=s("option",{value:null},"Select Division / Student Group",-1)),(i(!0),n(A,null,R(e.divisions,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,Va))),128))],8,xa),[[G,e.formData.divisionName]]),e.errors.divisionName?(i(),n("span",Ya,m(e.errors.divisionName),1)):c("",!0)])):c("",!0)]),s("div",Ma,[a[44]||(a[44]=s("h3",{class:"section-title"},"Personal Details",-1)),s("div",wa,[s("div",Ua,[a[37]||(a[37]=s("label",null,"First Name",-1)),d(s("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>e.formData.student_data["First Name"]=t),type:"text",class:"input",placeholder:"Enter first name",required:""},null,512),[[f,e.formData.student_data["First Name"]]]),e.errors.firstName?(i(),n("span",Ba,m(e.errors.firstName),1)):c("",!0)]),s("div",Pa,[a[38]||(a[38]=s("label",null,"Middle Name",-1)),d(s("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>e.formData.student_data["Middle Name"]=t),type:"text",class:"input",placeholder:"Enter middle name"},null,512),[[f,e.formData.student_data["Middle Name"]]])]),s("div",Fa,[a[39]||(a[39]=s("label",null,"Last Name",-1)),d(s("input",{"onUpdate:modelValue":a[10]||(a[10]=t=>e.formData.student_data["Last Name"]=t),type:"text",class:"input",placeholder:"Enter last name",required:""},null,512),[[f,e.formData.student_data["Last Name"]]]),e.errors.lastName?(i(),n("span",qa,m(e.errors.lastName),1)):c("",!0)]),s("div",La,[a[40]||(a[40]=s("label",null,"Student Date of Birth",-1)),d(s("input",{"onUpdate:modelValue":a[11]||(a[11]=t=>e.formData.student_data["Student Date of Birth"]=t),type:"date",class:"input",max:e.getTodayDate()},null,8,Oa),[[f,e.formData.student_data["Student Date of Birth"]]]),e.errors.studentDob?(i(),n("span",Ha,m(e.errors.studentDob),1)):c("",!0)]),s("div",Qa,[a[41]||(a[41]=s("label",null,"GR Number",-1)),d(s("input",{"onUpdate:modelValue":a[12]||(a[12]=t=>e.formData.student_data["GR Number"]=t),type:"text",class:"input",placeholder:"Enter GR number",required:""},null,512),[[f,e.formData.student_data["GR Number"]]]),e.errors.grNumber?(i(),n("span",Ta,m(e.errors.grNumber),1)):c("",!0)]),s("div",ja,[a[42]||(a[42]=s("label",null,"Email Address",-1)),d(s("input",{"onUpdate:modelValue":a[13]||(a[13]=t=>e.formData.student_data["Email Address"]=t),type:"email",class:"input",placeholder:"Enter email address"},null,512),[[f,e.formData.student_data["Email Address"]]]),e.errors.email?(i(),n("span",Ia,m(e.errors.email),1)):c("",!0)]),s("div",Wa,[a[43]||(a[43]=s("label",null,"Phone Number",-1)),d(s("input",{"onUpdate:modelValue":a[14]||(a[14]=t=>e.formData.student_data["Phone Number"]=t),type:"tel",class:"input",placeholder:"Enter phone number"},null,512),[[f,e.formData.student_data["Phone Number"]]]),e.errors.phone?(i(),n("span",za,m(e.errors.phone),1)):c("",!0)])])]),s("div",Za,[a[45]||(a[45]=s("label",null,"Aadhar Number",-1)),d(s("input",{"onUpdate:modelValue":a[15]||(a[15]=t=>e.formData.student_data["Aadhar Number"]=t),type:"text",class:"input",placeholder:"Enter Aadhar number",maxlength:"12"},null,512),[[f,e.formData.student_data["Aadhar Number"]]]),e.errors.aadharNumber?(i(),n("span",Ja,m(e.errors.aadharNumber),1)):c("",!0)]),s("div",Ka,[a[56]||(a[56]=s("h3",{class:"section-title"},"Guardian Information",-1)),s("div",Xa,[s("div",$a,[a[46]||(a[46]=s("label",null,"Guardian Name",-1)),d(s("input",{"onUpdate:modelValue":a[16]||(a[16]=t=>e.formData.student_data["Guardian Name"]=t),type:"text",class:"input",placeholder:"Enter guardian name"},null,512),[[f,e.formData.student_data["Guardian Name"]]])]),s("div",ae,[a[47]||(a[47]=s("label",null,"Guardian Number",-1)),d(s("input",{"onUpdate:modelValue":a[17]||(a[17]=t=>e.formData.student_data["Guardian Number"]=t),type:"tel",class:"input",placeholder:"Enter guardian phone number"},null,512),[[f,e.formData.student_data["Guardian Number"]]]),e.errors.guardianNumber?(i(),n("span",ee,m(e.errors.guardianNumber),1)):c("",!0)]),s("div",se,[a[49]||(a[49]=s("label",null,"Relation",-1)),d(s("select",{"onUpdate:modelValue":a[18]||(a[18]=t=>e.formData.student_data.Relation=t),class:"picker"},a[48]||(a[48]=[na('<option value="">Select Relation</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Brother">Brother</option><option value="Sister">Sister</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Guardian">Guardian</option><option value="Other">Other</option>',11)]),512),[[G,e.formData.student_data.Relation]])]),s("div",te,[a[50]||(a[50]=s("label",null,"Guardian Date of Birth",-1)),d(s("input",{"onUpdate:modelValue":a[19]||(a[19]=t=>e.formData.student_data["Guardian Date of Birth"]=t),type:"date",class:"input",max:e.getTodayDate()},null,8,re),[[f,e.formData.student_data["Guardian Date of Birth"]]]),e.errors.guardianDob?(i(),n("span",oe,m(e.errors.guardianDob),1)):c("",!0)]),s("div",ne,[a[51]||(a[51]=s("label",null,"Guardian Email",-1)),d(s("input",{"onUpdate:modelValue":a[20]||(a[20]=t=>e.formData.student_data["Guardian Email"]=t),type:"email",class:"input",placeholder:"Enter guardian email"},null,512),[[f,e.formData.student_data["Guardian Email"]]]),e.errors.guardianEmail?(i(),n("span",ie,m(e.errors.guardianEmail),1)):c("",!0)]),s("div",le,[a[52]||(a[52]=s("label",null,"Guardian Occupation",-1)),d(s("input",{"onUpdate:modelValue":a[21]||(a[21]=t=>e.formData.student_data["Guardian Occupation"]=t),type:"text",class:"input",placeholder:"Enter guardian occupation"},null,512),[[f,e.formData.student_data["Guardian Occupation"]]])]),s("div",de,[a[53]||(a[53]=s("label",null,"Guardian Designation",-1)),d(s("input",{"onUpdate:modelValue":a[22]||(a[22]=t=>e.formData.student_data["Guardian Designation"]=t),type:"text",class:"input",placeholder:"Enter guardian designation"},null,512),[[f,e.formData.student_data["Guardian Designation"]]])]),s("div",ue,[a[54]||(a[54]=s("label",null,"Guardian Education",-1)),d(s("input",{"onUpdate:modelValue":a[23]||(a[23]=t=>e.formData.student_data["Guardian Education"]=t),type:"text",class:"input",placeholder:"Enter guardian education"},null,512),[[f,e.formData.student_data["Guardian Education"]]])]),s("div",me,[a[55]||(a[55]=s("label",null,"Guardian Work Address",-1)),d(s("textarea",{"onUpdate:modelValue":a[24]||(a[24]=t=>e.formData.student_data["Guardian Work Address"]=t),class:"input textarea",placeholder:"Enter guardian work address",rows:"3"},null,512),[[f,e.formData.student_data["Guardian Work Address"]]])])])]),s("div",ce,[a[60]||(a[60]=s("h3",{class:"section-title"},"Additional Options",-1)),s("div",fe,[s("label",ge,[d(s("input",{"onUpdate:modelValue":a[25]||(a[25]=t=>e.formData.generateQRCode=t),type:"checkbox",class:"checkbox"},null,512),[[ia,e.formData.generateQRCode]]),a[57]||(a[57]=s("span",{class:"checkmark"},null,-1)),a[58]||(a[58]=C(" Generate QR Code "))]),a[59]||(a[59]=s("p",{class:"checkbox-description"},"Check this to generate a QR code for the student",-1))])]),s("div",ve,[s("button",{class:"enroll-button",onClick:a[26]||(a[26]=(...t)=>e.validateAndSubmit&&e.validateAndSubmit(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage},[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("span",pe,a[61]||(a[61]=[s("span",{class:"spinner"},null,-1),C(" Processing... ")]))):(i(),n("span",Ne,a[62]||(a[62]=[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1),C(" Enroll Student ")])))],8,be),s("button",{class:"reset-button",onClick:a[27]||(a[27]=(...t)=>e.resetForm&&e.resetForm(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage}," Reset Form ",8,De)]),e.message&&!e.showResultMessage?(i(),n("div",{key:0,class:la(["message",e.message.type])},m(e.message.text),3)):c("",!0)])])}const Ge=ra(da,[["render",_e]]);export{Ge as default};
