var ze=Object.defineProperty,Je=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var he=(w,s,b)=>s in w?ze(w,s,{enumerable:!0,configurable:!0,writable:!0,value:b}):w[s]=b,X=(w,s)=>{for(var b in s||(s={}))Xe.call(s,b)&&he(w,b,s[b]);if(ge)for(var b of ge(s))Ze.call(s,b)&&he(w,b,s[b]);return w},Z=(w,s)=>Je(w,Ke(s));var W=(w,s,b)=>new Promise((l,N)=>{var Y=_=>{try{f(b.next(_))}catch(h){N(h)}},n=_=>{try{f(b.throw(_))}catch(h){N(h)}},f=_=>_.done?l(_.value):Promise.resolve(_.value).then(Y,n);f((b=b.apply(w,s)).next())});import{_ as $e,r as S,c as q,C as $,j as es,a as i,b as t,i as R,t as v,y as O,A as ee,F as M,l as A,H as ss,h as z,n as _e,o as d,z as ts}from"./index-BhxGw4-h.js";import{v as pe,g as ls,u as D,p as os,f as ns,a as J,r as as}from"./dateUtils-CshPDU0n.js";/* empty css             */const rs={setup(){const w=S(!1),s=S(!1),b=S([]),l=q(()=>b.value.map((e,o)=>({original:e,display:o===0?`${e} - Current Year`:e}))),N=S(null),Y=S([]),n=S([]),f=S(null),_=S(null),h=S([]),V=S(null),be=S(["First Name","Middle Name","Last Name","Student Date of Birth","Email Address","Phone Number","GR Number","Aadhar Number","Roll No","Guardian Name","Guardian Number","Guardian Email","Relation","Guardian Date of Birth"]),de=S(null),p=S([]),F=S([]),H=S([]),U=S([]),L=S([]),T=S([]),Q=S({total_processed:0,successful:0,failed:0}),B=S(!1),se=S(!1),te=S("success"),le=S(""),oe=S(""),ye=q(()=>p.value.filter(e=>I(e)).length),Se=q(()=>p.value.filter(e=>!I(e)).length),ke=q(()=>p.value.filter(e=>!I(e))),we=q(()=>F.value.filter((e,o)=>{var r;const a=p.value.some(u=>{const m=u[e];return m!=null&&m!==""&&m.toString().trim()!==""}),c=(r=h.value[o])==null?void 0:r.type;return a||c})),Re=q(()=>h.value.map((e,o)=>Z(X({},e),{originalIndex:o})).filter((e,o)=>{const a=F.value[o],c=p.value.some(u=>{const m=u[a];return m!=null&&m!==""&&m.toString().trim()!==""}),r=e.type;return c||r}));function Ne(e){const o=G(e);return`${o["First Name"]||""} ${o["Middle Name"]||""} ${o["Last Name"]||""}`.trim()||"Unknown Student"}function Ee(e){return G(e)["GR Number"]||"N/A"}function Ce(e){return G(e)["Roll No"]||"N/A"}function De(e){const o=[];["First Name","Last Name","GR Number","Roll No"].forEach(u=>{const m=h.value.findIndex(g=>g.type===u);if(m===-1)o.push(`${u} not mapped`);else{const g=D.decode_col(h.value[m].column),k=F.value[g],E=e[k];(!E||E.toString().trim()==="")&&o.push(`${u} missing`)}});const r=G(e)["Student Date of Birth"];if(r&&r.toString().trim()!==""){const u=J(r,"Student Date of Birth");u.isValid||o.push(u.error)}return o.length>0?o.join("; "):"Check field mappings"}const ue=$({url:"school.al_ummah.api4.get_academic_years",params:{values:{}},onSuccess:e=>{b.value=Array.isArray(e)?e:[],b.value.length>0&&(N.value=b.value[0]),b.value.length||y("No academic years available","error")},onError:e=>{var o;console.error("Error fetching academic years:",e),b.value=[],y(`Error fetching academic years: ${((o=e.messages)==null?void 0:o[0])||"Unknown error"}`,"error")}}),ce=$({url:"school.al_ummah.api4.get_classes",params:{values:{}},onSuccess:e=>{Y.value=Array.isArray(e)?e:[],console.log("Classes loaded:",Y.value),Y.value.length||y("No classes available","error")},onError:e=>{var o;console.error("Error fetching classes:",e),Y.value=[],y(`Error fetching classes: ${((o=e.messages)==null?void 0:o[0])||"Unknown error"}`,"error")}}),ne=$({url:"school.al_ummah.api4.get_divisions2",params:{values:{classId:f.value,academicYear:N.value}},onSuccess:e=>{n.value=Array.isArray(e)?e:[],console.log("Divisions loaded:",n.value)},onError:e=>{var o;console.error("Error fetching divisions:",e),n.value=[],y(`Error fetching divisions: ${((o=e.messages)==null?void 0:o[0])||"Unknown error"}`,"error")}}),ae=$({url:"school.al_ummah.api4.bulk_enroll_students",method:"POST",onSuccess:e=>{console.log("Bulk enrollment successful:",e),B.value=!1,e&&e.success?(L.value=e.enrolled_students||[],T.value=e.failed_enrollments||[],Q.value=e.summary||{total_processed:e.enrolled_students.length+e.failed_enrollments.length,successful:e.enrolled_students.length,failed:e.failed_enrollments.length},Ue(e.enrolled_students,e.failed_enrollments),T.value.length===0?(y(`Successfully enrolled all ${L.value.length} students!`,"success"),K("success","Enrollment Complete",`Successfully enrolled all ${L.value.length} students!`)):(y(`Completed: ${L.value.length} successful, ${T.value.length} failed.`,"warning"),K("warning","Enrollment Completed with Errors",`Completed with ${L.value.length} successful enrollments and ${T.value.length} failures.`))):y("Bulk enrollment completed with issues","warning")},onError:e=>{var o,a;console.error("Error in bulk enrollment:",e),B.value=!1,y(`Bulk enrollment failed: ${((o=e.messages)==null?void 0:o[0])||e.message||"Unknown error"}`,"error"),K("error","Bulk Enrollment Failed",((a=e.messages)==null?void 0:a[0])||e.message||"Unknown error occurred during bulk enrollment.")}});es(()=>{ue.reload(),ce.reload()});function Fe(){f.value=null,_.value=null,n.value=[],me()}function me(){_.value=null,n.value=[],f.value&&N.value&&(ne.update({params:{values:{classId:f.value,academicYear:N.value}}}),ne.reload())}function Be(e){let o="";for(;e>=0;)o=String.fromCharCode(65+e%26)+o,e=Math.floor(e/26)-1;return o}function Ge(){return W(this,null,function*(){const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls,.csv",e.onchange=o=>W(this,null,function*(){const a=o.target.files[0];if(a){V.value=a,y(null),L.value=[],T.value=[],Q.value={total_processed:0,successful:0,failed:0};try{const{data:c,headers:r}=yield Ie(a);p.value=c.slice(0,100).map(u=>Z(X({},u),{_status:null,_error:null,_touched:!1})),F.value=r,h.value=r.map((u,m)=>({type:null,column:D.encode_col(m)})),Te(r)}catch(c){console.error("Error loading preview:",c),y("Error loading file preview","error")}}}),e.click()})}function Me(){V.value=null,p.value=[],F.value=[],h.value=[],H.value=[],U.value=[],L.value=[],T.value=[],Q.value={total_processed:0,successful:0,failed:0},y(null)}function I(e){const o=h.value.some(g=>g.type==="First Name"&&e[F.value[D.decode_col(g.column)]]),a=h.value.some(g=>g.type==="Last Name"&&e[F.value[D.decode_col(g.column)]]),c=h.value.some(g=>g.type==="GR Number"&&e[F.value[D.decode_col(g.column)]]),r=h.value.some(g=>g.type==="Roll No"&&e[F.value[D.decode_col(g.column)]]),u=G(e)["Student Date of Birth"];let m=!0;return u&&u.toString().trim()!==""&&(m=pe(u)),o&&a&&c&&r&&m}function Ae(e){p.value[e]&&(p.value[e]._touched=!0)}function Ve(e){return e._status==="success"?"row-success":e._enrollment_status==="error"?"row-enrollment-error":I(e)?"":"row-invalid"}function G(e){const o={"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","Email Address":"","Phone Number":"","GR Number":"","Roll No":"","Aadhar Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Email":"","Guardian Date of Birth":"",className:f.value,divisionName:_.value,academicYear:N.value};return h.value.forEach(({type:a,column:c},r)=>{var u;if(a&&o.hasOwnProperty(a))try{const m=D.decode_col(c),g=F.value[m];let k=((u=e[g])==null?void 0:u.toString().trim())||"";if(a==="Student Date of Birth"||a==="Guardian Date of Birth"){const E=os(k);k=E?ns(E):""}o[a]=k}catch(m){console.error(`Error mapping column ${c} for type ${a}:`,m)}}),o}function Ue(e,o){console.log("Updating row statuses from bulk response..."),p.value.forEach(a=>{a._status=null,a._error=null}),e.forEach(a=>{const c=Le(a);c!==-1&&(p.value[c]._status="success",p.value[c]._error=null)}),o.forEach(a=>{const c=xe(a.student_data);c!==-1&&(p.value[c]._enrollment_status="error",p.value[c]._enrollment_error=a.error||"Unknown error")})}function Le(e){return p.value.findIndex(o=>{const a=G(o);return`${a["First Name"]} ${a["Middle Name"]} ${a["Last Name"]}`.trim()===e})}function xe(e){return p.value.findIndex(o=>{const a=G(o);return a["GR Number"]===e["GR Number"]&&a["First Name"]===e["First Name"]&&a["Last Name"]===e["Last Name"]})}function K(e,o,a){te.value=e,le.value=o,oe.value=a,se.value=!0}function Pe(){se.value=!1,te.value="success",le.value="",oe.value=""}function Ye(){return W(this,null,function*(){console.log("Enroll button clicked"),L.value=[],T.value=[],Q.value={total_processed:0,successful:0,failed:0},B.value=!0,p.value.forEach(r=>{r._status=null,r._error=null});const e=["First Name","GR Number","Last Name","Roll No"],o=h.value.map(r=>r.type).filter(r=>r),a=e.filter(r=>!o.includes(r));if(a.length>0){const r=`Please map the following required fields: ${a.join(", ")}`;console.error(r),y(r,"error"),B.value=!1;return}if(!N.value||!f.value||!_.value){const r="Please select an academic year, class, and division";console.error(r),y(r,"error"),B.value=!1;return}if(!V.value){const r="Please select a file first";console.error(r),y(r,"error"),B.value=!1;return}if(p.value.length===0){y("No data available to enroll","error"),B.value=!1;return}const c=p.value.filter(r=>{const u=G(r),m=u["Student Date of Birth"]&&u["Student Date of Birth"].toString().trim()!==""?J(u["Student Date of Birth"],"Student Date of Birth"):{isValid:!0},g=u["Guardian Date of Birth"]&&u["Guardian Date of Birth"].toString().trim()!==""?J(u["Guardian Date of Birth"],"Guardian Date of Birth"):{isValid:!0};return!m.isValid||!g.isValid});if(c.length>0){y(`${c.length} rows have invalid dates. Please correct the dates before enrolling.`,"warning"),c.forEach(r=>{const u=p.value.indexOf(r);if(u!==-1){const m=G(r),g=J(m["Student Date of Birth"],"Student Date of Birth"),k=J(m["Guardian Date of Birth"],"Guardian Date of Birth");let E="";g.isValid||(E+=g.error+" "),k.isValid||(E+=k.error),p.value[u]._status="error",p.value[u]._error=E.trim()}}),B.value=!1;return}try{y("Starting bulk enrollment process...","info");const r=p.value.filter(m=>I(m));if(r.length===0){y("No valid rows to enroll. Please check your data and mappings.","warning"),B.value=!1;return}console.log(`Starting bulk enrollment for ${r.length} students...`);const u=r.map(m=>G(m));yield ae.submit({academicYear:N.value,className:f.value,divisionName:_.value,generate_qr_code:w.value,students:u,mappings:Object.fromEntries(h.value.filter(m=>m.type).map(m=>[m.type,m.column]))})}catch(r){console.error("Bulk enrollment process error:",r),y(`Bulk enrollment process failed: ${r.message||"Unknown error"}`,"error"),K("error","Bulk Enrollment Process Failed",r.message||"Unknown error occurred during enrollment."),B.value=!1}})}function Te(e){const o={"First Name":["first","fname","given"],"Last Name":["last","lname","surname"],"Middle Name":["middle","mname"],"Email Address":["email","mail"],"Phone Number":["phone","mobile","contact"],"GR Number":["gr","grno","gr_num","gr no"],"Roll No":["r. no","roll","rollno","roll_num"],"Aadhar Number":["aadhar","aadhaar","uid","aadhar no","aadhaar no"],"Student Date of Birth":["dob","birth","birthdate","date of birth"],"Guardian Date of Birth":["guardian dob","parent dob","father dob","mother dob"],"Guardian Name":["guardian name","parent","father","mother"],"Guardian Number":["guardian no","guardian number","guardian phone","parent phone"],Relation:["relation","relationship"],"Guardian Email":["guardian email","parent email","father email","mother email"]};e.forEach((a,c)=>{if(!a)return;const r=a.toLowerCase().trim();if(r.includes("email"))if(r.includes("guardian")||r.includes("parent")){h.value[c].type="Guardian Email",console.log(`âœ“ Guardian Email: "${a}"`);return}else{h.value[c].type="Email Address",console.log(`âœ“ Student Email: "${a}"`);return}for(const[u,m]of Object.entries(o))if(m.some(g=>r.includes(g))){if(u==="Email Address"||u==="Guardian Email")continue;h.value[c].type=u,console.log(`âœ“ ${u}: "${a}"`);break}}),console.log("Final auto-detected mappings:",h.value)}function Ie(e){return new Promise((o,a)=>{const c=new FileReader;c.onload=r=>{try{const u=new Uint8Array(r.target.result),m=as(u,{type:"array",sheetStubs:!0}),g=m.Sheets[m.SheetNames[0]],k=D.decode_range(g["!ref"]);let E=0;for(let C=k.s.r;C<=k.e.r;++C){let x=!1;for(let j=k.s.c;j<=k.e.c;++j){const P=g[D.encode_cell({c:j,r:C})];if(P&&P.v!==void 0&&P.v!==null&&P.v!==""){x=!0;break}}if(x){E=C;break}}const re=[];for(let C=k.s.c;C<=k.e.c;++C){const x=g[D.encode_cell({c:C,r:E})];re.push(x?String(x.v).trim():`Column ${C+1}`)}const ve=[];for(let C=E+1;C<=k.e.r;++C){const x={};let j=!1;for(let P=k.s.c;P<=k.e.c;++P){const ie=g[D.encode_cell({c:P,r:C})],fe=re[P-k.s.c];x[fe]=ie?ie.v===void 0?"":ie.v:"",x[fe]!==""&&(j=!0)}j&&ve.push(x)}o({data:ve,headers:re})}catch(u){a(u)}},c.onerror=r=>a(r),c.readAsArrayBuffer(e)})}function je(e,o,a){h.value[e]=Z(X({},h.value[e]),{[o]:a,column:D.encode_col(e)})}function qe(e){p.value.splice(e,1),H.value=H.value.filter(o=>o.rowIndex!==e),U.value=U.value.filter(o=>o.rowIndex!==e),y("Row deleted","success")}function y(e,o="info"){de.value=e?{text:e,type:o}:null,e&&o!=="error"&&o!=="success"&&setTimeout(()=>y(null),5e3)}function Oe(e,o,a){const r=p.value[e][o]||"";if(r!==a){const u={rowIndex:e,column:o,oldValue:r,newValue:a,timestamp:new Date().toISOString()};H.value.push(u),U.value.push(u),console.log("Cell edit recorded:",u),Qe()}}function He(e,o){let a;return function(...c){clearTimeout(a),a=setTimeout(()=>e.apply(this,c),o)}}const Qe=He(We,500);function We(){return W(this,null,function*(){if(U.value.length!==0)try{const e=U.value[U.value.length-1],o=p.value[e.rowIndex],a=G(o);yield ae.submit({academicYear:N.value,className:f.value,divisionName:_.value,students:[a],mappings:Object.fromEntries(h.value.filter(c=>c.type).map(c=>[c.type,c.column]))}),U.value=[]}catch(e){console.error("Error sending cell update:",e),y(`Failed to save cell update: ${e.message||"Unknown error"}`,"error")}})}return{academicYears:b,displayYears:l,selectedYear:N,classes:Y,divisions:n,selectedClass:f,selectedDivision:_,mappings:h,fileSelected:V,options:be,message:de,previewData:p,previewHeaders:F,editHistory:H,pendingEdits:U,enrolledStudents:L,failedEnrollments:T,enrollmentSummary:Q,processing:B,showResultModal:se,resultModalType:te,resultModalTitle:le,resultModalDescription:oe,showErrorStudentsList:s,validRowsCount:ye,invalidRowsCount:Se,errorRows:ke,filteredHeaders:we,filteredMappings:Re,getStudentFullName:Ne,getStudentGR:Ee,getStudentRoll:Ce,getRowError:De,academicYearsResource:ue,classesResource:ce,divisionsResource:ne,enrollStudentsResource:ae,onYearChange:Fe,onClassChange:me,getExcelColumnLetter:Be,handleFileSelection:Ge,removeFile:Me,handleEnrollStudents:Ye,updateMapping:je,deleteRow:qe,showMessage:y,handleCellEdit:Oe,closeResultModal:Pe,isRowValid:I,markRowAsTouched:Ae,getRowStatusClass:Ve,validDate:pe,getTodayDate:ls,generateQRCode:w}}},is={class:"enrollment-container"},ds={class:"scroll-view-content"},us={key:0,class:"loading-overlay"},cs={key:1,class:"modal-overlay"},ms={class:"result-modal"},vs={key:0,class:"success-icon"},fs={key:1,class:"error-icon"},gs={class:"result-title"},hs={class:"result-description"},_s={class:"modal-actions"},ps={class:"form-card"},bs={class:"form-grid"},ys={class:"form-group required"},Ss=["disabled"],ks=["value"],ws={class:"form-group required"},Rs=["disabled"],Ns=["value"],Es={key:0,class:"form-group required"},Cs=["disabled"],Ds=["value"],Fs={class:"form-card"},Bs={class:"form-section"},Gs={key:0,class:"file-selected"},Ms={class:"button-content"},As={class:"form-section"},Vs={class:"form-group checkbox-group"},Us={class:"checkbox-label"},Ls={class:"enroll-button-section"},xs=["disabled"],Ps={class:"button-content"},Ys={key:0,class:"spinner"},Ts={key:2,class:"form-card summary-card"},Is={class:"summary-stats"},js={class:"stat-item"},qs={class:"stat-value"},Os={class:"stat-item"},Hs={class:"stat-value valid"},Qs={class:"stat-item"},Ws={class:"stat-value warning"},zs={key:0,class:"success-details"},Js={class:"section-title"},Ks={class:"results-list"},Xs={key:1,class:"error-details"},Zs={class:"section-title"},$s={class:"results-list"},et={class:"error-student"},st={class:"student-details"},tt={class:"error-text"},lt={key:3,class:"form-card preview-card"},ot={class:"summary-stats"},nt={class:"stat-item"},at={class:"stat-value"},rt={class:"stat-item"},it={class:"stat-value valid"},dt={class:"stat-item"},ut=["title"],ct={key:0,class:"error-indicator"},mt={key:0,class:"error-students-card"},vt={class:"section-title"},ft={class:"error-details",style:{"max-height":"200px","overflow-y":"auto"}},gt={class:"results-list"},ht={class:"error-student"},_t={class:"student-details"},pt={class:"error-text"},bt={key:0,class:"multiple-errors"},yt={key:1},St={key:1,class:"table-spacing"},kt={class:"table-container-wrapper"},wt={class:"table-scroll-container"},Rt={class:"table-container"},Nt={class:"preview-table"},Et=["onUpdate:modelValue","onChange"],Ct=["value"],Dt={class:"header-label"},Ft={class:"actions"},Bt=["onClick"],Gt={class:"status-cell"},Mt={key:0,class:"status-badge success"},At={key:1,class:"status-badge error"},Vt={key:2,class:"status-badge warning"},Ut={key:3,class:"status-badge pending"},Lt={key:4,class:"error-tooltip"},xt=["onUpdate:modelValue","onInput","onBlur","placeholder"];function Pt(w,s,b,l,N,Y){return d(),i("div",is,[t("div",ds,[s[43]||(s[43]=t("div",{class:"header"},[t("h1",{class:"title"},"Students Enrollment Screen")],-1)),l.processing?(d(),i("div",us,s[12]||(s[12]=[t("div",{class:"loading-modal"},[t("div",{class:"loading-spinner"}),t("h3",{class:"loading-title"},"Enrolling Students"),t("p",{class:"loading-description"},"Please wait while we process the student data...")],-1)]))):R("",!0),l.showResultModal?(d(),i("div",cs,[t("div",ms,[l.resultModalType==="success"?(d(),i("div",vs,s[13]||(s[13]=[t("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(d(),i("div",fs,s[14]||(s[14]=[t("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),t("h3",gs,v(l.resultModalTitle),1),t("p",hs,v(l.resultModalDescription),1),t("div",_s,[l.resultModalType==="success"?(d(),i("button",{key:0,class:"success-button",onClick:s[0]||(s[0]=(...n)=>l.closeResultModal&&l.closeResultModal(...n))}," Continue ")):(d(),i("button",{key:1,class:"primary-button",onClick:s[1]||(s[1]=(...n)=>l.closeResultModal&&l.closeResultModal(...n))}," Try Again "))])])])):R("",!0),t("div",ps,[s[21]||(s[21]=t("h2",{class:"form-title"},"Academic Information",-1)),t("div",bs,[t("div",ys,[s[16]||(s[16]=t("label",null,"Academic Year",-1)),O(t("select",{"onUpdate:modelValue":s[2]||(s[2]=n=>l.selectedYear=n),class:"picker",onChange:s[3]||(s[3]=(...n)=>l.onYearChange&&l.onYearChange(...n)),disabled:l.academicYearsResource.loading},[s[15]||(s[15]=t("option",{value:null},"Select a Year",-1)),(d(!0),i(M,null,A(l.displayYears,n=>(d(),i("option",{key:n,value:n.original},v(n.display),9,ks))),128))],40,Ss),[[ee,l.selectedYear]])]),t("div",ws,[s[18]||(s[18]=t("label",null,"Class / Program",-1)),O(t("select",{"onUpdate:modelValue":s[4]||(s[4]=n=>l.selectedClass=n),class:"picker",onChange:s[5]||(s[5]=(...n)=>l.onClassChange&&l.onClassChange(...n)),disabled:!l.selectedYear||l.classesResource.loading},[s[17]||(s[17]=t("option",{value:null},"Select a Class / Program",-1)),(d(!0),i(M,null,A(l.classes,n=>(d(),i("option",{key:n.name,value:n.name},v(n.name),9,Ns))),128))],40,Rs),[[ee,l.selectedClass]])]),l.divisions.length>0?(d(),i("div",Es,[s[20]||(s[20]=t("label",null,"Division / Student Group",-1)),l.divisions.length>0?O((d(),i("select",{key:0,"onUpdate:modelValue":s[6]||(s[6]=n=>l.selectedDivision=n),class:"picker",disabled:!l.selectedClass||l.divisionsResource.loading},[s[19]||(s[19]=t("option",{value:null},"Select a Division / Student Group",-1)),(d(!0),i(M,null,A(l.divisions,n=>(d(),i("option",{key:n.name,value:n.name},v(n.name),9,Ds))),128))],8,Cs)),[[ee,l.selectedDivision]]):R("",!0)])):R("",!0)])]),t("div",Fs,[s[26]||(s[26]=t("h2",{class:"form-title"},"Student Data Upload",-1)),t("div",Bs,[l.fileSelected?(d(),i("div",Gs,[t("span",null,"Selected file: "+v(l.fileSelected.name),1),t("button",{onClick:s[7]||(s[7]=(...n)=>l.removeFile&&l.removeFile(...n)),class:"remove-file-btn"},"Ã—")])):R("",!0),t("button",{class:"secondary-button",onClick:s[8]||(s[8]=(...n)=>l.handleFileSelection&&l.handleFileSelection(...n))},[t("span",Ms,v(l.fileSelected?"Change File":"Upload File ðŸ“¤"),1)]),t("div",As,[s[25]||(s[25]=t("h3",{class:"section-title"},"Additional Options",-1)),t("div",Vs,[t("label",Us,[O(t("input",{"onUpdate:modelValue":s[9]||(s[9]=n=>l.generateQRCode=n),type:"checkbox",class:"checkbox"},null,512),[[ss,l.generateQRCode]]),s[22]||(s[22]=t("span",{class:"checkmark"},null,-1)),s[23]||(s[23]=z(" Generate QR Code for Students "))]),s[24]||(s[24]=t("p",{class:"checkbox-description"},"Check this to generate QR codes for all enrolled students",-1))])]),t("div",Ls,[t("button",{class:"enroll-button",onClick:s[10]||(s[10]=(...n)=>l.handleEnrollStudents&&l.handleEnrollStudents(...n)),disabled:l.processing||!l.selectedYear||!l.selectedClass||!l.selectedDivision||!l.fileSelected},[t("span",Ps,[l.processing?(d(),i("span",Ys)):R("",!0),z(" "+v(l.processing?"Processing...":"Enroll Students"),1)])],8,xs)]),l.message?(d(),i("div",{key:1,class:_e(["message",l.message.type])},v(l.message.text),3)):R("",!0)])]),l.enrollmentSummary.total_processed>0?(d(),i("div",Ts,[s[32]||(s[32]=t("h2",{class:"form-title"},"Enrollment Summary",-1)),t("div",Is,[t("div",js,[s[27]||(s[27]=t("span",{class:"stat-label"},"Total Processed",-1)),t("span",qs,v(l.enrollmentSummary.total_processed),1)]),t("div",Os,[s[28]||(s[28]=t("span",{class:"stat-label"},"Successful",-1)),t("span",Hs,v(l.enrollmentSummary.successful),1)]),t("div",Qs,[s[29]||(s[29]=t("span",{class:"stat-label"},"Failed",-1)),t("span",Ws,v(l.enrollmentSummary.failed),1)])]),l.enrolledStudents.length>0?(d(),i("div",zs,[t("h4",Js,"Successfully Enrolled ("+v(l.enrolledStudents.length)+")",1),t("div",Ks,[(d(!0),i(M,null,A(l.enrolledStudents,(n,f)=>(d(),i("div",{key:f,class:"success-message"},[s[30]||(s[30]=t("span",{class:"status-badge success"},"Success",-1)),z(" "+v(n),1)]))),128))])])):R("",!0),l.failedEnrollments.length>0?(d(),i("div",Xs,[t("h4",Zs,"Enrollment Errors ("+v(l.failedEnrollments.length)+")",1),t("div",$s,[(d(!0),i(M,null,A(l.failedEnrollments,(n,f)=>(d(),i("div",{key:f,class:"error-message"},[t("div",et,[t("strong",null,v(n.student_data["First Name"])+" "+v(n.student_data["Middle Name"])+" "+v(n.student_data["Last Name"]),1),t("span",st,"(GR: "+v(n.student_data["GR Number"])+", Roll: "+v(n.student_data["Roll No"])+")",1)]),t("div",tt,[s[31]||(s[31]=t("span",{class:"status-badge error"},"Error",-1)),z(" "+v(n.error),1)])]))),128))])])):R("",!0)])):R("",!0),l.fileSelected&&l.previewData.length>0?(d(),i("div",lt,[s[42]||(s[42]=t("h2",{class:"form-title"},"File Preview (First 100 rows)",-1)),t("div",ot,[t("div",nt,[s[33]||(s[33]=t("span",{class:"stat-label"},"Total Rows:",-1)),t("span",at,v(l.previewData.length),1)]),t("div",rt,[s[34]||(s[34]=t("span",{class:"stat-label"},"Ready to Enroll:",-1)),t("span",it,v(l.validRowsCount),1)]),t("div",dt,[s[35]||(s[35]=t("span",{class:"stat-label"},"With Errors:",-1)),t("span",{class:"stat-value warning",style:{cursor:"pointer"},onClick:s[11]||(s[11]=n=>l.showErrorStudentsList=!l.showErrorStudentsList),title:l.invalidRowsCount>0?"Click to view students with errors":""},[z(v(l.invalidRowsCount)+" ",1),l.invalidRowsCount>0?(d(),i("span",ct,"âš ï¸")):R("",!0)],8,ut)])]),l.showErrorStudentsList&&l.errorRows.length>0?(d(),i("div",mt,[t("h4",vt,"Students with Errors ("+v(l.invalidRowsCount)+")",1),t("div",ft,[t("div",gt,[(d(!0),i(M,null,A(l.errorRows,(n,f)=>(d(),i("div",{key:f,class:"error-message"},[t("div",ht,[t("strong",null,v(l.getStudentFullName(n)),1),t("span",_t," (GR: "+v(l.getStudentGR(n))+", Roll: "+v(l.getStudentRoll(n))+") ",1)]),t("div",pt,[s[36]||(s[36]=t("span",{class:"status-badge warning"},"Warning",-1)),l.getRowError(n).includes(";")?(d(),i("span",bt,v(l.getRowError(n)),1)):(d(),i("span",yt,v(l.getRowError(n)),1))])]))),128))])])])):R("",!0),l.showErrorStudentsList&&l.errorRows.length>0?(d(),i("div",St)):R("",!0),t("div",kt,[t("div",wt,[t("div",Rt,[t("table",Nt,[t("thead",null,[t("tr",null,[s[37]||(s[37]=t("th",{class:"actions"},"Actions",-1)),s[38]||(s[38]=t("th",{class:"status-cell"},"Status",-1)),(d(!0),i(M,null,A(l.filteredHeaders,(n,f)=>(d(),i("th",{key:"letter-"+f},v(l.getExcelColumnLetter(f)),1))),128))]),t("tr",null,[s[40]||(s[40]=t("th",{class:"actions"},null,-1)),s[41]||(s[41]=t("th",{class:"status-cell"},null,-1)),(d(!0),i(M,null,A(l.filteredHeaders,(n,f)=>(d(),i("th",{key:"header-"+f},[O(t("select",{"onUpdate:modelValue":_=>l.filteredMappings[f].type=_,class:"table-select",onChange:_=>l.updateMapping(l.filteredMappings[f].originalIndex,"type",_.target.value)},[s[39]||(s[39]=t("option",{value:null},"Select Field",-1)),(d(!0),i(M,null,A(l.options,(_,h)=>(d(),i("option",{key:h,value:_},v(_),9,Ct))),128))],40,Et),[[ee,l.filteredMappings[f].type]]),t("span",Dt,v(n),1)]))),128))])]),t("tbody",null,[(d(!0),i(M,null,A(l.previewData,(n,f)=>(d(),i("tr",{key:f,class:_e(l.getRowStatusClass(n))},[t("td",Ft,[t("button",{onClick:_=>l.deleteRow(f),class:"trash-icon"}," Delete ",8,Bt)]),t("td",Gt,[n._status==="success"?(d(),i("span",Mt,"Success")):n._status==="error"?(d(),i("span",At,"Error")):l.isRowValid(n)?(d(),i("span",Ut,"Pending")):(d(),i("span",Vt,"Warning")),n._error?(d(),i("div",Lt,v(n._error),1)):R("",!0)]),(d(!0),i(M,null,A(l.filteredHeaders,(_,h)=>(d(),i("td",{key:h},[O(t("input",{"onUpdate:modelValue":V=>n[_]=V,class:"table-input",onInput:V=>l.handleCellEdit(f,_,V.target.value),onBlur:V=>l.markRowAsTouched(f),placeholder:n[_]||"-"},null,40,xt),[[ts,n[_]]])]))),128))],2))),128))])])])])])])):R("",!0)])])}const qt=$e(rs,[["render",Pt]]);export{qt as default};
