var Le=Object.defineProperty,Te=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var fe=(k,s,g)=>s in k?Le(k,s,{enumerable:!0,configurable:!0,writable:!0,value:g}):k[s]=g,ae=(k,s)=>{for(var g in s||(s={}))xe.call(s,g)&&fe(k,g,s[g]);if(ve)for(var g of ve(s))je.call(s,g)&&fe(k,g,s[g]);return k},ne=(k,s)=>Te(k,Ie(s));var H=(k,s,g)=>new Promise((t,D)=>{var N=_=>{try{c(g.next(_))}catch(G){D(G)}},o=_=>{try{c(g.throw(_))}catch(G){D(G)}},c=_=>_.done?t(_.value):Promise.resolve(_.value).then(N,o);c((g=g.apply(k,s)).next())});import{_ as Oe,r as y,y as re,j as J,k as qe,c as i,b as l,l as R,t as v,f as z,g as K,F as B,h as M,i as He,n as ge,o as d,v as ze}from"./index-CN8Igeqz.js";import{v as he,g as We,u as C,p as Je,f as Ke,a as Q,r as Qe}from"./dateUtils-CshPDU0n.js";/* empty css             */const Xe={setup(){const k=y([]),s=re(()=>k.value.map((e,a)=>({original:e,display:a===0?`${e} - Current Year`:e}))),g=y(null),t=y([]),D=y([]),N=y(null),o=y(null),c=y([]),_=y(null),G=y(["First Name","Middle Name","Last Name","Student Date of Birth","Email Address","Phone Number","GR Number","Roll No","Guardian Name","Guardian Number","Guardian Email","Relation","Guardian Date of Birth"]),T=y(null),p=y([]),P=y([]),j=y([]),U=y([]),V=y([]),L=y([]),O=y({total_processed:0,successful:0,failed:0}),E=y(!1),X=y(!1),Z=y("success"),$=y(""),ee=y(""),_e=re(()=>p.value.filter(e=>q(e)).length),pe=re(()=>p.value.filter(e=>!q(e)).length),ie=J({url:"school.al_ummah.api4.get_academic_years",params:{values:{}},onSuccess:e=>{k.value=Array.isArray(e)?e:[],k.value.length>0&&(g.value=k.value[0]),k.value.length||b("No academic years available","error")},onError:e=>{var a;console.error("Error fetching academic years:",e),k.value=[],b(`Error fetching academic years: ${((a=e.messages)==null?void 0:a[0])||"Unknown error"}`,"error")}}),de=J({url:"school.al_ummah.api4.get_classes",params:{values:{}},onSuccess:e=>{t.value=Array.isArray(e)?e:[],console.log("Classes loaded:",t.value),t.value.length||b("No classes available","error")},onError:e=>{var a;console.error("Error fetching classes:",e),t.value=[],b(`Error fetching classes: ${((a=e.messages)==null?void 0:a[0])||"Unknown error"}`,"error")}}),se=J({url:"school.al_ummah.api4.get_divisions2",params:{values:{classId:N.value,academicYear:g.value}},onSuccess:e=>{D.value=Array.isArray(e)?e:[],console.log("Divisions loaded:",D.value)},onError:e=>{var a;console.error("Error fetching divisions:",e),D.value=[],b(`Error fetching divisions: ${((a=e.messages)==null?void 0:a[0])||"Unknown error"}`,"error")}}),le=J({url:"school.al_ummah.api4.bulk_enroll_students",method:"POST",onSuccess:e=>{console.log("Bulk enrollment successful:",e),E.value=!1,e&&e.success?(V.value=e.enrolled_students||[],L.value=e.failed_enrollments||[],O.value=e.summary||{total_processed:e.enrolled_students.length+e.failed_enrollments.length,successful:e.enrolled_students.length,failed:e.failed_enrollments.length},Re(e.enrolled_students,e.failed_enrollments),L.value.length===0?(b(`✅ Successfully enrolled all ${V.value.length} students!`,"success"),W("success","Enrollment Complete",`Successfully enrolled all ${V.value.length} students!`)):(b(`Completed: ${V.value.length} successful, ${L.value.length} failed.`,"warning"),W("warning","Enrollment Completed with Errors",`Completed with ${V.value.length} successful enrollments and ${L.value.length} failures.`))):b("Bulk enrollment completed with issues","warning")},onError:e=>{var a,n;console.error("Error in bulk enrollment:",e),E.value=!1,b(`Bulk enrollment failed: ${((a=e.messages)==null?void 0:a[0])||e.message||"Unknown error"}`,"error"),W("error","Bulk Enrollment Failed",((n=e.messages)==null?void 0:n[0])||e.message||"Unknown error occurred during bulk enrollment.")}});qe(()=>{ie.reload(),de.reload()});function be(){N.value=null,o.value=null,D.value=[],ue()}function ue(){o.value=null,D.value=[],N.value&&g.value&&(se.update({params:{values:{classId:N.value,academicYear:g.value}}}),se.reload())}function ye(e){let a="";for(;e>=0;)a=String.fromCharCode(65+e%26)+a,e=Math.floor(e/26)-1;return a}function ke(){return H(this,null,function*(){const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls,.csv",e.onchange=a=>H(this,null,function*(){const n=a.target.files[0];if(n){_.value=n,b(null),V.value=[],L.value=[],O.value={total_processed:0,successful:0,failed:0};try{const{data:u,headers:r}=yield Me(n);p.value=u.slice(0,100).map(m=>ne(ae({},m),{_status:null,_error:null,_touched:!1})),P.value=r,c.value=r.map((m,f)=>({type:null,column:C.encode_col(f)})),Be(r)}catch(u){console.error("Error loading preview:",u),b("Error loading file preview","error")}}}),e.click()})}function Se(){_.value=null,p.value=[],P.value=[],c.value=[],j.value=[],U.value=[],V.value=[],L.value=[],O.value={total_processed:0,successful:0,failed:0},b(null)}function q(e){const a=c.value.some(h=>h.type==="First Name"&&e[P.value[C.decode_col(h.column)]]),n=c.value.some(h=>h.type==="Last Name"&&e[P.value[C.decode_col(h.column)]]),u=c.value.some(h=>h.type==="GR Number"&&e[P.value[C.decode_col(h.column)]]),r=c.value.some(h=>h.type==="Roll No"&&e[P.value[C.decode_col(h.column)]]),m=I(e)["Student Date of Birth"];let f=!0;return m&&m.toString().trim()!==""&&(f=he(m)),a&&n&&u&&r&&f}function we(e){p.value[e]&&(p.value[e]._touched=!0)}function Ne(e){return e._status==="success"?"row-success":e._status==="error"?"row-error":q(e)?"":"row-invalid"}function I(e){const a={"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","Email Address":"","Phone Number":"","GR Number":"","Roll No":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Email":"","Guardian Date of Birth":"",className:N.value,divisionName:o.value,academicYear:g.value};return c.value.forEach(({type:n,column:u},r)=>{var m;if(n&&a.hasOwnProperty(n))try{const f=C.decode_col(u),h=P.value[f];let S=((m=e[h])==null?void 0:m.toString().trim())||"";if(n==="Student Date of Birth"||n==="Guardian Date of Birth"){const F=Je(S);S=F?Ke(F):""}a[n]=S}catch(f){console.error(`Error mapping column ${u} for type ${n}:`,f)}}),a}function Re(e,a){console.log("Updating row statuses from bulk response..."),console.log("Enrolled students:",e),console.log("Failed enrollments:",a),p.value.forEach(n=>{n._status=null,n._error=null}),e.forEach(n=>{console.log("Looking for successful student:",n);const u=Ee(n);u!==-1?(console.log(`✅ Marking row ${u} as success for student: ${n}`),p.value[u]._status="success",p.value[u]._error=null):console.log(`❌ Could not find row for successful student: ${n}`)}),a.forEach(n=>{const u=Ce(n.student_data);u!==-1&&(console.log(`❌ Marking row ${u} as error for student:`,n.student_data["First Name"]),p.value[u]._status="error",p.value[u]._error=n.error||"Unknown error")})}function Ee(e){return p.value.findIndex(a=>{const n=I(a);return`${n["First Name"]} ${n["Middle Name"]} ${n["Last Name"]}`.trim()===e})}function Ce(e){return p.value.findIndex(a=>{const n=I(a);return n["GR Number"]===e["GR Number"]&&n["First Name"]===e["First Name"]&&n["Last Name"]===e["Last Name"]})}function W(e,a,n){Z.value=e,$.value=a,ee.value=n,X.value=!0}function De(){X.value=!1,Z.value="success",$.value="",ee.value=""}function Fe(){return H(this,null,function*(){console.log("Enroll button clicked"),V.value=[],L.value=[],O.value={total_processed:0,successful:0,failed:0},E.value=!0,p.value.forEach(r=>{r._status=null,r._error=null});const e=["First Name","GR Number","Last Name","Roll No"],a=c.value.map(r=>r.type).filter(r=>r),n=e.filter(r=>!a.includes(r));if(n.length>0){const r=`Please map the following required fields: ${n.join(", ")}`;console.error(r),b(r,"error"),E.value=!1;return}if(!g.value||!N.value||!o.value){const r="Please select an academic year, class, and division";console.error(r),b(r,"error"),E.value=!1;return}if(!_.value){const r="Please select a file first";console.error(r),b(r,"error"),E.value=!1;return}if(p.value.length===0){b("No data available to enroll","error"),E.value=!1;return}const u=p.value.filter(r=>{const m=I(r),f=m["Student Date of Birth"]&&m["Student Date of Birth"].toString().trim()!==""?Q(m["Student Date of Birth"],"Student Date of Birth"):{isValid:!0},h=m["Guardian Date of Birth"]&&m["Guardian Date of Birth"].toString().trim()!==""?Q(m["Guardian Date of Birth"],"Guardian Date of Birth"):{isValid:!0};return!f.isValid||!h.isValid});if(u.length>0){b(`${u.length} rows have invalid dates. Please correct the dates before enrolling.`,"warning"),u.forEach(r=>{const m=p.value.indexOf(r);if(m!==-1){const f=I(r),h=Q(f["Student Date of Birth"],"Student Date of Birth"),S=Q(f["Guardian Date of Birth"],"Guardian Date of Birth");let F="";h.isValid||(F+=h.error+" "),S.isValid||(F+=S.error),p.value[m]._status="error",p.value[m]._error=F.trim()}}),E.value=!1;return}try{b("Starting bulk enrollment process...","info");const r=p.value.filter(f=>q(f));if(r.length===0){b("No valid rows to enroll. Please check your data and mappings.","warning"),E.value=!1;return}console.log(`Starting bulk enrollment for ${r.length} students...`);const m=r.map(f=>I(f));yield le.submit({academicYear:g.value,className:N.value,divisionName:o.value,students:m,mappings:Object.fromEntries(c.value.filter(f=>f.type).map(f=>[f.type,f.column]))})}catch(r){console.error("Bulk enrollment process error:",r),b(`Bulk enrollment process failed: ${r.message||"Unknown error"}`,"error"),W("error","Bulk Enrollment Process Failed",r.message||"Unknown error occurred during enrollment."),E.value=!1}})}function Be(e){const a={"First Name":["first","fname","given"],"Last Name":["last","lname","surname"],"Middle Name":["middle","mname"],"Email Address":["email","mail"],"Phone Number":["phone","mobile","contact"],"GR Number":["gr","grno","gr_num"],"Roll No":["r. no","roll","rollno","roll_num"],"Student Date of Birth":["dob","birth","birthdate","date of birth","student dob","student date of birth"],"Guardian Date of Birth":["guardian dob","parent dob","father dob","mother dob","guardian date of birth"],"Guardian Name":["guardian","parent","father","mother"],"Guardian Number":["guardian no","guardian phone","parent phone","father phone","mother phone","guardian mobile"],Relation:["relation","relationship"],"Guardian Email":["guardian email","parent email","father email","mother email"]};e.forEach((n,u)=>{if(!n)return;const r=n.toLowerCase();for(const[m,f]of Object.entries(a))if(f.some(h=>r.includes(h))){c.value[u].type=m;break}}),console.log("Auto-detected mappings:",c.value)}function Me(e){return new Promise((a,n)=>{const u=new FileReader;u.onload=r=>{try{const m=new Uint8Array(r.target.result),f=Qe(m,{type:"array",sheetStubs:!0}),h=f.Sheets[f.SheetNames[0]],S=C.decode_range(h["!ref"]);let F=0;for(let w=S.s.r;w<=S.e.r;++w){let Y=!1;for(let x=S.s.c;x<=S.e.c;++x){const A=h[C.encode_cell({c:x,r:w})];if(A&&A.v!==void 0&&A.v!==null&&A.v!==""){Y=!0;break}}if(Y){F=w;break}}const te=[];for(let w=S.s.c;w<=S.e.c;++w){const Y=h[C.encode_cell({c:w,r:F})];te.push(Y?String(Y.v).trim():`Column ${w+1}`)}const ce=[];for(let w=F+1;w<=S.e.r;++w){const Y={};let x=!1;for(let A=S.s.c;A<=S.e.c;++A){const oe=h[C.encode_cell({c:A,r:w})],me=te[A-S.s.c];Y[me]=oe?oe.v===void 0?"":oe.v:"",Y[me]!==""&&(x=!0)}x&&ce.push(Y)}a({data:ce,headers:te})}catch(m){n(m)}},u.onerror=r=>n(r),u.readAsArrayBuffer(e)})}function Ge(e,a,n){c.value[e]=ne(ae({},c.value[e]),{[a]:n,column:C.encode_col(e)})}function Ue(e){p.value.splice(e,1),j.value=j.value.filter(a=>a.rowIndex!==e),U.value=U.value.filter(a=>a.rowIndex!==e),b("Row deleted","success")}function b(e,a="info"){T.value=e?{text:e,type:a}:null,e&&a!=="error"&&a!=="success"&&setTimeout(()=>b(null),5e3)}function Ve(e,a,n){const r=p.value[e][a]||"";if(r!==n){const m={rowIndex:e,column:a,oldValue:r,newValue:n,timestamp:new Date().toISOString()};j.value.push(m),U.value.push(m),console.log("Cell edit recorded:",m),Ae()}}function Ye(e,a){let n;return function(...u){clearTimeout(n),n=setTimeout(()=>e.apply(this,u),a)}}const Ae=Ye(Pe,500);function Pe(){return H(this,null,function*(){if(U.value.length!==0)try{const e=U.value[U.value.length-1],a=p.value[e.rowIndex],n=I(a);yield le.submit({academicYear:g.value,className:N.value,divisionName:o.value,students:[n],mappings:Object.fromEntries(c.value.filter(u=>u.type).map(u=>[u.type,u.column]))}),U.value=[]}catch(e){console.error("Error sending cell update:",e),b(`Failed to save cell update: ${e.message||"Unknown error"}`,"error")}})}return{academicYears:k,displayYears:s,selectedYear:g,classes:t,divisions:D,selectedClass:N,selectedDivision:o,mappings:c,fileSelected:_,options:G,message:T,previewData:p,previewHeaders:P,editHistory:j,pendingEdits:U,enrolledStudents:V,failedEnrollments:L,enrollmentSummary:O,processing:E,showResultModal:X,resultModalType:Z,resultModalTitle:$,resultModalDescription:ee,validRowsCount:_e,invalidRowsCount:pe,academicYearsResource:ie,classesResource:de,divisionsResource:se,enrollStudentsResource:le,onYearChange:be,onClassChange:ue,getExcelColumnLetter:ye,handleFileSelection:ke,removeFile:Se,handleEnrollStudents:Fe,updateMapping:Ge,deleteRow:Ue,showMessage:b,handleCellEdit:Ve,closeResultModal:De,isRowValid:q,markRowAsTouched:we,getRowStatusClass:Ne,validDate:he,getTodayDate:We}}},Ze={class:"enrollment-container"},$e={class:"scroll-view-content"},es={key:0,class:"loading-overlay"},ss={key:1,class:"modal-overlay"},ls={class:"result-modal"},ts={key:0,class:"success-icon"},os={key:1,class:"error-icon"},as={class:"result-title"},ns={class:"result-description"},rs={class:"modal-actions"},is={class:"form-card"},ds={class:"form-grid"},us={class:"form-group required"},cs=["disabled"],ms=["value"],vs={class:"form-group required"},fs=["disabled"],gs=["value"],hs={key:0,class:"form-group required"},_s=["disabled"],ps=["value"],bs={class:"form-card"},ys={class:"form-section"},ks={key:0,class:"file-selected"},Ss={class:"button-content"},ws={class:"enroll-button-section"},Ns=["disabled"],Rs={class:"button-content"},Es={key:0,class:"spinner"},Cs={key:2,class:"summary-section"},Ds={class:"summary-stats"},Fs={class:"stat-item"},Bs={class:"stat-value"},Ms={class:"stat-item"},Gs={class:"stat-value valid"},Us={class:"stat-item"},Vs={class:"stat-value warning"},Ys={key:3,class:"success-details"},As={class:"section-title"},Ps={class:"results-list"},Ls={key:4,class:"error-details"},Ts={class:"section-title"},Is={class:"results-list"},xs={class:"error-student"},js={class:"student-details"},Os={class:"error-text"},qs={key:2,class:"form-card preview-card"},Hs={class:"summary-stats"},zs={class:"stat-item"},Ws={class:"stat-value"},Js={class:"stat-item"},Ks={class:"stat-value valid"},Qs={class:"stat-item"},Xs={class:"stat-value warning"},Zs={class:"table-container-wrapper"},$s={class:"table-scroll-container"},el={class:"table-container"},sl={class:"preview-table"},ll=["onUpdate:modelValue","onChange"],tl=["value"],ol={class:"header-label"},al={class:"actions"},nl=["onClick"],rl={class:"status-cell"},il={key:0,class:"status-badge success"},dl={key:1,class:"status-badge error"},ul={key:2,class:"status-badge warning"},cl={key:3,class:"status-badge pending"},ml={key:4,class:"error-tooltip"},vl=["onUpdate:modelValue","onInput","onBlur","placeholder"];function fl(k,s,g,t,D,N){return d(),i("div",Ze,[l("div",$e,[s[35]||(s[35]=l("div",{class:"header"},[l("h1",{class:"title"},"Students Enrollment Screen")],-1)),t.processing?(d(),i("div",es,s[10]||(s[10]=[l("div",{class:"loading-modal"},[l("div",{class:"loading-spinner"}),l("h3",{class:"loading-title"},"Enrolling Students"),l("p",{class:"loading-description"},"Please wait while we process the student data...")],-1)]))):R("",!0),t.showResultModal?(d(),i("div",ss,[l("div",ls,[t.resultModalType==="success"?(d(),i("div",ts,s[11]||(s[11]=[l("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(d(),i("div",os,s[12]||(s[12]=[l("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),l("h3",as,v(t.resultModalTitle),1),l("p",ns,v(t.resultModalDescription),1),l("div",rs,[t.resultModalType==="success"?(d(),i("button",{key:0,class:"success-button",onClick:s[0]||(s[0]=(...o)=>t.closeResultModal&&t.closeResultModal(...o))}," Continue ")):(d(),i("button",{key:1,class:"primary-button",onClick:s[1]||(s[1]=(...o)=>t.closeResultModal&&t.closeResultModal(...o))}," Try Again "))])])])):R("",!0),l("div",is,[s[19]||(s[19]=l("h2",{class:"form-title"},"Academic Information",-1)),l("div",ds,[l("div",us,[s[14]||(s[14]=l("label",null,"Academic Year",-1)),z(l("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.selectedYear=o),class:"picker",onChange:s[3]||(s[3]=(...o)=>t.onYearChange&&t.onYearChange(...o)),disabled:t.academicYearsResource.loading},[s[13]||(s[13]=l("option",{value:null},"Select a Year",-1)),(d(!0),i(B,null,M(t.displayYears,o=>(d(),i("option",{key:o,value:o.original},v(o.display),9,ms))),128))],40,cs),[[K,t.selectedYear]])]),l("div",vs,[s[16]||(s[16]=l("label",null,"Class / Program",-1)),z(l("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.selectedClass=o),class:"picker",onChange:s[5]||(s[5]=(...o)=>t.onClassChange&&t.onClassChange(...o)),disabled:!t.selectedYear||t.classesResource.loading},[s[15]||(s[15]=l("option",{value:null},"Select a Class / Program",-1)),(d(!0),i(B,null,M(t.classes,o=>(d(),i("option",{key:o.name,value:o.name},v(o.name),9,gs))),128))],40,fs),[[K,t.selectedClass]])]),t.divisions.length>0?(d(),i("div",hs,[s[18]||(s[18]=l("label",null,"Division / Student Group",-1)),t.divisions.length>0?z((d(),i("select",{key:0,"onUpdate:modelValue":s[6]||(s[6]=o=>t.selectedDivision=o),class:"picker",disabled:!t.selectedClass||t.divisionsResource.loading},[s[17]||(s[17]=l("option",{value:null},"Select a Division / Student Group",-1)),(d(!0),i(B,null,M(t.divisions,o=>(d(),i("option",{key:o.name,value:o.name},v(o.name),9,ps))),128))],8,_s)),[[K,t.selectedDivision]]):R("",!0)])):R("",!0)])]),l("div",bs,[s[24]||(s[24]=l("h2",{class:"form-title"},"Student Data Upload",-1)),l("div",ys,[t.fileSelected?(d(),i("div",ks,[l("span",null,"Selected file: "+v(t.fileSelected.name),1),l("button",{onClick:s[7]||(s[7]=(...o)=>t.removeFile&&t.removeFile(...o)),class:"remove-file-btn"},"×")])):R("",!0),l("button",{class:"secondary-button",onClick:s[8]||(s[8]=(...o)=>t.handleFileSelection&&t.handleFileSelection(...o))},[l("span",Ss,v(t.fileSelected?"Change File":"Upload File 📤"),1)]),l("div",ws,[l("button",{class:"enroll-button",onClick:s[9]||(s[9]=(...o)=>t.handleEnrollStudents&&t.handleEnrollStudents(...o)),disabled:t.processing||!t.selectedYear||!t.selectedClass||!t.selectedDivision||!t.fileSelected},[l("span",Rs,[t.processing?(d(),i("span",Es)):R("",!0),He(" "+v(t.processing?"Processing...":"Enroll Students ✅"),1)])],8,Ns)]),t.message?(d(),i("div",{key:1,class:ge(["message",t.message.type])},v(t.message.text),3)):R("",!0),t.enrollmentSummary.total_processed>0?(d(),i("div",Cs,[s[23]||(s[23]=l("h4",{class:"section-title"},"Enrollment Summary",-1)),l("div",Ds,[l("div",Fs,[s[20]||(s[20]=l("span",{class:"stat-label"},"Total Processed",-1)),l("span",Bs,v(t.enrollmentSummary.total_processed),1)]),l("div",Ms,[s[21]||(s[21]=l("span",{class:"stat-label"},"Successful",-1)),l("span",Gs,v(t.enrollmentSummary.successful),1)]),l("div",Us,[s[22]||(s[22]=l("span",{class:"stat-label"},"Failed",-1)),l("span",Vs,v(t.enrollmentSummary.failed),1)])])])):R("",!0),t.enrolledStudents.length>0?(d(),i("div",Ys,[l("h4",As,"Successfully Enrolled ("+v(t.enrolledStudents.length)+")",1),l("div",Ps,[(d(!0),i(B,null,M(t.enrolledStudents,(o,c)=>(d(),i("div",{key:c,class:"success-message"}," ✅ "+v(o),1))),128))])])):R("",!0),t.failedEnrollments.length>0?(d(),i("div",Ls,[l("h4",Ts,"Enrollment Errors ("+v(t.failedEnrollments.length)+")",1),l("div",Is,[(d(!0),i(B,null,M(t.failedEnrollments,(o,c)=>(d(),i("div",{key:c,class:"error-message"},[l("div",xs,[l("strong",null,v(o.student_data["First Name"])+" "+v(o.student_data["Middle Name"])+" "+v(o.student_data["Last Name"]),1),l("span",js,"(GR: "+v(o.student_data["GR Number"])+", Roll: "+v(o.student_data["Roll No"])+")",1)]),l("div",Os,"❌ "+v(o.error),1)]))),128))])])):R("",!0)])]),t.fileSelected&&t.previewData.length>0?(d(),i("div",qs,[s[34]||(s[34]=l("h2",{class:"form-title"},"File Preview (First 100 rows)",-1)),l("div",Hs,[l("div",zs,[s[25]||(s[25]=l("span",{class:"stat-label"},"Total Rows:",-1)),l("span",Ws,v(t.previewData.length),1)]),l("div",Js,[s[26]||(s[26]=l("span",{class:"stat-label"},"Ready to Enroll:",-1)),l("span",Ks,v(t.validRowsCount),1)]),l("div",Qs,[s[27]||(s[27]=l("span",{class:"stat-label"},"With Errors:",-1)),l("span",Xs,v(t.invalidRowsCount),1)])]),l("div",Zs,[l("div",$s,[l("div",el,[l("table",sl,[l("thead",null,[l("tr",null,[s[28]||(s[28]=l("th",{class:"actions"},"Actions",-1)),s[29]||(s[29]=l("th",{class:"status-cell"},"Status",-1)),(d(!0),i(B,null,M(t.previewHeaders,(o,c)=>(d(),i("th",{key:"letter-"+c},v(t.getExcelColumnLetter(c)),1))),128))]),l("tr",null,[s[31]||(s[31]=l("th",{class:"actions"},null,-1)),s[32]||(s[32]=l("th",{class:"status-cell"},null,-1)),(d(!0),i(B,null,M(t.previewHeaders,(o,c)=>(d(),i("th",{key:"header-"+c},[z(l("select",{"onUpdate:modelValue":_=>t.mappings[c].type=_,class:"table-select",onChange:_=>t.updateMapping(c,"type",_.target.value)},[s[30]||(s[30]=l("option",{value:null},"Select Field",-1)),(d(!0),i(B,null,M(t.options,(_,G)=>(d(),i("option",{key:G,value:_},v(_),9,tl))),128))],40,ll),[[K,t.mappings[c].type]]),l("span",ol,v(o),1)]))),128))])]),l("tbody",null,[(d(!0),i(B,null,M(t.previewData,(o,c)=>(d(),i("tr",{key:c,class:ge(t.getRowStatusClass(o))},[l("td",al,[l("button",{onClick:_=>t.deleteRow(c),class:"trash-icon"},s[33]||(s[33]=[l("span",{class:"icon"},"❎",-1)]),8,nl)]),l("td",rl,[o._status==="success"?(d(),i("span",il,"✅")):o._status==="error"?(d(),i("span",dl,"❌")):t.isRowValid(o)?(d(),i("span",cl,"🔄")):(d(),i("span",ul,"⚠️")),o._error?(d(),i("div",ml,v(o._error),1)):R("",!0)]),(d(!0),i(B,null,M(t.previewHeaders,(_,G)=>(d(),i("td",{key:G},[z(l("input",{"onUpdate:modelValue":T=>o[_]=T,class:"table-input",onInput:T=>t.handleCellEdit(c,_,T.target.value),onBlur:T=>t.markRowAsTouched(c),placeholder:o[_]||"-"},null,40,vl),[[ze,o[_]]])]))),128))],2))),128))])])])])])])):R("",!0)])])}const bl=Oe(Xe,[["render",fl]]);export{bl as default};
