var le=Object.defineProperty,de=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var oe=(s,e,r)=>e in s?le(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,U=(s,e)=>{for(var r in e||(e={}))ce.call(e,r)&&oe(s,r,e[r]);if(se)for(var r of se(e))me.call(e,r)&&oe(s,r,e[r]);return s},V=(s,e)=>de(s,ue(e));var ie=(s,e,r)=>new Promise((i,l)=>{var n=a=>{try{d(r.next(a))}catch(v){l(v)}},o=a=>{try{d(r.throw(a))}catch(v){l(v)}},d=a=>a.done?i(a.value):Promise.resolve(a.value).then(n,o);d((r=r.apply(s,e)).next())});import{_ as G,o as u,a as c,b as t,y as f,D as x,z as W,F as C,l as S,t as m,h as A,r as _,x as M,j as te,i as w,n as T,E,g as ne,c as ee,d as H,H as ge,q as pe,v as be,e as ve,f as fe}from"./index-BRDXlhrI.js";/* empty css             */const he={props:{values:Object},computed:{email:{get(){return this.values.email},set(s){this.$emit("update-field",{field:"email",value:s})}},googleAppPassword:{get(){return this.values.googleAppPassword},set(s){this.$emit("update-field",{field:"googleAppPassword",value:s})}}},methods:{updateField(s,e){this.$emit("update-field",{field:s,value:e})}}},xe={class:"card"},ye={class:"field"},Ce={class:"field"};function Se(s,e,r,i,l,n){return u(),c("div",xe,[t("div",ye,[e[5]||(e[5]=t("label",null,"Email Address",-1)),f(t("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=o=>n.email=o),placeholder:"Enter your email address",onInput:e[1]||(e[1]=o=>n.updateField("email",o.target.value))},null,544),[[x,n.email]])]),t("div",Ce,[e[6]||(e[6]=t("label",null,"Google App Password",-1)),f(t("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=o=>n.googleAppPassword=o),placeholder:"Enter your Google app password",onInput:e[3]||(e[3]=o=>n.updateField("googleAppPassword",o.target.value))},null,544),[[x,n.googleAppPassword]])]),t("button",{onClick:e[4]||(e[4]=o=>s.$emit("submit-email"))},"Submit Email Account")])}const _e=G(he,[["render",Se],["__scopeId","data-v-a1f91314"]]),we={props:{values:Object},data(){return{selectedTerm:"",lastValidTermCount:0}},computed:{academicYear:{get(){return this.values.academicYear},set(s){this.$emit("update-field",{field:"academicYear",value:s})}},academicYearStart:{get(){return this.values.academicYearStart},set(s){this.$emit("update-field",{field:"academicYearStart",value:s})}},academicYearEnd:{get(){return this.values.academicYearEnd},set(s){this.$emit("update-field",{field:"academicYearEnd",value:s})}},numberOfTerms:{get(){return this.values.numberOfTerms},set(s){this.$emit("update-field",{field:"numberOfTerms",value:s})}}},methods:{handleNumberOfTermsChange(s){const e=parseInt(s.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.adjustTermsToMatchCount()):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.adjustTermsToMatchCount()},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.adjustTermsToMatchCount())},adjustTermsToMatchCount(){const s=this.values.terms.length,e=this.numberOfTerms;if(e>s){const r=e-s,i=[...this.values.terms];for(let l=0;l<r;l++){const n=s+l+1,{startDate:o,endDate:d}=this.calculateTermDates(n,e);i.push({name:`Term ${n}`,startDate:o,endDate:d})}this.$emit("update-field-array",{field:"terms",value:i})}else if(e<s){const r=s-e,i=[...this.values.terms];i.splice(-r,r),this.$emit("update-field-array",{field:"terms",value:i})}},calculateTermDates(s,e){if(!this.academicYearStart||!this.academicYearEnd)return{startDate:"",endDate:""};const r=new Date(this.academicYearStart),n=(new Date(this.academicYearEnd)-r)/e,o=new Date(r.getTime()+n*(s-1)),d=new Date(r.getTime()+n*s-1),a=v=>v.toISOString().split("T")[0];return{startDate:a(o),endDate:a(d)}},formatDate(s){if(!s)return"";const e={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(void 0,e)},updateField(s,e){this.$emit("update-field",{field:s,value:e})},updateTermField(s,e,r){this.$emit("update-field-array",{field:"terms",index:s,subField:e,value:r})},addTerm(){const s={name:"",startDate:"",endDate:""};this.$emit("update-field-array",{field:"terms",value:[...this.values.terms,s]}),this.numberOfTerms=this.values.terms.length},removeTerm(s){const e=[...this.values.terms];e.splice(s,1),this.$emit("update-field-array",{field:"terms",value:e}),this.numberOfTerms=e.length},handleTermsInput(s){const e=parseInt(s.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.$emit("auto-create-terms")):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.$emit("auto-create-terms")},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.$emit("auto-create-terms"))}},mounted(){this.lastValidTermCount=this.numberOfTerms||1}},ke={class:"academic-year-form"},Te={class:"form-grid"},De={class:"form-row"},Ae={class:"form-group full-width required"},je={class:"form-row date-range-row"},Ge={class:"form-group required"},Fe={class:"form-group required"},Pe={class:"form-row"},Ne={class:"form-group full-width required"},Ie={class:"number-input-group"},Oe={class:"number-input-buttons"},Ue=["disabled"],Ve={class:"form-row"},Ee={class:"form-group full-width"},Me=["value"],Le={class:"terms-list"},Ye={class:"term-header"},Be={class:"section-title"},$e=["onClick"],Re={class:"term-body"},qe={class:"form-group required"},He=["onUpdate:modelValue","placeholder","onInput"],We={class:"form-row term-dates-row"},Ke={class:"form-group required"},ze=["onUpdate:modelValue","onInput"],Je={class:"form-group required"},Qe=["onUpdate:modelValue","onInput"],Ze={class:"form-actions"};function Xe(s,e,r,i,l,n){return u(),c("div",ke,[e[23]||(e[23]=t("div",{class:"form-header"},[t("h3",{class:"form-title"},"Academic Year Setup"),t("p",{class:"form-subtitle"}," Provide details about the academic year, its duration, and terms. ")],-1)),t("div",Te,[t("div",De,[t("div",Ae,[e[13]||(e[13]=t("label",{class:"form-label"},"Academic Year",-1)),f(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>n.academicYear=o),class:"input",placeholder:"e.g., 2023-2024",onInput:e[1]||(e[1]=o=>n.updateField("academicYear",o.target.value))},null,544),[[x,n.academicYear]])])]),t("div",je,[t("div",Ge,[e[14]||(e[14]=t("label",{class:"form-label"},"Start Date",-1)),f(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=o=>n.academicYearStart=o),class:"input",onInput:e[3]||(e[3]=o=>n.updateField("academicYearStart",o.target.value))},null,544),[[x,n.academicYearStart]])]),t("div",Fe,[e[15]||(e[15]=t("label",{class:"form-label"},"End Date",-1)),f(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=o=>n.academicYearEnd=o),class:"input",onInput:e[5]||(e[5]=o=>n.updateField("academicYearEnd",o.target.value))},null,544),[[x,n.academicYearEnd]])])]),t("div",Pe,[t("div",Ne,[e[16]||(e[16]=t("label",{class:"form-label"},"Number of Terms",-1)),t("div",Ie,[f(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=o=>n.numberOfTerms=o),class:"input number-input",placeholder:"e.g., 3",min:"1",onInput:e[7]||(e[7]=(...o)=>n.handleNumberOfTermsChange&&n.handleNumberOfTermsChange(...o))},null,544),[[x,n.numberOfTerms,void 0,{number:!0}]]),t("div",Oe,[t("button",{class:"number-input-btn minus-btn",onClick:e[8]||(e[8]=(...o)=>n.decrementTerms&&n.decrementTerms(...o)),disabled:n.numberOfTerms<=1,type:"button"}," − ",8,Ue),t("button",{class:"number-input-btn plus-btn",onClick:e[9]||(e[9]=(...o)=>n.incrementTerms&&n.incrementTerms(...o)),type:"button"}," + ")])])])]),t("div",Ve,[t("div",Ee,[e[18]||(e[18]=t("label",{class:"form-label"},"Current Academic Term",-1)),f(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.selectedTerm=o),class:"picker",onChange:e[11]||(e[11]=o=>n.updateField("selectedTerm",o.target.value))},[e[17]||(e[17]=t("option",{value:""},"-- Select a Term --",-1)),(u(!0),c(C,null,S(r.values.terms,(o,d)=>(u(),c("option",{key:d,value:o.name},m(o.name)+" ("+m(n.formatDate(o.startDate))+" - "+m(n.formatDate(o.endDate))+") ",9,Me))),128))],544),[[W,l.selectedTerm]])])])]),t("div",Le,[(u(!0),c(C,null,S(r.values.terms,(o,d)=>(u(),c("div",{key:d,class:"term-card form-card"},[t("div",Ye,[t("h4",Be,"Term "+m(d+1),1),t("button",{class:"trash-icon",onClick:a=>n.removeTerm(d),title:"Remove term",type:"button"}," ✕ ",8,$e)]),t("div",Re,[t("div",qe,[e[19]||(e[19]=t("label",{class:"form-label"},"Term Name",-1)),f(t("input",{type:"text","onUpdate:modelValue":a=>o.name=a,class:"input",placeholder:`e.g., Spring ${d+1}`,onInput:a=>n.updateTermField(d,"name",a.target.value)},null,40,He),[[x,o.name]])]),t("div",We,[t("div",Ke,[e[20]||(e[20]=t("label",{class:"form-label"},"Start Date",-1)),f(t("input",{type:"date","onUpdate:modelValue":a=>o.startDate=a,class:"input",onInput:a=>n.updateTermField(d,"startDate",a.target.value)},null,40,ze),[[x,o.startDate]])]),t("div",Je,[e[21]||(e[21]=t("label",{class:"form-label"},"End Date",-1)),f(t("input",{type:"date","onUpdate:modelValue":a=>o.endDate=a,class:"input",onInput:a=>n.updateTermField(d,"endDate",a.target.value)},null,40,Qe),[[x,o.endDate]])])])])]))),128))]),t("div",Ze,[t("button",{class:"primary-button",onClick:e[12]||(e[12]=(...o)=>n.addTerm&&n.addTerm(...o)),type:"button"},e[22]||(e[22]=[t("span",{class:"button-content"},[t("span",{class:"icon"},"+"),A(" Add Term ")],-1)]))])])}const et=G(we,[["render",Xe],["__scopeId","data-v-6ea154fc"]]),tt={props:{values:Object,previousDataList:Array},emits:["update-field","use-previous-data"],setup(s,{emit:e}){const r=_(null),i=_(s.values.dontCreateClasses||!1),l=_(!1),n=_(""),o=M({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:v=>{console.log("Previous data loaded successfully")},onError:v=>{console.error("Error fetching previous data:",v)}}),d=()=>{if(!r.value){console.warn("No data selected");return}e("use-previous-data",r.value),n.value=r.value.academicYear,l.value=!0,setTimeout(()=>{l.value=!1},5e3)},a=()=>{e("update-field",{field:"dontCreateClasses",value:i.value})};return te(()=>{(!s.previousDataList||s.previousDataList.length===0)&&o.reload()}),{selectedPreviousData:r,dontCreateClasses:i,showSuccessMessage:l,usedPreviousYear:n,previousDataResource:o,handleUsePreviousData:d,updateDontCreateClasses:a}}},st={class:"card"},ot={key:0,class:"loading"},it={key:1},nt={key:0,class:"success-message"},rt={class:"field"},at=["value"],lt=["disabled"];function dt(s,e,r,i,l,n){return u(),c("div",st,[e[3]||(e[3]=t("h3",{class:"section-title"},"Use Previous Data",-1)),i.previousDataResource.loading?(u(),c("div",ot,"Loading previous data...")):(u(),c("div",it,[i.showSuccessMessage?(u(),c("div",nt," ✓ Previous data from "+m(i.usedPreviousYear)+" has been successfully loaded ",1)):w("",!0),t("div",rt,[f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.selectedPreviousData=o)},[e[2]||(e[2]=t("option",{value:null},"Select a year",-1)),(u(!0),c(C,null,S(r.previousDataList,(o,d)=>(u(),c("option",{key:d,value:o},m(o.academicYear),9,at))),128))],512),[[W,i.selectedPreviousData]])]),t("button",{onClick:e[1]||(e[1]=(...o)=>i.handleUsePreviousData&&i.handleUsePreviousData(...o)),disabled:!i.selectedPreviousData}," Use Previous Data ",8,lt)]))])}const ut=G(tt,[["render",dt],["__scopeId","data-v-b5328e59"]]),ct=[{id:1,name:"Pre-K"},{id:2,name:"Kindergarten"},{id:3,name:"1st Grade"},{id:4,name:"2nd Grade"},{id:5,name:"3rd Grade"},{id:6,name:"4th Grade"},{id:7,name:"5th Grade"},{id:8,name:"6th Grade"},{id:9,name:"7th Grade"},{id:10,name:"8th Grade"},{id:11,name:"9th Grade"},{id:12,name:"10th Grade"},{id:13,name:"11th Grade"},{id:14,name:"12th Grade"},{id:15,name:"Other"}],mt={school:["Nursery","Jr KG","Sr KG","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th"],college:["FY BSc","SY BSc","TY BSc","FY BCA","SY BCA","TY BCA","FY BTech","SY BTech","TY BTech","Final Year BTech","FY BCom","SY BCom","TY BCom","MBA"]},gt={props:{values:Object},data(){return{selectedInstitution:"",editablePrograms:[],availablePrograms:ct}},watch:{"values.classes":{immediate:!0,handler(s){s&&s.length>0&&(this.editablePrograms=[...s])}}},computed:{selectedPrograms(){return this.values.classes||[]}},methods:{isSelected(s){return this.selectedPrograms.some(e=>e.id===s.id)},toggleProgram(s){let e;this.isSelected(s)?e=this.selectedPrograms.filter(r=>r.id!==s.id):e=[...this.selectedPrograms,{id:s.id,className:s.name,subjects:[],divisions:[]}],this.updatePrograms(e)},handleEditProgram(s,e){const r=this.editablePrograms.map(i=>i.id===s?V(U({},i),{className:e}):i);this.updatePrograms(r)},handleDeleteProgram(s){const e=this.editablePrograms.filter(r=>r.id!==s);this.updatePrograms(e)},handleAddProgram(){const s={id:Math.random().toString(),className:"",subjects:[],divisions:[]},e=[...this.editablePrograms,s];this.updatePrograms(e)},handleInstitutionChange(){const s=(mt[this.selectedInstitution]||[]).map(e=>({id:Math.random().toString(),className:e,subjects:[],divisions:[]}));this.updatePrograms(s)},updatePrograms(s){this.editablePrograms=s,this.$emit("update-field-array",{field:"classes",value:s})}}},pt={class:"program-selector-container"},bt={class:"institution-selector"},vt={key:0,class:"programs-list"},ft=["onUpdate:modelValue","onInput"],ht=["onClick"],xt={key:1,class:"quick-select"},yt={class:"program-grid"},Ct=["onClick"];function St(s,e,r,i,l,n){return u(),c("div",pt,[t("div",bt,[e[4]||(e[4]=t("label",{class:"form-label"},"Select Institution Type",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.selectedInstitution=o),class:"form-select",onChange:e[1]||(e[1]=(...o)=>n.handleInstitutionChange&&n.handleInstitutionChange(...o))},e[3]||(e[3]=[t("option",{value:""},"Select Institution",-1),t("option",{value:"school"},"School",-1),t("option",{value:"college"},"College",-1)]),544),[[W,l.selectedInstitution]])]),l.editablePrograms.length>0?(u(),c("div",vt,[e[6]||(e[6]=t("h3",{class:"section-title"},"Classes List",-1)),(u(!0),c(C,null,S(l.editablePrograms,o=>(u(),c("div",{key:o.id,class:"program-item"},[f(t("input",{type:"text","onUpdate:modelValue":d=>o.className=d,class:"program-input",onInput:d=>n.handleEditProgram(o.id,d.target.value)},null,40,ft),[[x,o.className]]),t("button",{class:"delete-btn",onClick:d=>n.handleDeleteProgram(o.id),title:"Remove class"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]),8,ht)]))),128))])):w("",!0),l.selectedInstitution===""?(u(),c("div",xt,[e[7]||(e[7]=t("h3",{class:"section-title"},"Quick Select Programs",-1)),t("div",yt,[(u(!0),c(C,null,S(l.availablePrograms,o=>(u(),c("div",{key:o.id,class:T(["program-card",{selected:n.isSelected(o)}]),onClick:d=>n.toggleProgram(o)},m(o.name),11,Ct))),128))])])):w("",!0),t("button",{class:"add-btn",onClick:e[2]||(e[2]=(...o)=>n.handleAddProgram&&n.handleAddProgram(...o))},e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),A(" Add Class ")]))])}const _t=G(gt,[["render",St],["__scopeId","data-v-f6b17094"]]),wt={props:{values:Object},data(){return{newCommonSubject:"",newCommonDivision:"",commonSubjectsList:[],commonDivisionsList:[],classesWithText:[],commonSubjects:["Math","Social Studies","Science","English","History","Geography","Physics","Chemistry","Biology","Computer","Civics","Hindi","Marathi","Arabic","Play"],commonDivisions:["A","B","C","D","E","F"]}},created(){this.values.commonSubjects&&(this.commonSubjectsList=[...this.values.commonSubjects]),this.values.commonDivisions&&(this.commonDivisionsList=[...this.values.commonDivisions])},watch:{"values.classes":{immediate:!0,deep:!0,handler(s){this.classesWithText=s.map(e=>V(U({},e),{subjectsText:"",divisionsText:"",specificSubjects:e.subjects?e.subjects.filter(r=>!this.commonSubjectsList.includes(r)):[],specificDivisions:e.divisions?e.divisions.filter(r=>{const i=r.divisionName.split("-").slice(1).join("-");return!this.commonDivisionsList.includes(i)}):[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}))}},commonSubjectsList:{handler(s){this.$emit("update-field",{field:"commonSubjects",value:s}),this.updateAllClassesWithCommonData()},deep:!0},commonDivisionsList:{handler(s){this.$emit("update-field",{field:"commonDivisions",value:s}),this.updateAllClassesWithCommonData()},deep:!0}},methods:{addCommonSubject(){this.newCommonSubject.trim()&&!this.commonSubjectsList.includes(this.newCommonSubject.trim())&&(this.commonSubjectsList.push(this.newCommonSubject.trim()),this.newCommonSubject="")},removeCommonSubject(s){this.commonSubjectsList.splice(s,1)},isCommonSubjectSelected(s){return this.commonSubjectsList.includes(s)},toggleCommonSubject(s){this.isCommonSubjectSelected(s)?this.removeCommonSubject(this.commonSubjectsList.indexOf(s)):(this.newCommonSubject=s,this.addCommonSubject())},addCommonDivision(){this.newCommonDivision.trim()&&!this.commonDivisionsList.includes(this.newCommonDivision.trim())&&(this.commonDivisionsList.push(this.newCommonDivision.trim()),this.newCommonDivision="")},removeCommonDivision(s){this.commonDivisionsList.splice(s,1)},isCommonDivisionSelected(s){return this.commonDivisionsList.includes(s)},toggleCommonDivision(s){this.isCommonDivisionSelected(s)?this.removeCommonDivision(this.commonDivisionsList.indexOf(s)):(this.newCommonDivision=s,this.addCommonDivision())},addSpecificSubject(s){if(this.classesWithText[s].subjectsText.trim()){const e=[...this.classesWithText];e[s].specificSubjects=[...e[s].specificSubjects,e[s].subjectsText.trim()],e[s].subjectsText="",this.emitUpdatedClasses(e)}},removeSpecificSubject(s,e){const r=[...this.classesWithText];r[s].specificSubjects.splice(e,1),this.emitUpdatedClasses(r)},addSpecificDivision(s){if(this.classesWithText[s].divisionsText.trim()){const e=[...this.classesWithText],r=e[s].className||"Class";e[s].specificDivisions=[...e[s].specificDivisions,{divisionName:`${r}-${e[s].divisionsText.trim()}`}],e[s].divisionsText="",this.emitUpdatedClasses(e)}},removeSpecificDivision(s,e){const r=[...this.classesWithText];r[s].specificDivisions.splice(e,1),this.emitUpdatedClasses(r)},updateClassName(s,e){const r=[...this.classesWithText],i=r[s].className;r[s].className=e,r[s].specificDivisions&&(r[s].specificDivisions=r[s].specificDivisions.map(l=>{const n=l.divisionName.replace(`${i}-`,"");return{divisionName:`${e}-${n}`}})),this.emitUpdatedClasses(r)},updateAllClassesWithCommonData(){const s=this.classesWithText.map(e=>V(U({},e),{specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}));this.emitUpdatedClasses(s)},isCommonSubjectExcluded(s,e){var i;return((i=this.classesWithText[s].excludedCommonSubjects)==null?void 0:i.includes(e))||!1},toggleExcludeCommonSubject(s,e){const r=[...this.classesWithText];r[s].excludedCommonSubjects||(r[s].excludedCommonSubjects=[]);const i=r[s].excludedCommonSubjects.indexOf(e);i>=0?r[s].excludedCommonSubjects.splice(i,1):r[s].excludedCommonSubjects.push(e),this.emitUpdatedClasses(r)},isCommonDivisionExcluded(s,e){var i;return((i=this.classesWithText[s].excludedCommonDivisions)==null?void 0:i.includes(e))||!1},toggleExcludeCommonDivision(s,e){const r=[...this.classesWithText];r[s].excludedCommonDivisions||(r[s].excludedCommonDivisions=[]);const i=r[s].excludedCommonDivisions.indexOf(e);i>=0?r[s].excludedCommonDivisions.splice(i,1):r[s].excludedCommonDivisions.push(e),this.emitUpdatedClasses(r)},emitUpdatedClasses(s){this.$emit("update-field-array",{field:"classes",value:s.map(e=>({className:e.className,subjects:[...this.commonSubjectsList.filter(r=>{var i;return!((i=e.excludedCommonSubjects)!=null&&i.includes(r))}),...e.specificSubjects||[]],divisions:[...this.commonDivisionsList.filter(r=>{var i;return!((i=e.excludedCommonDivisions)!=null&&i.includes(r))}).map(r=>({divisionName:`${e.className}-${r}`})),...e.specificDivisions||[]],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[],specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[]}))})}}},kt={class:"bg-white shadow rounded-lg p-6 space-y-6"},Tt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Dt=["onClick"],At={class:"quick-select mt-3"},jt={class:"subject-grid grid grid-cols-3 gap-2"},Gt=["onClick"],Ft={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Pt=["onClick"],Nt={class:"quick-select mt-3"},It={class:"division-grid grid grid-cols-6 gap-2"},Ot=["onClick"],Ut={class:"overflow-x-auto"},Vt={class:"min-w-full text-sm text-left text-gray-700"},Et={class:"px-4 py-2"},Mt={class:"px-4 py-2"},Lt=["onUpdate:modelValue","onInput"],Yt={class:"px-4 py-2 w-[300px]"},Bt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},$t=["onClick"],Rt=["onClick"],qt={class:"flex gap-2"},Ht=["onUpdate:modelValue","onKeydown"],Wt=["onClick"],Kt={class:"px-4 py-2"},zt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Jt=["onClick"],Qt=["onClick"],Zt={class:"flex gap-2"},Xt=["onUpdate:modelValue","onKeydown"],es=["onClick"];function ts(s,e,r,i,l,n){return u(),c("div",kt,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Subjects for All Classes",-1)),t("div",Tt,[(u(!0),c(C,null,S(l.commonSubjectsList,(o,d)=>(u(),c("span",{key:d,class:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm"},[A(m(o)+" ",1),t("button",{onClick:a=>n.removeCommonSubject(d),class:"ml-1.5 text-blue-500 hover:text-blue-700"}," × ",8,Dt)]))),128)),f(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>l.newCommonSubject=o),onKeydown:e[1]||(e[1]=E((...o)=>n.addCommonSubject&&n.addCommonSubject(...o),["enter"])),onBlur:e[2]||(e[2]=(...o)=>n.addCommonSubject&&n.addCommonSubject(...o)),placeholder:"Add subjects...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[x,l.newCommonSubject]])]),t("div",At,[e[6]||(e[6]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Subjects",-1)),t("div",jt,[(u(!0),c(C,null,S(l.commonSubjects,o=>(u(),c("div",{key:o,class:T(["subject-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-blue-100 border-blue-300":n.isCommonSubjectSelected(o),"bg-gray-50 hover:bg-gray-100":!n.isCommonSubjectSelected(o)}]),onClick:d=>n.toggleCommonSubject(o)},m(o),11,Gt))),128))])])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Divisions for All Classes",-1)),t("div",Ft,[(u(!0),c(C,null,S(l.commonDivisionsList,(o,d)=>(u(),c("span",{key:d,class:"inline-flex items-center px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm"},[A(m(o)+" ",1),t("button",{onClick:a=>n.removeCommonDivision(d),class:"ml-1.5 text-green-500 hover:text-green-700"}," × ",8,Pt)]))),128)),f(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>l.newCommonDivision=o),onKeydown:e[4]||(e[4]=E((...o)=>n.addCommonDivision&&n.addCommonDivision(...o),["enter"])),onBlur:e[5]||(e[5]=(...o)=>n.addCommonDivision&&n.addCommonDivision(...o)),placeholder:"Add divisions...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[x,l.newCommonDivision]])]),t("div",Nt,[e[8]||(e[8]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Divisions",-1)),t("div",It,[(u(!0),c(C,null,S(l.commonDivisions,o=>(u(),c("div",{key:o,class:T(["division-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-green-100 border-green-300":n.isCommonDivisionSelected(o),"bg-gray-50 hover:bg-gray-100":!n.isCommonDivisionSelected(o)}]),onClick:d=>n.toggleCommonDivision(o)},m(o),11,Ot))),128))])])]),e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-2"},"Classes Overview",-1)),t("div",Ut,[t("table",Vt,[e[10]||(e[10]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-2 font-medium"},"#"),t("th",{class:"px-4 py-2 font-medium"},"Class Name / Programs"),t("th",{class:"px-4 py-2 font-medium"},"Subjects / Courses"),t("th",{class:"px-4 py-2 font-medium"},"Divisions / Student Groups")])],-1)),t("tbody",null,[(u(!0),c(C,null,S(l.classesWithText,(o,d)=>(u(),c("tr",{key:d,class:"border-t hover:bg-gray-50"},[t("td",Et,m(d+1),1),t("td",Mt,[f(t("input",{type:"text","onUpdate:modelValue":a=>o.className=a,onInput:a=>n.updateClassName(d,a.target.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Lt),[[x,o.className]])]),t("td",Yt,[t("div",Bt,[(u(!0),c(C,null,S(l.commonSubjectsList,(a,v)=>(u(),c("span",{key:"common-"+v,class:T(["inline-flex items-center px-2 py-1 rounded-full text-xs",n.isCommonSubjectExcluded(d,a)?"bg-red-100 text-red-600":"bg-blue-50 text-blue-600"])},[A(m(a)+" ",1),t("button",{onClick:ne(D=>n.toggleExcludeCommonSubject(d,a),["stop"]),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"},m(n.isCommonSubjectExcluded(d,a)?"+":"×"),9,$t)],2))),128)),(u(!0),c(C,null,S(o.specificSubjects,(a,v)=>(u(),c("span",{key:"specific-"+v,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs"},[A(m(a)+" ",1),t("button",{onClick:D=>n.removeSpecificSubject(d,v),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"}," × ",8,Rt)]))),128))]),t("div",qt,[f(t("input",{type:"text","onUpdate:modelValue":a=>o.subjectsText=a,onKeydown:E(a=>n.addSpecificSubject(d),["enter"]),placeholder:"Add class-specific subject...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Ht),[[x,o.subjectsText]]),t("button",{onClick:a=>n.addSpecificSubject(d),class:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs"}," Add ",8,Wt)])]),t("td",Kt,[t("div",zt,[(u(!0),c(C,null,S(l.commonDivisionsList,(a,v)=>(u(),c("span",{key:"common-"+v,class:T(["inline-flex items-center px-2 py-1 rounded-full text-xs",n.isCommonDivisionExcluded(d,a)?"bg-red-100 text-red-600 border border-red-300":"bg-green-50 text-green-600"])},[A(m(a)+" ",1),t("button",{onClick:ne(D=>n.toggleExcludeCommonDivision(d,a),["stop"]),class:"ml-1 text-green-500 hover:text-green-700 text-xs"},m(n.isCommonDivisionExcluded(d,a)?"+":"×"),9,Jt)],2))),128)),(u(!0),c(C,null,S(o.specificDivisions,(a,v)=>(u(),c("span",{key:"specific-"+v,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800 text-xs"},[A(m(a.divisionName.split("-").slice(1).join("-"))+" ",1),t("button",{onClick:D=>n.removeSpecificDivision(d,v),class:"ml-1 text-green-500 hover:text-green-700 text-xs"}," × ",8,Qt)]))),128))]),t("div",Zt,[f(t("input",{type:"text","onUpdate:modelValue":a=>o.divisionsText=a,onKeydown:E(a=>n.addSpecificDivision(d),["enter"]),placeholder:"Add class-specific division...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Xt),[[x,o.divisionsText]]),t("button",{onClick:a=>n.addSpecificDivision(d),class:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-xs"}," Add ",8,es)])])]))),128))])])])])}const ss=G(wt,[["render",ts],["__scopeId","data-v-9515f27e"]]),os={name:"GradingSystem",emits:["update-field","grading-completed"],props:{values:{type:Object,required:!0}},setup(s,{emit:e}){var F,g,p,y;const r=_(((F=s.values.gradingSystem)==null?void 0:F.selectedOption)||""),i=_(((g=s.values.gradingSystem)==null?void 0:g.scaleName)||""),l=_(((p=s.values.gradingSystem)==null?void 0:p.previousScaleName)||""),n=_(((y=s.values.gradingSystem)==null?void 0:y.gradeData)||[{grade_code:"",threshold:"",description:""}]),o=_([]),d=_(!1),a=_(!1);let v=null;const D=M({url:"school.al_ummah.api3.fetch_grading_scales",onSuccess:b=>{b.success&&(o.value=b.grading_scales||[]),d.value=!1},onError:b=>{console.error("Error fetching grading scales:",b),d.value=!1}}),L=_([{value:"school",label:"School (K-12)",grades:[{grade_code:"A+",threshold:95,description:"Outstanding"},{grade_code:"A",threshold:90,description:"Excellent"},{grade_code:"B+",threshold:85,description:"Very Good"},{grade_code:"B",threshold:80,description:"Good"},{grade_code:"C+",threshold:75,description:"Above Average"},{grade_code:"C",threshold:70,description:"Average"},{grade_code:"D",threshold:60,description:"Below Average"},{grade_code:"F",threshold:0,description:"Fail"}]},{value:"college",label:"College/University",grades:[{grade_code:"A",threshold:90,description:"Excellent"},{grade_code:"B",threshold:80,description:"Good"},{grade_code:"C",threshold:70,description:"Satisfactory"},{grade_code:"D",threshold:60,description:"Pass"},{grade_code:"F",threshold:0,description:"Fail"}]}]),I=ee(()=>n.value.length>0&&n.value.every(b=>{var h;return((h=b.grade_code)==null?void 0:h.trim())&&X(b.threshold)})),K=ee(()=>!i.value||!I.value),Y=ee(()=>{var b;return r.value==="previous"?!!l.value:r.value==="manual"?((b=i.value)==null?void 0:b.trim())&&I.value:!0});function B(){d.value=!0,D.fetch()}function z(b){r.value=b,j()}function J(b){n.value=JSON.parse(JSON.stringify(b.grades)),i.value||(i.value=`${b.label} Grading Scale`),j()}function Q(){n.value.push({grade_code:"",threshold:"",description:""}),j()}function Z(b){n.value.length>1&&(n.value.splice(b,1),j())}function X(b){const h=parseFloat(b);return!isNaN(h)&&h>=0&&h<=100&&b!==""}function $(){clearTimeout(v),v=setTimeout(j,300)}function j(){clearTimeout(v);const b=r.value==="manual"?n.value.map(h=>({grade_code:(h.grade_code||"").trim(),threshold:parseFloat(h.threshold)||0,description:(h.description||"").trim()})).filter(h=>h.grade_code&&!isNaN(h.threshold)):null;e("update-field",{field:"gradingSystem",value:{selectedOption:r.value,scaleName:i.value,previousScaleName:l.value,gradeData:b}})}function R(){a.value=!0,!(!Y.value&&r.value!=="")&&(j(),e("grading-completed"))}function q(){r.value="",i.value="",l.value="",n.value=[{grade_code:"",threshold:"",description:""}],a.value=!1,e("update-field",{field:"gradingSystem",value:{selectedOption:"",scaleName:"",previousScaleName:"",gradeData:null}}),e("grading-completed")}return te(()=>{B(),j()}),{selectedOption:r,scaleName:i,previousScaleName:l,manualGrades:n,gradingScales:o,loadingScales:d,instituteTypes:L,showValidation:a,hasValidManualGrades:I,hasManualValidationErrors:K,isFormValid:Y,selectOption:z,applyTemplate:J,addGrade:Q,removeGrade:Z,submitGrading:R,skipGrading:q,debouncedUpdate:$}}},is={class:"grading-system-container"},ns={class:"mb-8"},rs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},as={class:"flex items-start space-x-4"},ls={class:"flex-1"},ds=["disabled"],us=["value"],cs={key:0,class:"mt-2 text-sm text-gray-500"},ms={key:1,class:"mt-2 text-sm text-gray-500"},gs={key:0,class:"space-y-6"},ps={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},bs=["onClick"],vs={class:"flex items-center space-x-3"},fs={class:"font-medium text-gray-900"},hs={class:"text-xs text-gray-500 mt-1"},xs={class:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden"},ys={class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},Cs={class:"flex items-center justify-between"},Ss={class:"overflow-x-auto"},_s={class:"w-full"},ws={class:"bg-white divide-y divide-gray-200"},ks={class:"px-6 py-4 whitespace-nowrap"},Ts=["onUpdate:modelValue"],Ds={class:"px-6 py-4 whitespace-nowrap"},As={class:"flex items-center space-x-2"},js=["onUpdate:modelValue"],Gs={class:"px-6 py-4"},Fs=["onUpdate:modelValue"],Ps={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ns=["onClick","disabled"],Is={key:0,class:"text-center py-12"},Os={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Us={class:"mt-2 text-sm text-red-600 list-disc list-inside space-y-1"},Vs={key:0},Es={key:1},Ms={class:"mt-8 flex justify-between items-center pt-6 border-t border-gray-200"},Ls={class:"flex space-x-3"},Ys=["disabled"];function Bs(s,e,r,i,l,n){return u(),c("div",is,[e[28]||(e[28]=t("div",{class:"mb-8"},[t("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Grading System Setup"),t("p",{class:"text-gray-600"},"Configure your institution's grading system. This step is optional.")],-1)),t("div",ns,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Select Grading System Option ",-1)),t("div",rs,[t("div",{onClick:e[1]||(e[1]=o=>i.selectOption("previous")),class:T(["p-6 border-2 rounded-lg cursor-pointer transition-all duration-200",i.selectedOption==="previous"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-300 bg-white hover:border-gray-400"])},[t("div",as,[e[14]||(e[14]=t("div",{class:"flex-shrink-0 w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",ls,[e[12]||(e[12]=t("h4",{class:"font-semibold text-gray-900 mb-2"},"Use Existing Grading Scale",-1)),e[13]||(e[13]=t("p",{class:"text-sm text-gray-600 mb-3"},"Select from previously created grading scales",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.previousScaleName=o),disabled:i.selectedOption!=="previous",class:T(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"bg-gray-100":i.selectedOption!=="previous"}])},[e[11]||(e[11]=t("option",{value:""},"Select a grading scale",-1)),(u(!0),c(C,null,S(i.gradingScales,o=>(u(),c("option",{key:o,value:o},m(o),9,us))),128))],10,ds),[[W,i.previousScaleName]]),i.loadingScales?(u(),c("div",cs," Loading grading scales... ")):i.gradingScales.length===0?(u(),c("div",ms," No previous grading scales found ")):w("",!0)])])],2),t("div",{onClick:e[2]||(e[2]=o=>i.selectOption("manual")),class:T(["p-6 border-2 rounded-lg cursor-pointer transition-all duration-200",i.selectedOption==="manual"?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-gray-300 bg-white hover:border-gray-400"])},e[15]||(e[15]=[H('<div class="flex items-start space-x-4" data-v-d1923fe5><div class="flex-shrink-0 w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center" data-v-d1923fe5><svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d1923fe5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-d1923fe5></path></svg></div><div class="flex-1" data-v-d1923fe5><h4 class="font-semibold text-gray-900 mb-2" data-v-d1923fe5>Create New Grading Scale</h4><p class="text-sm text-gray-600" data-v-d1923fe5>Manually define your grading system</p></div></div>',1)]),2)])]),i.selectedOption==="manual"?(u(),c("div",gs,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A(" Grading Scale Name "),t("span",{class:"text-red-500"},"*")],-1)),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.scaleName=o),type:"text",placeholder:"e.g., Standard Grading Scale",class:T(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"border-red-300":!i.scaleName&&i.showValidation}])},null,2),[[x,i.scaleName]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Quick Templates (Optional) ",-1)),t("div",ps,[(u(!0),c(C,null,S(i.instituteTypes,o=>(u(),c("button",{key:o.value,onClick:d=>i.applyTemplate(o),class:"p-4 border border-gray-300 rounded-lg text-left bg-white hover:border-gray-400 transition-colors"},[t("div",vs,[e[18]||(e[18]=t("div",{class:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),t("div",null,[t("h4",fs,m(o.label),1),t("p",hs,m(o.grades.length)+" pre-defined grades",1)])])],8,bs))),128))])]),t("div",xs,[t("div",ys,[t("div",Cs,[e[21]||(e[21]=t("h4",{class:"text-lg font-semibold text-gray-800"},"Grading Scale",-1)),t("button",{onClick:e[4]||(e[4]=(...o)=>i.addGrade&&i.addGrade(...o)),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2 text-sm"},e[20]||(e[20]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",null,"Add Grade",-1)]))])]),t("div",Ss,[t("table",_s,[e[24]||(e[24]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Grade Code"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Threshold (%)"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ws,[(u(!0),c(C,null,S(i.manualGrades,(o,d)=>(u(),c("tr",{key:d,class:"hover:bg-gray-50 transition-colors"},[t("td",ks,[f(t("input",{"onUpdate:modelValue":a=>o.grade_code=a,type:"text",placeholder:"e.g., A, B, C",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[5]||(e[5]=(...a)=>i.debouncedUpdate&&i.debouncedUpdate(...a))},null,40,Ts),[[x,o.grade_code]])]),t("td",Ds,[t("div",As,[f(t("input",{"onUpdate:modelValue":a=>o.threshold=a,type:"number",min:"0",max:"100",step:"0.1",placeholder:"0-100",class:"w-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[6]||(e[6]=(...a)=>i.debouncedUpdate&&i.debouncedUpdate(...a))},null,40,js),[[x,o.threshold]]),e[22]||(e[22]=t("span",{class:"text-gray-500 text-sm"},"%",-1))])]),t("td",Gs,[f(t("input",{"onUpdate:modelValue":a=>o.description=a,type:"text",placeholder:"e.g., Excellent, Good, Average",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:e[7]||(e[7]=(...a)=>i.debouncedUpdate&&i.debouncedUpdate(...a))},null,40,Fs),[[x,o.description]])]),t("td",Ps,[t("button",{onClick:a=>i.removeGrade(d),class:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",disabled:i.manualGrades.length<=1},e[23]||(e[23]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Ns)])]))),128))])])]),i.manualGrades.length===0?(u(),c("div",Is,[e[25]||(e[25]=t("p",{class:"text-gray-500 mb-4"},"No grades added yet.",-1)),t("button",{onClick:e[8]||(e[8]=(...o)=>i.addGrade&&i.addGrade(...o)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Add First Grade ")])):w("",!0)]),i.showValidation&&i.hasManualValidationErrors?(u(),c("div",Os,[e[26]||(e[26]=t("div",{class:"flex items-center space-x-2 text-red-700"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("span",{class:"font-medium"},"Please fix the following issues:")],-1)),t("ul",Us,[i.scaleName?w("",!0):(u(),c("li",Vs,"Grading scale name is required")),i.hasValidManualGrades?w("",!0):(u(),c("li",Es,"All grades must have a code and valid threshold (0-100)"))])])):w("",!0)])):w("",!0),t("div",Ms,[e[27]||(e[27]=t("div",{class:"text-sm text-gray-500"}," This step is optional. ",-1)),t("div",Ls,[t("button",{onClick:e[9]||(e[9]=(...o)=>i.skipGrading&&i.skipGrading(...o)),class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Skip Grading "),t("button",{onClick:e[10]||(e[10]=(...o)=>i.submitGrading&&i.submitGrading(...o)),disabled:!i.isFormValid&&i.selectedOption!=="",class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors"}," Continue ",8,Ys)])])])}const $s=G(os,[["render",Bs],["__scopeId","data-v-d1923fe5"]]),Rs={name:"FeeStructureCreator",props:{values:Object},data(){return{selectedInstitutionType:"",selectedGlobalCategories:[],newCategoryInputs:[],newAmountInputs:[],feeStructures:[],feeCategories:{school:[{name:"Tuition Fee",suggestedAmount:5e3,editableAmount:5e3},{name:"Admission Fee",suggestedAmount:1e3,editableAmount:1e3},{name:"Annual Charges",suggestedAmount:2e3,editableAmount:2e3},{name:"Sports Fee",suggestedAmount:500,editableAmount:500},{name:"Library Fee",suggestedAmount:300,editableAmount:300},{name:"Lab Fee",suggestedAmount:800,editableAmount:800},{name:"Computer Fee",suggestedAmount:600,editableAmount:600},{name:"Transport Fee",suggestedAmount:3e3,editableAmount:3e3},{name:"Exam Fee",suggestedAmount:400,editableAmount:400},{name:"Development Fee",suggestedAmount:1500,editableAmount:1500},{name:"Activity Fee",suggestedAmount:700,editableAmount:700},{name:"Uniform Fee",suggestedAmount:2500,editableAmount:2500}],college:[{name:"Tuition Fee",suggestedAmount:15e3,editableAmount:15e3},{name:"Admission Fee",suggestedAmount:5e3,editableAmount:5e3},{name:"University Fee",suggestedAmount:3e3,editableAmount:3e3},{name:"Library Fee",suggestedAmount:1e3,editableAmount:1e3},{name:"Lab Fee",suggestedAmount:2e3,editableAmount:2e3},{name:"Computer Fee",suggestedAmount:1500,editableAmount:1500},{name:"Sports Fee",suggestedAmount:800,editableAmount:800},{name:"Exam Fee",suggestedAmount:1e3,editableAmount:1e3},{name:"Development Fee",suggestedAmount:2500,editableAmount:2500},{name:"Identity Card",suggestedAmount:200,editableAmount:200},{name:"Study Material",suggestedAmount:3e3,editableAmount:3e3},{name:"Placement Fee",suggestedAmount:2e3,editableAmount:2e3}]}}},computed:{classes(){return this.values.classes||[]}},watch:{classes:{immediate:!0,handler(s){this.feeStructures=s.map(()=>({components:[]})),this.newCategoryInputs=new Array(s.length).fill(""),this.newAmountInputs=new Array(s.length).fill(0)}},selectedGlobalCategories:{handler(s){this.applyGlobalCategoriesToAll()},deep:!0},feeStructures:{handler(s){this.emitFeeStructures()},deep:!0}},methods:{getCategoryCardClass(s){return this.selectedGlobalCategories.includes(s)?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 bg-white hover:shadow-sm"},selectInstitutionType(s){this.selectedInstitutionType=s,this.selectedGlobalCategories=[],this.feeStructures=this.classes.map(()=>({components:[]}))},toggleGlobalCategory(s){const e=this.selectedGlobalCategories.indexOf(s);e>=0?this.selectedGlobalCategories.splice(e,1):this.selectedGlobalCategories.push(s)},updateGlobalCategoryAmount(s,e){const r=this.feeCategories[this.selectedInstitutionType].find(i=>i.name===s);r&&(r.editableAmount=parseFloat(e)||0,this.applyGlobalCategoriesToAll())},validateAmount(s){s.editableAmount<=0&&(s.editableAmount=s.suggestedAmount),this.applyGlobalCategoriesToAll()},updateComponentAmount(s,e,r){const i=this.feeStructures[s].components[e];i&&(i.amount=parseFloat(r)||0,i.total=i.amount)},validateComponentAmount(s){s.amount<=0&&(s.amount=0,s.total=0)},applyGlobalCategoriesToAll(){this.feeStructures=this.feeStructures.map(s=>{const e=s.components.filter(i=>!this.feeCategories[this.selectedInstitutionType].some(l=>l.name===i.fees_category));return{components:[...this.selectedGlobalCategories.map(i=>{const l=this.feeCategories[this.selectedInstitutionType].find(n=>n.name===i);return{fees_category:i,amount:l.editableAmount,discount:0,total:l.editableAmount}}),...e]}})},addCustomCategory(s){var i;const e=(i=this.newCategoryInputs[s])==null?void 0:i.trim(),r=parseFloat(this.newAmountInputs[s])||0;if(e&&r>0){const l=this.feeStructures[s].components.findIndex(n=>n.fees_category.toLowerCase()===e.toLowerCase());l>=0?(this.feeStructures[s].components[l].amount=r,this.feeStructures[s].components[l].total=r):this.feeStructures[s].components.push({fees_category:e,amount:r,discount:0,total:r}),this.newCategoryInputs[s]="",this.newAmountInputs[s]=0}},removeComponent(s,e){const r=this.feeStructures[s].components[e];if(this.feeCategories[this.selectedInstitutionType].some(l=>l.name===r.fees_category)){const l=this.selectedGlobalCategories.indexOf(r.fees_category);l>=0&&this.selectedGlobalCategories.splice(l,1)}else this.feeStructures[s].components.splice(e,1)},calculateClassTotal(s){return this.feeStructures[s].components.reduce((e,r)=>e+r.amount,0)},getTotalCategories(){return this.feeStructures.reduce((s,e)=>s+e.components.length,0)},getGrandTotal(){return this.feeStructures.reduce((s,e)=>s+e.components.reduce((r,i)=>r+i.amount,0),0)},emitFeeStructures(){this.$emit("update-field",{field:"feeStructures",value:this.feeStructures})}}},qs={class:"bg-white shadow rounded-lg p-6 space-y-6"},Hs={class:"institution-type-section"},Ws={class:"grid grid-cols-2 gap-4"},Ks={key:0,class:"global-categories-section"},zs={class:"flex items-center justify-between mb-3"},Js={class:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded"},Qs={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},Zs={class:"flex items-center justify-between mb-1"},Xs={class:"flex items-center space-x-2 flex-1 min-w-0"},eo=["onClick"],to={key:0,class:"w-2 h-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},so={class:"font-medium text-gray-900 text-xs leading-tight truncate flex-1"},oo={class:"flex items-center space-x-1"},io=["onUpdate:modelValue","onInput","onBlur","disabled"],no={key:1,class:"class-structures-section"},ro={class:"space-y-4"},ao={class:"flex items-center justify-between mb-3"},lo={class:"flex items-center space-x-3"},uo={class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},co={class:"text-blue-600 font-medium text-sm"},mo={class:"font-semibold text-gray-900"},go={class:"text-xs text-gray-500"},po={class:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full"},bo={key:0,class:"space-y-2 mb-3"},vo={class:"flex items-center space-x-3 flex-1"},fo={class:"flex-1 min-w-0"},ho={class:"text-sm font-medium text-gray-800 block truncate"},xo={class:"flex items-center space-x-1 mt-1"},yo=["onUpdate:modelValue","onInput","onBlur"],Co=["onClick"],So={class:"flex space-x-2"},_o=["onUpdate:modelValue","onKeydown"],wo={class:"relative"},ko=["onUpdate:modelValue"],To=["onClick","disabled"],Do={key:2,class:"summary-section"},Ao={class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-100"},jo={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},Go={class:"text-center"},Fo={class:"text-2xl font-bold text-blue-600"},Po={class:"font-semibold text-gray-800 capitalize"},No={class:"text-center"},Io={class:"text-2xl font-bold text-green-600"},Oo={class:"font-semibold text-gray-800"},Uo={class:"text-center"},Vo={class:"text-2xl font-bold text-purple-600"},Eo={class:"font-semibold text-gray-800"},Mo={class:"text-center"},Lo={class:"text-2xl font-bold text-orange-600"},Yo={class:"font-semibold text-gray-800"},Bo={class:"mt-4 pt-4 border-t border-blue-200"},$o={class:"text-center"},Ro={class:"text-lg font-bold text-gray-800"},qo={key:3,class:"text-center py-8"};function Ho(s,e,r,i,l,n){return u(),c("div",qs,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-3"},"Create Fee Structures",-1)),t("div",Hs,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Select Institution Type",-1)),t("div",Ws,[t("div",{class:T(["institution-card p-4 border-2 rounded-lg cursor-pointer transition-all duration-200",l.selectedInstitutionType==="school"?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 bg-white"]),onClick:e[0]||(e[0]=o=>n.selectInstitutionType("school"))},e[2]||(e[2]=[H('<div class="text-center" data-v-1be8d1ba><div class="w-10 h-10 mx-auto mb-2 bg-blue-100 rounded-full flex items-center justify-center" data-v-1be8d1ba><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1be8d1ba><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" data-v-1be8d1ba></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l9 5m-9-5v8" data-v-1be8d1ba></path></svg></div><h4 class="font-medium text-gray-900 text-sm" data-v-1be8d1ba>School</h4><p class="text-xs text-gray-500 mt-1" data-v-1be8d1ba>Primary &amp; Secondary</p></div>',1)]),2),t("div",{class:T(["institution-card p-4 border-2 rounded-lg cursor-pointer transition-all duration-200",l.selectedInstitutionType==="college"?"border-green-500 bg-green-50 shadow-sm":"border-gray-200 hover:border-green-300 bg-white"]),onClick:e[1]||(e[1]=o=>n.selectInstitutionType("college"))},e[3]||(e[3]=[H('<div class="text-center" data-v-1be8d1ba><div class="w-10 h-10 mx-auto mb-2 bg-green-100 rounded-full flex items-center justify-center" data-v-1be8d1ba><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1be8d1ba><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" data-v-1be8d1ba></path></svg></div><h4 class="font-medium text-gray-900 text-sm" data-v-1be8d1ba>College</h4><p class="text-xs text-gray-500 mt-1" data-v-1be8d1ba>Higher Education</p></div>',1)]),2)])]),l.selectedInstitutionType?(u(),c("div",Ks,[t("div",zs,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Common Fee Categories",-1)),t("span",Js,m(l.selectedGlobalCategories.length)+" selected ",1)]),t("div",Qs,[(u(!0),c(C,null,S(l.feeCategories[l.selectedInstitutionType],o=>(u(),c("div",{key:o.name,class:T(["category-card p-2 border rounded-lg transition-all duration-200 h-20 flex flex-col",n.getCategoryCardClass(o.name)])},[t("div",Zs,[t("div",Xs,[t("div",{class:T(["w-4 h-4 rounded border flex items-center justify-center cursor-pointer transition-colors",l.selectedGlobalCategories.includes(o.name)?"bg-blue-500 border-blue-500":"bg-white border-gray-300"]),onClick:d=>n.toggleGlobalCategory(o.name)},[l.selectedGlobalCategories.includes(o.name)?(u(),c("svg",to,e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):w("",!0)],10,eo),t("h4",so,m(o.name),1)])]),t("div",oo,[e[7]||(e[7]=t("span",{class:"text-gray-500 text-xs flex-shrink-0"},"₹",-1)),f(t("input",{type:"number","onUpdate:modelValue":d=>o.editableAmount=d,onInput:d=>n.updateGlobalCategoryAmount(o.name,d.target.value),onBlur:d=>n.validateAmount(o),disabled:!l.selectedGlobalCategories.includes(o.name),class:T(["w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:text-gray-500",l.selectedGlobalCategories.includes(o.name)?"bg-white text-gray-900":"bg-gray-50 text-gray-400"])},null,42,io),[[x,o.editableAmount]])])],2))),128))])])):w("",!0),l.selectedInstitutionType&&n.classes.length>0?(u(),c("div",no,[e[12]||(e[12]=t("h4",{class:"text-md font-semibold text-gray-800 mb-4"},"Class-wise Fee Structures",-1)),t("div",ro,[(u(!0),c(C,null,S(n.classes,(o,d)=>(u(),c("div",{key:d,class:"class-fee-card p-4 border border-gray-200 rounded-lg bg-white shadow-sm"},[t("div",ao,[t("div",lo,[t("div",uo,[t("span",co,m(d+1),1)]),t("div",null,[t("h5",mo,m(o.className),1),t("p",go,"Total: ₹"+m(n.calculateClassTotal(d).toLocaleString()),1)])]),t("span",po,m(l.feeStructures[d].components.length)+" categories ",1)]),l.feeStructures[d].components.length>0?(u(),c("div",bo,[(u(!0),c(C,null,S(l.feeStructures[d].components,(a,v)=>(u(),c("div",{key:v,class:"component-item flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100"},[t("div",vo,[e[9]||(e[9]=t("div",{class:"w-2 h-2 bg-blue-500 rounded-full"},null,-1)),t("div",fo,[t("span",ho,m(a.fees_category),1),t("div",xo,[e[8]||(e[8]=t("span",{class:"text-gray-500 text-xs"},"₹",-1)),f(t("input",{type:"number","onUpdate:modelValue":D=>a.amount=D,onInput:D=>n.updateComponentAmount(d,v,D.target.value),onBlur:D=>n.validateComponentAmount(a),class:"w-20 px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,40,yo),[[x,a.amount]])])])]),t("button",{onClick:D=>n.removeComponent(d,v),class:"text-red-400 hover:text-red-600 transition-colors p-1",title:"Remove category"},e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Co)]))),128))])):w("",!0),t("div",So,[f(t("input",{"onUpdate:modelValue":a=>l.newCategoryInputs[d]=a,onKeydown:E(a=>n.addCustomCategory(d),["enter"]),placeholder:"Custom category name...",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,_o),[[x,l.newCategoryInputs[d]]]),t("div",wo,[e[11]||(e[11]=t("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm"},"₹",-1)),f(t("input",{"onUpdate:modelValue":a=>l.newAmountInputs[d]=a,type:"number",placeholder:"Amount",class:"w-24 pl-8 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,ko),[[x,l.newAmountInputs[d]]])]),t("button",{onClick:a=>n.addCustomCategory(d),disabled:!l.newCategoryInputs[d]||!l.newAmountInputs[d],class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-sm font-medium transition-colors"}," Add ",8,To)])]))),128))])])):w("",!0),l.selectedInstitutionType&&n.classes.length>0?(u(),c("div",Do,[e[18]||(e[18]=t("h4",{class:"text-md font-semibold text-gray-800 mb-3"},"Summary",-1)),t("div",Ao,[t("div",jo,[t("div",Go,[t("div",Fo,m(l.selectedInstitutionType==="school"?"🏫":"🎓"),1),e[13]||(e[13]=t("div",{class:"text-gray-600 mt-1"},"Institution",-1)),t("div",Po,m(l.selectedInstitutionType),1)]),t("div",No,[t("div",Io,m(n.classes.length),1),e[14]||(e[14]=t("div",{class:"text-gray-600 mt-1"},"Total Classes",-1)),t("div",Oo,m(n.classes.length),1)]),t("div",Uo,[t("div",Vo,m(l.selectedGlobalCategories.length),1),e[15]||(e[15]=t("div",{class:"text-gray-600 mt-1"},"Global Categories",-1)),t("div",Eo,m(l.selectedGlobalCategories.length),1)]),t("div",Mo,[t("div",Lo,m(n.getTotalCategories()),1),e[16]||(e[16]=t("div",{class:"text-gray-600 mt-1"},"Total Categories",-1)),t("div",Yo,m(n.getTotalCategories()),1)])]),t("div",Bo,[t("div",$o,[t("div",Ro,"₹"+m(n.getGrandTotal().toLocaleString()),1),e[17]||(e[17]=t("div",{class:"text-gray-600 text-sm"},"Grand Total Across All Classes",-1))])])])])):w("",!0),l.selectedInstitutionType&&n.classes.length===0?(u(),c("div",qo,e[19]||(e[19]=[H('<div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center" data-v-1be8d1ba><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1be8d1ba><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-1be8d1ba></path></svg></div><h4 class="text-lg font-medium text-gray-900 mb-2" data-v-1be8d1ba>No Classes Found</h4><p class="text-gray-500 text-sm" data-v-1be8d1ba>Please go back and set up classes first to create fee structures.</p>',3)]))):w("",!0)])}const Wo=G(Rs,[["render",Ho],["__scopeId","data-v-1be8d1ba"]]),Ko={name:"MultiStepForm",components:{EmailAccountSetup:_e,AcademicYearTerms:et,UsePreviousData:ut,ProgramSelection:_t,SubjectsDivisions:ss,GradingSystem:$s,FeeStructureCreator:Wo},setup(){const s=_(0),e=_([]),r=_(!1),i=_(!1),l=_(!1),n=_(""),o=_([]),d=_(!1),a=ge({email:"",googleAppPassword:"",academicYear:"",academicYearStart:"",academicYearEnd:"",numberOfTerms:"",terms:[],selectedTerm:"",classes:[],subjects:[],divisions:[],commonSubjects:[],commonDivisions:[],dontCreateClasses:!1,feeStructures:[],gradingSystem:{selectedOption:"",scaleName:"",previousScaleName:"",gradeData:null},gradingCompleted:!1}),v=_([{title:"Email Account Setup (Optional)",component:"EmailAccountSetup"},{title:"Academic Year & Terms",component:"AcademicYearTerms"},{title:"Grading System (Optional)",component:"GradingSystem"},{title:"Use Previous Data",component:"UsePreviousData"},{title:"Select Institution Type & Classes",component:"ProgramSelection"},{title:"Create Fee Structures",component:"FeeStructureCreator"},{title:"Subjects and Divisions",component:"SubjectsDivisions"}]),D=M({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:g=>{e.value=Array.isArray(g)?g.map(p=>V(U({},p),{academicYear:p.json_data?JSON.parse(p.json_data).academicYear:""})):[]},onError:g=>{console.error("Error fetching previous data:",g),e.value=[]}}),L=M({url:"school.al_ummah.api3.create_email_account",params:{email_id:"",password:""},onSuccess:()=>{alert("Email account setup successfully!")},onError:g=>{console.error("Error setting up email account:",g),alert("Error setting up email account.")}}),I=M({url:"school.al_ummah.api3.quick_setup",params:{values:{}},onSuccess:()=>{l.value=!0,s.value++,r.value=!1,i.value=!0},onError:g=>{var p;l.value=!1,n.value=((p=g.messages)==null?void 0:p[0])||"An error occurred while submitting the form.",console.error("Submission error:",g),r.value=!1,i.value=!0}});function K(){a.gradingCompleted=!0,$()}function Y({classNames:g}){const p=[...a.classes],y=p.reduce((h,k)=>Math.max(h,k.classIndex||0),0),b=g.map((h,k)=>({className:h,subjects:[],divisions:[{divisionName:""}],classIndex:y+k+1}));a.classes=[...p,...b]}function B(){D.reload()}function z({field:g,value:p,parent:y=null}){y&&a[y]?a[y][g]=p:a[g]=p}function J({field:g,index:p,subField:y,value:b}){p!==void 0&&y?a[g][p][y]=b:p!==void 0?a[g][p]=b:a[g]=b}function Q(){return ie(this,null,function*(){const{email:g,googleAppPassword:p}=a;if(!g||!p){alert("Please provide both email and Google app password.");return}L.update({params:{email_id:g,password:p}}),L.submit()})}function Z(){const g=parseInt(a.numberOfTerms,10),p=new Date(a.academicYearStart),y=new Date(a.academicYearEnd);if(!g||g<=0){alert("Please enter a valid number of terms.");return}if(isNaN(p.getTime())){alert("Please enter valid 'From' date.");return}if(isNaN(y.getTime())){alert("Please enter valid 'To' date.");return}if(p>=y){alert("'From' date must be before 'To' date.");return}const b=Math.ceil((y-p)/(1e3*60*60*24)),h=Math.floor(b/g),k=[];let P=new Date(p);for(let O=0;O<g;O++){const N=new Date(P);N.setDate(P.getDate()+h-1),O===g-1&&N.setTime(y.getTime()),k.push({name:`Term ${O+1}`,startDate:P.toISOString().split("T")[0],endDate:N.toISOString().split("T")[0]}),P=new Date(N),P.setDate(P.getDate()+1)}a.terms=k}function X(g){if(!(g!=null&&g.json_data)){console.error("Invalid or missing previous data");return}try{const p=JSON.parse(g.json_data);a.classes=p.classes||[],a.subjects=p.subjects||[]}catch(p){console.error("Error parsing previous data:",p),alert("Failed to load previous data. Please try another selection.")}}function $(){s.value<v.value.length-1?(s.value++,d.value=!1):R()}function j(){s.value>0&&(s.value--,d.value=!1)}function R(){r.value=!0,i.value=!1,l.value=!1,n.value="",d.value=!1;const p=q(a,["selectedTerm","commonSubjects","commonDivisions","divisions","institutionName","logo","dontCreateClasses","subjects","terms","email","googleAppPassword","classes","gradingSystem","gradingCompleted"]);if(p.length>0){o.value=p,d.value=!0,r.value=!1,window.scrollTo({top:0,behavior:"smooth"});return}I.update({params:{values:U({},a)}}),I.submit()}function q(g,p){const y=[];return Object.entries(g).forEach(([b,h])=>{if(!p.includes(b)){if(Array.isArray(h))if(h.length===0){const k=F(b);y.push(`${k} list is empty`)}else h.forEach((k,P)=>{typeof k=="object"&&k!==null&&Object.entries(k).forEach(([O,N])=>{if(!N||typeof N=="string"&&N.trim()===""){const re=F(O),ae=F(b);y.push(`${ae} ${P+1}: ${re} is required`)}})});else if(!h||typeof h=="string"&&h.trim()===""){const k=F(b);y.push(`${k} is required`)}}}),y}function F(g){return g.replace(/([A-Z])/g," $1").replace(/^./,p=>p.toUpperCase()).replace(/([A-Z])/g," $1").trim()}return te(()=>{B()}),{currentStep:s,previousDataList:e,isSubmitting:r,showResultMessage:i,submitSuccess:l,errorMessage:n,missingFields:o,showMissingFields:d,formValues:a,steps:v,quickSetupResource:I,autoCreateClasses:Y,fetchPreviousData:B,updateField:z,updateFieldArray:J,submitEmailAccount:Q,autoCreateTerms:Z,usePreviousData:X,handleGradingCompleted:K,nextStep:$,prevStep:j,submitForm:R,checkMissingFields:q,formatFieldName:F}}},zo={class:"p-4 max-w-4xl mx-auto"},Jo={key:0},Qo={class:"text-2xl font-semibold mb-6"},Zo={key:0,class:"missing-fields-alert"},Xo={class:"alert-header"},ei={class:"alert-content"},ti={class:"missing-fields-list"},si={class:"flex justify-between gap-4"},oi=["disabled"],ii={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ni={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ri={class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},ai={key:0,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},li={key:1,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},di={class:"mt-3 text-lg font-medium text-gray-900"},ui={class:"mt-2 text-sm text-gray-500"},ci={class:"mt-5"},mi={key:3,class:"text-center mt-10"};function gi(s,e,r,i,l,n){return u(),c("div",zo,[i.currentStep<i.steps.length?(u(),c("div",Jo,[t("h2",Qo,m(i.steps[i.currentStep].title),1),i.missingFields.length>0&&i.showMissingFields?(u(),c("div",Zo,[t("div",Xo,[e[5]||(e[5]=t("div",{class:"alert-icon"},[t("svg",{class:"icon",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})])],-1)),e[6]||(e[6]=t("h3",{class:"alert-title"},"Required Information Missing",-1)),t("button",{onClick:e[0]||(e[0]=o=>i.showMissingFields=!1),class:"close-button"},e[4]||(e[4]=[t("svg",{class:"close-icon",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1)]))]),t("div",ei,[e[8]||(e[8]=t("p",{class:"alert-description"},"Please fill in the following required fields before proceeding:",-1)),t("ul",ti,[(u(!0),c(C,null,S(i.missingFields,(o,d)=>(u(),c("li",{key:d,class:"missing-field-item"},[e[7]||(e[7]=t("span",{class:"field-bullet"},"•",-1)),A(" "+m(o),1)]))),128))])])])):w("",!0),(u(),pe(be(i.steps[i.currentStep].component),{values:i.formValues,previousDataList:i.previousDataList,onUpdateField:i.updateField,onUpdateFieldArray:i.updateFieldArray,onSubmitEmail:i.submitEmailAccount,onAutoCreateTerms:i.autoCreateTerms,onAutoCreateClasses:i.autoCreateClasses,onUsePreviousData:i.usePreviousData,onGradingCompleted:i.handleGradingCompleted,class:"mb-6"},null,40,["values","previousDataList","onUpdateField","onUpdateFieldArray","onSubmitEmail","onAutoCreateTerms","onAutoCreateClasses","onUsePreviousData","onGradingCompleted"])),t("div",si,[i.currentStep>0?(u(),c("button",{key:0,onClick:e[1]||(e[1]=(...o)=>i.prevStep&&i.prevStep(...o)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"}," Back ")):w("",!0),t("button",{onClick:e[2]||(e[2]=(...o)=>i.nextStep&&i.nextStep(...o)),class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:i.isSubmitting||i.quickSetupResource.loading},m(i.currentStep===i.steps.length-1?i.isSubmitting?"Submitting...":"Submit":"Next"),9,oi)])])):w("",!0),i.isSubmitting?(u(),c("div",ii,e[9]||(e[9]=[t("div",{class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),t("h3",{class:"text-lg font-medium text-gray-900"},"Submitting your data..."),t("p",{class:"mt-2 text-sm text-gray-500"},"Please wait while we process your information.")],-1)]))):w("",!0),i.showResultMessage?(u(),c("div",ni,[t("div",ri,[i.submitSuccess?(u(),c("div",ai,e[10]||(e[10]=[t("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(u(),c("div",li,e[11]||(e[11]=[t("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),t("h3",di,m(i.submitSuccess?"Form Submitted Successfully!":"Submission Failed"),1),t("p",ui,m(i.submitSuccess?"Your data has been successfully processed.":i.errorMessage||"An error occurred while submitting the form."),1),t("div",ci,[t("button",{onClick:e[3]||(e[3]=o=>i.showResultMessage=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," OK ")])])])):w("",!0),i.currentStep>=i.steps.length&&!i.isSubmitting&&!i.showResultMessage?(u(),c("div",mi,e[12]||(e[12]=[t("h2",{class:"text-2xl font-semibold text-green-600"},"Form Submitted Successfully!",-1)]))):w("",!0)])}const pi=G(Ko,[["render",gi],["__scopeId","data-v-fd5c1944"]]),bi={components:{MultiStepForm:pi}},vi={class:"app-container"};function fi(s,e,r,i,l,n){const o=fe("MultiStepForm");return u(),c("div",vi,[ve(o)])}const Ci=G(bi,[["render",fi]]);export{Ci as default};
