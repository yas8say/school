var Le=Object.defineProperty,Pe=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var ie=(N,t,k)=>t in N?Le(N,t,{enumerable:!0,configurable:!0,writable:!0,value:k}):N[t]=k,se=(N,t)=>{for(var k in t||(t={}))Je.call(t,k)&&ie(N,k,t[k]);if(re)for(var k of re(t))Ge.call(t,k)&&ie(N,k,t[k]);return N},te=(N,t)=>Pe(N,xe(t));var j=(N,t,k)=>new Promise((l,x)=>{var h=u=>{try{g(k.next(u))}catch(D){x(D)}},r=u=>{try{g(k.throw(u))}catch(D){x(D)}},g=u=>u.done?l(u.value):Promise.resolve(u.value).then(h,r);g((k=k.apply(N,t)).next())});import{_ as je,r as y,c as Q,q as le,x as qe,a as i,b as s,t as f,i as S,h as P,n as ce,F as T,p as M,o as c,l as z,m as oe,v as Oe}from"./index-2wQlti7p.js";import{v as He,g as Qe,u as I,a as U,p as ze,f as Ke,r as We}from"./dateUtils-CshPDU0n.js";/* empty css             */const Xe={setup(){const N=y(!1),t=y([]),k=y(null),l=y(["First Name","Middle Name","Last Name","Full Name","Gender","Mobile","Email","Date of Birth","Date of Joining","PAN Number","Bank Name","Bank A/C No.","IFSC Code","Current Address","Permanent Address","Blood Group","Attendance Device ID (Biometric/RF tag ID)","Qualification (Education)","School/University (Education)"]),x=y(null),h=y([]),r=y([]),g=y([]),u=y([]),D=y([]),C=y([]),V=y([]),q=y({total_processed:0,successful:0,failed:0}),F=y(!1),K=y(!1),W=y("success"),X=y(""),Y=y(""),de=Q(()=>h.value.filter(e=>L(e)).length),ue=Q(()=>h.value.filter(e=>e.className&&e.divisionName).length),me=Q(()=>h.value.filter(e=>!L(e)).length),fe=Q(()=>h.value.filter(e=>!L(e)));function ve(e){const o=B(e);return`${o["First Name"]||""} ${o["Middle Name"]||""} ${o["Last Name"]||""}`.trim()||"Unknown Teacher"}function he(e){return B(e).Email||"N/A"}function ge(e){return B(e).Mobile||"N/A"}function pe(e){const o=[];return["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"].forEach(d=>{const b=t.value.findIndex(n=>n.type===d);if(b===-1)o.push(`${d} not mapped`);else{const n=I.decode_col(t.value[b].column),v=r.value[n],m=e[v];if(!m||m.toString().trim()==="")o.push(`${d} missing`);else switch(d){case"Mobile":m.toString().replace(/\D/g,"").length<10&&o.push("Invalid mobile number");break;case"Email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.toString().trim())||o.push("Invalid email format");break;case"Gender":const J=m.toString().trim().toLowerCase();["male","female","other","m","f","o"].includes(J)||o.push("Invalid gender");break;case"Date of Birth":const w=U(m,"Date of Birth");w.isValid||o.push(w.error);break;case"Date of Joining":const R=U(m,"Date of Joining");R.isValid||o.push(R.error);break}}}),e.className&&!e.divisionName&&o.push("Class selected but no division assigned"),o.length>0?o.join("; "):"Check field mappings"}const ne=le({url:"school.al_ummah.api4.get_classes",params:{values:{}},onSuccess:e=>{g.value=Array.isArray(e)?e:[],console.log("Classes loaded:",g.value),g.value.length||_("No classes available","error")},onError:e=>{var o;console.error("Error fetching classes:",e),g.value=[],_(`Error fetching classes: ${((o=e.messages)==null?void 0:o[0])||"Unknown error"}`,"error")}}),Z=le({url:"school.al_ummah.api4.get_divisions1",params:{values:{classId:""}},onSuccess:e=>Array.isArray(e)?e:[],onError:e=>{var o;return console.error("Error fetching divisions:",e),_(`Error fetching divisions: ${((o=e.messages)==null?void 0:o[0])||"Unknown error"}`,"error"),[]}}),$=le({url:"school.al_ummah.api4.bulk_enroll_instructors",method:"POST",onSuccess:e=>{console.log("Bulk enrollment successful:",e),F.value=!1,e&&e.success?(C.value=e.enrolled_instructors||[],V.value=e.failed_enrollments||[],q.value=e.summary||{total_processed:e.enrolled_instructors.length+e.failed_enrollments.length,successful:e.enrolled_instructors.length,failed:e.failed_enrollments.length},Ne(e.enrolled_instructors,e.failed_enrollments),V.value.length===0?(_(`✅ Successfully enrolled all ${C.value.length} teachers!`,"success"),O("success","Enrollment Complete",`Successfully enrolled all ${C.value.length} teachers!`)):(_(`Completed: ${C.value.length} successful, ${V.value.length} failed.`,"warning"),O("warning","Enrollment Completed with Errors",`Completed with ${C.value.length} successful enrollments and ${V.value.length} failures.`))):_("Bulk enrollment completed with issues","warning")},onError:e=>{var o,a;console.error("Error in bulk enrollment:",e),F.value=!1,_(`Bulk enrollment failed: ${((o=e.messages)==null?void 0:o[0])||e.message||"Unknown error"}`,"error"),O("error","Bulk Enrollment Failed",((a=e.messages)==null?void 0:a[0])||e.message||"Unknown error occurred during bulk enrollment.")}});qe(()=>{ne.reload()});function _e(e){return j(this,null,function*(){const o=h.value[e];if(o.className){o.divisionName=null;try{Z.update({params:{values:{classId:o.className}}});const a=yield Z.reload();o.divisions=Array.isArray(a)?a:[]}catch(a){console.error("Error fetching divisions:",a),_(`Error fetching divisions for ${o.className}`,"error")}}else o.divisionName=null,o.divisions=[]})}function be(e){let o="";for(;e>=0;)o=String.fromCharCode(65+e%26)+o,e=Math.floor(e/26)-1;return o}function ke(){return j(this,null,function*(){const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls",e.onchange=o=>j(this,null,function*(){const a=o.target.files[0];if(a){k.value=a,_(null),C.value=[],V.value=[],q.value={total_processed:0,successful:0,failed:0};try{const{data:d,headers:b}=yield Be(a);h.value=d.slice(0,100).map(n=>te(se({},n),{className:null,divisionName:null,divisions:[],_status:null,_error:null,_touched:!1})),r.value=b,t.value=b.map((n,v)=>({type:null,column:I.encode_col(v)})),ye(b,d.slice(0,5))}catch(d){console.error("Error loading preview:",d),_("Error loading file preview","error")}}}),e.click()})}function ye(e,o){const a={"First Name":["first","fname","given","firstname"],"Middle Name":["middle","mname","midname"],"Last Name":["last","lname","surname","family","lastname"],"Full Name":["full name","name","teacher name"],Email:["email","e-mail","mail"],Mobile:["mobile","phone","cell","contact"],"Date of Birth":["dob","birth","birthdate","date of birth"],Gender:["gender","sex"],"Date of Joining":["doj","joining","start date"],"PAN Number":["pan","pan no","pan number"],"Bank Name":["bank","bank name"],"Bank A/C No.":["account","ac no","bank account","account no"],"IFSC Code":["ifsc","code"],"Current Address":["current address","address","present address"],"Permanent Address":["permanent address","home address"],"Blood Group":["blood","blood group"],"Attendance Device ID (Biometric/RF tag ID)":["attendance id","biometric","rfid","device id"],"Qualification (Education)":["qualification","education","degree"],"School/University (Education)":["school","university","institution"]};e.forEach((d,b)=>{if(!d)return;const n=d.toString().toLowerCase();for(const[v,m]of Object.entries(a))if(m.some(p=>n.includes(p))){t.value[b].type=v;break}})}function De(){k.value=null,h.value=[],r.value=[],t.value=[],u.value=[],D.value=[],C.value=[],V.value=[],q.value={total_processed:0,successful:0,failed:0},_(null)}function L(e){const o=["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"],a=t.value.map(n=>n.type).filter(n=>n);if(o.filter(n=>!a.includes(n)).length>0)return!1;const b=B(e);for(const n of o){const v=b[n];if(!v||v.toString().trim()==="")return!1;switch(n){case"Mobile":if(v.toString().replace(/\D/g,"").length<10)return!1;break;case"Email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.toString().trim()))return!1;break;case"Gender":const E=v.toString().trim().toLowerCase();if(!["male","female","other","m","f","o"].includes(E))return!1;break;case"Date of Birth":if(!U(v,"Date of Birth").isValid)return!1;break;case"Date of Joining":if(!U(v,"Date of Joining").isValid)return!1;break}}return!(e.className&&!e.divisionName)}function we(e){h.value[e]&&(h.value[e]._touched=!0)}function Ee(e){return e._status==="success"?"row-success":e._enrollment_status==="error"?"row-enrollment-error":L(e)?"":"row-invalid"}function B(e){const o={"First Name":"","Middle Name":"","Last Name":"","Full Name":"",Gender:"",Mobile:"",Email:"","Date of Birth":"","Date of Joining":"","PAN Number":"","Bank Name":"","Bank A/C No.":"","IFSC Code":"","Current Address":"","Permanent Address":"","Blood Group":"","Attendance Device ID (Biometric/RF tag ID)":"","Qualification (Education)":"","School/University (Education)":"",Class:e.className||"",Division:e.divisionName||""};return t.value.forEach(({type:a,column:d},b)=>{var n;if(a&&o.hasOwnProperty(a))try{const v=I.decode_col(d),m=r.value[v];let p=((n=e[m])==null?void 0:n.toString().trim())||"";if(a==="Date of Birth"||a==="Date of Joining"){const E=ze(p);p=E?Ke(E):""}o[a]=p}catch(v){console.error(`Error mapping column ${d} for type ${a}:`,v)}}),o}function Ne(e,o){console.log("Updating row statuses from bulk response..."),h.value.forEach(a=>{a._status=null,a._error=null}),e.forEach(a=>{const d=Ce(a);d!==-1&&(h.value[d]._status="success",h.value[d]._error=null)}),o.forEach(a=>{const d=Se(a.instructor_data);d!==-1&&(h.value[d]._enrollment_status="error",h.value[d]._enrollment_error=a.error||"Unknown error")})}function Ce(e){return h.value.findIndex(o=>{const a=B(o);return`${a["First Name"]} ${a["Middle Name"]} ${a["Last Name"]}`.trim()===e})}function Se(e){return h.value.findIndex(o=>{const a=B(o);return a.Email===e.Email&&a["First Name"]===e["First Name"]&&a["Last Name"]===e["Last Name"]})}function O(e,o,a){W.value=e,X.value=o,Y.value=a,K.value=!0}function Re(){K.value=!1,W.value="success",X.value="",Y.value=""}function Fe(){return j(this,null,function*(){console.log("Enroll button clicked"),C.value=[],V.value=[],q.value={total_processed:0,successful:0,failed:0},F.value=!0,h.value.forEach(n=>{n._status=null,n._error=null});const e=["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"],o=t.value.map(n=>n.type).filter(n=>n),a=e.filter(n=>!o.includes(n));if(a.length>0){const n=`Please map the following required fields: ${a.join(", ")}`;console.error(n),_(n,"error"),F.value=!1;return}if(!k.value){const n="Please select a file first";console.error(n),_(n,"error"),F.value=!1;return}if(h.value.length===0){_("No data available to enroll","error"),F.value=!1;return}const d=h.value.filter(n=>{const v=B(n),m=v["Date of Birth"]&&v["Date of Birth"].toString().trim()!==""?U(v["Date of Birth"],"Date of Birth"):{isValid:!1,error:"Date of Birth is required"},p=v["Date of Joining"]&&v["Date of Joining"].toString().trim()!==""?U(v["Date of Joining"],"Date of Joining"):{isValid:!1,error:"Date of Joining is required"};return!m.isValid||!p.isValid});if(d.length>0){_(`${d.length} rows have invalid dates. Please correct the dates before enrolling.`,"warning"),d.forEach(n=>{const v=h.value.indexOf(n);if(v!==-1){const m=B(n);let p="";if(!m["Date of Birth"]||m["Date of Birth"].toString().trim()==="")p+="Date of Birth is required. ";else{const E=U(m["Date of Birth"],"Date of Birth");E.isValid||(p+=E.error+" ")}if(!m["Date of Joining"]||m["Date of Joining"].toString().trim()==="")p+="Date of Joining is required. ";else{const E=U(m["Date of Joining"],"Date of Joining");E.isValid||(p+=E.error)}h.value[v]._status="error",h.value[v]._error=p.trim()}}),F.value=!1;return}const b=h.value.filter(n=>!L(n));if(b.length>0){_(`${b.length} rows have class selected but no division. Please either select a division or remove the class assignment.`,"warning"),b.forEach(n=>n._touched=!0),F.value=!1;return}try{_("Starting bulk enrollment process...","info");const n=h.value.filter(m=>L(m));if(n.length===0){_("No valid rows to enroll. Please check your data and mappings.","warning"),F.value=!1;return}console.log(`Starting bulk enrollment for ${n.length} teachers...`);const v=n.map(m=>B(m));yield $.submit({teachers:v,mappings:Object.fromEntries(t.value.filter(m=>m.type).map(m=>[m.type,m.column]))})}catch(n){console.error("Bulk enrollment process error:",n),_(`Bulk enrollment process failed: ${n.message||"Unknown error"}`,"error"),O("error","Bulk Enrollment Process Failed",n.message||"Unknown error occurred during enrollment."),F.value=!1}})}function Be(e){return new Promise((o,a)=>{const d=new FileReader;d.onload=b=>{try{const n=new Uint8Array(b.target.result),v=We(n,{type:"array",sheetStubs:!0}),m=v.Sheets[v.SheetNames[0]],p=I.decode_range(m["!ref"]);let E=0;for(let w=p.s.r;w<=p.e.r;++w){let R=!1;for(let G=p.s.c;G<=p.e.c;++G){const A=m[I.encode_cell({c:G,r:w})];if(A&&A.v!==void 0&&A.v!==null&&A.v!==""){R=!0;break}}if(R){E=w;break}}const J=[];for(let w=p.s.c;w<=p.e.c;++w){const R=m[I.encode_cell({c:w,r:E})];J.push(R?String(R.v).trim():`Column ${w+1}`)}const H=[];for(let w=E+1;w<=p.e.r;++w){const R={};let G=!1;for(let A=p.s.c;A<=p.e.c;++A){const ee=m[I.encode_cell({c:A,r:w})],ae=J[A-p.s.c];R[ae]=ee?ee.v===void 0?"":ee.v:"",R[ae]!==""&&(G=!0)}G&&H.push(R)}o({data:H,headers:J})}catch(n){a(n)}},d.onerror=b=>a(b),d.readAsArrayBuffer(e)})}function Te(e,o,a){t.value[e]=te(se({},t.value[e]),{[o]:a,column:I.encode_col(e)})}function Me(e){h.value.splice(e,1),u.value=u.value.filter(o=>o.rowIndex!==e),D.value=D.value.filter(o=>o.rowIndex!==e),_("Row deleted","success")}function _(e,o="info"){x.value=e?{text:e,type:o}:null,e&&o!=="error"&&o!=="success"&&setTimeout(()=>_(null),5e3)}function Ae(e,o,a){const b=h.value[e][o]||"";if(b!==a){const n={rowIndex:e,column:o,oldValue:b,newValue:a,timestamp:new Date().toISOString()};u.value.push(n),D.value.push(n),console.log("Cell edit recorded:",n),Ie()}}function Ve(e,o){let a;return function(...d){clearTimeout(a),a=setTimeout(()=>e.apply(this,d),o)}}const Ie=Ve(Ue,500);function Ue(){return j(this,null,function*(){if(D.value.length!==0)try{const e=D.value[D.value.length-1],o=h.value[e.rowIndex],a=B(o);yield $.submit({teachers:[a],mappings:Object.fromEntries(t.value.filter(d=>d.type).map(d=>[d.type,d.column]))}),D.value=[]}catch(e){console.error("Error sending cell update:",e),_(`Failed to save cell update: ${e.message||"Unknown error"}`,"error")}})}return{mappings:t,fileSelected:k,options:l,message:x,previewData:h,previewHeaders:r,classes:g,editHistory:u,pendingEdits:D,enrolledTeachers:C,failedEnrollments:V,enrollmentSummary:q,processing:F,showResultModal:K,resultModalType:W,resultModalTitle:X,resultModalDescription:Y,showErrorTeachersList:N,validRowsCount:de,classTeachersCount:ue,invalidRowsCount:me,errorRows:fe,getTeacherFullName:ve,getTeacherEmail:he,getTeacherMobile:ge,getRowError:pe,classesResource:ne,divisionsResource:Z,enrollTeachersResource:$,onClassChange:_e,getExcelColumnLetter:be,handleFileSelection:ke,removeFile:De,handleEnrollTeachers:Fe,updateMapping:Te,deleteRow:Me,showMessage:_,handleCellEdit:Ae,closeResultModal:Re,isRowValid:L,markRowAsTouched:we,getRowStatusClass:Ee,validDate:He,getTodayDate:Qe}}},Ye={class:"enrollment-container"},Ze={class:"scroll-view-content"},$e={class:"form-card"},es={class:"form-section"},ss={key:0,class:"file-selected"},ts={class:"button-content"},ls={class:"enroll-button-section"},os=["disabled"],ns={class:"button-content"},as={key:0,class:"spinner"},rs={key:0,class:"form-card summary-card"},is={class:"summary-stats"},cs={class:"stat-item"},ds={class:"stat-value"},us={class:"stat-item"},ms={class:"stat-value valid"},fs={class:"stat-item"},vs={class:"stat-value warning"},hs={key:0,class:"success-details"},gs={class:"section-title"},ps={class:"results-list"},_s={key:1,class:"error-details"},bs={class:"section-title"},ks={class:"results-list"},ys={class:"error-student"},Ds={class:"student-details"},ws={class:"error-text"},Es={key:1,class:"form-card preview-card"},Ns={class:"summary-stats"},Cs={class:"stat-item"},Ss={class:"stat-value"},Rs={class:"stat-item"},Fs={class:"stat-value valid"},Bs={class:"stat-item"},Ts={class:"stat-value info"},Ms={class:"stat-item"},As=["title"],Vs={key:0,class:"error-indicator"},Is={key:0,class:"error-students-card"},Us={class:"section-title"},Ls={class:"error-details",style:{"max-height":"200px","overflow-y":"auto"}},Ps={class:"results-list"},xs={class:"error-student"},Js={class:"student-details"},Gs={class:"error-text"},js={key:0,class:"multiple-errors"},qs={key:1},Os={key:1,class:"table-spacing"},Hs={class:"table-container-wrapper"},Qs={class:"table-scroll-container"},zs={class:"table-container"},Ks={class:"preview-table"},Ws=["onUpdate:modelValue","onChange"],Xs=["value"],Ys={class:"header-label"},Zs={class:"actions"},$s=["onClick"],et={class:"status-cell"},st={key:0,class:"status-badge success"},tt={key:1,class:"status-badge error"},lt={key:2,class:"status-badge warning"},ot={key:3,class:"status-badge pending"},nt={key:4,class:"error-tooltip"},at=["onUpdate:modelValue","onChange","disabled"],rt=["value"],it=["onUpdate:modelValue","disabled"],ct=["value"],dt={key:0,class:"field-hint"},ut=["onUpdate:modelValue","onInput","onBlur","placeholder"],mt={key:2,class:"loading-overlay"},ft={key:3,class:"modal-overlay"},vt={class:"result-modal"},ht={key:0,class:"success-icon"},gt={key:1,class:"error-icon"},pt={class:"result-title"},_t={class:"result-description"},bt={class:"modal-actions"};function kt(N,t,k,l,x,h){return c(),i("div",Ye,[s("div",Ze,[t[33]||(t[33]=s("div",{class:"header"},[s("h1",{class:"title"},"Teacher Enrollment")],-1)),s("div",$e,[t[6]||(t[6]=s("h2",{class:"form-title"},"Upload Teacher Data",-1)),s("div",es,[l.fileSelected?(c(),i("div",ss,[s("span",null,"Selected file: "+f(l.fileSelected.name),1),s("button",{onClick:t[0]||(t[0]=(...r)=>l.removeFile&&l.removeFile(...r)),class:"remove-file-btn"},"×")])):S("",!0),s("button",{class:"secondary-button",onClick:t[1]||(t[1]=(...r)=>l.handleFileSelection&&l.handleFileSelection(...r))},[s("span",ts,f(l.fileSelected?"Change File":"Upload File 📤"),1)]),s("div",ls,[s("button",{class:"enroll-button",onClick:t[2]||(t[2]=(...r)=>l.handleEnrollTeachers&&l.handleEnrollTeachers(...r)),disabled:l.processing||!l.fileSelected},[s("span",ns,[l.processing?(c(),i("span",as)):S("",!0),P(" "+f(l.processing?"Processing...":"Enroll Teachers ✅"),1)])],8,os)]),l.message?(c(),i("div",{key:1,class:ce(["message",l.message.type])},f(l.message.text),3)):S("",!0)])]),l.enrollmentSummary.total_processed>0?(c(),i("div",rs,[t[10]||(t[10]=s("h2",{class:"form-title"},"Enrollment Summary",-1)),s("div",is,[s("div",cs,[t[7]||(t[7]=s("span",{class:"stat-label"},"Total Processed",-1)),s("span",ds,f(l.enrollmentSummary.total_processed),1)]),s("div",us,[t[8]||(t[8]=s("span",{class:"stat-label"},"Successful",-1)),s("span",ms,f(l.enrollmentSummary.successful),1)]),s("div",fs,[t[9]||(t[9]=s("span",{class:"stat-label"},"Failed",-1)),s("span",vs,f(l.enrollmentSummary.failed),1)])]),l.enrolledTeachers.length>0?(c(),i("div",hs,[s("h4",gs,"Successfully Enrolled ("+f(l.enrolledTeachers.length)+")",1),s("div",ps,[(c(!0),i(T,null,M(l.enrolledTeachers,(r,g)=>(c(),i("div",{key:g,class:"success-message"}," ✅ "+f(r),1))),128))])])):S("",!0),l.failedEnrollments.length>0?(c(),i("div",_s,[s("h4",bs,"Enrollment Errors ("+f(l.failedEnrollments.length)+")",1),s("div",ks,[(c(!0),i(T,null,M(l.failedEnrollments,(r,g)=>(c(),i("div",{key:g,class:"error-message"},[s("div",ys,[s("strong",null,f(r.instructor_data["First Name"])+" "+f(r.instructor_data["Middle Name"])+" "+f(r.instructor_data["Last Name"]),1),s("span",Ds,"(Email: "+f(r.instructor_data.Email)+", Mobile: "+f(r.instructor_data.Mobile)+")",1)]),s("div",ws,"❌ "+f(r.error),1)]))),128))])])):S("",!0)])):S("",!0),l.fileSelected&&l.previewData.length>0?(c(),i("div",Es,[t[28]||(t[28]=s("h2",{class:"form-title"},"File Preview (First 100 rows)",-1)),s("div",Ns,[s("div",Cs,[t[11]||(t[11]=s("span",{class:"stat-label"},"Total Rows:",-1)),s("span",Ss,f(l.previewData.length),1)]),s("div",Rs,[t[12]||(t[12]=s("span",{class:"stat-label"},"Ready to Enroll:",-1)),s("span",Fs,f(l.validRowsCount),1)]),s("div",Bs,[t[13]||(t[13]=s("span",{class:"stat-label"},"Class Teachers:",-1)),s("span",Ts,f(l.classTeachersCount),1)]),s("div",Ms,[t[14]||(t[14]=s("span",{class:"stat-label"},"Need Attention:",-1)),s("span",{class:"stat-value warning",style:{cursor:"pointer"},onClick:t[3]||(t[3]=r=>l.showErrorTeachersList=!l.showErrorTeachersList),title:l.invalidRowsCount>0?"Click to view teachers with errors":""},[P(f(l.invalidRowsCount)+" ",1),l.invalidRowsCount>0?(c(),i("span",Vs,"⚠️")):S("",!0)],8,As)])]),l.showErrorTeachersList&&l.errorRows.length>0?(c(),i("div",Is,[s("h4",Us,"Teachers with Errors ("+f(l.invalidRowsCount)+")",1),s("div",Ls,[s("div",Ps,[(c(!0),i(T,null,M(l.errorRows,(r,g)=>(c(),i("div",{key:g,class:"error-message"},[s("div",xs,[s("strong",null,f(l.getTeacherFullName(r)),1),s("span",Js," (Email: "+f(l.getTeacherEmail(r))+", Mobile: "+f(l.getTeacherMobile(r))+") ",1)]),s("div",Gs,[t[15]||(t[15]=P(" ⚠️ ")),l.getRowError(r).includes(";")?(c(),i("span",js,f(l.getRowError(r)),1)):(c(),i("span",qs,f(l.getRowError(r)),1))])]))),128))])])])):S("",!0),t[29]||(t[29]=s("div",{class:"instructions"},[s("p",null,[P("💡 "),s("strong",null,"Note:"),P(" Class and Division are optional fields. Only assign them for teachers who are class teachers.")])],-1)),l.showErrorTeachersList&&l.errorRows.length>0?(c(),i("div",Os)):S("",!0),s("div",Hs,[s("div",Qs,[s("div",zs,[s("table",Ks,[s("thead",null,[s("tr",null,[t[16]||(t[16]=s("th",{class:"actions"},"Actions",-1)),t[17]||(t[17]=s("th",{class:"status-cell"},"Status",-1)),t[18]||(t[18]=s("th",null,[P("Class/Program "),s("span",{class:"optional"},"(Optional)")],-1)),t[19]||(t[19]=s("th",null,[P("Division/Student Group "),s("span",{class:"optional"},"(Optional)")],-1)),(c(!0),i(T,null,M(l.previewHeaders,(r,g)=>(c(),i("th",{key:"letter-"+g},f(l.getExcelColumnLetter(g)),1))),128))]),s("tr",null,[t[21]||(t[21]=s("th",{class:"actions"},null,-1)),t[22]||(t[22]=s("th",{class:"status-cell"},null,-1)),t[23]||(t[23]=s("th",null,"Class/Program",-1)),t[24]||(t[24]=s("th",null,"Division/Student Group",-1)),(c(!0),i(T,null,M(l.previewHeaders,(r,g)=>(c(),i("th",{key:"header-"+g},[z(s("select",{"onUpdate:modelValue":u=>l.mappings[g].type=u,class:"table-select",onChange:u=>l.updateMapping(g,"type",u.target.value)},[t[20]||(t[20]=s("option",{value:null},"Select Field",-1)),(c(!0),i(T,null,M(l.options,(u,D)=>(c(),i("option",{key:D,value:u},f(u),9,Xs))),128))],40,Ws),[[oe,l.mappings[g].type]]),s("span",Ys,f(r),1)]))),128))])]),s("tbody",null,[(c(!0),i(T,null,M(l.previewData,(r,g)=>(c(),i("tr",{key:g,class:ce(l.getRowStatusClass(r))},[s("td",Zs,[s("button",{onClick:u=>l.deleteRow(g),class:"trash-icon"},t[25]||(t[25]=[s("span",{class:"icon"},"❎",-1)]),8,$s)]),s("td",et,[r._status==="success"?(c(),i("span",st,"✅")):r._status==="error"?(c(),i("span",tt,"❌")):l.isRowValid(r)?(c(),i("span",ot,"🔄")):(c(),i("span",lt,"⚠️")),r._error?(c(),i("div",nt,f(r._error),1)):S("",!0)]),s("td",null,[z(s("select",{"onUpdate:modelValue":u=>r.className=u,class:"table-select",onChange:u=>l.onClassChange(g),disabled:l.classesResource.loading},[t[26]||(t[26]=s("option",{value:null},"Not a Class Teacher",-1)),(c(!0),i(T,null,M(l.classes,u=>(c(),i("option",{key:u.name,value:u.name},f(u.name),9,rt))),128))],40,at),[[oe,r.className]])]),s("td",null,[z(s("select",{"onUpdate:modelValue":u=>r.divisionName=u,class:"table-select",disabled:!r.className||l.divisionsResource.loading},[t[27]||(t[27]=s("option",{value:null},"Select Division",-1)),(c(!0),i(T,null,M(r.divisions,u=>(c(),i("option",{key:u.name,value:u.name},f(u.name),9,ct))),128))],8,it),[[oe,r.divisionName]]),r.className&&!r.divisionName?(c(),i("div",dt," Select division if this teacher is a class teacher ")):S("",!0)]),(c(!0),i(T,null,M(l.previewHeaders,(u,D)=>(c(),i("td",{key:D},[z(s("input",{"onUpdate:modelValue":C=>r[u]=C,class:"table-input",onInput:C=>l.handleCellEdit(g,u,C.target.value),onBlur:C=>l.markRowAsTouched(g),placeholder:r[u]||"-"},null,40,ut),[[Oe,r[u]]])]))),128))],2))),128))])])])])])])):S("",!0),l.processing?(c(),i("div",mt,t[30]||(t[30]=[s("div",{class:"loading-modal"},[s("div",{class:"loading-spinner"}),s("h3",{class:"loading-title"},"Enrolling Teachers"),s("p",{class:"loading-description"},"Please wait while we process the teacher data...")],-1)]))):S("",!0),l.showResultModal?(c(),i("div",ft,[s("div",vt,[l.resultModalType==="success"?(c(),i("div",ht,t[31]||(t[31]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(c(),i("div",gt,t[32]||(t[32]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",pt,f(l.resultModalTitle),1),s("p",_t,f(l.resultModalDescription),1),s("div",bt,[l.resultModalType==="success"?(c(),i("button",{key:0,class:"success-button",onClick:t[4]||(t[4]=(...r)=>l.closeResultModal&&l.closeResultModal(...r))}," Continue ")):(c(),i("button",{key:1,class:"primary-button",onClick:t[5]||(t[5]=(...r)=>l.closeResultModal&&l.closeResultModal(...r))}," Try Again "))])])])):S("",!0)])])}const Nt=je(Xe,[["render",kt]]);export{Nt as default};
