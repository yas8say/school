const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VueCropper-Di-HRxu9.js","assets/index-BhxGw4-h.js","assets/index-D9x31ZqE.css"])))=>i.map(i=>d[i]);
var B=(H,q,u)=>new Promise((b,U)=>{var h=p=>{try{k(u.next(p))}catch(y){U(y)}},f=p=>{try{k(u.throw(p))}catch(y){U(y)}},k=p=>p.done?b(p.value):Promise.resolve(p.value).then(h,f);k((u=u.apply(H,q)).next())});import{_ as ce,r as c,c as oe,j as ge,x as _e,o as n,a as r,b as e,t as v,y as $,z as E,F as ke,l as Ce,n as W,A as re,d as ne,i as _,B as Ne,C as se,k as Fe,D as he,q as we,h as ue,u as me,E as Pe,G as de,e as Ve,g as Le,m as Ge}from"./index-BhxGw4-h.js";const Ae={class:"bg-white rounded-lg border border-gray-200 p-4"},Oe={class:"flex items-center justify-between mb-4"},He={class:"flex items-center space-x-2"},qe={class:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full"},We={class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full"},Te={class:"space-y-4"},Je={class:"flex justify-between items-center mb-2"},Ke={class:"text-sm text-blue-600 font-medium"},Qe={class:"grid grid-cols-4 gap-2"},Ye=["onClick"],Xe={class:"grid grid-cols-2 gap-4"},Ze={key:0,class:"bg-gray-50 rounded-lg p-3 border border-gray-200"},et={class:"grid grid-cols-2 gap-4 text-sm"},tt={class:"font-medium text-gray-800"},st={class:"font-medium text-green-600"},ot={class:"font-medium text-blue-600"},lt={class:"font-medium text-gray-800"},at={class:"flex space-x-3 pt-2"},nt=["disabled"],rt={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},it={__name:"ImageCompressor",props:{imageBlob:{type:Blob,required:!0},imageUrl:{type:String,default:""},autoCompress:{type:Boolean,default:!0},defaultQuality:{type:Number,default:80},defaultMaxWidth:{type:[String,Number],default:"1024"}},emits:["compressed","cancel","error"],setup(H,{emit:q}){const u=q,b=H,U=c(b.defaultQuality),h=c(b.defaultMaxWidth),f=c("jpeg"),k=c(null),p=c(!1),y=c(0),I=c(0),j=c({width:0,height:0}),P=c([{name:"High",quality:90,maxWidth:"original"},{name:"Medium",quality:75,maxWidth:"1024"},{name:"Low",quality:50,maxWidth:"800"},{name:"Minimal",quality:30,maxWidth:"600"}]),R=oe(()=>!y.value||!I.value?0:Math.round((y.value-I.value)/y.value*100)),S=d=>d?d<1024?d+" Bytes":d<1048576?(d/1024).toFixed(1)+" KB":(d/1048576).toFixed(1)+" MB":"0 KB",O=d=>new Promise(i=>{const w=new Image;w.onload=()=>{i({width:w.width,height:w.height})},w.onerror=()=>{i({width:0,height:0})},w.src=d}),C=(d,i=.8,w="original",J="jpeg")=>B(this,null,function*(){return new Promise(V=>{const F=new Image,L=URL.createObjectURL(d);F.onload=()=>B(this,null,function*(){const G=document.createElement("canvas"),A=G.getContext("2d");let{width:z,height:N}=F;w!=="original"&&z>w&&(N=N*w/z,z=w),G.width=z,G.height=N,A.imageSmoothingEnabled=!0,A.imageSmoothingQuality="high",A.drawImage(F,0,0,z,N);const K=J==="webp"?"image/webp":J==="png"?"image/png":"image/jpeg";G.toBlob(Q=>{URL.revokeObjectURL(L),V({blob:Q||d,dimensions:{width:z,height:N}})},K,i/100)}),F.onerror=()=>{URL.revokeObjectURL(L),V({blob:d,dimensions:{width:0,height:0}})},F.src=L})}),m=()=>B(this,null,function*(){if(b.imageBlob){p.value=!0;try{const d=yield C(b.imageBlob,U.value,h.value==="original"?"original":parseInt(h.value),f.value);k.value=d.blob,I.value=d.blob.size,j.value=d.dimensions}catch(d){u("error","Failed to compress image: "+d.message)}finally{p.value=!1}}}),T=d=>{U.value=d.quality,h.value=d.maxWidth,m()},D=()=>{k.value&&u("compressed",{blob:k.value,quality:U.value,dimensions:j.value,format:f.value,originalSize:y.value,compressedSize:I.value,reduction:R.value})};return ge(()=>B(this,null,function*(){if(b.imageBlob){if(y.value=b.imageBlob.size,b.imageUrl){const d=yield O(b.imageUrl);j.value=d}b.autoCompress&&(yield m())}})),_e(()=>b.imageBlob,d=>B(this,null,function*(){d&&(y.value=d.size,b.autoCompress&&(yield m()))})),(d,i)=>(n(),r("div",Ae,[e("div",Oe,[i[5]||(i[5]=e("div",null,[e("h4",{class:"font-medium text-gray-800"},"Image Compression"),e("p",{class:"text-sm text-gray-600"},"Optimize image size for better performance")],-1)),e("div",He,[e("span",qe,v(S(y.value)),1),i[4]||(i[4]=e("span",{class:"text-gray-400"},"â†’",-1)),e("span",We,v(S(I.value)),1)])]),e("div",Te,[e("div",null,[e("div",Je,[i[6]||(i[6]=e("label",{class:"text-sm font-medium text-gray-700"},"Compression Quality",-1)),e("span",Ke,v(U.value)+"%",1)]),$(e("input",{type:"range","onUpdate:modelValue":i[0]||(i[0]=w=>U.value=w),min:"10",max:"100",step:"5",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",onInput:m},null,544),[[E,U.value]]),i[7]||(i[7]=e("div",{class:"flex justify-between text-xs text-gray-500 mt-1"},[e("span",null,"Smaller File"),e("span",null,"Better Quality")],-1))]),e("div",null,[i[8]||(i[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Presets",-1)),e("div",Qe,[(n(!0),r(ke,null,Ce(P.value,w=>(n(),r("button",{key:w.name,onClick:J=>T(w),class:W(["px-3 py-2 text-xs rounded-md transition-colors border",w.quality===U.value?"bg-blue-100 text-blue-700 border-blue-300":"bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200"])},v(w.name),11,Ye))),128))])]),e("div",Xe,[e("div",null,[i[10]||(i[10]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Max Width",-1)),$(e("select",{"onUpdate:modelValue":i[1]||(i[1]=w=>h.value=w),onChange:m,class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},i[9]||(i[9]=[ne('<option value="original" data-v-cca7466d>Original</option><option value="800" data-v-cca7466d>800px</option><option value="1024" data-v-cca7466d>1024px</option><option value="1200" data-v-cca7466d>1200px</option><option value="1600" data-v-cca7466d>1600px</option>',5)]),544),[[re,h.value]])]),e("div",null,[i[12]||(i[12]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Format",-1)),$(e("select",{"onUpdate:modelValue":i[2]||(i[2]=w=>f.value=w),onChange:m,class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},i[11]||(i[11]=[e("option",{value:"jpeg"},"JPEG",-1),e("option",{value:"webp"},"WebP",-1),e("option",{value:"png"},"PNG",-1)]),544),[[re,f.value]])])]),k.value?(n(),r("div",Ze,[e("div",et,[e("div",null,[i[13]||(i[13]=e("p",{class:"text-gray-600"},"Original Size",-1)),e("p",tt,v(S(y.value)),1)]),e("div",null,[i[14]||(i[14]=e("p",{class:"text-gray-600"},"Compressed Size",-1)),e("p",st,v(S(I.value)),1)]),e("div",null,[i[15]||(i[15]=e("p",{class:"text-gray-600"},"Reduction",-1)),e("p",ot,v(R.value)+"%",1)]),e("div",null,[i[16]||(i[16]=e("p",{class:"text-gray-600"},"Dimensions",-1)),e("p",lt,v(j.value.width)+"Ã—"+v(j.value.height)+"px",1)])])])):_("",!0),e("div",at,[e("button",{onClick:D,disabled:!k.value||p.value,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transition-colors"},[p.value?(n(),r("svg",rt,i[17]||(i[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):_("",!0),e("span",null,v(p.value?"Compressing...":"Apply Compression"),1)],8,nt),e("button",{onClick:i[3]||(i[3]=w=>d.$emit("cancel")),class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors"}," Cancel ")])])]))}},dt=ce(it,[["__scopeId","data-v-cca7466d"]]),ut={class:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm"},mt={class:"flex items-center justify-between mb-6"},ct=["src","alt"],gt={class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},pt={class:"flex items-center space-x-4"},vt={class:"w-20 h-20 rounded-full border-2 border-white shadow-md overflow-hidden bg-gray-100"},bt=["src","alt"],ft={key:2,class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center"},xt={key:0,class:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"},yt={class:"flex-1"},ht={class:"font-medium text-gray-800"},wt={class:"text-sm text-gray-600"},_t={key:0,class:"text-sm text-blue-600 mt-1"},kt={class:"bg-blue-50 rounded-lg border border-blue-200 p-5"},Ct={class:"space-y-4"},$t={class:"flex flex-col sm:flex-row gap-3"},jt=["disabled"],It={class:"relative flex-1"},Mt=["disabled"],St={key:0,class:"absolute top-full left-0 mt-1 w-full bg-white rounded-lg shadow-lg border border-gray-200 z-10"},Ut={key:0,class:"p-4 bg-white rounded-lg border border-gray-200"},Rt={class:"flex items-center justify-between"},Bt={class:"flex items-center space-x-3"},Et=["src"],Dt={key:1,class:"w-full h-full flex items-center justify-center text-blue-600 font-semibold text-sm rounded-lg bg-blue-50"},zt={class:"font-medium text-gray-800"},Nt={class:"text-sm text-gray-600"},Ft={class:"text-xs text-gray-500 mt-1"},Pt={class:"flex items-center space-x-2"},Vt={key:2,class:"flex space-x-3"},Lt=["disabled"],Gt={key:0,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={key:0,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4"},Ot={class:"bg-white rounded-lg max-w-4xl max-h-[90vh] w-full h-full flex flex-col"},Ht={class:"flex-1 flex items-center justify-center p-8 overflow-auto"},qt=["src"],Wt={key:2,class:"fixed inset-0 bg-black bg-opacity-90 flex flex-col items-center justify-center z-50 p-4"},Tt={class:"bg-white rounded-xl p-6 max-w-lg w-full"},Jt={class:"flex justify-between items-center mb-6"},Kt={class:"flex items-center space-x-2"},Qt={class:"relative bg-gray-900 rounded-xl overflow-hidden mb-4"},Yt={class:"text-center"},Xt={class:"text-sm text-gray-600"},Zt={class:"font-medium"},es={key:3,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4"},ts={class:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[95vh] overflow-hidden flex flex-col"},ss={class:"text-xl font-semibold text-gray-800 mb-6 flex-shrink-0"},os={class:"flex-1 min-h-0 bg-gray-100 rounded-lg p-4 overflow-hidden"},ls={key:1,class:"h-full w-full flex items-center justify-center"},as={class:"flex-shrink-0 mt-6"},ns={class:"flex justify-center items-center space-x-4 mb-6"},rs=["disabled"],is=["disabled"],ds=["disabled"],us={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},ms=["disabled"],cs={__name:"StudentProfileImage",props:{studentId:{type:String,required:!0},currentImage:{type:String,default:""},studentName:{type:String,default:""}},emits:["image-updated","error","success"],setup(H,{emit:q}){const u=Ne(null),b=c(!1),U=()=>B(this,null,function*(){if(!u.value)try{const l=yield Pe(()=>import("./VueCropper-Di-HRxu9.js").then(g=>g.V),__vite__mapDeps([0,1,2]));u.value=l.default;const o=document.createElement("link");o.rel="stylesheet",o.href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css",document.head.appendChild(o),b.value=!0}catch(l){console.error("Failed to load CropperJS:",l),f("error","Failed to load image editor")}}),h=H,f=q,k=c(!1),p=c(null),y=c(null),I=c(null),j=c(""),P=c(!1),R=c(!1),S=c(!1),O=c(!1),C=c(!1),m=c(""),T=c(""),D=c(""),d=c(null),i=c("user"),w=c([]),J=c(!1),V=c(""),F=c(0),L=c({width:0,height:0}),G=c(null),A=c(null),z=c(null),N=oe(()=>V.value?V.value:j.value?j.value:h.currentImage&&h.currentImage!=="null"&&h.currentImage!==""?Z(h.currentImage):null),K=oe(()=>{if(!h.studentName)return"?";const l=h.studentName.trim().split(" ");if(l.length===0)return"?";const o=l[0].charAt(0).toUpperCase();if(l.length===1)return o;const g=l[l.length-1].charAt(0).toUpperCase();return o+g}),Q=oe(()=>{if(!h.studentName)return"#6b7280";const l=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#14b8a6"];let o=0;for(let g=0;g<h.studentName.length;g++)o=h.studentName.charCodeAt(g)+((o<<5)-o);return l[Math.abs(o)%l.length]}),le=l=>l?l<1024?l+" Bytes":l<1048576?(l/1024).toFixed(1)+" KB":(l/1048576).toFixed(1)+" MB":"0 KB",Z=l=>!l||l==="null"||l===""?null:l.startsWith("http")||l.startsWith("//")?l:l.startsWith("/")?window.location.origin+l:`${window.location.origin}/${l.replace(/^\//,"")}`,ee=l=>new Promise(o=>{const g=new Image;g.onload=()=>{o({width:g.width,height:g.height})},g.onerror=()=>{o({width:0,height:0})},g.src=l}),te=l=>{l&&(T.value=l,O.value=!0)},ie=()=>{O.value=!1,T.value=""},X=l=>{D.value==="file"&&p.value?p.value=new File([l.blob],p.value.name,{type:l.blob.type,lastModified:Date.now()}):D.value==="camera"&&(I.value=l.blob,y.value=new File([l.blob],`camera-photo-${Date.now()}.${l.format}`,{type:l.blob.type,lastModified:Date.now()})),F.value=l.compressedSize,L.value=l.dimensions,C.value=!1,f("success",`Image compressed to ${l.reduction}% smaller`)},s=l=>{f("error",l),C.value=!1},t=()=>B(this,null,function*(){try{const o=(yield navigator.mediaDevices.enumerateDevices()).filter(g=>g.kind==="videoinput");w.value=o,J.value=o.length>1}catch(l){}}),a=(l="user")=>B(this,null,function*(){S.value=!1,R.value=!1,P.value=!0,i.value=l;try{d.value&&d.value.getTracks().forEach(g=>g.stop());const o={video:{facingMode:l,width:{ideal:1920},height:{ideal:1080}}};d.value=yield navigator.mediaDevices.getUserMedia(o),A.value&&(A.value.srcObject=d.value)}catch(o){f("error","Camera access denied or not available"),P.value=!1}}),x=()=>B(this,null,function*(){const l=i.value==="user"?"environment":"user";yield a(l)}),$e=()=>{S.value=!S.value},pe=l=>{l.target.closest(".relative")||(S.value=!1)},je=se({url:"school.al_ummah.api2.update_student_profile_image",auto:!1,onSuccess(l){k.value=!1,l.status==="success"?(V.value=j.value,f("image-updated",l.image_url),f("success",l.message||"Profile image updated successfully!"),xe()):f("error",l.message||"Upload failed")},onError(l){k.value=!1,f("error",l.message||"Upload error occurred")}}),ve=()=>{var l;return(l=G.value)==null?void 0:l.click()},Ie=l=>B(this,null,function*(){const o=l.target.files[0];if(!o)return;if(!o.type.startsWith("image/"))return f("error","Select an image");if(o.size>10*1024*1024)return f("error","Image must be less than 10MB");p.value=o,F.value=o.size;const g=new FileReader;g.onload=M=>B(this,null,function*(){m.value=M.target.result,j.value=M.target.result,D.value="file",yield U();const Y=yield ee(M.target.result);L.value=Y,R.value=!0}),g.readAsDataURL(o)}),Me=()=>{if(!A.value)return;const l=document.createElement("canvas"),o=A.value;l.width=o.videoWidth,l.height=o.videoHeight,l.getContext("2d").drawImage(o,0,0),l.toBlob(g=>B(this,null,function*(){if(!g)return;I.value=g,F.value=g.size,y.value=new File([g],`camera-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});const M=new FileReader;M.onload=Y=>B(this,null,function*(){m.value=Y.target.result,j.value=Y.target.result,D.value="camera",yield U();const ze=yield ee(Y.target.result);L.value=ze,R.value=!0}),M.readAsDataURL(g)}),"image/jpeg",.8),ae()},ae=()=>{d.value&&d.value.getTracks().forEach(l=>l.stop()),d.value=null,P.value=!1,S.value=!1},be=l=>{z.value&&b.value&&z.value.rotate(l)},Se=()=>{z.value&&b.value&&z.value.reset()},Ue=()=>{if(!(!z.value||!b.value))try{const l=z.value.getCroppedCanvas();if(!l)throw new Error("Cannot crop image");l.toBlob(o=>{if(!o){f("error","Failed to process cropped image");return}Re(o)},"image/jpeg",.8)}catch(l){f("error","Failed to crop image. Please try again.")}},Re=l=>B(this,null,function*(){const o=new FileReader;o.onload=g=>B(this,null,function*(){const M=g.target.result;V.value=M,j.value=M,F.value=l.size;const Y=yield ee(M);L.value=Y,D.value==="file"&&p.value?p.value=new File([l],p.value.name,{type:"image/jpeg",lastModified:Date.now()}):D.value==="camera"&&(y.value=new File([l],`camera-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()}),I.value=l)}),o.readAsDataURL(l),R.value=!1,f("success",'Image cropped successfully! Click "Update Profile Image" to save.')}),Be=()=>{R.value=!1,m.value="",D.value==="file"?(p.value=null,G.value&&(G.value.value="")):(y.value=null,I.value=null,a(i.value))},Ee=()=>{let l="";if(p.value){const o=new FileReader;o.onload=g=>{l=g.target.result,fe(l)},o.readAsDataURL(p.value)}else if(y.value&&I.value){const o=new FileReader;o.onload=g=>{l=g.target.result,fe(l)},o.readAsDataURL(I.value)}else{f("error","No image selected or image data missing");return}},fe=l=>{k.value=!0;let o=l;if(l.startsWith("data:")){const g=l.indexOf(",");g!==-1&&(o=l.substring(g+1))}je.fetch({student_id:h.studentId,base64_image:o})},De=()=>xe(),xe=()=>{p.value=null,y.value=null,I.value=null,j.value="",R.value=!1,m.value="",S.value=!1,C.value=!1,F.value=0,L.value={width:0,height:0},G.value&&(G.value.value=""),ae()},ye=l=>{l.target.style.display="none";const o=l.target.parentElement;if(o){const g=document.createElement("div");g.className="w-full h-full flex items-center justify-center text-white font-semibold text-2xl",g.style.backgroundColor=Q.value,g.textContent=K.value,o.innerHTML="",o.appendChild(g)}};return ge(()=>{t(),document.addEventListener("click",pe),h.currentImage&&(V.value=Z(h.currentImage))}),Fe(()=>{ae(),document.removeEventListener("click",pe)}),_e(()=>h.currentImage,l=>{l&&(V.value=Z(l))}),(l,o)=>{var g;return n(),r("div",ut,[e("div",mt,[o[10]||(o[10]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-800"},"Profile Image"),e("p",{class:"text-sm text-gray-600 mt-1"},"Update student's profile picture")],-1)),e("div",{class:"w-16 h-16 rounded-full border-2 border-gray-100 shadow-sm overflow-hidden bg-gray-50 cursor-pointer",onClick:o[0]||(o[0]=M=>te(N.value))},[N.value?(n(),r("img",{key:0,src:N.value,alt:H.studentName,class:"w-full h-full object-cover",onError:ye,loading:"lazy"},null,40,ct)):(n(),r("div",{key:1,class:"w-full h-full flex items-center justify-center text-white font-semibold text-xl",style:he({backgroundColor:Q.value})},v(K.value),5))])]),e("div",gt,[e("div",pt,[e("div",{class:"relative cursor-pointer",onClick:o[1]||(o[1]=M=>te(N.value))},[e("div",vt,[N.value?(n(),r("img",{key:0,src:N.value,alt:H.studentName,class:"w-full h-full object-cover",onError:ye,loading:"lazy"},null,40,bt)):(n(),r("div",{key:1,class:"w-full h-full flex items-center justify-center text-white font-semibold text-2xl",style:he({backgroundColor:Q.value})},v(K.value),5)),k.value?(n(),r("div",ft,o[11]||(o[11]=[e("div",{class:"spinner-small !w-6 !h-6 !border-2"},null,-1)]))):_("",!0)]),N.value?(n(),r("div",xt,o[12]||(o[12]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)]))):_("",!0)]),e("div",yt,[e("h4",ht,v(H.studentName),1),e("p",wt,"Student ID: "+v(H.studentId),1),k.value?(n(),r("p",_t,"Uploading image...")):_("",!0)])])]),e("div",kt,[o[18]||(o[18]=e("h4",{class:"font-medium text-gray-800 mb-4"},"Upload New Image",-1)),e("div",Ct,[e("div",$t,[e("input",{type:"file",ref_key:"fileInput",ref:G,accept:"image/*",onChange:Ie,class:"hidden"},null,544),e("button",{type:"button",onClick:ve,disabled:k.value,class:"flex-1 px-4 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 flex items-center justify-center space-x-2 transition-colors"},o[13]||(o[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),e("span",null,"Choose File",-1)]),8,jt),e("div",It,[e("button",{type:"button",onClick:$e,disabled:k.value,class:"w-full px-4 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 flex items-center justify-center space-x-2 transition-colors"},o[14]||(o[14]=[ne('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ae34969f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" data-v-ae34969f></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" data-v-ae34969f></path></svg><span data-v-ae34969f>Take Photo</span><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ae34969f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-v-ae34969f></path></svg>',3)]),8,Mt),S.value?(n(),r("div",St,[e("button",{type:"button",onClick:o[2]||(o[2]=M=>a("user")),class:"w-full px-4 py-3 text-left text-gray-700 hover:bg-gray-50 flex items-center space-x-3 border-b border-gray-100"},o[15]||(o[15]=[ne('<div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center" data-v-ae34969f><svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ae34969f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" data-v-ae34969f></path></svg></div><div class="text-left" data-v-ae34969f><p class="font-medium" data-v-ae34969f>Front Camera</p><p class="text-xs text-gray-500" data-v-ae34969f>Take a selfie</p></div>',2)])),e("button",{type:"button",onClick:o[3]||(o[3]=M=>a("environment")),class:"w-full px-4 py-3 text-left text-gray-700 hover:bg-gray-50 flex items-center space-x-3"},o[16]||(o[16]=[ne('<div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center" data-v-ae34969f><svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ae34969f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" data-v-ae34969f></path></svg></div><div class="text-left" data-v-ae34969f><p class="font-medium" data-v-ae34969f>Rear Camera</p><p class="text-xs text-gray-500" data-v-ae34969f>Take a photo</p></div>',2)]))])):_("",!0)])]),p.value||y.value?(n(),r("div",Ut,[e("div",Rt,[e("div",Bt,[e("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center cursor-pointer",onClick:o[4]||(o[4]=M=>te(j.value))},[j.value?(n(),r("img",{key:0,src:j.value,alt:"Preview",class:"w-full h-full object-cover rounded-lg"},null,8,Et)):(n(),r("div",Dt,v(K.value),1))]),e("div",null,[e("p",zt,v(D.value==="camera"?"Camera Photo":(g=p.value)==null?void 0:g.name),1),e("p",Nt,v(D.value==="camera"?`Captured from ${i.value==="user"?"Front":"Rear"} Camera â€¢ ${le(F.value)}`:`Size: ${p.value?le(p.value.size):"0 KB"}`),1),e("p",Ft," Dimensions: "+v(L.value.width)+" Ã— "+v(L.value.height)+"px ",1)])]),e("div",Pt,[e("button",{type:"button",onClick:o[5]||(o[5]=M=>C.value=!0),class:"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"}," Compress "),e("button",{type:"button",onClick:o[6]||(o[6]=M=>D.value==="camera"?a(i.value):ve()),class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors"}," Change ")])])])):_("",!0),C.value&&(p.value||I.value)?(n(),we(dt,{key:1,"image-blob":p.value||I.value,"image-url":j.value,"auto-compress":!0,onCompressed:X,onCancel:o[7]||(o[7]=M=>C.value=!1),onError:s},null,8,["image-blob","image-url"])):_("",!0),p.value||y.value?(n(),r("div",Vt,[e("button",{type:"button",onClick:Ee,disabled:k.value,class:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transition-colors font-medium"},[k.value?(n(),r("svg",Gt,o[17]||(o[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):_("",!0),e("span",null,v(k.value?"Uploading...":"Update Profile Image"),1)],8,Lt),e("button",{type:"button",onClick:De,class:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium"}," Cancel ")])):_("",!0)])]),O.value?(n(),r("div",At,[e("div",Ot,[e("div",{class:"flex justify-between items-center p-4 border-b border-gray-200"},[o[20]||(o[20]=e("h3",{class:"text-lg font-semibold text-gray-800"},"Image Preview",-1)),e("button",{onClick:ie,class:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},o[19]||(o[19]=[e("svg",{class:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Ht,[e("img",{src:T.value,alt:"Preview",class:"max-w-full max-h-full object-contain"},null,8,qt)]),o[21]||(o[21]=e("div",{class:"p-4 border-t border-gray-200 text-center"},[e("p",{class:"text-sm text-gray-600"}," Click anywhere outside to close ")],-1))])])):_("",!0),P.value?(n(),r("video",{key:1,ref_key:"videoEl",ref:A,autoplay:"",playsinline:"",muted:"",class:"hidden"},null,512)):_("",!0),P.value&&!R.value?(n(),r("div",Wt,[e("div",Tt,[e("div",Jt,[o[24]||(o[24]=e("h3",{class:"text-xl font-semibold text-gray-800"},"Take Photo",-1)),e("div",Kt,[J.value?(n(),r("button",{key:0,type:"button",onClick:x,class:"p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Switch Camera"},o[22]||(o[22]=[e("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]))):_("",!0),e("button",{type:"button",onClick:ae,class:"p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Close Camera"},o[23]||(o[23]=[e("svg",{class:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),e("div",Qt,[e("video",{ref_key:"videoEl",ref:A,autoplay:"",playsinline:"",muted:"",class:"w-full h-80 object-cover"},null,512),e("div",{class:"absolute bottom-6 left-1/2 transform -translate-x-1/2"},[e("button",{type:"button",onClick:Me,class:"w-20 h-20 bg-white rounded-full shadow-2xl flex items-center justify-center hover:bg-gray-100 transition-colors"},o[25]||(o[25]=[e("div",{class:"w-16 h-16 bg-white border-4 border-gray-800 rounded-full flex items-center justify-center"},[e("div",{class:"w-12 h-12 bg-gray-800 rounded-full"})],-1)]))])]),e("div",Yt,[e("p",Xt,[o[26]||(o[26]=ue(" Using: ")),e("span",Zt,v(i.value==="user"?"Front Camera":"Rear Camera"),1)]),o[27]||(o[27]=e("p",{class:"text-xs text-gray-500 mt-1"},"Position the student's face in the frame and click the button to capture",-1))])])])):_("",!0),R.value?(n(),r("div",es,[e("div",ts,[e("h3",ss,v(D.value==="camera"?"Crop Your Photo":"Crop Uploaded Image"),1),e("div",os,[b.value?(n(),we(me(u),{key:0,ref_key:"cropper",ref:z,src:m.value,"aspect-ratio":1,"view-mode":2,guides:!0,background:!1,"auto-crop-area":.8,"min-container-width":200,"min-container-height":200,class:"cropper-container h-full w-full max-h-[50vh]"},null,8,["src"])):(n(),r("div",ls,o[28]||(o[28]=[e("div",{class:"text-center"},[e("div",{class:"spinner mx-auto mb-4"}),e("p",{class:"text-gray-600"},"Loading image editor...")],-1)])))]),e("div",as,[e("div",ns,[e("button",{type:"button",onClick:o[8]||(o[8]=M=>be(-90)),disabled:!b.value,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 flex items-center space-x-2 transition-colors",title:"Rotate Left"},o[29]||(o[29]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"font-medium"},"Rotate Left",-1)]),8,rs),e("button",{type:"button",onClick:o[9]||(o[9]=M=>be(90)),disabled:!b.value,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 flex items-center space-x-2 transition-colors",title:"Rotate Right"},o[30]||(o[30]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"font-medium"},"Rotate Right",-1)]),8,is),e("button",{type:"button",onClick:Se,disabled:!b.value,class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 flex items-center space-x-2 transition-colors",title:"Reset Crop"},o[31]||(o[31]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"font-medium"},"Reset",-1)]),8,ds)]),e("div",us,[e("button",{type:"button",onClick:Be,class:"px-8 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors"},v(D.value==="camera"?"Retake Photo":"Choose Different File"),1),e("button",{type:"button",onClick:Ue,disabled:!b.value,class:"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-300 font-medium transition-colors"}," Apply Crop ",8,ms)])])])])):_("",!0)])}}},gs=ce(cs,[["__scopeId","data-v-ae34969f"]]),ps={class:"min-h-screen bg-gray-50 p-4"},vs={class:"fixed top-4 right-4 z-50 space-y-2 w-full max-w-sm px-4 sm:px-0 sm:w-96"},bs={class:"flex items-start space-x-3"},fs={class:"flex-1"},xs={class:"text-green-700 text-sm mt-1"},ys={class:"flex items-start space-x-3"},hs={class:"flex-1"},ws={class:"text-red-700 text-sm mt-1"},_s={class:"mb-6"},ks={class:"text-xl sm:text-2xl font-bold text-gray-800"},Cs={class:"text-xs sm:text-sm text-gray-500 font-normal ml-2"},$s={key:0,class:"flex justify-center items-center py-8"},js={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Is={key:2,class:"bg-white rounded-lg shadow-sm p-4 sm:p-6"},Ms={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ss={class:"md:col-span-2 lg:col-span-3"},Us=["value"],Rs={class:"md:col-span-2 lg:col-span-3"},Bs=["value"],Es={class:"md:col-span-2 lg:col-span-3"},Ds={key:0,class:"text-gray-500 text-sm mt-2"},zs={class:"md:col-span-2 lg:col-span-3"},Ns={key:0,class:"text-red-600 text-xs mt-1"},Fs={key:1,class:"text-gray-500 text-xs mt-1"},Ps={class:"mt-8 pt-6 border-t flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0"},Vs={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto"},Ls=["disabled"],Gs={key:0},As={key:1},Os={class:"md:col-span-2 lg:col-span-3"},Hs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},qs=["disabled"],Ws=["disabled"],Ts=["disabled"],Js={class:"mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0"},Ks={key:0,class:"text-red-600 text-sm font-medium"},Qs={key:1,class:"text-gray-600 text-sm"},Ys=["disabled"],Xs={key:0},Zs={key:1},eo={class:"md:col-span-2 lg:col-span-3"},to={class:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6"},so={key:0,class:"flex justify-center py-4"},oo={key:1,class:"text-center py-8 text-gray-500"},lo={key:2,class:"space-y-4"},ao={class:"flex items-start justify-between"},no={class:"flex items-start space-x-3 flex-1"},ro={class:"flex-1 min-w-0"},io={class:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2 mb-1"},uo={class:"font-medium text-gray-800 text-lg truncate"},mo={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full self-start sm:self-auto"},co={key:0,class:"space-y-2 text-sm text-gray-600"},go={class:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-4"},po={class:"flex items-center space-x-1"},vo={class:"truncate"},bo={class:"flex items-center space-x-1"},fo={class:"truncate"},xo={key:0,class:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2 text-xs"},yo={key:0,class:"flex items-center space-x-1"},ho={class:"truncate"},wo={key:1,class:"hidden sm:inline text-gray-400"},_o={key:2,class:"flex items-center space-x-1"},ko={class:"truncate"},Co={key:1,class:"text-xs text-gray-500 flex items-center space-x-1"},$o={class:"truncate"},jo={key:1,class:"space-y-4 mt-4 p-4 bg-gray-50 rounded-lg"},Io={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Mo={class:"md:col-span-2"},So={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 pt-4"},Uo=["onClick","disabled"],Ro={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bo=["onClick"],Eo={__name:"EditStudent",setup(H){const q=Ge(),u=de({student:"",student_name:"",date_of_birth:"",group_roll_number:"",student_email_id:"",student_mobile_number:"",address:"",img_url:""}),b=c(""),U=c(""),h=c(!1),f=c(""),k=c(""),p=c(""),y=c(""),I=c(""),j=c(""),P=c([]),R=c(null),S=c(!1),O=c(!1),C=de({guardian_name:"",phone_number:"",relation:"Mother"}),m=de({guardian_name:"",mobile_number:"",relation:"Mother",date_of_birth:"",email:"",occupation:"",designation:"",work_address:"",education:""}),T=oe(()=>{const s=j.value||u.img_url||"";return s?(console.log("ðŸ–¼ï¸ Using image URL:",s),D(s)):(console.log("âŒ No image URL available from any source"),"")});ge(()=>{if(b.value=q.query.studentId,q.query.studentData)try{const s=JSON.parse(decodeURIComponent(q.query.studentData));U.value=s.student_group||"",j.value=s.student_image||s.img_url||"",console.log("ðŸŽ¯ COMPLETE Route data analysis:",{studentGroup:U.value,hasStudentImage:!!s.student_image,studentImageValue:s.student_image,hasImgUrl:!!s.img_url,imgUrlValue:s.img_url,hasAddress:!!s.address,addressValue:s.address,hasMobile:!!s.mobile,mobileValue:s.mobile,allKeys:Object.keys(s),allValues:s}),s.student_name&&(u.student_name=s.student_name),s.group_roll_number&&(u.group_roll_number=s.group_roll_number),s.address&&(console.log("ðŸ  Setting address from route data:",s.address),u.address=s.address),s.mobile&&(console.log("ðŸ“± Setting mobile from route data:",s.mobile),u.student_mobile_number=s.mobile)}catch(s){console.error("Error parsing student data:",s),d("Invalid student data")}X()});const D=s=>s?s.startsWith("http")||s.startsWith("//")?s:s.startsWith("/")?window.location.origin+s:`${window.location.origin}/${s.replace(/^\//,"")}`:null,d=s=>{k.value=s,p.value="",y.value="animate-slide-in-right"},i=s=>{p.value=s,k.value="",y.value="animate-slide-in-right"},w=()=>{y.value="animate-slide-out-right",setTimeout(()=>{k.value="",p.value="",y.value=""},300)},J=s=>{console.log("ðŸ“¸ Image updated in StudentProfileImage:",s),j.value=s},V=se({url:"school.al_ummah.api2.get_student_details",auto:!1,onSuccess(s){s.student_info&&(Object.assign(u,{student:s.student_info.student||s.student_info.name||"",student_name:s.student_info.student_name||"",date_of_birth:s.student_info.date_of_birth||s.student_info.student_date_of_birth||"",group_roll_number:s.student_info.group_roll_number||s.student_info.roll_number||"",student_email_id:s.student_info.student_email_id||s.student_info.email_address||"",student_mobile_number:s.student_info.student_mobile_number||s.student_info.phone_number||"",address:s.student_info.address||"",img_url:s.student_info.img_url||s.student_info.image||""}),!u.address&&s.address&&(u.address=s.address),!u.student_mobile_number&&s.mobile&&(u.student_mobile_number=s.mobile)),s.guardians&&Array.isArray(s.guardians)&&(P.value=s.guardians),I.value=""},onError(){I.value="Failed to load student details.",P.value=[]}}),F=se({url:"school.al_ummah.api2.update_student_details",auto:!1,onSuccess(s){h.value=!1,i(s.message||"Student updated successfully!")},onError(s){var a,x;h.value=!1;const t=s._server_messages?(x=JSON.parse(((a=JSON.parse(s._server_messages.at(-1)))==null?void 0:a.message)||"{}"))==null?void 0:x.message:s.message;d(t||"Update failed.")}}),L=se({url:"school.al_ummah.api2.add_guardian_to_student",auto:!1,onSuccess(s){O.value=!1,i(s.message||"Guardian added!"),X(),K()},onError(s){var a,x;O.value=!1;const t=s._server_messages?(x=JSON.parse(((a=JSON.parse(s._server_messages.at(-1)))==null?void 0:a.message)||"{}"))==null?void 0:x.message:s.message;d(t||"Failed to add guardian.")}}),G=se({url:"school.al_ummah.api2.update_guardian_details",auto:!1,onSuccess(s){S.value=!1,i(s.message||"Guardian updated!"),R.value=null,Q(),X()},onError(s){var a,x;S.value=!1;const t=s._server_messages?(x=JSON.parse(((a=JSON.parse(s._server_messages.at(-1)))==null?void 0:a.message)||"{}"))==null?void 0:x.message:s.message;d(t||"Failed to update guardian.")}}),A=s=>/^[0-9]{10}$/.test(s),z=s=>{[".",",","e","E","-"].includes(s.key)&&s.preventDefault()},N=()=>{const s=u.group_roll_number;if(!s&&s!==0)return f.value="";const t=Number(s);if(!Number.isInteger(t))return f.value="Must be a whole number";if(t<1)return f.value="Must be at least 1";if(t>999)return f.value="Cannot exceed 999";f.value=""},K=()=>{C.guardian_name="",C.phone_number="",C.relation="Mother"},Q=()=>{Object.keys(m).forEach(s=>{m[s]=""}),m.relation="Mother"},le=()=>B(this,null,function*(){if(!C.guardian_name.trim())return d("Guardian name required");if(!A(C.phone_number))return d("Valid 10-digit phone required");O.value=!0,L.fetch({student_id:b.value,student_name:u.student_name,guardian_name:C.guardian_name,relation:C.relation,phone_number:C.phone_number})}),Z=s=>{R.value=s.guardian,Object.assign(m,{guardian_name:s.guardian_name||"",mobile_number:s.mobile_number||"",relation:s.relation||"Mother",date_of_birth:s.date_of_birth||"",email:s.email||"",occupation:s.occupation||"",designation:s.designation||"",work_address:s.work_address||"",education:s.education||""})},ee=()=>{R.value=null,Q()},te=s=>{if(!m.guardian_name.trim())return d("Guardian name required");if(!A(m.mobile_number))return d("Valid 10-digit phone required");S.value=!0,G.fetch({guardian_id:s,guardian_name:m.guardian_name,phone_number:m.mobile_number,relation:m.relation,guardian_date_of_birth:m.date_of_birth,guardian_email:m.email,occupation:m.occupation,designation:m.designation,work_address:m.work_address,education:m.education})},ie=s=>B(this,null,function*(){if(s&&(s.preventDefault(),s.stopPropagation()),N(),f.value){d(f.value);return}h.value=!0;const t={student_id:b.value,student_group:U.value,student_name:u.student_name||"",date_of_birth:u.date_of_birth||"",group_roll_number:u.group_roll_number||"",student_email_id:u.student_email_id||"",student_mobile_number:u.student_mobile_number||"",address:u.address||""};console.log("Sending update data:",t),yield F.fetch(t)}),X=()=>{b.value&&V.fetch({student:b.value})};return(s,t)=>(n(),r("div",ps,[e("div",vs,[p.value?(n(),r("div",{key:0,class:W(["bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",y.value])},[e("div",bs,[t[23]||(t[23]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",fs,[t[22]||(t[22]=e("p",{class:"text-green-800 font-medium"},"Success",-1)),e("p",xs,v(p.value),1)])]),e("div",{class:"mt-4 flex justify-end"},[e("button",{type:"button",onClick:w,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm font-medium"}," OK ")])],2)):_("",!0),k.value?(n(),r("div",{key:1,class:W(["bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg transform transition-all duration-300 ease-in-out",y.value])},[e("div",ys,[t[25]||(t[25]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",hs,[t[24]||(t[24]=e("p",{class:"text-red-800 font-medium"},"Error",-1)),e("p",ws,v(k.value),1)])]),e("div",{class:"mt-4 flex justify-end"},[e("button",{type:"button",onClick:w,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium"}," OK ")])],2)):_("",!0)]),e("div",_s,[e("h1",ks,[ue(" Edit Student: "+v(u.student_name||b.value)+" ",1),e("span",Cs,"(ID: "+v(b.value)+")",1)])]),me(V).loading?(n(),r("div",$s,t[26]||(t[26]=[e("div",{class:"spinner"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Loading student details...",-1)]))):I.value?(n(),r("div",js,[t[27]||(t[27]=e("p",{class:"text-red-800"},"Failed to load student details.",-1)),e("button",{type:"button",onClick:X,class:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm"}," Retry ")])):(n(),r("div",Is,[e("form",{onSubmit:Le(ie,["prevent"])},[e("div",Ms,[e("div",Ss,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student ID",-1)),e("input",{value:b.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Us),t[29]||(t[29]=e("p",{class:"text-xs text-gray-500 mt-1"},"Student ID cannot be changed",-1))]),e("div",Rs,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Group",-1)),e("input",{value:U.value,type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500"},null,8,Bs),t[31]||(t[31]=e("p",{class:"text-xs text-gray-500 mt-1"},"Student group cannot be changed",-1))]),t[39]||(t[39]=e("div",{class:"md:col-span-2 lg:col-span-3"},[e("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Personal Details")],-1)),e("div",Es,[Ve(gs,{"student-id":b.value,"current-image":T.value,"student-name":u.student_name,onImageUpdated:J,onSuccess:t[0]||(t[0]=a=>i(a)),onError:t[1]||(t[1]=a=>d(a))},null,8,["student-id","current-image","student-name"]),T.value?_("",!0):(n(),r("p",Ds," No profile image available. Click above to upload one. "))]),e("div",zs,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Student Name",-1)),$(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>u.student_name=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full student name"},null,512),[[E,u.student_name]])]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date of Birth",-1)),$(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>u.date_of_birth=a),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,u.date_of_birth]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"GR Number",-1)),$(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>u.student=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,u.student]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Roll Number ",-1)),$(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>u.group_roll_number=a),type:"number",min:"1",max:"999",step:"1",placeholder:"Enter roll number",onKeypress:z,onInput:N,class:W(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",f.value?"border-red-300 bg-red-50":"border-gray-300"])},null,34),[[E,u.group_roll_number]]),f.value?(n(),r("p",Ns,v(f.value),1)):(n(),r("p",Fs,"Must be a whole number between 1-999 (optional)"))]),t[40]||(t[40]=e("div",{class:"md:col-span-2 lg:col-span-3 mt-4"},[e("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},"Contact Information")],-1)),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address",-1)),$(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.student_email_id=a),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,u.student_email_id]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),$(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>u.student_mobile_number=a),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,u.student_mobile_number]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Address",-1)),$(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>u.address=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Address line 1"},null,512),[[E,u.address]])])]),e("div",Ps,[e("div",Vs,[e("button",{type:"button",class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",onClick:t[9]||(t[9]=a=>s.$router.back())}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:h.value},[h.value?(n(),r("span",Gs,"Updating...")):(n(),r("span",As,"Update Student"))],8,Ls)])]),t[68]||(t[68]=e("div",{class:"md:col-span-2 lg:col-span-3 mt-8"},[e("h3",{class:"text-lg font-medium text-gray-800 mb-4 border-b pb-2"},[ue(" Guardian Management "),e("span",{class:"text-sm text-blue-600 font-normal ml-2"},"(Manage multiple guardians)")])],-1)),e("div",Os,[e("div",{class:W(["bg-gray-50 rounded-lg p-4 sm:p-6 border-2 border-dashed mb-6 transition-all",s.isGuardianLimitReached?"border-gray-300 opacity-50":"border-blue-200 hover:border-blue-300"])},[t[45]||(t[45]=e("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Add New Guardian",-1)),e("div",Hs,[e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),$(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>C.guardian_name=a),type:"text",placeholder:"Enter guardian name",disabled:s.isGuardianLimitReached,class:W(["w-full px-3 py-2 border rounded-md",s.isGuardianLimitReached?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,qs),[[E,C.guardian_name]])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),$(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>C.phone_number=a),type:"tel",placeholder:"10-digit number",disabled:s.isGuardianLimitReached,class:W(["w-full px-3 py-2 border rounded-md",s.isGuardianLimitReached?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},null,10,Ws),[[E,C.phone_number]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),$(e("select",{"onUpdate:modelValue":t[12]||(t[12]=a=>C.relation=a),disabled:s.isGuardianLimitReached,class:W(["w-full px-3 py-2 border rounded-md",s.isGuardianLimitReached?"border-gray-200 bg-gray-100 text-gray-500":"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"])},t[43]||(t[43]=[e("option",{value:"Mother"},"Mother",-1),e("option",{value:"Father"},"Father",-1),e("option",{value:"Others"},"Others",-1)]),10,Ts),[[re,C.relation]])])]),e("div",Js,[e("div",null,[s.isGuardianLimitReached?(n(),r("p",Ks," âŒ Maximum of 3 guardians reached ")):(n(),r("p",Qs," Guardians added: "+v(P.value.length)+"/3 ",1))]),e("button",{type:"button",onClick:le,disabled:s.isGuardianLimitReached||O.value,class:W(["px-4 py-2 rounded-md flex items-center space-x-2 transition-colors w-full sm:w-auto justify-center",s.isGuardianLimitReached||O.value?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[O.value?(n(),r("span",Xs,"Adding...")):(n(),r("span",Zs,"Add Guardian"))],10,Ys)])],2)]),e("div",eo,[e("div",to,[t[67]||(t[67]=e("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"Existing Guardians",-1)),me(V).loading?(n(),r("div",so,t[46]||(t[46]=[e("div",{class:"spinner-small"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Loading guardians...",-1)]))):P.value.length===0?(n(),r("div",oo,t[47]||(t[47]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1),e("p",null,"No guardians added yet.",-1)]))):(n(),r("div",lo,[(n(!0),r(ke,null,Ce(P.value,a=>(n(),r("div",{key:a.guardian,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[e("div",ao,[e("div",no,[t[65]||(t[65]=e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),e("div",ro,[e("div",io,[e("h5",uo,v(a.guardian_name),1),e("span",mo,v(a.relation),1)]),R.value!==a.guardian?(n(),r("div",co,[e("div",go,[e("span",po,[t[48]||(t[48]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e("span",vo,v(a.mobile_number||"No phone"),1)]),t[50]||(t[50]=e("span",{class:"hidden sm:inline text-gray-400"},"â€¢",-1)),e("span",bo,[t[49]||(t[49]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})],-1)),e("span",fo,v(a.email||"No email"),1)])]),a.occupation||a.designation?(n(),r("div",xo,[a.occupation?(n(),r("span",yo,[t[51]||(t[51]=e("span",null,"ðŸ’¼",-1)),e("span",ho,v(a.occupation),1)])):_("",!0),a.occupation&&a.designation?(n(),r("span",wo,"â€¢")):_("",!0),a.designation?(n(),r("span",_o,[t[52]||(t[52]=e("span",null,"ðŸŽ¯",-1)),e("span",ko,v(a.designation),1)])):_("",!0)])):_("",!0),a.education?(n(),r("div",Co,[t[53]||(t[53]=e("span",null,"ðŸŽ“",-1)),e("span",$o,v(a.education),1)])):_("",!0)])):_("",!0),R.value===a.guardian?(n(),r("div",jo,[e("div",Io,[e("div",null,[t[54]||(t[54]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Guardian Name",-1)),$(e("input",{"onUpdate:modelValue":t[13]||(t[13]=x=>m.guardian_name=x),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.guardian_name]])]),e("div",null,[t[55]||(t[55]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),$(e("input",{"onUpdate:modelValue":t[14]||(t[14]=x=>m.mobile_number=x),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.mobile_number]])]),e("div",null,[t[57]||(t[57]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Relation",-1)),$(e("select",{"onUpdate:modelValue":t[15]||(t[15]=x=>m.relation=x),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t[56]||(t[56]=[e("option",{value:"Mother"},"Mother",-1),e("option",{value:"Father"},"Father",-1),e("option",{value:"Others"},"Others",-1)]),512),[[re,m.relation]])]),e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date of Birth",-1)),$(e("input",{"onUpdate:modelValue":t[16]||(t[16]=x=>m.date_of_birth=x),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.date_of_birth]])]),e("div",null,[t[59]||(t[59]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),$(e("input",{"onUpdate:modelValue":t[17]||(t[17]=x=>m.email=x),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.email]])]),e("div",null,[t[60]||(t[60]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Occupation",-1)),$(e("input",{"onUpdate:modelValue":t[18]||(t[18]=x=>m.occupation=x),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.occupation]])]),e("div",null,[t[61]||(t[61]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Designation",-1)),$(e("input",{"onUpdate:modelValue":t[19]||(t[19]=x=>m.designation=x),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.designation]])]),e("div",Mo,[t[62]||(t[62]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Work Address",-1)),$(e("textarea",{"onUpdate:modelValue":t[20]||(t[20]=x=>m.work_address=x),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.work_address]])]),e("div",null,[t[63]||(t[63]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Education",-1)),$(e("input",{"onUpdate:modelValue":t[21]||(t[21]=x=>m.education=x),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,m.education]])])]),e("div",So,[e("button",{type:"button",onClick:x=>te(a.guardian),disabled:S.value,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 flex items-center space-x-2 justify-center"},[S.value?(n(),r("svg",Ro,t[64]||(t[64]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):_("",!0),e("span",null,v(S.value?"Updating...":"Update Guardian"),1)],8,Uo),e("button",{type:"button",onClick:ee,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])):_("",!0)])]),R.value!==a.guardian?(n(),r("button",{key:0,type:"button",onClick:x=>Z(a),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors flex-shrink-0",title:"Edit guardian details"},t[66]||(t[66]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Bo)):_("",!0)])]))),128))]))])]),t[69]||(t[69]=e("div",{class:"text-sm text-gray-600 mt-4"},null,-1))],32)]))]))}},No=ce(Eo,[["__scopeId","data-v-bb860370"]]);export{No as default};
