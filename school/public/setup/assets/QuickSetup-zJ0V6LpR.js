var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var G=(t,e,o)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,A=(t,e)=>{for(var o in e||(e={}))ie.call(e,o)&&G(t,o,e[o]);if(B)for(var o of B(e))oe.call(e,o)&&G(t,o,e[o]);return t},Y=(t,e)=>te(t,se(e));var R=(t,e,o)=>new Promise((n,u)=>{var a=r=>{try{l(o.next(r))}catch(f){u(f)}},s=r=>{try{l(o.throw(r))}catch(f){u(f)}},l=r=>r.done?n(r.value):Promise.resolve(r.value).then(a,s);l((o=o.apply(t,e)).next())});import{_ as j,o as d,c as m,b as i,f as b,v as h,g as F,F as g,h as x,t as v,i as T,r as y,j as I,k as $,l as _,n as O,m as U,p as W,q as ae,e as ne,x as re,d as le,a as de}from"./index-YpdTZEFl.js";const me={props:{values:Object},computed:{email:{get(){return this.values.email},set(t){this.$emit("update-field",{field:"email",value:t})}},googleAppPassword:{get(){return this.values.googleAppPassword},set(t){this.$emit("update-field",{field:"googleAppPassword",value:t})}}},methods:{updateField(t,e){this.$emit("update-field",{field:t,value:e})}}},ue={class:"card"},ce={class:"field"},pe={class:"field"};function ve(t,e,o,n,u,a){return d(),m("div",ue,[i("div",ce,[e[5]||(e[5]=i("label",null,"Email Address",-1)),b(i("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=s=>a.email=s),placeholder:"Enter your email address",onInput:e[1]||(e[1]=s=>a.updateField("email",s.target.value))},null,544),[[h,a.email]])]),i("div",pe,[e[6]||(e[6]=i("label",null,"Google App Password",-1)),b(i("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=s=>a.googleAppPassword=s),placeholder:"Enter your Google app password",onInput:e[3]||(e[3]=s=>a.updateField("googleAppPassword",s.target.value))},null,544),[[h,a.googleAppPassword]])]),i("button",{onClick:e[4]||(e[4]=s=>t.$emit("submit-email"))},"Submit Email Account")])}const fe=j(me,[["render",ve],["__scopeId","data-v-a1f91314"]]),be={props:{values:Object},data(){return{selectedTerm:"",lastValidTermCount:0}},computed:{academicYear:{get(){return this.values.academicYear},set(t){this.$emit("update-field",{field:"academicYear",value:t})}},academicYearStart:{get(){return this.values.academicYearStart},set(t){this.$emit("update-field",{field:"academicYearStart",value:t})}},academicYearEnd:{get(){return this.values.academicYearEnd},set(t){this.$emit("update-field",{field:"academicYearEnd",value:t})}},numberOfTerms:{get(){return this.values.numberOfTerms},set(t){this.$emit("update-field",{field:"numberOfTerms",value:t})}}},methods:{handleNumberOfTermsChange(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.adjustTermsToMatchCount()):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.adjustTermsToMatchCount()},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.adjustTermsToMatchCount())},adjustTermsToMatchCount(){const t=this.values.terms.length,e=this.numberOfTerms;if(e>t){const o=e-t,n=[...this.values.terms];for(let u=0;u<o;u++){const a=t+u+1,{startDate:s,endDate:l}=this.calculateTermDates(a,e);n.push({name:`Term ${a}`,startDate:s,endDate:l})}this.$emit("update-field-array",{field:"terms",value:n})}else if(e<t){const o=t-e,n=[...this.values.terms];n.splice(-o,o),this.$emit("update-field-array",{field:"terms",value:n})}},calculateTermDates(t,e){if(!this.academicYearStart||!this.academicYearEnd)return{startDate:"",endDate:""};const o=new Date(this.academicYearStart),a=(new Date(this.academicYearEnd)-o)/e,s=new Date(o.getTime()+a*(t-1)),l=new Date(o.getTime()+a*t-1),r=f=>f.toISOString().split("T")[0];return{startDate:r(s),endDate:r(l)}},formatDate(t){if(!t)return"";const e={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,e)},updateField(t,e){this.$emit("update-field",{field:t,value:e})},updateTermField(t,e,o){this.$emit("update-field-array",{field:"terms",index:t,subField:e,value:o})},addTerm(){const t={name:"",startDate:"",endDate:""};this.$emit("update-field-array",{field:"terms",value:[...this.values.terms,t]}),this.numberOfTerms=this.values.terms.length},removeTerm(t){const e=[...this.values.terms];e.splice(t,1),this.$emit("update-field-array",{field:"terms",value:e}),this.numberOfTerms=e.length},handleTermsInput(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.$emit("auto-create-terms")):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.$emit("auto-create-terms")},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.$emit("auto-create-terms"))}},mounted(){this.lastValidTermCount=this.numberOfTerms||1}},he={class:"academic-year-form"},ge={class:"form-grid"},xe={class:"form-row"},Ce={class:"form-group full-width"},Se={class:"form-row date-range-row"},De={class:"form-group"},ye={class:"form-group"},Te={class:"form-row"},_e={class:"form-group full-width"},we={class:"number-input-group"},je={class:"number-input-buttons"},ke=["disabled"],Pe={class:"form-row"},Ae={class:"form-group full-width"},Ye=["value"],Oe={class:"terms-list"},Ee={class:"term-header"},Ne={class:"term-title"},Ue=["onClick"],Ie={class:"term-body"},Fe={class:"form-group"},Le=["onUpdate:modelValue","placeholder","onInput"],Ve={class:"form-row term-dates-row"},Me={class:"form-group"},Be=["onUpdate:modelValue","onInput"],Ge={class:"form-group"},Re=["onUpdate:modelValue","onInput"],We={class:"form-actions"};function $e(t,e,o,n,u,a){return d(),m("div",he,[e[23]||(e[23]=i("div",{class:"form-header"},[i("h3",{class:"form-title"},"Academic Year Setup"),i("p",{class:"form-subtitle"}," Provide details about the academic year, its duration, and terms. ")],-1)),i("div",ge,[i("div",xe,[i("div",Ce,[e[13]||(e[13]=i("label",{class:"form-label"},"Academic Year",-1)),b(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>a.academicYear=s),class:"form-input",placeholder:"e.g., 2023-2024",onInput:e[1]||(e[1]=s=>a.updateField("academicYear",s.target.value))},null,544),[[h,a.academicYear]])])]),i("div",Se,[i("div",De,[e[14]||(e[14]=i("label",{class:"form-label"},"Start Date",-1)),b(i("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>a.academicYearStart=s),class:"form-input",onInput:e[3]||(e[3]=s=>a.updateField("academicYearStart",s.target.value))},null,544),[[h,a.academicYearStart]])]),i("div",ye,[e[15]||(e[15]=i("label",{class:"form-label"},"End Date",-1)),b(i("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=s=>a.academicYearEnd=s),class:"form-input",onInput:e[5]||(e[5]=s=>a.updateField("academicYearEnd",s.target.value))},null,544),[[h,a.academicYearEnd]])])]),i("div",Te,[i("div",_e,[e[16]||(e[16]=i("label",{class:"form-label"},"Number of Terms",-1)),i("div",we,[b(i("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>a.numberOfTerms=s),class:"form-input number-input",placeholder:"e.g., 3",min:"1",onInput:e[7]||(e[7]=(...s)=>a.handleNumberOfTermsChange&&a.handleNumberOfTermsChange(...s))},null,544),[[h,a.numberOfTerms,void 0,{number:!0}]]),i("div",je,[i("button",{class:"number-input-btn minus-btn",onClick:e[8]||(e[8]=(...s)=>a.decrementTerms&&a.decrementTerms(...s)),disabled:a.numberOfTerms<=1}," − ",8,ke),i("button",{class:"number-input-btn plus-btn",onClick:e[9]||(e[9]=(...s)=>a.incrementTerms&&a.incrementTerms(...s))}," + ")])])])]),i("div",Pe,[i("div",Ae,[e[18]||(e[18]=i("label",{class:"form-label"},"Current Academic Term",-1)),b(i("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>u.selectedTerm=s),class:"form-select",onChange:e[11]||(e[11]=s=>a.updateField("selectedTerm",s.target.value))},[e[17]||(e[17]=i("option",{value:""},"-- Select a Term --",-1)),(d(!0),m(g,null,x(o.values.terms,(s,l)=>(d(),m("option",{key:l,value:s.name},v(s.name)+" ("+v(a.formatDate(s.startDate))+" - "+v(a.formatDate(s.endDate))+") ",9,Ye))),128))],544),[[F,u.selectedTerm]])])])]),i("div",Oe,[(d(!0),m(g,null,x(o.values.terms,(s,l)=>(d(),m("div",{key:l,class:"term-card"},[i("div",Ee,[i("h4",Ne,"Term "+v(l+1),1),i("button",{class:"btn-icon",onClick:r=>a.removeTerm(l),title:"Remove term"}," ✕ ",8,Ue)]),i("div",Ie,[i("div",Fe,[e[19]||(e[19]=i("label",{class:"form-label"},"Term Name",-1)),b(i("input",{type:"text","onUpdate:modelValue":r=>s.name=r,class:"form-input",placeholder:`e.g., Spring ${l+1}`,onInput:r=>a.updateTermField(l,"name",r.target.value)},null,40,Le),[[h,s.name]])]),i("div",Ve,[i("div",Me,[e[20]||(e[20]=i("label",{class:"form-label"},"Start Date",-1)),b(i("input",{type:"date","onUpdate:modelValue":r=>s.startDate=r,class:"form-input",onInput:r=>a.updateTermField(l,"startDate",r.target.value)},null,40,Be),[[h,s.startDate]])]),i("div",Ge,[e[21]||(e[21]=i("label",{class:"form-label"},"End Date",-1)),b(i("input",{type:"date","onUpdate:modelValue":r=>s.endDate=r,class:"form-input",onInput:r=>a.updateTermField(l,"endDate",r.target.value)},null,40,Re),[[h,s.endDate]])])])])]))),128))]),i("div",We,[i("button",{class:"btn btn-primary",onClick:e[12]||(e[12]=(...s)=>a.addTerm&&a.addTerm(...s))},e[22]||(e[22]=[i("span",{class:"icon"},"+",-1),T(" Add Term ")]))])])}const Ke=j(be,[["render",$e],["__scopeId","data-v-401732b4"]]),qe={props:{values:Object,previousDataList:Array},emits:["update-field","use-previous-data"],setup(t,{emit:e}){const o=y(null),n=y(t.values.dontCreateClasses||!1),u=y(!1),a=y(""),s=I({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:f=>{console.log("Previous data loaded successfully")},onError:f=>{console.error("Error fetching previous data:",f)}}),l=()=>{if(!o.value){console.warn("No data selected");return}e("use-previous-data",o.value),a.value=o.value.academicYear,u.value=!0,setTimeout(()=>{u.value=!1},5e3)},r=()=>{e("update-field",{field:"dontCreateClasses",value:n.value})};return $(()=>{(!t.previousDataList||t.previousDataList.length===0)&&s.reload()}),{selectedPreviousData:o,dontCreateClasses:n,showSuccessMessage:u,usedPreviousYear:a,previousDataResource:s,handleUsePreviousData:l,updateDontCreateClasses:r}}},Qe={class:"card"},ze={key:0,class:"loading"},Je={key:1},He={key:0,class:"success-message"},Xe={class:"field"},Ze=["value"],et=["disabled"];function tt(t,e,o,n,u,a){return d(),m("div",Qe,[e[3]||(e[3]=i("h3",{class:"section-title"},"Use Previous Data",-1)),n.previousDataResource.loading?(d(),m("div",ze,"Loading previous data...")):(d(),m("div",Je,[n.showSuccessMessage?(d(),m("div",He," ✓ Previous data from "+v(n.usedPreviousYear)+" has been successfully loaded ",1)):_("",!0),i("div",Xe,[b(i("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.selectedPreviousData=s)},[e[2]||(e[2]=i("option",{value:null},"Select a year",-1)),(d(!0),m(g,null,x(o.previousDataList,(s,l)=>(d(),m("option",{key:l,value:s},v(s.academicYear),9,Ze))),128))],512),[[F,n.selectedPreviousData]])]),i("button",{onClick:e[1]||(e[1]=(...s)=>n.handleUsePreviousData&&n.handleUsePreviousData(...s)),disabled:!n.selectedPreviousData}," Use Previous Data ",8,et)]))])}const st=j(qe,[["render",tt],["__scopeId","data-v-b5328e59"]]),it=[{id:1,name:"Pre-K"},{id:2,name:"Kindergarten"},{id:3,name:"1st Grade"},{id:4,name:"2nd Grade"},{id:5,name:"3rd Grade"},{id:6,name:"4th Grade"},{id:7,name:"5th Grade"},{id:8,name:"6th Grade"},{id:9,name:"7th Grade"},{id:10,name:"8th Grade"},{id:11,name:"9th Grade"},{id:12,name:"10th Grade"},{id:13,name:"11th Grade"},{id:14,name:"12th Grade"},{id:15,name:"Other"}],ot={school:["Nursery","Jr KG","Sr KG","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th"],college:["FY BSc","SY BSc","TY BSc","FY BCA","SY BCA","TY BCA","FY BTech","SY BTech","TY BTech","Final Year BTech","FY BCom","SY BCom","TY BCom","MBA"]},at={props:{values:Object},data(){return{selectedInstitution:"",editablePrograms:[],availablePrograms:it}},watch:{"values.classes":{immediate:!0,handler(t){t&&t.length>0&&(this.editablePrograms=[...t])}}},computed:{selectedPrograms(){return this.values.classes||[]}},methods:{isSelected(t){return this.selectedPrograms.some(e=>e.id===t.id)},toggleProgram(t){let e;this.isSelected(t)?e=this.selectedPrograms.filter(o=>o.id!==t.id):e=[...this.selectedPrograms,{id:t.id,className:t.name,subjects:[],divisions:[]}],this.updatePrograms(e)},handleEditProgram(t,e){const o=this.editablePrograms.map(n=>n.id===t?Y(A({},n),{className:e}):n);this.updatePrograms(o)},handleDeleteProgram(t){const e=this.editablePrograms.filter(o=>o.id!==t);this.updatePrograms(e)},handleAddProgram(){const t={id:Math.random().toString(),className:"",subjects:[],divisions:[]},e=[...this.editablePrograms,t];this.updatePrograms(e)},handleInstitutionChange(){const t=(ot[this.selectedInstitution]||[]).map(e=>({id:Math.random().toString(),className:e,subjects:[],divisions:[]}));this.updatePrograms(t)},updatePrograms(t){this.editablePrograms=t,this.$emit("update-field-array",{field:"classes",value:t})}}},nt={class:"program-selector-container"},rt={class:"institution-selector"},lt={key:0,class:"programs-list"},dt=["onUpdate:modelValue","onInput"],mt=["onClick"],ut={key:1,class:"quick-select"},ct={class:"program-grid"},pt=["onClick"];function vt(t,e,o,n,u,a){return d(),m("div",nt,[i("div",rt,[e[4]||(e[4]=i("label",{class:"form-label"},"Select Institution Type",-1)),b(i("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.selectedInstitution=s),class:"form-select",onChange:e[1]||(e[1]=(...s)=>a.handleInstitutionChange&&a.handleInstitutionChange(...s))},e[3]||(e[3]=[i("option",{value:""},"Select Institution",-1),i("option",{value:"school"},"School",-1),i("option",{value:"college"},"College",-1)]),544),[[F,u.selectedInstitution]])]),u.editablePrograms.length>0?(d(),m("div",lt,[e[6]||(e[6]=i("h3",{class:"section-title"},"Classes List",-1)),(d(!0),m(g,null,x(u.editablePrograms,s=>(d(),m("div",{key:s.id,class:"program-item"},[b(i("input",{type:"text","onUpdate:modelValue":l=>s.className=l,class:"program-input",onInput:l=>a.handleEditProgram(s.id,l.target.value)},null,40,dt),[[h,s.className]]),i("button",{class:"delete-btn",onClick:l=>a.handleDeleteProgram(s.id),title:"Remove class"},e[5]||(e[5]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[i("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]),8,mt)]))),128))])):_("",!0),u.selectedInstitution===""?(d(),m("div",ut,[e[7]||(e[7]=i("h3",{class:"section-title"},"Quick Select Programs",-1)),i("div",ct,[(d(!0),m(g,null,x(u.availablePrograms,s=>(d(),m("div",{key:s.id,class:O(["program-card",{selected:a.isSelected(s)}]),onClick:l=>a.toggleProgram(s)},v(s.name),11,pt))),128))])])):_("",!0),i("button",{class:"add-btn",onClick:e[2]||(e[2]=(...s)=>a.handleAddProgram&&a.handleAddProgram(...s))},e[8]||(e[8]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[i("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),i("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),T(" Add Class ")]))])}const ft=j(at,[["render",vt],["__scopeId","data-v-f6b17094"]]),bt={props:{values:Object},data(){return{newCommonSubject:"",newCommonDivision:"",commonSubjectsList:[],commonDivisionsList:[],classesWithText:[],commonSubjects:["Math","Social Studies","Science","English","History","Geography","Physics","Chemistry","Biology","Computer","Civics","Hindi","Marathi","Arabic","Play"],commonDivisions:["A","B","C","D","E","F"]}},created(){this.values.commonSubjects&&(this.commonSubjectsList=[...this.values.commonSubjects]),this.values.commonDivisions&&(this.commonDivisionsList=[...this.values.commonDivisions])},watch:{"values.classes":{immediate:!0,deep:!0,handler(t){this.classesWithText=t.map(e=>Y(A({},e),{subjectsText:"",divisionsText:"",specificSubjects:e.subjects?e.subjects.filter(o=>!this.commonSubjectsList.includes(o)):[],specificDivisions:e.divisions?e.divisions.filter(o=>{const n=o.divisionName.split("-").slice(1).join("-");return!this.commonDivisionsList.includes(n)}):[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}))}},commonSubjectsList:{handler(t){this.$emit("update-field",{field:"commonSubjects",value:t}),this.updateAllClassesWithCommonData()},deep:!0},commonDivisionsList:{handler(t){this.$emit("update-field",{field:"commonDivisions",value:t}),this.updateAllClassesWithCommonData()},deep:!0}},methods:{addCommonSubject(){this.newCommonSubject.trim()&&!this.commonSubjectsList.includes(this.newCommonSubject.trim())&&(this.commonSubjectsList.push(this.newCommonSubject.trim()),this.newCommonSubject="")},removeCommonSubject(t){this.commonSubjectsList.splice(t,1)},isCommonSubjectSelected(t){return this.commonSubjectsList.includes(t)},toggleCommonSubject(t){this.isCommonSubjectSelected(t)?this.removeCommonSubject(this.commonSubjectsList.indexOf(t)):(this.newCommonSubject=t,this.addCommonSubject())},addCommonDivision(){this.newCommonDivision.trim()&&!this.commonDivisionsList.includes(this.newCommonDivision.trim())&&(this.commonDivisionsList.push(this.newCommonDivision.trim()),this.newCommonDivision="")},removeCommonDivision(t){this.commonDivisionsList.splice(t,1)},isCommonDivisionSelected(t){return this.commonDivisionsList.includes(t)},toggleCommonDivision(t){this.isCommonDivisionSelected(t)?this.removeCommonDivision(this.commonDivisionsList.indexOf(t)):(this.newCommonDivision=t,this.addCommonDivision())},addSpecificSubject(t){if(this.classesWithText[t].subjectsText.trim()){const e=[...this.classesWithText];e[t].specificSubjects=[...e[t].specificSubjects,e[t].subjectsText.trim()],e[t].subjectsText="",this.emitUpdatedClasses(e)}},removeSpecificSubject(t,e){const o=[...this.classesWithText];o[t].specificSubjects.splice(e,1),this.emitUpdatedClasses(o)},addSpecificDivision(t){if(this.classesWithText[t].divisionsText.trim()){const e=[...this.classesWithText],o=e[t].className||"Class";e[t].specificDivisions=[...e[t].specificDivisions,{divisionName:`${o}-${e[t].divisionsText.trim()}`}],e[t].divisionsText="",this.emitUpdatedClasses(e)}},removeSpecificDivision(t,e){const o=[...this.classesWithText];o[t].specificDivisions.splice(e,1),this.emitUpdatedClasses(o)},updateClassName(t,e){const o=[...this.classesWithText],n=o[t].className;o[t].className=e,o[t].specificDivisions&&(o[t].specificDivisions=o[t].specificDivisions.map(u=>{const a=u.divisionName.replace(`${n}-`,"");return{divisionName:`${e}-${a}`}})),this.emitUpdatedClasses(o)},updateAllClassesWithCommonData(){const t=this.classesWithText.map(e=>Y(A({},e),{specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}));this.emitUpdatedClasses(t)},isCommonSubjectExcluded(t,e){var n;return((n=this.classesWithText[t].excludedCommonSubjects)==null?void 0:n.includes(e))||!1},toggleExcludeCommonSubject(t,e){const o=[...this.classesWithText];o[t].excludedCommonSubjects||(o[t].excludedCommonSubjects=[]);const n=o[t].excludedCommonSubjects.indexOf(e);n>=0?o[t].excludedCommonSubjects.splice(n,1):o[t].excludedCommonSubjects.push(e),this.emitUpdatedClasses(o)},isCommonDivisionExcluded(t,e){var n;return((n=this.classesWithText[t].excludedCommonDivisions)==null?void 0:n.includes(e))||!1},toggleExcludeCommonDivision(t,e){const o=[...this.classesWithText];o[t].excludedCommonDivisions||(o[t].excludedCommonDivisions=[]);const n=o[t].excludedCommonDivisions.indexOf(e);n>=0?o[t].excludedCommonDivisions.splice(n,1):o[t].excludedCommonDivisions.push(e),this.emitUpdatedClasses(o)},emitUpdatedClasses(t){this.$emit("update-field-array",{field:"classes",value:t.map(e=>({className:e.className,subjects:[...this.commonSubjectsList.filter(o=>{var n;return!((n=e.excludedCommonSubjects)!=null&&n.includes(o))}),...e.specificSubjects||[]],divisions:[...this.commonDivisionsList.filter(o=>{var n;return!((n=e.excludedCommonDivisions)!=null&&n.includes(o))}).map(o=>({divisionName:`${e.className}-${o}`})),...e.specificDivisions||[]],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[],specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[]}))})}}},ht={class:"bg-white shadow rounded-lg p-6 space-y-6"},gt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},xt=["onClick"],Ct={class:"quick-select mt-3"},St={class:"subject-grid grid grid-cols-3 gap-2"},Dt=["onClick"],yt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Tt=["onClick"],_t={class:"quick-select mt-3"},wt={class:"division-grid grid grid-cols-6 gap-2"},jt=["onClick"],kt={class:"overflow-x-auto"},Pt={class:"min-w-full text-sm text-left text-gray-700"},At={class:"px-4 py-2"},Yt={class:"px-4 py-2"},Ot=["onUpdate:modelValue","onInput"],Et={class:"px-4 py-2 w-[300px]"},Nt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Ut=["onClick"],It=["onClick"],Ft={class:"flex gap-2"},Lt=["onUpdate:modelValue","onKeydown"],Vt=["onClick"],Mt={class:"px-4 py-2"},Bt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Gt=["onClick"],Rt=["onClick"],Wt={class:"flex gap-2"},$t=["onUpdate:modelValue","onKeydown"],Kt=["onClick"];function qt(t,e,o,n,u,a){return d(),m("div",ht,[i("div",null,[e[7]||(e[7]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Subjects for All Classes",-1)),i("div",gt,[(d(!0),m(g,null,x(u.commonSubjectsList,(s,l)=>(d(),m("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm"},[T(v(s)+" ",1),i("button",{onClick:r=>a.removeCommonSubject(l),class:"ml-1.5 text-blue-500 hover:text-blue-700"}," × ",8,xt)]))),128)),b(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>u.newCommonSubject=s),onKeydown:e[1]||(e[1]=U((...s)=>a.addCommonSubject&&a.addCommonSubject(...s),["enter"])),onBlur:e[2]||(e[2]=(...s)=>a.addCommonSubject&&a.addCommonSubject(...s)),placeholder:"Add subjects...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[h,u.newCommonSubject]])]),i("div",Ct,[e[6]||(e[6]=i("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Subjects",-1)),i("div",St,[(d(!0),m(g,null,x(u.commonSubjects,s=>(d(),m("div",{key:s,class:O(["subject-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-blue-100 border-blue-300":a.isCommonSubjectSelected(s),"bg-gray-50 hover:bg-gray-100":!a.isCommonSubjectSelected(s)}]),onClick:l=>a.toggleCommonSubject(s)},v(s),11,Dt))),128))])])]),i("div",null,[e[9]||(e[9]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Divisions for All Classes",-1)),i("div",yt,[(d(!0),m(g,null,x(u.commonDivisionsList,(s,l)=>(d(),m("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm"},[T(v(s)+" ",1),i("button",{onClick:r=>a.removeCommonDivision(l),class:"ml-1.5 text-green-500 hover:text-green-700"}," × ",8,Tt)]))),128)),b(i("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>u.newCommonDivision=s),onKeydown:e[4]||(e[4]=U((...s)=>a.addCommonDivision&&a.addCommonDivision(...s),["enter"])),onBlur:e[5]||(e[5]=(...s)=>a.addCommonDivision&&a.addCommonDivision(...s)),placeholder:"Add divisions...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[h,u.newCommonDivision]])]),i("div",_t,[e[8]||(e[8]=i("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Divisions",-1)),i("div",wt,[(d(!0),m(g,null,x(u.commonDivisions,s=>(d(),m("div",{key:s,class:O(["division-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-green-100 border-green-300":a.isCommonDivisionSelected(s),"bg-gray-50 hover:bg-gray-100":!a.isCommonDivisionSelected(s)}]),onClick:l=>a.toggleCommonDivision(s)},v(s),11,jt))),128))])])]),e[11]||(e[11]=i("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-2"},"Classes Overview",-1)),i("div",kt,[i("table",Pt,[e[10]||(e[10]=i("thead",{class:"bg-gray-100"},[i("tr",null,[i("th",{class:"px-4 py-2 font-medium"},"#"),i("th",{class:"px-4 py-2 font-medium"},"Class Name / Programs"),i("th",{class:"px-4 py-2 font-medium"},"Subjects / Courses"),i("th",{class:"px-4 py-2 font-medium"},"Divisions / Student Groups")])],-1)),i("tbody",null,[(d(!0),m(g,null,x(u.classesWithText,(s,l)=>(d(),m("tr",{key:l,class:"border-t hover:bg-gray-50"},[i("td",At,v(l+1),1),i("td",Yt,[b(i("input",{type:"text","onUpdate:modelValue":r=>s.className=r,onInput:r=>a.updateClassName(l,r.target.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Ot),[[h,s.className]])]),i("td",Et,[i("div",Nt,[(d(!0),m(g,null,x(u.commonSubjectsList,(r,f)=>(d(),m("span",{key:"common-"+f,class:O(["inline-flex items-center px-2 py-1 rounded-full text-xs",a.isCommonSubjectExcluded(l,r)?"bg-red-100 text-red-600":"bg-blue-50 text-blue-600"])},[T(v(r)+" ",1),i("button",{onClick:W(w=>a.toggleExcludeCommonSubject(l,r),["stop"]),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"},v(a.isCommonSubjectExcluded(l,r)?"+":"×"),9,Ut)],2))),128)),(d(!0),m(g,null,x(s.specificSubjects,(r,f)=>(d(),m("span",{key:"specific-"+f,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs"},[T(v(r)+" ",1),i("button",{onClick:w=>a.removeSpecificSubject(l,f),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"}," × ",8,It)]))),128))]),i("div",Ft,[b(i("input",{type:"text","onUpdate:modelValue":r=>s.subjectsText=r,onKeydown:U(r=>a.addSpecificSubject(l),["enter"]),placeholder:"Add class-specific subject...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Lt),[[h,s.subjectsText]]),i("button",{onClick:r=>a.addSpecificSubject(l),class:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs"}," Add ",8,Vt)])]),i("td",Mt,[i("div",Bt,[(d(!0),m(g,null,x(u.commonDivisionsList,(r,f)=>(d(),m("span",{key:"common-"+f,class:O(["inline-flex items-center px-2 py-1 rounded-full text-xs",a.isCommonDivisionExcluded(l,r)?"bg-red-100 text-red-600 border border-red-300":"bg-green-50 text-green-600"])},[T(v(r)+" ",1),i("button",{onClick:W(w=>a.toggleExcludeCommonDivision(l,r),["stop"]),class:"ml-1 text-green-500 hover:text-green-700 text-xs"},v(a.isCommonDivisionExcluded(l,r)?"+":"×"),9,Gt)],2))),128)),(d(!0),m(g,null,x(s.specificDivisions,(r,f)=>(d(),m("span",{key:"specific-"+f,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800 text-xs"},[T(v(r.divisionName.split("-").slice(1).join("-"))+" ",1),i("button",{onClick:w=>a.removeSpecificDivision(l,f),class:"ml-1 text-green-500 hover:text-green-700 text-xs"}," × ",8,Rt)]))),128))]),i("div",Wt,[b(i("input",{type:"text","onUpdate:modelValue":r=>s.divisionsText=r,onKeydown:U(r=>a.addSpecificDivision(l),["enter"]),placeholder:"Add class-specific division...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,$t),[[h,s.divisionsText]]),i("button",{onClick:r=>a.addSpecificDivision(l),class:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-xs"}," Add ",8,Kt)])])]))),128))])])])])}const Qt=j(bt,[["render",qt],["__scopeId","data-v-9515f27e"]]),zt={components:{EmailAccountSetup:fe,AcademicYearTerms:Ke,UsePreviousData:st,ProgramSelection:ft,SubjectsDivisions:Qt},setup(){const t=y(0),e=y([]),o=y(!1),n=y(!1),u=y(!1),a=y(""),s=ae({email:"",googleAppPassword:"",academicYear:"",academicYearStart:"",academicYearEnd:"",numberOfTerms:"",terms:[],selectedTerm:"",classes:[],subjects:[],divisions:[],commonSubjects:[],commonDivisions:[],dontCreateClasses:!1}),l=y([{title:"Email Account Setup (Optional)",component:"EmailAccountSetup"},{title:"Academic Year & Terms",component:"AcademicYearTerms"},{title:"Use Previous Data",component:"UsePreviousData"},{title:"Select Institution Type & Classes",component:"ProgramSelection"},{title:"Subjects and Divisions",component:"SubjectsDivisions"}]),r=I({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:c=>{e.value=Array.isArray(c)?c.map(p=>Y(A({},p),{academicYear:p.json_data?JSON.parse(p.json_data).academicYear:""})):[]},onError:c=>{console.error("Error fetching previous data:",c),e.value=[]}}),f=I({url:"school.al_ummah.api3.create_email_account",params:{email_id:"",password:""},onSuccess:()=>{alert("Email account setup successfully!")},onError:c=>{console.error("Error setting up email account:",c),alert("Error setting up email account.")}}),w=I({url:"school.al_ummah.api3.quick_setup",params:{values:{}},onSuccess:()=>{u.value=!0,t.value++,o.value=!1,n.value=!0},onError:c=>{var p;u.value=!1,a.value=((p=c.messages)==null?void 0:p[0])||"An error occurred while submitting the form.",console.error("Submission error:",c),o.value=!1,n.value=!0}});function K({classNames:c}){const p=[...s.classes],C=p.reduce((D,k)=>Math.max(D,k.classIndex||0),0),S=c.map((D,k)=>({className:D,subjects:[],divisions:[{divisionName:""}],classIndex:C+k+1}));s.classes=[...p,...S]}function L(){r.reload()}function q({field:c,value:p}){s[c]=p}function Q({field:c,index:p,subField:C,value:S}){p!==void 0&&C?s[c][p][C]=S:p!==void 0?s[c][p]=S:s[c]=S}function z(){return R(this,null,function*(){const{email:c,googleAppPassword:p}=s;if(!c||!p){alert("Please provide both email and Google app password.");return}f.update({params:{email_id:c,password:p}}),f.submit()})}function J(){const c=parseInt(s.numberOfTerms,10),p=new Date(s.academicYearStart),C=new Date(s.academicYearEnd);if(!c||c<=0){alert("Please enter a valid number of terms.");return}if(isNaN(p.getTime())){alert("Please enter valid 'From' date.");return}if(isNaN(C.getTime())){alert("Please enter valid 'To' date.");return}if(p>=C){alert("'From' date must be before 'To' date.");return}const S=Math.ceil((C-p)/(1e3*60*60*24)),D=Math.floor(S/c),k=[];let P=new Date(p);for(let E=0;E<c;E++){const N=new Date(P);N.setDate(P.getDate()+D-1),E===c-1&&N.setTime(C.getTime()),k.push({name:`Term ${E+1}`,startDate:P.toISOString().split("T")[0],endDate:N.toISOString().split("T")[0]}),P=new Date(N),P.setDate(P.getDate()+1)}s.terms=k}function H(c){if(!(c!=null&&c.json_data)){console.error("Invalid or missing previous data");return}try{const p=JSON.parse(c.json_data);s.classes=p.classes||[],s.subjects=p.subjects||[]}catch(p){console.error("Error parsing previous data:",p),alert("Failed to load previous data. Please try another selection.")}}function X(){t.value<l.value.length-1?t.value++:V()}function Z(){t.value>0&&t.value--}function V(){o.value=!0,n.value=!1,u.value=!1,a.value="";const p=M(s,["selectedTerm","commonSubjects","commonDivisions","divisions","institutionName","logo","dontCreateClasses","subjects","terms","email","googleAppPassword","classes"]);if(p.length>0){alert(`Please fill in the following fields:
 - ${p.join(`
- `)}`),o.value=!1;return}w.update({params:{values:A({},s)}}),w.submit()}function M(c,p){const C=[];return Object.entries(c).forEach(([S,D])=>{p.includes(S)||(Array.isArray(D)?D.length===0&&C.push(`The list of ${S} is empty`):(!D||typeof D=="string"&&D.trim()==="")&&C.push(`${S} is missing or empty`))}),C}return $(()=>{L()}),{currentStep:t,previousDataList:e,isSubmitting:o,showResultMessage:n,submitSuccess:u,errorMessage:a,formValues:s,steps:l,quickSetupResource:w,autoCreateClasses:K,fetchPreviousData:L,updateField:q,updateFieldArray:Q,submitEmailAccount:z,autoCreateTerms:J,usePreviousData:H,nextStep:X,prevStep:Z,submitForm:V,checkMissingFields:M}}},Jt={class:"p-4 max-w-4xl mx-auto"},Ht={key:0},Xt={class:"text-2xl font-semibold mb-6"},Zt={class:"flex justify-between gap-4"},es=["disabled"],ts={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ss={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},is={class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},os={key:0,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},as={key:1,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},ns={class:"mt-3 text-lg font-medium text-gray-900"},rs={class:"mt-2 text-sm text-gray-500"},ls={class:"mt-5"},ds={key:3,class:"text-center mt-10"};function ms(t,e,o,n,u,a){return d(),m("div",Jt,[n.currentStep<n.steps.length?(d(),m("div",Ht,[i("h2",Xt,v(n.steps[n.currentStep].title),1),(d(),ne(re(n.steps[n.currentStep].component),{values:n.formValues,previousDataList:n.previousDataList,onUpdateField:n.updateField,onUpdateFieldArray:n.updateFieldArray,onSubmitEmail:n.submitEmailAccount,onAutoCreateTerms:n.autoCreateTerms,onAutoCreateClasses:n.autoCreateClasses,onUsePreviousData:n.usePreviousData,class:"mb-6"},null,40,["values","previousDataList","onUpdateField","onUpdateFieldArray","onSubmitEmail","onAutoCreateTerms","onAutoCreateClasses","onUsePreviousData"])),i("div",Zt,[n.currentStep>0?(d(),m("button",{key:0,onClick:e[0]||(e[0]=(...s)=>n.prevStep&&n.prevStep(...s)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"}," Back ")):_("",!0),i("button",{onClick:e[1]||(e[1]=(...s)=>n.nextStep&&n.nextStep(...s)),class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:n.isSubmitting||n.quickSetupResource.loading},v(n.currentStep===n.steps.length-1?n.isSubmitting?"Submitting...":"Submit":"Next"),9,es)])])):_("",!0),n.isSubmitting?(d(),m("div",ts,e[3]||(e[3]=[i("div",{class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},[i("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),i("h3",{class:"text-lg font-medium text-gray-900"},"Submitting your data..."),i("p",{class:"mt-2 text-sm text-gray-500"},"Please wait while we process your information.")],-1)]))):_("",!0),n.showResultMessage?(d(),m("div",ss,[i("div",is,[n.submitSuccess?(d(),m("div",os,e[4]||(e[4]=[i("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(d(),m("div",as,e[5]||(e[5]=[i("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),i("h3",ns,v(n.submitSuccess?"Form Submitted Successfully!":"Submission Failed"),1),i("p",rs,v(n.submitSuccess?"Your data has been successfully processed.":n.errorMessage||"An error occurred while submitting the form."),1),i("div",ls,[i("button",{onClick:e[2]||(e[2]=s=>n.showResultMessage=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," OK ")])])])):_("",!0),n.currentStep>=n.steps.length&&!n.isSubmitting&&!n.showResultMessage?(d(),m("div",ds,e[6]||(e[6]=[i("h2",{class:"text-2xl font-semibold text-green-600"},"Form Submitted Successfully!",-1)]))):_("",!0)])}const us=j(zt,[["render",ms],["__scopeId","data-v-0a78be48"]]),cs={components:{MultiStepForm:us}},ps={class:"app-container"};function vs(t,e,o,n,u,a){const s=de("MultiStepForm");return d(),m("div",ps,[le(s)])}const hs=j(cs,[["render",vs]]);export{hs as default};
