var c=(a,e,d)=>new Promise((D,s)=>{var n=f=>{try{p(d.next(f))}catch(g){s(g)}},t=f=>{try{p(d.throw(f))}catch(g){s(g)}},p=f=>f.done?D(f.value):Promise.resolve(f.value).then(n,t);p((d=d.apply(a,e)).next())});import{g as Y,a as _,b as E,c as C}from"./apiUtils-CCQy72K0.js";/* empty css             */import{_ as S,c as i,b as r,f as u,g as N,F as v,h as b,t as l,j as m,v as h,i as y,n as k,o}from"./index-BsE_pyWB.js";const A={data(){return{formData:{academicYear:null,className:null,divisionName:null,student_data:{FirstName:"",MiddleName:"",LastName:"","GR Number":"","Email Address":"","Phone Number":""}},academicYears:[],displayYears:[],classes:[],divisions:[],isSubmitting:!1,message:null,errors:{}}},created(){return c(this,null,function*(){yield Promise.all([this.fetchAcademicYears(),this.fetchClasses()])})},methods:{fetchAcademicYears(){return c(this,null,function*(){try{const a=yield Y({values:{}});console.log("getAcademicYears API response:",a),a&&Array.isArray(a.message)?(this.academicYears=a.message,this.displayYears=this.academicYears.map((e,d)=>({original:e,display:d===0?`${e} - Current Year`:e})),this.academicYears.length>0&&(this.formData.academicYear=this.academicYears[0]),console.log("Processed academic years:",this.academicYears)):(this.academicYears=[],this.displayYears=[],console.warn("No valid academic years found in response"),this.showMessage("No academic years available","error"))}catch(a){console.error("Error fetching academic years:",a),this.academicYears=[],this.displayYears=[],this.showMessage("Error fetching academic years: "+(a.message||"Unknown error"),"error")}})},fetchClasses(){return c(this,null,function*(){try{const a=yield _({values:{}});this.classes=a.message?a.message.map(e=>e.name):[]}catch(a){console.error("Error fetching classes:",a),this.showMessage("Error fetching classes","error")}})},onYearChange(){return c(this,null,function*(){this.formData.className=null,this.formData.divisionName=null,this.divisions=[],this.errors.className="",this.errors.divisionName="",yield this.onClassChange()})},onClassChange(){return c(this,null,function*(){if(this.formData.divisionName=null,this.errors.divisionName="",this.formData.className&&this.formData.academicYear)try{const a=yield E({values:{classId:this.formData.className,academicYear:this.formData.academicYear}});this.divisions=a.message?a.message.map(e=>e.name):[]}catch(a){console.error("Error fetching divisions:",a),this.showMessage(`Error fetching divisions for ${this.formData.className} in ${this.formData.academicYear}`,"error")}else this.divisions=[]})},validateForm(){this.errors={};let a=!0;return this.formData.academicYear||(this.errors.academicYear="Please select an academic year",a=!1),this.formData.className||(this.errors.className="Please select a class",a=!1),this.formData.divisionName||(this.errors.divisionName="Please select a division",a=!1),this.formData.student_data.FirstName.trim()||(this.errors.firstName="First name is required",a=!1),this.formData.student_data.LastName.trim()||(this.errors.lastName="Last name is required",a=!1),this.formData.student_data["GR Number"].trim()||(this.errors.grNumber="GR number is required",a=!1),this.validEmail(this.formData.student_data["Email Address"])||(this.errors.email="Please enter a valid email",a=!1),this.validPhone(this.formData.student_data["Phone Number"])||(this.errors.phone="Please enter a valid phone number",a=!1),a},validEmail(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)},validPhone(a){return/^[0-9]{10,15}$/.test(a)},validateAndSubmit(){return c(this,null,function*(){this.validateForm()&&(yield this.submitForm())})},submitForm(){return c(this,null,function*(){this.isSubmitting=!0,this.message=null;try{const a={academicYear:this.formData.academicYear,student_data:{"First Name":this.formData.student_data.FirstName,"Middle Name":this.formData.student_data.MiddleName,"Last Name":this.formData.student_data.LastName,"GR Number":this.formData.student_data["GR Number"],"Email Address":this.formData.student_data["Email Address"],"Phone Number":this.formData.student_data["Phone Number"]},className:this.formData.className,divisionName:this.formData.divisionName};console.log("Submitting student data:",JSON.stringify(a,null,2));const e=yield C(a);if(e.success)this.showMessage("âœ… Student enrolled successfully!","success");else{let d=e.error;this.showMessage(d,"error")}}catch(a){console.error("Enrollment exception:",a),this.showMessage(a.message||"Unexpected error occurred","error")}finally{this.isSubmitting=!1}})},resetForm(){this.formData={academicYear:this.academicYears.length>0?this.academicYears[0]:null,className:null,divisionName:null,student_data:{FirstName:"",MiddleName:"",LastName:"","GR Number":"","Email Address":"","Phone Number":""}},this.divisions=[],this.errors={}},showMessage(a,e="info"){this.message={text:a,type:e},e!=="error"&&setTimeout(()=>this.message=null,5e3)}}},P={class:"enrollment-form"},w={class:"form-card"},F={class:"form-grid"},M={class:"form-group required"},V=["value"],q={key:0,class:"error-message"},x={class:"form-group required"},G=["disabled"],R=["value"],U={key:0,class:"error-message"},L={key:0,class:"form-group required"},H=["disabled"],B=["value"],I={key:0,class:"error-message"},T={class:"form-grid"},j={class:"form-group required"},z={key:0,class:"error-message"},J={class:"form-group"},O={class:"form-group required"},Z={key:0,class:"error-message"},K={class:"form-group required"},Q={key:0,class:"error-message"},W={class:"form-group"},X={key:0,class:"error-message"},$={class:"form-group"},ee={key:0,class:"error-message"},se={class:"form-actions"},ae=["disabled"],re={key:0,class:"button-content"},te={key:1,class:"button-content"},ie=["disabled"];function oe(a,e,d,D,s,n){return o(),i("div",P,[e[28]||(e[28]=r("div",{class:"header"},[r("h1",{class:"title"},"Student Enrollment"),r("p",{class:"subtitle"},"Add new student to the system")],-1)),r("div",w,[e[27]||(e[27]=r("h2",{class:"form-title"},"Student Information",-1)),r("div",F,[r("div",M,[e[14]||(e[14]=r("label",null,"Academic Year",-1)),u(r("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.formData.academicYear=t),class:"picker",onChange:e[1]||(e[1]=(...t)=>n.onYearChange&&n.onYearChange(...t))},[e[13]||(e[13]=r("option",{value:null},"Select Academic Year",-1)),(o(!0),i(v,null,b(s.displayYears,t=>(o(),i("option",{key:t,value:t.original},l(t.display),9,V))),128))],544),[[N,s.formData.academicYear]]),s.errors.academicYear?(o(),i("span",q,l(s.errors.academicYear),1)):m("",!0)]),r("div",x,[e[16]||(e[16]=r("label",null,"Class / Program",-1)),u(r("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.formData.className=t),class:"picker",onChange:e[3]||(e[3]=(...t)=>n.onClassChange&&n.onClassChange(...t)),disabled:!s.formData.academicYear},[e[15]||(e[15]=r("option",{value:null},"Select Class / Program",-1)),(o(!0),i(v,null,b(s.classes,t=>(o(),i("option",{key:t,value:t},l(t),9,R))),128))],40,G),[[N,s.formData.className]]),s.errors.className?(o(),i("span",U,l(s.errors.className),1)):m("",!0)]),s.divisions.length>0?(o(),i("div",L,[e[18]||(e[18]=r("label",null,"Division / Student Group",-1)),u(r("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.formData.divisionName=t),class:"picker",disabled:!s.formData.className},[e[17]||(e[17]=r("option",{value:null},"Select Division / Student Group",-1)),(o(!0),i(v,null,b(s.divisions,t=>(o(),i("option",{key:t,value:t},l(t),9,B))),128))],8,H),[[N,s.formData.divisionName]]),s.errors.divisionName?(o(),i("span",I,l(s.errors.divisionName),1)):m("",!0)])):m("",!0)]),r("div",T,[r("div",j,[e[19]||(e[19]=r("label",null,"First Name",-1)),u(r("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.formData.student_data.FirstName=t),type:"text",class:"input",placeholder:"Enter first name",required:""},null,512),[[h,s.formData.student_data.FirstName]]),s.errors.firstName?(o(),i("span",z,l(s.errors.firstName),1)):m("",!0)]),r("div",J,[e[20]||(e[20]=r("label",null,"Middle Name",-1)),u(r("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.formData.student_data.MiddleName=t),type:"text",class:"input",placeholder:"Enter middle name"},null,512),[[h,s.formData.student_data.MiddleName]])]),r("div",O,[e[21]||(e[21]=r("label",null,"Last Name",-1)),u(r("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.formData.student_data.LastName=t),type:"text",class:"input",placeholder:"Enter last name",required:""},null,512),[[h,s.formData.student_data.LastName]]),s.errors.lastName?(o(),i("span",Z,l(s.errors.lastName),1)):m("",!0)]),r("div",K,[e[22]||(e[22]=r("label",null,"GR Number",-1)),u(r("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>s.formData.student_data["GR Number"]=t),type:"text",class:"input",placeholder:"Enter GR number",required:""},null,512),[[h,s.formData.student_data["GR Number"]]]),s.errors.grNumber?(o(),i("span",Q,l(s.errors.grNumber),1)):m("",!0)]),r("div",W,[e[23]||(e[23]=r("label",null,"Email Address",-1)),u(r("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>s.formData.student_data["Email Address"]=t),type:"email",class:"input",placeholder:"Enter email address",required:""},null,512),[[h,s.formData.student_data["Email Address"]]]),s.errors.email?(o(),i("span",X,l(s.errors.email),1)):m("",!0)]),r("div",$,[e[24]||(e[24]=r("label",null,"Phone Number",-1)),u(r("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>s.formData.student_data["Phone Number"]=t),type:"tel",class:"input",placeholder:"Enter phone number",required:""},null,512),[[h,s.formData.student_data["Phone Number"]]]),s.errors.phone?(o(),i("span",ee,l(s.errors.phone),1)):m("",!0)])]),r("div",se,[r("button",{class:"enroll-button",onClick:e[11]||(e[11]=(...t)=>n.validateAndSubmit&&n.validateAndSubmit(...t)),disabled:s.isSubmitting},[s.isSubmitting?(o(),i("span",re,e[25]||(e[25]=[r("span",{class:"spinner"},null,-1),y(" Processing... ")]))):(o(),i("span",te,e[26]||(e[26]=[r("svg",{class:"icon",viewBox:"0 0 24 24"},[r("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1),y(" Enroll Student ")])))],8,ae),r("button",{class:"reset-button",onClick:e[12]||(e[12]=(...t)=>n.resetForm&&n.resetForm(...t)),disabled:s.isSubmitting}," Reset Form ",8,ie)]),s.message?(o(),i("div",{key:0,class:k(["message",s.message.type])},l(s.message.text),3)):m("",!0)])])}const ue=S(A,[["render",oe]]);export{ue as default};
