var X=Object.defineProperty;var O=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,aa=Object.prototype.propertyIsEnumerable;var H=(o,a,g)=>a in o?X(o,a,{enumerable:!0,configurable:!0,writable:!0,value:g}):o[a]=g,T=(o,a)=>{for(var g in a||(a={}))$.call(a,g)&&H(o,g,a[g]);if(O)for(var g of O(a))aa.call(a,g)&&H(o,g,a[g]);return o};import{_ as ea,q as j,r as v,y as sa,j as h,k as ta,c as n,b as s,l as c,t as m,f as u,g as k,F as R,h as A,v as f,z as ra,i as W,n as oa,o as i}from"./index-CN8Igeqz.js";/* empty css             */const na={setup(){const o=j({academicYear:null,className:null,divisionName:null,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),a=v([]),g=sa(()=>a.value.map((r,l)=>({original:r,display:l===0?`${r} - Current Year`:r}))),e=v([]),b=v([]),N=v(!1),t=v(null),d=j({}),y=v(!1),_=v(!1),Y=v(""),V=v(""),C=h({url:"school.al_ummah.api3.get_academic_years",params:{values:{}},onSuccess:r=>{a.value=Array.isArray(r)?r:[],a.value.length>0&&(o.academicYear=a.value[0]),a.value.length||D("No academic years available","error")},onError:r=>{var l;console.error("Error fetching academic years:",r),a.value=[],D(`Error fetching academic years: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),w=h({url:"school.al_ummah.api3.get_classes",params:{values:{}},onSuccess:r=>{e.value=Array.isArray(r)?r:[],console.log("Classes loaded:",e.value),e.value.length||D("No classes available","error")},onError:r=>{var l;console.error("Error fetching classes:",r),e.value=[],D(`Error fetching classes: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),S=h({url:"school.al_ummah.api3.get_divisions2",params:{values:{classId:o.className,academicYear:o.academicYear}},onSuccess:r=>{b.value=Array.isArray(r)?r:[],console.log("Divisions loaded:",b.value)},onError:r=>{var l;console.error("Error fetching divisions:",r),b.value=[],D(`Error fetching divisions: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),E=h({url:"school.al_ummah.api3.enroll_single_student",params:{academicYear:o.academicYear,className:o.className,divisionName:o.divisionName,student_data:o.student_data},onSuccess:r=>{N.value=!1,_.value=!0,V.value=`Student ${o.student_data["First Name"]} ${o.student_data["Last Name"]} has been successfully enrolled in ${o.className} - ${o.divisionName} for the ${o.academicYear} academic year.`,y.value=!0},onError:r=>{var l;N.value=!1,_.value=!1,Y.value=((l=r.messages)==null?void 0:l[0])||"An unexpected error occurred while enrolling the student. Please try again.",y.value=!0}});ta(()=>{C.reload(),w.reload()});function I(){o.className=null,o.divisionName=null,b.value=[],d.className="",d.divisionName="",M()}function M(){o.divisionName=null,d.divisionName="",o.className&&o.academicYear?(S.update({params:{values:{classId:o.className,academicYear:o.academicYear}}}),S.reload()):b.value=[]}function z(){Object.assign(d,{});let r=!0;o.academicYear||(d.academicYear="Please select an academic year",r=!1),o.className||(d.className="Please select a class",r=!1),o.divisionName||(d.divisionName="Please select a division",r=!1),o.student_data["First Name"].trim()||(d.firstName="First name is required",r=!1),o.student_data["Last Name"].trim()||(d.lastName="Last name is required",r=!1),o.student_data["GR Number"].trim()||(d.grNumber="GR number is required",r=!1);const l=o.student_data["Student Date of Birth"];l&&!B(l)&&(d.studentDob="Student date of birth cannot be in the future",r=!1);const p=o.student_data["Guardian Date of Birth"];p&&!B(p)&&(d.guardianDob="Guardian date of birth cannot be in the future",r=!1);const G=o.student_data["Email Address"].trim();G&&!x(G)&&(d.email="Please enter a valid email",r=!1);const P=o.student_data["Phone Number"].trim();P&&!U(P)&&(d.phone="Please enter a valid phone number (10-15 digits)",r=!1);const q=o.student_data["Guardian Number"].trim();q&&!U(q)&&(d.guardianNumber="Please enter a valid guardian phone number (10-15 digits)",r=!1);const L=o.student_data["Guardian Email"].trim();return L?x(L)||(d.guardianEmail="Please enter a valid guardian email",r=!1):(d.guardianEmail="Guardian email is required",r=!1),r}function x(r){return r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r):!0}function U(r){return r?/^[0-9]{10,15}$/.test(r):!0}function B(r){if(!r)return!0;const l=new Date(r),p=new Date;return p.setHours(0,0,0,0),l.setHours(0,0,0,0),l<=p}function Z(){const r=new Date,l=r.getFullYear(),p=String(r.getMonth()+1).padStart(2,"0"),G=String(r.getDate()).padStart(2,"0");return`${l}-${p}-${G}`}function J(){z()&&K()}function K(){N.value=!0,E.update({params:{academicYear:o.academicYear,className:o.className,divisionName:o.divisionName,student_data:T({},o.student_data)}}),E.submit()}function F(){Object.assign(o,{academicYear:a.value.length>0?a.value[0]:null,className:null,divisionName:null,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),b.value=[],Object.assign(d,{}),t.value=null}function Q(){F(),y.value=!1,_.value=!1}function D(r,l="info"){t.value={text:r,type:l},l!=="error"&&setTimeout(()=>t.value=null,5e3)}return{formData:o,academicYears:a,displayYears:g,classes:e,divisions:b,isSubmitting:N,message:t,errors:d,academicYearsResource:C,classesResource:w,divisionsResource:S,enrollStudentResource:E,showResultMessage:y,submitSuccess:_,errorMessage:Y,successMessage:V,onYearChange:I,onClassChange:M,validateAndSubmit:J,resetForm:F,resetAndClose:Q,getTodayDate:Z}}},ia={class:"enrollment-form"},la={key:0,class:"loading-overlay"},da={key:1,class:"modal-overlay"},ua={class:"result-modal"},ma={key:0,class:"success-icon"},ca={key:1,class:"error-icon"},fa={class:"result-title"},ga={class:"result-description"},va={class:"modal-actions"},ba={class:"form-card"},pa={class:"form-grid"},Na={class:"form-group required"},Da=["disabled"],ya=["value"],_a={key:0,class:"error-message"},Ga={class:"form-group required"},ha=["disabled"],ka=["value"],Sa={key:0,class:"error-message"},Ea={key:0,class:"form-group required"},Ra=["disabled"],Aa=["value"],Ya={key:0,class:"error-message"},Va={class:"form-section"},Ca={class:"form-grid"},wa={class:"form-group required"},Ma={key:0,class:"error-message"},xa={class:"form-group"},Ua={class:"form-group required"},Ba={key:0,class:"error-message"},Fa={class:"form-group"},Pa=["max"],qa={key:0,class:"error-message"},La={class:"form-group required"},Oa={key:0,class:"error-message"},Ha={class:"form-group required"},Ta={key:0,class:"error-message"},ja={class:"form-group"},Wa={key:0,class:"error-message"},Ia={class:"form-section"},za={class:"form-grid"},Za={class:"form-group"},Ja={class:"form-group"},Ka={key:0,class:"error-message"},Qa={class:"form-group"},Xa={class:"form-group"},$a=["max"],ae={key:0,class:"error-message"},ee={class:"form-group required"},se={key:0,class:"error-message"},te={class:"form-group"},re={class:"form-group"},oe={class:"form-group"},ne={class:"form-group"},ie={class:"form-actions"},le=["disabled"],de={key:0,class:"button-content"},ue={key:1,class:"button-content"},me=["disabled"];function ce(o,a,g,e,b,N){return i(),n("div",ia,[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("div",la,a[26]||(a[26]=[s("div",{class:"loading-modal"},[s("div",{class:"loading-spinner"}),s("h3",{class:"loading-title"},"Enrolling Student..."),s("p",{class:"loading-description"},"Please wait while we process the student information.")],-1)]))):c("",!0),e.showResultMessage?(i(),n("div",da,[s("div",ua,[e.submitSuccess?(i(),n("div",ma,a[27]||(a[27]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(i(),n("div",ca,a[28]||(a[28]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",fa,m(e.submitSuccess?"Student Enrolled Successfully!":"Enrollment Failed"),1),s("p",ga,m(e.submitSuccess?e.successMessage:e.errorMessage),1),s("div",va,[e.submitSuccess?(i(),n("button",{key:0,onClick:a[0]||(a[0]=(...t)=>e.resetAndClose&&e.resetAndClose(...t)),class:"success-button"}," Add Another Student ")):(i(),n("button",{key:1,onClick:a[1]||(a[1]=t=>e.showResultMessage=!1),class:"primary-button"}," Try Again ")),e.submitSuccess?(i(),n("button",{key:2,onClick:a[2]||(a[2]=t=>e.showResultMessage=!1),class:"secondary-button"}," Close ")):c("",!0)])])])):c("",!0),a[57]||(a[57]=s("div",{class:"header"},[s("h1",{class:"title"},"Student Enrollment"),s("p",{class:"subtitle"},"Add new student to the system")],-1)),s("div",ba,[a[56]||(a[56]=s("h2",{class:"form-title"},"Student Information",-1)),s("div",pa,[s("div",Na,[a[30]||(a[30]=s("label",null,"Academic Year",-1)),u(s("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.formData.academicYear=t),class:"picker",onChange:a[4]||(a[4]=(...t)=>e.onYearChange&&e.onYearChange(...t)),disabled:e.academicYearsResource.loading},[a[29]||(a[29]=s("option",{value:null},"Select Academic Year",-1)),(i(!0),n(R,null,A(e.displayYears,t=>(i(),n("option",{key:t,value:t.original},m(t.display),9,ya))),128))],40,Da),[[k,e.formData.academicYear]]),e.errors.academicYear?(i(),n("span",_a,m(e.errors.academicYear),1)):c("",!0)]),s("div",Ga,[a[32]||(a[32]=s("label",null,"Class / Program",-1)),u(s("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>e.formData.className=t),class:"picker",onChange:a[6]||(a[6]=(...t)=>e.onClassChange&&e.onClassChange(...t)),disabled:!e.formData.academicYear||e.classesResource.loading},[a[31]||(a[31]=s("option",{value:null},"Select Class / Program",-1)),(i(!0),n(R,null,A(e.classes,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,ka))),128))],40,ha),[[k,e.formData.className]]),e.errors.className?(i(),n("span",Sa,m(e.errors.className),1)):c("",!0)]),e.divisions.length>0?(i(),n("div",Ea,[a[34]||(a[34]=s("label",null,"Division / Student Group",-1)),u(s("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>e.formData.divisionName=t),class:"picker",disabled:!e.formData.className||e.divisionsResource.loading},[a[33]||(a[33]=s("option",{value:null},"Select Division / Student Group",-1)),(i(!0),n(R,null,A(e.divisions,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,Aa))),128))],8,Ra),[[k,e.formData.divisionName]]),e.errors.divisionName?(i(),n("span",Ya,m(e.errors.divisionName),1)):c("",!0)])):c("",!0)]),s("div",Va,[a[42]||(a[42]=s("h3",{class:"section-title"},"Personal Details",-1)),s("div",Ca,[s("div",wa,[a[35]||(a[35]=s("label",null,"First Name",-1)),u(s("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>e.formData.student_data["First Name"]=t),type:"text",class:"input",placeholder:"Enter first name",required:""},null,512),[[f,e.formData.student_data["First Name"]]]),e.errors.firstName?(i(),n("span",Ma,m(e.errors.firstName),1)):c("",!0)]),s("div",xa,[a[36]||(a[36]=s("label",null,"Middle Name",-1)),u(s("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>e.formData.student_data["Middle Name"]=t),type:"text",class:"input",placeholder:"Enter middle name"},null,512),[[f,e.formData.student_data["Middle Name"]]])]),s("div",Ua,[a[37]||(a[37]=s("label",null,"Last Name",-1)),u(s("input",{"onUpdate:modelValue":a[10]||(a[10]=t=>e.formData.student_data["Last Name"]=t),type:"text",class:"input",placeholder:"Enter last name",required:""},null,512),[[f,e.formData.student_data["Last Name"]]]),e.errors.lastName?(i(),n("span",Ba,m(e.errors.lastName),1)):c("",!0)]),s("div",Fa,[a[38]||(a[38]=s("label",null,"Student Date of Birth",-1)),u(s("input",{"onUpdate:modelValue":a[11]||(a[11]=t=>e.formData.student_data["Student Date of Birth"]=t),type:"date",class:"input",max:e.getTodayDate()},null,8,Pa),[[f,e.formData.student_data["Student Date of Birth"]]]),e.errors.studentDob?(i(),n("span",qa,m(e.errors.studentDob),1)):c("",!0)]),s("div",La,[a[39]||(a[39]=s("label",null,"GR Number",-1)),u(s("input",{"onUpdate:modelValue":a[12]||(a[12]=t=>e.formData.student_data["GR Number"]=t),type:"text",class:"input",placeholder:"Enter GR number",required:""},null,512),[[f,e.formData.student_data["GR Number"]]]),e.errors.grNumber?(i(),n("span",Oa,m(e.errors.grNumber),1)):c("",!0)]),s("div",Ha,[a[40]||(a[40]=s("label",null,"Email Address",-1)),u(s("input",{"onUpdate:modelValue":a[13]||(a[13]=t=>e.formData.student_data["Email Address"]=t),type:"email",class:"input",placeholder:"Enter email address"},null,512),[[f,e.formData.student_data["Email Address"]]]),e.errors.email?(i(),n("span",Ta,m(e.errors.email),1)):c("",!0)]),s("div",ja,[a[41]||(a[41]=s("label",null,"Phone Number",-1)),u(s("input",{"onUpdate:modelValue":a[14]||(a[14]=t=>e.formData.student_data["Phone Number"]=t),type:"tel",class:"input",placeholder:"Enter phone number"},null,512),[[f,e.formData.student_data["Phone Number"]]]),e.errors.phone?(i(),n("span",Wa,m(e.errors.phone),1)):c("",!0)])])]),s("div",Ia,[a[53]||(a[53]=s("h3",{class:"section-title"},"Guardian Information",-1)),s("div",za,[s("div",Za,[a[43]||(a[43]=s("label",null,"Guardian Name",-1)),u(s("input",{"onUpdate:modelValue":a[15]||(a[15]=t=>e.formData.student_data["Guardian Name"]=t),type:"text",class:"input",placeholder:"Enter guardian name"},null,512),[[f,e.formData.student_data["Guardian Name"]]])]),s("div",Ja,[a[44]||(a[44]=s("label",null,"Guardian Number",-1)),u(s("input",{"onUpdate:modelValue":a[16]||(a[16]=t=>e.formData.student_data["Guardian Number"]=t),type:"tel",class:"input",placeholder:"Enter guardian phone number"},null,512),[[f,e.formData.student_data["Guardian Number"]]]),e.errors.guardianNumber?(i(),n("span",Ka,m(e.errors.guardianNumber),1)):c("",!0)]),s("div",Qa,[a[46]||(a[46]=s("label",null,"Relation",-1)),u(s("select",{"onUpdate:modelValue":a[17]||(a[17]=t=>e.formData.student_data.Relation=t),class:"picker"},a[45]||(a[45]=[ra('<option value="">Select Relation</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Brother">Brother</option><option value="Sister">Sister</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Guardian">Guardian</option><option value="Other">Other</option>',11)]),512),[[k,e.formData.student_data.Relation]])]),s("div",Xa,[a[47]||(a[47]=s("label",null,"Guardian Date of Birth",-1)),u(s("input",{"onUpdate:modelValue":a[18]||(a[18]=t=>e.formData.student_data["Guardian Date of Birth"]=t),type:"date",class:"input",max:e.getTodayDate()},null,8,$a),[[f,e.formData.student_data["Guardian Date of Birth"]]]),e.errors.guardianDob?(i(),n("span",ae,m(e.errors.guardianDob),1)):c("",!0)]),s("div",ee,[a[48]||(a[48]=s("label",null,"Guardian Email",-1)),u(s("input",{"onUpdate:modelValue":a[19]||(a[19]=t=>e.formData.student_data["Guardian Email"]=t),type:"email",class:"input",placeholder:"Enter guardian email"},null,512),[[f,e.formData.student_data["Guardian Email"]]]),e.errors.guardianEmail?(i(),n("span",se,m(e.errors.guardianEmail),1)):c("",!0)]),s("div",te,[a[49]||(a[49]=s("label",null,"Guardian Occupation",-1)),u(s("input",{"onUpdate:modelValue":a[20]||(a[20]=t=>e.formData.student_data["Guardian Occupation"]=t),type:"text",class:"input",placeholder:"Enter guardian occupation"},null,512),[[f,e.formData.student_data["Guardian Occupation"]]])]),s("div",re,[a[50]||(a[50]=s("label",null,"Guardian Designation",-1)),u(s("input",{"onUpdate:modelValue":a[21]||(a[21]=t=>e.formData.student_data["Guardian Designation"]=t),type:"text",class:"input",placeholder:"Enter guardian designation"},null,512),[[f,e.formData.student_data["Guardian Designation"]]])]),s("div",oe,[a[51]||(a[51]=s("label",null,"Guardian Education",-1)),u(s("input",{"onUpdate:modelValue":a[22]||(a[22]=t=>e.formData.student_data["Guardian Education"]=t),type:"text",class:"input",placeholder:"Enter guardian education"},null,512),[[f,e.formData.student_data["Guardian Education"]]])]),s("div",ne,[a[52]||(a[52]=s("label",null,"Guardian Work Address",-1)),u(s("textarea",{"onUpdate:modelValue":a[23]||(a[23]=t=>e.formData.student_data["Guardian Work Address"]=t),class:"input textarea",placeholder:"Enter guardian work address",rows:"3"},null,512),[[f,e.formData.student_data["Guardian Work Address"]]])])])]),s("div",ie,[s("button",{class:"enroll-button",onClick:a[24]||(a[24]=(...t)=>e.validateAndSubmit&&e.validateAndSubmit(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage},[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("span",de,a[54]||(a[54]=[s("span",{class:"spinner"},null,-1),W(" Processing... ")]))):(i(),n("span",ue,a[55]||(a[55]=[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1),W(" Enroll Student ")])))],8,le),s("button",{class:"reset-button",onClick:a[25]||(a[25]=(...t)=>e.resetForm&&e.resetForm(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage}," Reset Form ",8,me)]),e.message&&!e.showResultMessage?(i(),n("div",{key:0,class:oa(["message",e.message.type])},m(e.message.text),3)):c("",!0)])])}const be=ea(na,[["render",ce]]);export{be as default};
