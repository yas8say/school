var xe=Object.defineProperty,Je=Object.defineProperties;var Ge=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ie=(N,t,k)=>t in N?xe(N,t,{enumerable:!0,configurable:!0,writable:!0,value:k}):N[t]=k,W=(N,t)=>{for(var k in t||(t={}))je.call(t,k)&&ie(N,k,t[k]);if(re)for(var k of re(t))qe.call(t,k)&&ie(N,k,t[k]);return N},z=(N,t)=>Je(N,Ge(t));var j=(N,t,k)=>new Promise((o,x)=>{var h=m=>{try{g(k.next(m))}catch(D){x(D)}},r=m=>{try{g(k.throw(m))}catch(D){x(D)}},g=m=>m.done?o(m.value):Promise.resolve(m.value).then(h,r);g((k=k.apply(N,t)).next())});import{_ as Oe,r as y,c as q,q as le,x as He,a as c,b as s,t as v,i as S,h as V,n as ce,F as B,p as T,o as d,l as K,m as oe,v as Qe}from"./index-CphjL6GV.js";import{v as We,g as ze,u as U,a as L,p as Ke,f as Xe,r as Ye}from"./dateUtils-CshPDU0n.js";/* empty css             */const Ze={setup(){const N=y(!1),t=y([]),k=y(null),o=y(["First Name","Middle Name","Last Name","Full Name","Gender","Mobile","Email","Date of Birth","Date of Joining","PAN Number","Bank Name","Bank A/C No.","IFSC Code","Current Address","Permanent Address","Blood Group","Attendance Device ID (Biometric/RF tag ID)","Qualification (Education)","School/University (Education)"]),x=y(null),h=y([]),r=y([]),g=y([]),m=y([]),D=y([]),C=y([]),I=y([]),O=y({total_processed:0,successful:0,failed:0}),F=y(!1),X=y(!1),Y=y("success"),Z=y(""),$=y(""),de=q(()=>h.value.filter(e=>P(e)).length),ue=q(()=>h.value.filter(e=>e.className&&e.divisionName).length),me=q(()=>h.value.filter(e=>!P(e)).length),fe=q(()=>h.value.filter(e=>!P(e))),ve=q(()=>r.value.filter((e,l)=>{var p;const a=h.value.some(n=>{const u=n[e];return u!=null&&u!==""&&u.toString().trim()!==""}),i=(p=t.value[l])==null?void 0:p.type;return a||i})),he=q(()=>t.value.map((e,l)=>z(W({},e),{originalIndex:l})).filter((e,l)=>{const a=r.value[l],i=h.value.some(n=>{const u=n[a];return u!=null&&u!==""&&u.toString().trim()!==""}),p=e.type;return i||p}));function ge(e){const l=M(e);return`${l["First Name"]||""} ${l["Middle Name"]||""} ${l["Last Name"]||""}`.trim()||"Unknown Teacher"}function pe(e){return M(e).Email||"N/A"}function _e(e){return M(e).Mobile||"N/A"}function be(e){const l=[];return["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"].forEach(i=>{const p=t.value.findIndex(n=>n.type===i);if(p===-1)l.push(`${i} not mapped`);else{const n=U.decode_col(t.value[p].column),u=r.value[n],f=e[u];if(!f||f.toString().trim()==="")l.push(`${i} missing`);else switch(i){case"Mobile":f.toString().replace(/\D/g,"").length<10&&l.push("Invalid mobile number");break;case"Email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.toString().trim())||l.push("Invalid email format");break;case"Gender":const J=f.toString().trim().toLowerCase();["male","female","other","m","f","o"].includes(J)||l.push("Invalid gender");break;case"Date of Birth":const E=L(f,"Date of Birth");E.isValid||l.push(E.error);break;case"Date of Joining":const R=L(f,"Date of Joining");R.isValid||l.push(R.error);break}}}),e.className&&!e.divisionName&&l.push("Class selected but no division assigned"),l.length>0?l.join("; "):"Check field mappings"}const ne=le({url:"school.al_ummah.api4.get_classes",params:{values:{}},onSuccess:e=>{g.value=Array.isArray(e)?e:[],console.log("Classes loaded:",g.value),g.value.length||b("No classes available","error")},onError:e=>{var l;console.error("Error fetching classes:",e),g.value=[],b(`Error fetching classes: ${((l=e.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),ee=le({url:"school.al_ummah.api4.get_divisions1",params:{values:{classId:""}},onSuccess:e=>Array.isArray(e)?e:[],onError:e=>{var l;return console.error("Error fetching divisions:",e),b(`Error fetching divisions: ${((l=e.messages)==null?void 0:l[0])||"Unknown error"}`,"error"),[]}}),se=le({url:"school.al_ummah.api4.bulk_enroll_instructors",method:"POST",onSuccess:e=>{console.log("Bulk enrollment successful:",e),F.value=!1,e&&e.success?(C.value=e.enrolled_instructors||[],I.value=e.failed_enrollments||[],O.value=e.summary||{total_processed:e.enrolled_instructors.length+e.failed_enrollments.length,successful:e.enrolled_instructors.length,failed:e.failed_enrollments.length},Se(e.enrolled_instructors,e.failed_enrollments),I.value.length===0?(b(`Successfully enrolled all ${C.value.length} teachers!`,"success"),H("success","Enrollment Complete",`Successfully enrolled all ${C.value.length} teachers!`)):(b(`Completed: ${C.value.length} successful, ${I.value.length} failed.`,"warning"),H("warning","Enrollment Completed with Errors",`Completed with ${C.value.length} successful enrollments and ${I.value.length} failures.`))):b("Bulk enrollment completed with issues","warning")},onError:e=>{var l,a;console.error("Error in bulk enrollment:",e),F.value=!1,b(`Bulk enrollment failed: ${((l=e.messages)==null?void 0:l[0])||e.message||"Unknown error"}`,"error"),H("error","Bulk Enrollment Failed",((a=e.messages)==null?void 0:a[0])||e.message||"Unknown error occurred during bulk enrollment.")}});He(()=>{ne.reload()});function ke(e){return j(this,null,function*(){const l=h.value[e];if(l.className){l.divisionName=null;try{ee.update({params:{values:{classId:l.className}}});const a=yield ee.reload();l.divisions=Array.isArray(a)?a:[]}catch(a){console.error("Error fetching divisions:",a),b(`Error fetching divisions for ${l.className}`,"error")}}else l.divisionName=null,l.divisions=[]})}function ye(e){let l="";for(;e>=0;)l=String.fromCharCode(65+e%26)+l,e=Math.floor(e/26)-1;return l}function De(){return j(this,null,function*(){const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls",e.onchange=l=>j(this,null,function*(){const a=l.target.files[0];if(a){k.value=a,b(null),C.value=[],I.value=[],O.value={total_processed:0,successful:0,failed:0};try{const{data:i,headers:p}=yield Te(a);h.value=i.slice(0,100).map(n=>z(W({},n),{className:null,divisionName:null,divisions:[],_status:null,_error:null,_touched:!1})),r.value=p,t.value=p.map((n,u)=>({type:null,column:U.encode_col(u)})),Ee(p,i.slice(0,5))}catch(i){console.error("Error loading preview:",i),b("Error loading file preview","error")}}}),e.click()})}function Ee(e,l){const a={"First Name":["first","fname","given","firstname"],"Middle Name":["middle","mname","midname"],"Last Name":["last","lname","surname","family","lastname"],"Full Name":["full name","name","teacher name"],Email:["email","e-mail","mail"],Mobile:["mobile","phone","cell","contact"],"Date of Birth":["dob","birth","birthdate","date of birth"],Gender:["gender","sex"],"Date of Joining":["doj","joining","start date"],"PAN Number":["pan","pan no","pan number"],"Bank Name":["bank","bank name"],"Bank A/C No.":["account","ac no","bank account","account no"],"IFSC Code":["ifsc","code"],"Current Address":["current address","address","present address"],"Permanent Address":["permanent address","home address"],"Blood Group":["blood","blood group"],"Attendance Device ID (Biometric/RF tag ID)":["attendance id","biometric","rfid","device id"],"Qualification (Education)":["qualification","education","degree"],"School/University (Education)":["school","university","institution"]};e.forEach((i,p)=>{if(!i)return;const n=i.toString().toLowerCase();for(const[u,f]of Object.entries(a))if(f.some(_=>n.includes(_))){t.value[p].type=u;break}})}function we(){k.value=null,h.value=[],r.value=[],t.value=[],m.value=[],D.value=[],C.value=[],I.value=[],O.value={total_processed:0,successful:0,failed:0},b(null)}function P(e){const l=["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"],a=t.value.map(n=>n.type).filter(n=>n);if(l.filter(n=>!a.includes(n)).length>0)return!1;const p=M(e);for(const n of l){const u=p[n];if(!u||u.toString().trim()==="")return!1;switch(n){case"Mobile":if(u.toString().replace(/\D/g,"").length<10)return!1;break;case"Email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.toString().trim()))return!1;break;case"Gender":const w=u.toString().trim().toLowerCase();if(!["male","female","other","m","f","o"].includes(w))return!1;break;case"Date of Birth":if(!L(u,"Date of Birth").isValid)return!1;break;case"Date of Joining":if(!L(u,"Date of Joining").isValid)return!1;break}}return!(e.className&&!e.divisionName)}function Ne(e){h.value[e]&&(h.value[e]._touched=!0)}function Ce(e){return e._status==="success"?"row-success":e._enrollment_status==="error"?"row-enrollment-error":P(e)?"":"row-invalid"}function M(e){const l={"First Name":"","Middle Name":"","Last Name":"","Full Name":"",Gender:"",Mobile:"",Email:"","Date of Birth":"","Date of Joining":"","PAN Number":"","Bank Name":"","Bank A/C No.":"","IFSC Code":"","Current Address":"","Permanent Address":"","Blood Group":"","Attendance Device ID (Biometric/RF tag ID)":"","Qualification (Education)":"","School/University (Education)":"",Class:e.className||"",Division:e.divisionName||""};return t.value.forEach(({type:a,column:i},p)=>{var n;if(a&&l.hasOwnProperty(a))try{const u=U.decode_col(i),f=r.value[u];let _=((n=e[f])==null?void 0:n.toString().trim())||"";if(a==="Date of Birth"||a==="Date of Joining"){const w=Ke(_);_=w?Xe(w):""}l[a]=_}catch(u){console.error(`Error mapping column ${i} for type ${a}:`,u)}}),l}function Se(e,l){console.log("Updating row statuses from bulk response..."),h.value.forEach(a=>{a._status=null,a._error=null}),e.forEach(a=>{const i=Re(a);i!==-1&&(h.value[i]._status="success",h.value[i]._error=null)}),l.forEach(a=>{const i=Fe(a.instructor_data);i!==-1&&(h.value[i]._enrollment_status="error",h.value[i]._enrollment_error=a.error||"Unknown error")})}function Re(e){return h.value.findIndex(l=>{const a=M(l);return`${a["First Name"]} ${a["Middle Name"]} ${a["Last Name"]}`.trim()===e})}function Fe(e){return h.value.findIndex(l=>{const a=M(l);return a.Email===e.Email&&a["First Name"]===e["First Name"]&&a["Last Name"]===e["Last Name"]})}function H(e,l,a){Y.value=e,Z.value=l,$.value=a,X.value=!0}function Me(){X.value=!1,Y.value="success",Z.value="",$.value=""}function Be(){return j(this,null,function*(){console.log("Enroll button clicked"),C.value=[],I.value=[],O.value={total_processed:0,successful:0,failed:0},F.value=!0,h.value.forEach(n=>{n._status=null,n._error=null});const e=["Mobile","Email","Gender","First Name","Last Name","Attendance Device ID (Biometric/RF tag ID)","Date of Birth","Date of Joining"],l=t.value.map(n=>n.type).filter(n=>n),a=e.filter(n=>!l.includes(n));if(a.length>0){const n=`Please map the following required fields: ${a.join(", ")}`;console.error(n),b(n,"error"),F.value=!1;return}if(!k.value){const n="Please select a file first";console.error(n),b(n,"error"),F.value=!1;return}if(h.value.length===0){b("No data available to enroll","error"),F.value=!1;return}const i=h.value.filter(n=>{const u=M(n),f=u["Date of Birth"]&&u["Date of Birth"].toString().trim()!==""?L(u["Date of Birth"],"Date of Birth"):{isValid:!1,error:"Date of Birth is required"},_=u["Date of Joining"]&&u["Date of Joining"].toString().trim()!==""?L(u["Date of Joining"],"Date of Joining"):{isValid:!1,error:"Date of Joining is required"};return!f.isValid||!_.isValid});if(i.length>0){b(`${i.length} rows have invalid dates. Please correct the dates before enrolling.`,"warning"),i.forEach(n=>{const u=h.value.indexOf(n);if(u!==-1){const f=M(n);let _="";if(!f["Date of Birth"]||f["Date of Birth"].toString().trim()==="")_+="Date of Birth is required. ";else{const w=L(f["Date of Birth"],"Date of Birth");w.isValid||(_+=w.error+" ")}if(!f["Date of Joining"]||f["Date of Joining"].toString().trim()==="")_+="Date of Joining is required. ";else{const w=L(f["Date of Joining"],"Date of Joining");w.isValid||(_+=w.error)}h.value[u]._status="error",h.value[u]._error=_.trim()}}),F.value=!1;return}const p=h.value.filter(n=>!P(n));if(p.length>0){b(`${p.length} rows have class selected but no division. Please either select a division or remove the class assignment.`,"warning"),p.forEach(n=>n._touched=!0),F.value=!1;return}try{b("Starting bulk enrollment process...","info");const n=h.value.filter(f=>P(f));if(n.length===0){b("No valid rows to enroll. Please check your data and mappings.","warning"),F.value=!1;return}console.log(`Starting bulk enrollment for ${n.length} teachers...`);const u=n.map(f=>M(f));yield se.submit({teachers:u,mappings:Object.fromEntries(t.value.filter(f=>f.type).map(f=>[f.type,f.column]))})}catch(n){console.error("Bulk enrollment process error:",n),b(`Bulk enrollment process failed: ${n.message||"Unknown error"}`,"error"),H("error","Bulk Enrollment Process Failed",n.message||"Unknown error occurred during enrollment."),F.value=!1}})}function Te(e){return new Promise((l,a)=>{const i=new FileReader;i.onload=p=>{try{const n=new Uint8Array(p.target.result),u=Ye(n,{type:"array",sheetStubs:!0}),f=u.Sheets[u.SheetNames[0]],_=U.decode_range(f["!ref"]);let w=0;for(let E=_.s.r;E<=_.e.r;++E){let R=!1;for(let G=_.s.c;G<=_.e.c;++G){const A=f[U.encode_cell({c:G,r:E})];if(A&&A.v!==void 0&&A.v!==null&&A.v!==""){R=!0;break}}if(R){w=E;break}}const J=[];for(let E=_.s.c;E<=_.e.c;++E){const R=f[U.encode_cell({c:E,r:w})];J.push(R?String(R.v).trim():`Column ${E+1}`)}const Q=[];for(let E=w+1;E<=_.e.r;++E){const R={};let G=!1;for(let A=_.s.c;A<=_.e.c;++A){const te=f[U.encode_cell({c:A,r:E})],ae=J[A-_.s.c];R[ae]=te?te.v===void 0?"":te.v:"",R[ae]!==""&&(G=!0)}G&&Q.push(R)}l({data:Q,headers:J})}catch(n){a(n)}},i.onerror=p=>a(p),i.readAsArrayBuffer(e)})}function Ae(e,l,a){t.value[e]=z(W({},t.value[e]),{[l]:a,column:U.encode_col(e)})}function Ie(e){h.value.splice(e,1),m.value=m.value.filter(l=>l.rowIndex!==e),D.value=D.value.filter(l=>l.rowIndex!==e),b("Row deleted","success")}function b(e,l="info"){x.value=e?{text:e,type:l}:null,e&&l!=="error"&&l!=="success"&&setTimeout(()=>b(null),5e3)}function Ve(e,l,a){const p=h.value[e][l]||"";if(p!==a){const n={rowIndex:e,column:l,oldValue:p,newValue:a,timestamp:new Date().toISOString()};m.value.push(n),D.value.push(n),console.log("Cell edit recorded:",n),Le()}}function Ue(e,l){let a;return function(...i){clearTimeout(a),a=setTimeout(()=>e.apply(this,i),l)}}const Le=Ue(Pe,500);function Pe(){return j(this,null,function*(){if(D.value.length!==0)try{const e=D.value[D.value.length-1],l=h.value[e.rowIndex],a=M(l);yield se.submit({teachers:[a],mappings:Object.fromEntries(t.value.filter(i=>i.type).map(i=>[i.type,i.column]))}),D.value=[]}catch(e){console.error("Error sending cell update:",e),b(`Failed to save cell update: ${e.message||"Unknown error"}`,"error")}})}return{mappings:t,fileSelected:k,options:o,message:x,previewData:h,previewHeaders:r,classes:g,editHistory:m,pendingEdits:D,enrolledTeachers:C,failedEnrollments:I,enrollmentSummary:O,processing:F,showResultModal:X,resultModalType:Y,resultModalTitle:Z,resultModalDescription:$,showErrorTeachersList:N,validRowsCount:de,classTeachersCount:ue,invalidRowsCount:me,errorRows:fe,filteredHeaders:ve,filteredMappings:he,getTeacherFullName:ge,getTeacherEmail:pe,getTeacherMobile:_e,getRowError:be,classesResource:ne,divisionsResource:ee,enrollTeachersResource:se,onClassChange:ke,getExcelColumnLetter:ye,handleFileSelection:De,removeFile:we,handleEnrollTeachers:Be,updateMapping:Ae,deleteRow:Ie,showMessage:b,handleCellEdit:Ve,closeResultModal:Me,isRowValid:P,markRowAsTouched:Ne,getRowStatusClass:Ce,validDate:We,getTodayDate:ze}}},$e={class:"enrollment-container"},es={class:"scroll-view-content"},ss={class:"form-card"},ts={class:"form-section"},ls={key:0,class:"file-selected"},os={class:"button-content"},ns={class:"enroll-button-section"},as=["disabled"],rs={class:"button-content"},is={key:0,class:"spinner"},cs={key:0,class:"form-card summary-card"},ds={class:"summary-stats"},us={class:"stat-item"},ms={class:"stat-value"},fs={class:"stat-item"},vs={class:"stat-value valid"},hs={class:"stat-item"},gs={class:"stat-value warning"},ps={key:0,class:"success-details"},_s={class:"section-title"},bs={class:"results-list"},ks={key:1,class:"error-details"},ys={class:"section-title"},Ds={class:"results-list"},Es={class:"error-student"},ws={class:"student-details"},Ns={class:"error-text"},Cs={key:1,class:"form-card preview-card"},Ss={class:"summary-stats"},Rs={class:"stat-item"},Fs={class:"stat-value"},Ms={class:"stat-item"},Bs={class:"stat-value valid"},Ts={class:"stat-item"},As={class:"stat-value info"},Is={class:"stat-item"},Vs=["title"],Us={key:0,class:"error-indicator"},Ls={key:0,class:"error-students-card"},Ps={class:"section-title"},xs={class:"error-details",style:{"max-height":"200px","overflow-y":"auto"}},Js={class:"results-list"},Gs={class:"error-student"},js={class:"student-details"},qs={class:"error-text"},Os={key:0,class:"multiple-errors"},Hs={key:1},Qs={key:1,class:"table-spacing"},Ws={class:"table-container-wrapper"},zs={class:"table-scroll-container"},Ks={class:"table-container"},Xs={class:"preview-table"},Ys=["onUpdate:modelValue","onChange"],Zs=["value"],$s={class:"header-label"},et={class:"actions"},st=["onClick"],tt={class:"status-cell"},lt={key:0,class:"status-badge success"},ot={key:1,class:"status-badge error"},nt={key:2,class:"status-badge warning"},at={key:3,class:"status-badge pending"},rt={key:4,class:"error-tooltip"},it=["onUpdate:modelValue","onChange","disabled"],ct=["value"],dt=["onUpdate:modelValue","disabled"],ut=["value"],mt={key:0,class:"field-hint"},ft=["onUpdate:modelValue","onInput","onBlur","placeholder"],vt={key:2,class:"loading-overlay"},ht={key:3,class:"modal-overlay"},gt={class:"result-modal"},pt={key:0,class:"success-icon"},_t={key:1,class:"error-icon"},bt={class:"result-title"},kt={class:"result-description"},yt={class:"modal-actions"};function Dt(N,t,k,o,x,h){return d(),c("div",$e,[s("div",es,[t[34]||(t[34]=s("div",{class:"header"},[s("h1",{class:"title"},"Teacher Enrollment")],-1)),s("div",ss,[t[6]||(t[6]=s("h2",{class:"form-title"},"Upload Teacher Data",-1)),s("div",ts,[o.fileSelected?(d(),c("div",ls,[s("span",null,"Selected file: "+v(o.fileSelected.name),1),s("button",{onClick:t[0]||(t[0]=(...r)=>o.removeFile&&o.removeFile(...r)),class:"remove-file-btn"},"×")])):S("",!0),s("button",{class:"secondary-button",onClick:t[1]||(t[1]=(...r)=>o.handleFileSelection&&o.handleFileSelection(...r))},[s("span",os,v(o.fileSelected?"Change File":"Upload File 📤"),1)]),s("div",ns,[s("button",{class:"enroll-button",onClick:t[2]||(t[2]=(...r)=>o.handleEnrollTeachers&&o.handleEnrollTeachers(...r)),disabled:o.processing||!o.fileSelected},[s("span",rs,[o.processing?(d(),c("span",is)):S("",!0),V(" "+v(o.processing?"Processing...":"Enroll Teachers"),1)])],8,as)]),o.message?(d(),c("div",{key:1,class:ce(["message",o.message.type])},v(o.message.text),3)):S("",!0)])]),o.enrollmentSummary.total_processed>0?(d(),c("div",cs,[t[12]||(t[12]=s("h2",{class:"form-title"},"Enrollment Summary",-1)),s("div",ds,[s("div",us,[t[7]||(t[7]=s("span",{class:"stat-label"},"Total Processed",-1)),s("span",ms,v(o.enrollmentSummary.total_processed),1)]),s("div",fs,[t[8]||(t[8]=s("span",{class:"stat-label"},"Successful",-1)),s("span",vs,v(o.enrollmentSummary.successful),1)]),s("div",hs,[t[9]||(t[9]=s("span",{class:"stat-label"},"Failed",-1)),s("span",gs,v(o.enrollmentSummary.failed),1)])]),o.enrolledTeachers.length>0?(d(),c("div",ps,[s("h4",_s,"Successfully Enrolled ("+v(o.enrolledTeachers.length)+")",1),s("div",bs,[(d(!0),c(B,null,T(o.enrolledTeachers,(r,g)=>(d(),c("div",{key:g,class:"success-message"},[t[10]||(t[10]=s("span",{class:"status-badge success"},"Success",-1)),V(" "+v(r),1)]))),128))])])):S("",!0),o.failedEnrollments.length>0?(d(),c("div",ks,[s("h4",ys,"Enrollment Errors ("+v(o.failedEnrollments.length)+")",1),s("div",Ds,[(d(!0),c(B,null,T(o.failedEnrollments,(r,g)=>(d(),c("div",{key:g,class:"error-message"},[s("div",Es,[s("strong",null,v(r.instructor_data["First Name"])+" "+v(r.instructor_data["Middle Name"])+" "+v(r.instructor_data["Last Name"]),1),s("span",ws,"(Email: "+v(r.instructor_data.Email)+", Mobile: "+v(r.instructor_data.Mobile)+")",1)]),s("div",Ns,[t[11]||(t[11]=s("span",{class:"status-badge error"},"Error",-1)),V(" "+v(r.error),1)])]))),128))])])):S("",!0)])):S("",!0),o.fileSelected&&o.previewData.length>0?(d(),c("div",Cs,[t[29]||(t[29]=s("h2",{class:"form-title"},"File Preview (First 100 rows)",-1)),s("div",Ss,[s("div",Rs,[t[13]||(t[13]=s("span",{class:"stat-label"},"Total Rows:",-1)),s("span",Fs,v(o.previewData.length),1)]),s("div",Ms,[t[14]||(t[14]=s("span",{class:"stat-label"},"Ready to Enroll:",-1)),s("span",Bs,v(o.validRowsCount),1)]),s("div",Ts,[t[15]||(t[15]=s("span",{class:"stat-label"},"Class Teachers:",-1)),s("span",As,v(o.classTeachersCount),1)]),s("div",Is,[t[16]||(t[16]=s("span",{class:"stat-label"},"Need Attention:",-1)),s("span",{class:"stat-value warning",style:{cursor:"pointer"},onClick:t[3]||(t[3]=r=>o.showErrorTeachersList=!o.showErrorTeachersList),title:o.invalidRowsCount>0?"Click to view teachers with errors":""},[V(v(o.invalidRowsCount)+" ",1),o.invalidRowsCount>0?(d(),c("span",Us,"⚠️")):S("",!0)],8,Vs)])]),o.showErrorTeachersList&&o.errorRows.length>0?(d(),c("div",Ls,[s("h4",Ps,"Teachers with Errors ("+v(o.invalidRowsCount)+")",1),s("div",xs,[s("div",Js,[(d(!0),c(B,null,T(o.errorRows,(r,g)=>(d(),c("div",{key:g,class:"error-message"},[s("div",Gs,[s("strong",null,v(o.getTeacherFullName(r)),1),s("span",js," (Email: "+v(o.getTeacherEmail(r))+", Mobile: "+v(o.getTeacherMobile(r))+") ",1)]),s("div",qs,[t[17]||(t[17]=s("span",{class:"status-badge warning"},"Warning",-1)),o.getRowError(r).includes(";")?(d(),c("span",Os,v(o.getRowError(r)),1)):(d(),c("span",Hs,v(o.getRowError(r)),1))])]))),128))])])])):S("",!0),t[30]||(t[30]=s("div",{class:"instructions"},[s("p",null,[V("💡 "),s("strong",null,"Note:"),V(" Class and Division are optional fields. Only assign them for teachers who are class teachers.")])],-1)),o.showErrorTeachersList&&o.errorRows.length>0?(d(),c("div",Qs)):S("",!0),s("div",Ws,[s("div",zs,[s("div",Ks,[s("table",Xs,[s("thead",null,[s("tr",null,[t[18]||(t[18]=s("th",{class:"actions"},"Actions",-1)),t[19]||(t[19]=s("th",{class:"status-cell"},"Status",-1)),t[20]||(t[20]=s("th",null,[V("Class/Program "),s("span",{class:"optional"},"(Optional)")],-1)),t[21]||(t[21]=s("th",null,[V("Division/Student Group "),s("span",{class:"optional"},"(Optional)")],-1)),(d(!0),c(B,null,T(o.filteredHeaders,(r,g)=>(d(),c("th",{key:"letter-"+g},v(o.getExcelColumnLetter(g)),1))),128))]),s("tr",null,[t[23]||(t[23]=s("th",{class:"actions"},null,-1)),t[24]||(t[24]=s("th",{class:"status-cell"},null,-1)),t[25]||(t[25]=s("th",null,"Class/Program",-1)),t[26]||(t[26]=s("th",null,"Division/Student Group",-1)),(d(!0),c(B,null,T(o.filteredHeaders,(r,g)=>(d(),c("th",{key:"header-"+g},[K(s("select",{"onUpdate:modelValue":m=>o.filteredMappings[g].type=m,class:"table-select",onChange:m=>o.updateMapping(o.filteredMappings[g].originalIndex,"type",m.target.value)},[t[22]||(t[22]=s("option",{value:null},"Select Field",-1)),(d(!0),c(B,null,T(o.options,(m,D)=>(d(),c("option",{key:D,value:m},v(m),9,Zs))),128))],40,Ys),[[oe,o.filteredMappings[g].type]]),s("span",$s,v(r),1)]))),128))])]),s("tbody",null,[(d(!0),c(B,null,T(o.previewData,(r,g)=>(d(),c("tr",{key:g,class:ce(o.getRowStatusClass(r))},[s("td",et,[s("button",{onClick:m=>o.deleteRow(g),class:"trash-icon"}," Delete ",8,st)]),s("td",tt,[r._status==="success"?(d(),c("span",lt,"Success")):r._status==="error"?(d(),c("span",ot,"Error")):o.isRowValid(r)?(d(),c("span",at,"Pending")):(d(),c("span",nt,"Warning")),r._error?(d(),c("div",rt,v(r._error),1)):S("",!0)]),s("td",null,[K(s("select",{"onUpdate:modelValue":m=>r.className=m,class:"table-select",onChange:m=>o.onClassChange(g),disabled:o.classesResource.loading},[t[27]||(t[27]=s("option",{value:null},"Not a Class Teacher",-1)),(d(!0),c(B,null,T(o.classes,m=>(d(),c("option",{key:m.name,value:m.name},v(m.name),9,ct))),128))],40,it),[[oe,r.className]])]),s("td",null,[K(s("select",{"onUpdate:modelValue":m=>r.divisionName=m,class:"table-select",disabled:!r.className||o.divisionsResource.loading},[t[28]||(t[28]=s("option",{value:null},"Select Division",-1)),(d(!0),c(B,null,T(r.divisions,m=>(d(),c("option",{key:m.name,value:m.name},v(m.name),9,ut))),128))],8,dt),[[oe,r.divisionName]]),r.className&&!r.divisionName?(d(),c("div",mt," Select division if this teacher is a class teacher ")):S("",!0)]),(d(!0),c(B,null,T(o.filteredHeaders,(m,D)=>(d(),c("td",{key:D},[K(s("input",{"onUpdate:modelValue":C=>r[m]=C,class:"table-input",onInput:C=>o.handleCellEdit(g,m,C.target.value),onBlur:C=>o.markRowAsTouched(g),placeholder:r[m]||"-"},null,40,ft),[[Qe,r[m]]])]))),128))],2))),128))])])])])])])):S("",!0),o.processing?(d(),c("div",vt,t[31]||(t[31]=[s("div",{class:"loading-modal"},[s("div",{class:"loading-spinner"}),s("h3",{class:"loading-title"},"Enrolling Teachers"),s("p",{class:"loading-description"},"Please wait while we process the teacher data...")],-1)]))):S("",!0),o.showResultModal?(d(),c("div",ht,[s("div",gt,[o.resultModalType==="success"?(d(),c("div",pt,t[32]||(t[32]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(d(),c("div",_t,t[33]||(t[33]=[s("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",bt,v(o.resultModalTitle),1),s("p",kt,v(o.resultModalDescription),1),s("div",yt,[o.resultModalType==="success"?(d(),c("button",{key:0,class:"success-button",onClick:t[4]||(t[4]=(...r)=>o.closeResultModal&&o.closeResultModal(...r))}," Continue ")):(d(),c("button",{key:1,class:"primary-button",onClick:t[5]||(t[5]=(...r)=>o.closeResultModal&&o.closeResultModal(...r))}," Try Again "))])])])):S("",!0)])])}const St=Oe(Ze,[["render",Dt]]);export{St as default};
