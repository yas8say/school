var Z=Object.defineProperty;var B=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var q=(o,a,v)=>a in o?Z(o,a,{enumerable:!0,configurable:!0,writable:!0,value:v}):o[a]=v,L=(o,a)=>{for(var v in a||(a={}))J.call(a,v)&&q(o,v,a[v]);if(B)for(var v of B(a))K.call(a,v)&&q(o,v,a[v]);return o};import{_ as Q,q as O,r as g,y as X,j as _,k as $,c as n,b as s,l as c,t as m,f as d,g as G,F as S,h,v as f,z as aa,i as j,n as ea,o as i}from"./index-AyqD_6TW.js";/* empty css             */const sa={setup(){const o=O({academicYear:null,className:null,divisionName:null,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),a=g([]),v=X(()=>a.value.map((r,l)=>({original:r,display:l===0?`${r} - Current Year`:r}))),e=g([]),b=g([]),p=g(!1),t=g(null),u=O({}),D=g(!1),y=g(!1),R=g(""),A=g(""),Y=_({url:"school.al_ummah.api3.get_academic_years",params:{values:{}},onSuccess:r=>{a.value=Array.isArray(r)?r:[],a.value.length>0&&(o.academicYear=a.value[0]),a.value.length||N("No academic years available","error")},onError:r=>{var l;console.error("Error fetching academic years:",r),a.value=[],N(`Error fetching academic years: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),V=_({url:"school.al_ummah.api3.get_classes",params:{values:{}},onSuccess:r=>{e.value=Array.isArray(r)?r:[],console.log("Classes loaded:",e.value),e.value.length||N("No classes available","error")},onError:r=>{var l;console.error("Error fetching classes:",r),e.value=[],N(`Error fetching classes: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),k=_({url:"school.al_ummah.api3.get_divisions2",params:{values:{classId:o.className,academicYear:o.academicYear}},onSuccess:r=>{b.value=Array.isArray(r)?r:[],console.log("Divisions loaded:",b.value)},onError:r=>{var l;console.error("Error fetching divisions:",r),b.value=[],N(`Error fetching divisions: ${((l=r.messages)==null?void 0:l[0])||"Unknown error"}`,"error")}}),E=_({url:"school.al_ummah.api3.enroll_single_student",params:{academicYear:o.academicYear,className:o.className,divisionName:o.divisionName,student_data:o.student_data},onSuccess:r=>{p.value=!1,y.value=!0,A.value=`Student ${o.student_data["First Name"]} ${o.student_data["Last Name"]} has been successfully enrolled in ${o.className} - ${o.divisionName} for the ${o.academicYear} academic year.`,D.value=!0},onError:r=>{var l;p.value=!1,y.value=!1,R.value=((l=r.messages)==null?void 0:l[0])||"An unexpected error occurred while enrolling the student. Please try again.",D.value=!0}});$(()=>{Y.reload(),V.reload()});function H(){o.className=null,o.divisionName=null,b.value=[],u.className="",u.divisionName="",C()}function C(){o.divisionName=null,u.divisionName="",o.className&&o.academicYear?(k.update({params:{values:{classId:o.className,academicYear:o.academicYear}}}),k.reload()):b.value=[]}function W(){Object.assign(u,{});let r=!0;o.academicYear||(u.academicYear="Please select an academic year",r=!1),o.className||(u.className="Please select a class",r=!1),o.divisionName||(u.divisionName="Please select a division",r=!1),o.student_data["First Name"].trim()||(u.firstName="First name is required",r=!1),o.student_data["Last Name"].trim()||(u.lastName="Last name is required",r=!1),o.student_data["GR Number"].trim()||(u.grNumber="GR number is required",r=!1);const l=o.student_data["Email Address"].trim();l&&!M(l)&&(u.email="Please enter a valid email",r=!1);const x=o.student_data["Phone Number"].trim();x&&!w(x)&&(u.phone="Please enter a valid phone number (10-15 digits)",r=!1);const P=o.student_data["Guardian Number"].trim();P&&!w(P)&&(u.guardianNumber="Please enter a valid guardian phone number (10-15 digits)",r=!1);const F=o.student_data["Guardian Email"].trim();return F?M(F)||(u.guardianEmail="Please enter a valid guardian email",r=!1):(u.guardianEmail="Guardian email is required",r=!1),r}function M(r){return r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r):!0}function w(r){return r?/^[0-9]{10,15}$/.test(r):!0}function I(){W()&&T()}function T(){p.value=!0,E.update({params:{academicYear:o.academicYear,className:o.className,divisionName:o.divisionName,student_data:L({},o.student_data)}}),E.submit()}function U(){Object.assign(o,{academicYear:a.value.length>0?a.value[0]:null,className:null,divisionName:null,student_data:{"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","GR Number":"","Email Address":"","Phone Number":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Date of Birth":"","Guardian Email":"","Guardian Occupation":"","Guardian Designation":"","Guardian Work Address":"","Guardian Education":""}}),b.value=[],Object.assign(u,{}),t.value=null}function z(){U(),D.value=!1,y.value=!1}function N(r,l="info"){t.value={text:r,type:l},l!=="error"&&setTimeout(()=>t.value=null,5e3)}return{formData:o,academicYears:a,displayYears:v,classes:e,divisions:b,isSubmitting:p,message:t,errors:u,academicYearsResource:Y,classesResource:V,divisionsResource:k,enrollStudentResource:E,showResultMessage:D,submitSuccess:y,errorMessage:R,successMessage:A,onYearChange:H,onClassChange:C,validateAndSubmit:I,resetForm:U,resetAndClose:z}}},ta={class:"enrollment-form"},ra={key:0,class:"loading-overlay"},oa={key:1,class:"modal-overlay"},na={class:"result-modal"},ia={key:0,class:"success-icon"},la={key:1,class:"error-icon"},da={class:"result-title"},ua={class:"result-description"},ma={class:"modal-actions"},ca={class:"form-card"},fa={class:"form-grid"},va={class:"form-group required"},ga=["disabled"],ba=["value"],pa={key:0,class:"error-message"},Na={class:"form-group required"},Da=["disabled"],ya=["value"],_a={key:0,class:"error-message"},Ga={key:0,class:"form-group required"},ka=["disabled"],Ea=["value"],Sa={key:0,class:"error-message"},ha={class:"form-section"},Ra={class:"form-grid"},Aa={class:"form-group required"},Ya={key:0,class:"error-message"},Va={class:"form-group"},Ca={class:"form-group required"},Ma={key:0,class:"error-message"},wa={class:"form-group"},Ua={key:0,class:"error-message"},xa={class:"form-group required"},Pa={key:0,class:"error-message"},Fa={class:"form-group required"},Ba={key:0,class:"error-message"},qa={class:"form-group"},La={key:0,class:"error-message"},Oa={class:"form-section"},ja={class:"form-grid"},Ha={class:"form-group"},Wa={class:"form-group"},Ia={key:0,class:"error-message"},Ta={class:"form-group"},za={class:"form-group"},Za={class:"form-group required"},Ja={key:0,class:"error-message"},Ka={class:"form-group"},Qa={class:"form-group"},Xa={class:"form-group"},$a={class:"form-group"},ae={class:"form-actions"},ee=["disabled"],se={key:0,class:"button-content"},te={key:1,class:"button-content"},re=["disabled"];function oe(o,a,v,e,b,p){return i(),n("div",ta,[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("div",ra,a[26]||(a[26]=[s("div",{class:"loading-modal"},[s("div",{class:"loading-spinner"}),s("h3",{class:"loading-title"},"Enrolling Student..."),s("p",{class:"loading-description"},"Please wait while we process the student information.")],-1)]))):c("",!0),e.showResultMessage?(i(),n("div",oa,[s("div",na,[e.submitSuccess?(i(),n("div",ia,a[27]||(a[27]=[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(i(),n("div",la,a[28]||(a[28]=[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",da,m(e.submitSuccess?"Student Enrolled Successfully!":"Enrollment Failed"),1),s("p",ua,m(e.submitSuccess?e.successMessage:e.errorMessage),1),s("div",ma,[e.submitSuccess?(i(),n("button",{key:0,onClick:a[0]||(a[0]=(...t)=>e.resetAndClose&&e.resetAndClose(...t)),class:"success-button"}," Add Another Student ")):(i(),n("button",{key:1,onClick:a[1]||(a[1]=t=>e.showResultMessage=!1),class:"primary-button"}," Try Again ")),e.submitSuccess?(i(),n("button",{key:2,onClick:a[2]||(a[2]=t=>e.showResultMessage=!1),class:"secondary-button"}," Close ")):c("",!0)])])])):c("",!0),a[57]||(a[57]=s("div",{class:"header"},[s("h1",{class:"title"},"Student Enrollment"),s("p",{class:"subtitle"},"Add new student to the system")],-1)),s("div",ca,[a[56]||(a[56]=s("h2",{class:"form-title"},"Student Information",-1)),s("div",fa,[s("div",va,[a[30]||(a[30]=s("label",null,"Academic Year",-1)),d(s("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.formData.academicYear=t),class:"picker",onChange:a[4]||(a[4]=(...t)=>e.onYearChange&&e.onYearChange(...t)),disabled:e.academicYearsResource.loading},[a[29]||(a[29]=s("option",{value:null},"Select Academic Year",-1)),(i(!0),n(S,null,h(e.displayYears,t=>(i(),n("option",{key:t,value:t.original},m(t.display),9,ba))),128))],40,ga),[[G,e.formData.academicYear]]),e.errors.academicYear?(i(),n("span",pa,m(e.errors.academicYear),1)):c("",!0)]),s("div",Na,[a[32]||(a[32]=s("label",null,"Class / Program",-1)),d(s("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>e.formData.className=t),class:"picker",onChange:a[6]||(a[6]=(...t)=>e.onClassChange&&e.onClassChange(...t)),disabled:!e.formData.academicYear||e.classesResource.loading},[a[31]||(a[31]=s("option",{value:null},"Select Class / Program",-1)),(i(!0),n(S,null,h(e.classes,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,ya))),128))],40,Da),[[G,e.formData.className]]),e.errors.className?(i(),n("span",_a,m(e.errors.className),1)):c("",!0)]),e.divisions.length>0?(i(),n("div",Ga,[a[34]||(a[34]=s("label",null,"Division / Student Group",-1)),d(s("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>e.formData.divisionName=t),class:"picker",disabled:!e.formData.className||e.divisionsResource.loading},[a[33]||(a[33]=s("option",{value:null},"Select Division / Student Group",-1)),(i(!0),n(S,null,h(e.divisions,t=>(i(),n("option",{key:t.name,value:t.name},m(t.name),9,Ea))),128))],8,ka),[[G,e.formData.divisionName]]),e.errors.divisionName?(i(),n("span",Sa,m(e.errors.divisionName),1)):c("",!0)])):c("",!0)]),s("div",ha,[a[42]||(a[42]=s("h3",{class:"section-title"},"Personal Details",-1)),s("div",Ra,[s("div",Aa,[a[35]||(a[35]=s("label",null,"First Name",-1)),d(s("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>e.formData.student_data["First Name"]=t),type:"text",class:"input",placeholder:"Enter first name",required:""},null,512),[[f,e.formData.student_data["First Name"]]]),e.errors.firstName?(i(),n("span",Ya,m(e.errors.firstName),1)):c("",!0)]),s("div",Va,[a[36]||(a[36]=s("label",null,"Middle Name",-1)),d(s("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>e.formData.student_data["Middle Name"]=t),type:"text",class:"input",placeholder:"Enter middle name"},null,512),[[f,e.formData.student_data["Middle Name"]]])]),s("div",Ca,[a[37]||(a[37]=s("label",null,"Last Name",-1)),d(s("input",{"onUpdate:modelValue":a[10]||(a[10]=t=>e.formData.student_data["Last Name"]=t),type:"text",class:"input",placeholder:"Enter last name",required:""},null,512),[[f,e.formData.student_data["Last Name"]]]),e.errors.lastName?(i(),n("span",Ma,m(e.errors.lastName),1)):c("",!0)]),s("div",wa,[a[38]||(a[38]=s("label",null,"Student Date of Birth",-1)),d(s("input",{"onUpdate:modelValue":a[11]||(a[11]=t=>e.formData.student_data["Student Date of Birth"]=t),type:"date",class:"input",required:""},null,512),[[f,e.formData.student_data["Student Date of Birth"]]]),e.errors.studentDob?(i(),n("span",Ua,m(e.errors.studentDob),1)):c("",!0)]),s("div",xa,[a[39]||(a[39]=s("label",null,"GR Number",-1)),d(s("input",{"onUpdate:modelValue":a[12]||(a[12]=t=>e.formData.student_data["GR Number"]=t),type:"text",class:"input",placeholder:"Enter GR number",required:""},null,512),[[f,e.formData.student_data["GR Number"]]]),e.errors.grNumber?(i(),n("span",Pa,m(e.errors.grNumber),1)):c("",!0)]),s("div",Fa,[a[40]||(a[40]=s("label",null,"Email Address",-1)),d(s("input",{"onUpdate:modelValue":a[13]||(a[13]=t=>e.formData.student_data["Email Address"]=t),type:"email",class:"input",placeholder:"Enter email address"},null,512),[[f,e.formData.student_data["Email Address"]]]),e.errors.email?(i(),n("span",Ba,m(e.errors.email),1)):c("",!0)]),s("div",qa,[a[41]||(a[41]=s("label",null,"Phone Number",-1)),d(s("input",{"onUpdate:modelValue":a[14]||(a[14]=t=>e.formData.student_data["Phone Number"]=t),type:"tel",class:"input",placeholder:"Enter phone number"},null,512),[[f,e.formData.student_data["Phone Number"]]]),e.errors.phone?(i(),n("span",La,m(e.errors.phone),1)):c("",!0)])])]),s("div",Oa,[a[53]||(a[53]=s("h3",{class:"section-title"},"Guardian Information",-1)),s("div",ja,[s("div",Ha,[a[43]||(a[43]=s("label",null,"Guardian Name",-1)),d(s("input",{"onUpdate:modelValue":a[15]||(a[15]=t=>e.formData.student_data["Guardian Name"]=t),type:"text",class:"input",placeholder:"Enter guardian name"},null,512),[[f,e.formData.student_data["Guardian Name"]]])]),s("div",Wa,[a[44]||(a[44]=s("label",null,"Guardian Number",-1)),d(s("input",{"onUpdate:modelValue":a[16]||(a[16]=t=>e.formData.student_data["Guardian Number"]=t),type:"tel",class:"input",placeholder:"Enter guardian phone number"},null,512),[[f,e.formData.student_data["Guardian Number"]]]),e.errors.guardianNumber?(i(),n("span",Ia,m(e.errors.guardianNumber),1)):c("",!0)]),s("div",Ta,[a[46]||(a[46]=s("label",null,"Relation",-1)),d(s("select",{"onUpdate:modelValue":a[17]||(a[17]=t=>e.formData.student_data.Relation=t),class:"picker"},a[45]||(a[45]=[aa('<option value="">Select Relation</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Brother">Brother</option><option value="Sister">Sister</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Guardian">Guardian</option><option value="Other">Other</option>',11)]),512),[[G,e.formData.student_data.Relation]])]),s("div",za,[a[47]||(a[47]=s("label",null,"Guardian Date of Birth",-1)),d(s("input",{"onUpdate:modelValue":a[18]||(a[18]=t=>e.formData.student_data["Guardian Date of Birth"]=t),type:"date",class:"input"},null,512),[[f,e.formData.student_data["Guardian Date of Birth"]]])]),s("div",Za,[a[48]||(a[48]=s("label",null,"Guardian Email",-1)),d(s("input",{"onUpdate:modelValue":a[19]||(a[19]=t=>e.formData.student_data["Guardian Email"]=t),type:"email",class:"input",placeholder:"Enter guardian email"},null,512),[[f,e.formData.student_data["Guardian Email"]]]),e.errors.guardianEmail?(i(),n("span",Ja,m(e.errors.guardianEmail),1)):c("",!0)]),s("div",Ka,[a[49]||(a[49]=s("label",null,"Guardian Occupation",-1)),d(s("input",{"onUpdate:modelValue":a[20]||(a[20]=t=>e.formData.student_data["Guardian Occupation"]=t),type:"text",class:"input",placeholder:"Enter guardian occupation"},null,512),[[f,e.formData.student_data["Guardian Occupation"]]])]),s("div",Qa,[a[50]||(a[50]=s("label",null,"Guardian Designation",-1)),d(s("input",{"onUpdate:modelValue":a[21]||(a[21]=t=>e.formData.student_data["Guardian Designation"]=t),type:"text",class:"input",placeholder:"Enter guardian designation"},null,512),[[f,e.formData.student_data["Guardian Designation"]]])]),s("div",Xa,[a[51]||(a[51]=s("label",null,"Guardian Education",-1)),d(s("input",{"onUpdate:modelValue":a[22]||(a[22]=t=>e.formData.student_data["Guardian Education"]=t),type:"text",class:"input",placeholder:"Enter guardian education"},null,512),[[f,e.formData.student_data["Guardian Education"]]])]),s("div",$a,[a[52]||(a[52]=s("label",null,"Guardian Work Address",-1)),d(s("textarea",{"onUpdate:modelValue":a[23]||(a[23]=t=>e.formData.student_data["Guardian Work Address"]=t),class:"input textarea",placeholder:"Enter guardian work address",rows:"3"},null,512),[[f,e.formData.student_data["Guardian Work Address"]]])])])]),s("div",ae,[s("button",{class:"enroll-button",onClick:a[24]||(a[24]=(...t)=>e.validateAndSubmit&&e.validateAndSubmit(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage},[e.isSubmitting||e.enrollStudentResource.loading?(i(),n("span",se,a[54]||(a[54]=[s("span",{class:"spinner"},null,-1),j(" Processing... ")]))):(i(),n("span",te,a[55]||(a[55]=[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1),j(" Enroll Student ")])))],8,ee),s("button",{class:"reset-button",onClick:a[25]||(a[25]=(...t)=>e.resetForm&&e.resetForm(...t)),disabled:e.isSubmitting||e.enrollStudentResource.loading||e.showResultMessage}," Reset Form ",8,re)]),e.message&&!e.showResultMessage?(i(),n("div",{key:0,class:ea(["message",e.message.type])},m(e.message.text),3)):c("",!0)])])}const de=Q(sa,[["render",oe]]);export{de as default};
