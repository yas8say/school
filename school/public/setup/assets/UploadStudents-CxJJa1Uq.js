var He=Object.defineProperty,ze=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var ge=(w,t,S)=>t in w?He(w,t,{enumerable:!0,configurable:!0,writable:!0,value:S}):w[t]=S,ae=(w,t)=>{for(var S in t||(t={}))Je.call(t,S)&&ge(w,S,t[S]);if(he)for(var S of he(t))Ke.call(t,S)&&ge(w,S,t[S]);return w},re=(w,t)=>ze(w,We(t));var H=(w,t,S)=>new Promise((s,M)=>{var V=u=>{try{f(S.next(u))}catch(E){M(E)}},o=u=>{try{f(S.throw(u))}catch(E){M(E)}},f=u=>u.done?s(u.value):Promise.resolve(u.value).then(V,o);f((S=S.apply(w,t)).next())});import{_ as Qe,r as y,y as K,j as Q,k as Xe,c as i,b as l,l as k,t as v,f as z,g as X,F as B,h as G,i as ie,n as _e,o as d,v as Ze}from"./index-DWsDgi70.js";import{v as pe,g as $e,u as C,p as es,f as ss,a as W,r as ts}from"./dateUtils-CshPDU0n.js";/* empty css             */const ls={setup(){const w=y(!1),t=y([]),S=K(()=>t.value.map((e,n)=>({original:e,display:n===0?`${e} - Current Year`:e}))),s=y(null),M=y([]),V=y([]),o=y(null),f=y(null),u=y([]),E=y(null),x=y(["First Name","Middle Name","Last Name","Student Date of Birth","Email Address","Phone Number","GR Number","Roll No","Guardian Name","Guardian Number","Guardian Email","Relation","Guardian Date of Birth"]),de=y(null),_=y([]),L=y([]),q=y([]),U=y([]),A=y([]),T=y([]),O=y({total_processed:0,successful:0,failed:0}),D=y(!1),Z=y(!1),$=y("success"),ee=y(""),se=y(""),ye=K(()=>_.value.filter(e=>I(e)).length),be=K(()=>_.value.filter(e=>!I(e)).length),Se=K(()=>_.value.filter(e=>!I(e)));function ke(e){const n=F(e);return`${n["First Name"]||""} ${n["Middle Name"]||""} ${n["Last Name"]||""}`.trim()||"Unknown Student"}function we(e){return F(e)["GR Number"]||"N/A"}function Re(e){return F(e)["Roll No"]||"N/A"}function Ne(e){const n=[];["First Name","Last Name","GR Number","Roll No"].forEach(m=>{const h=u.value.findIndex(g=>g.type===m);if(h===-1)n.push(`${m} not mapped`);else{const g=C.decode_col(u.value[h].column),b=L.value[g],R=e[b];(!R||R.toString().trim()==="")&&n.push(`${m} missing`)}});const c=F(e),r=W(c["Student Date of Birth"],"Student Date of Birth");return r.isValid||n.push(r.error),n.length>0?n.join("; "):"Check field mappings"}const ue=Q({url:"school.al_ummah.api4.get_academic_years",params:{values:{}},onSuccess:e=>{t.value=Array.isArray(e)?e:[],t.value.length>0&&(s.value=t.value[0]),t.value.length||p("No academic years available","error")},onError:e=>{var n;console.error("Error fetching academic years:",e),t.value=[],p(`Error fetching academic years: ${((n=e.messages)==null?void 0:n[0])||"Unknown error"}`,"error")}}),ce=Q({url:"school.al_ummah.api4.get_classes",params:{values:{}},onSuccess:e=>{M.value=Array.isArray(e)?e:[],console.log("Classes loaded:",M.value),M.value.length||p("No classes available","error")},onError:e=>{var n;console.error("Error fetching classes:",e),M.value=[],p(`Error fetching classes: ${((n=e.messages)==null?void 0:n[0])||"Unknown error"}`,"error")}}),te=Q({url:"school.al_ummah.api4.get_divisions2",params:{values:{classId:o.value,academicYear:s.value}},onSuccess:e=>{V.value=Array.isArray(e)?e:[],console.log("Divisions loaded:",V.value)},onError:e=>{var n;console.error("Error fetching divisions:",e),V.value=[],p(`Error fetching divisions: ${((n=e.messages)==null?void 0:n[0])||"Unknown error"}`,"error")}}),le=Q({url:"school.al_ummah.api4.bulk_enroll_students",method:"POST",onSuccess:e=>{console.log("Bulk enrollment successful:",e),D.value=!1,e&&e.success?(A.value=e.enrolled_students||[],T.value=e.failed_enrollments||[],O.value=e.summary||{total_processed:e.enrolled_students.length+e.failed_enrollments.length,successful:e.enrolled_students.length,failed:e.failed_enrollments.length},Me(e.enrolled_students,e.failed_enrollments),T.value.length===0?(p(`âœ… Successfully enrolled all ${A.value.length} students!`,"success"),J("success","Enrollment Complete",`Successfully enrolled all ${A.value.length} students!`)):(p(`Completed: ${A.value.length} successful, ${T.value.length} failed.`,"warning"),J("warning","Enrollment Completed with Errors",`Completed with ${A.value.length} successful enrollments and ${T.value.length} failures.`))):p("Bulk enrollment completed with issues","warning")},onError:e=>{var n,a;console.error("Error in bulk enrollment:",e),D.value=!1,p(`Bulk enrollment failed: ${((n=e.messages)==null?void 0:n[0])||e.message||"Unknown error"}`,"error"),J("error","Bulk Enrollment Failed",((a=e.messages)==null?void 0:a[0])||e.message||"Unknown error occurred during bulk enrollment.")}});Xe(()=>{ue.reload(),ce.reload()});function Ee(){o.value=null,f.value=null,V.value=[],me()}function me(){f.value=null,V.value=[],o.value&&s.value&&(te.update({params:{values:{classId:o.value,academicYear:s.value}}}),te.reload())}function Ce(e){let n="";for(;e>=0;)n=String.fromCharCode(65+e%26)+n,e=Math.floor(e/26)-1;return n}function De(){return H(this,null,function*(){const e=document.createElement("input");e.type="file",e.accept=".xlsx,.xls,.csv",e.onchange=n=>H(this,null,function*(){const a=n.target.files[0];if(a){E.value=a,p(null),A.value=[],T.value=[],O.value={total_processed:0,successful:0,failed:0};try{const{data:c,headers:r}=yield Pe(a);_.value=c.slice(0,100).map(m=>re(ae({},m),{_status:null,_error:null,_touched:!1})),L.value=r,u.value=r.map((m,h)=>({type:null,column:C.encode_col(h)})),Ye(r)}catch(c){console.error("Error loading preview:",c),p("Error loading file preview","error")}}}),e.click()})}function Fe(){E.value=null,_.value=[],L.value=[],u.value=[],q.value=[],U.value=[],A.value=[],T.value=[],O.value={total_processed:0,successful:0,failed:0},p(null)}function I(e){const n=u.value.some(g=>g.type==="First Name"&&e[L.value[C.decode_col(g.column)]]),a=u.value.some(g=>g.type==="Last Name"&&e[L.value[C.decode_col(g.column)]]),c=u.value.some(g=>g.type==="GR Number"&&e[L.value[C.decode_col(g.column)]]),r=u.value.some(g=>g.type==="Roll No"&&e[L.value[C.decode_col(g.column)]]),m=F(e)["Student Date of Birth"];let h=!0;return m&&m.toString().trim()!==""&&(h=pe(m)),n&&a&&c&&r&&h}function Be(e){_.value[e]&&(_.value[e]._touched=!0)}function Ge(e){return e._status==="success"?"row-success":e._enrollment_status==="error"?"row-enrollment-error":I(e)?"":"row-invalid"}function F(e){const n={"First Name":"","Middle Name":"","Last Name":"","Student Date of Birth":"","Email Address":"","Phone Number":"","GR Number":"","Roll No":"","Guardian Name":"","Guardian Number":"",Relation:"","Guardian Email":"","Guardian Date of Birth":"",className:o.value,divisionName:f.value,academicYear:s.value};return u.value.forEach(({type:a,column:c},r)=>{var m;if(a&&n.hasOwnProperty(a))try{const h=C.decode_col(c),g=L.value[h];let b=((m=e[g])==null?void 0:m.toString().trim())||"";if(a==="Student Date of Birth"||a==="Guardian Date of Birth"){const R=es(b);b=R?ss(R):""}n[a]=b}catch(h){console.error(`Error mapping column ${c} for type ${a}:`,h)}}),n}function Me(e,n){console.log("Updating row statuses from bulk response..."),_.value.forEach(a=>{a._status=null,a._error=null}),e.forEach(a=>{const c=Ve(a);c!==-1&&(_.value[c]._status="success",_.value[c]._error=null)}),n.forEach(a=>{const c=Le(a.student_data);c!==-1&&(_.value[c]._enrollment_status="error",_.value[c]._enrollment_error=a.error||"Unknown error")})}function Ve(e){return _.value.findIndex(n=>{const a=F(n);return`${a["First Name"]} ${a["Middle Name"]} ${a["Last Name"]}`.trim()===e})}function Le(e){return _.value.findIndex(n=>{const a=F(n);return a["GR Number"]===e["GR Number"]&&a["First Name"]===e["First Name"]&&a["Last Name"]===e["Last Name"]})}function J(e,n,a){$.value=e,ee.value=n,se.value=a,Z.value=!0}function Ue(){Z.value=!1,$.value="success",ee.value="",se.value=""}function Ae(){return H(this,null,function*(){console.log("Enroll button clicked"),A.value=[],T.value=[],O.value={total_processed:0,successful:0,failed:0},D.value=!0,_.value.forEach(r=>{r._status=null,r._error=null});const e=["First Name","GR Number","Last Name","Roll No"],n=u.value.map(r=>r.type).filter(r=>r),a=e.filter(r=>!n.includes(r));if(a.length>0){const r=`Please map the following required fields: ${a.join(", ")}`;console.error(r),p(r,"error"),D.value=!1;return}if(!s.value||!o.value||!f.value){const r="Please select an academic year, class, and division";console.error(r),p(r,"error"),D.value=!1;return}if(!E.value){const r="Please select a file first";console.error(r),p(r,"error"),D.value=!1;return}if(_.value.length===0){p("No data available to enroll","error"),D.value=!1;return}const c=_.value.filter(r=>{const m=F(r),h=m["Student Date of Birth"]&&m["Student Date of Birth"].toString().trim()!==""?W(m["Student Date of Birth"],"Student Date of Birth"):{isValid:!0},g=m["Guardian Date of Birth"]&&m["Guardian Date of Birth"].toString().trim()!==""?W(m["Guardian Date of Birth"],"Guardian Date of Birth"):{isValid:!0};return!h.isValid||!g.isValid});if(c.length>0){p(`${c.length} rows have invalid dates. Please correct the dates before enrolling.`,"warning"),c.forEach(r=>{const m=_.value.indexOf(r);if(m!==-1){const h=F(r),g=W(h["Student Date of Birth"],"Student Date of Birth"),b=W(h["Guardian Date of Birth"],"Guardian Date of Birth");let R="";g.isValid||(R+=g.error+" "),b.isValid||(R+=b.error),_.value[m]._status="error",_.value[m]._error=R.trim()}}),D.value=!1;return}try{p("Starting bulk enrollment process...","info");const r=_.value.filter(h=>I(h));if(r.length===0){p("No valid rows to enroll. Please check your data and mappings.","warning"),D.value=!1;return}console.log(`Starting bulk enrollment for ${r.length} students...`);const m=r.map(h=>F(h));yield le.submit({academicYear:s.value,className:o.value,divisionName:f.value,students:m,mappings:Object.fromEntries(u.value.filter(h=>h.type).map(h=>[h.type,h.column]))})}catch(r){console.error("Bulk enrollment process error:",r),p(`Bulk enrollment process failed: ${r.message||"Unknown error"}`,"error"),J("error","Bulk Enrollment Process Failed",r.message||"Unknown error occurred during enrollment."),D.value=!1}})}function Ye(e){const n={"First Name":["first","fname","given"],"Last Name":["last","lname","surname"],"Middle Name":["middle","mname"],"Email Address":["email","mail"],"Phone Number":["phone","mobile","contact"],"GR Number":["gr","grno","gr_num","gr no"],"Roll No":["r. no","roll","rollno","roll_num"],"Student Date of Birth":["dob","birth","birthdate","date of birth"],"Guardian Date of Birth":["guardian dob","parent dob","father dob","mother dob"],"Guardian Name":["guardian name","parent","father","mother"],"Guardian Number":["guardian no","guardian number","guardian phone","parent phone"],Relation:["relation","relationship"],"Guardian Email":["guardian email","parent email","father email","mother email"]};e.forEach((a,c)=>{if(!a)return;const r=a.toLowerCase().trim();if(r.includes("email"))if(r.includes("guardian")||r.includes("parent")){u.value[c].type="Guardian Email",console.log(`âœ“ Guardian Email: "${a}"`);return}else{u.value[c].type="Email Address",console.log(`âœ“ Student Email: "${a}"`);return}for(const[m,h]of Object.entries(n))if(h.some(g=>r.includes(g))){if(m==="Email Address"||m==="Guardian Email")continue;u.value[c].type=m,console.log(`âœ“ ${m}: "${a}"`);break}}),console.log("Final auto-detected mappings:",u.value)}function Pe(e){return new Promise((n,a)=>{const c=new FileReader;c.onload=r=>{try{const m=new Uint8Array(r.target.result),h=ts(m,{type:"array",sheetStubs:!0}),g=h.Sheets[h.SheetNames[0]],b=C.decode_range(g["!ref"]);let R=0;for(let N=b.s.r;N<=b.e.r;++N){let Y=!1;for(let j=b.s.c;j<=b.e.c;++j){const P=g[C.encode_cell({c:j,r:N})];if(P&&P.v!==void 0&&P.v!==null&&P.v!==""){Y=!0;break}}if(Y){R=N;break}}const oe=[];for(let N=b.s.c;N<=b.e.c;++N){const Y=g[C.encode_cell({c:N,r:R})];oe.push(Y?String(Y.v).trim():`Column ${N+1}`)}const ve=[];for(let N=R+1;N<=b.e.r;++N){const Y={};let j=!1;for(let P=b.s.c;P<=b.e.c;++P){const ne=g[C.encode_cell({c:P,r:N})],fe=oe[P-b.s.c];Y[fe]=ne?ne.v===void 0?"":ne.v:"",Y[fe]!==""&&(j=!0)}j&&ve.push(Y)}n({data:ve,headers:oe})}catch(m){a(m)}},c.onerror=r=>a(r),c.readAsArrayBuffer(e)})}function Te(e,n,a){u.value[e]=re(ae({},u.value[e]),{[n]:a,column:C.encode_col(e)})}function xe(e){_.value.splice(e,1),q.value=q.value.filter(n=>n.rowIndex!==e),U.value=U.value.filter(n=>n.rowIndex!==e),p("Row deleted","success")}function p(e,n="info"){de.value=e?{text:e,type:n}:null,e&&n!=="error"&&n!=="success"&&setTimeout(()=>p(null),5e3)}function Ie(e,n,a){const r=_.value[e][n]||"";if(r!==a){const m={rowIndex:e,column:n,oldValue:r,newValue:a,timestamp:new Date().toISOString()};q.value.push(m),U.value.push(m),console.log("Cell edit recorded:",m),qe()}}function je(e,n){let a;return function(...c){clearTimeout(a),a=setTimeout(()=>e.apply(this,c),n)}}const qe=je(Oe,500);function Oe(){return H(this,null,function*(){if(U.value.length!==0)try{const e=U.value[U.value.length-1],n=_.value[e.rowIndex],a=F(n);yield le.submit({academicYear:s.value,className:o.value,divisionName:f.value,students:[a],mappings:Object.fromEntries(u.value.filter(c=>c.type).map(c=>[c.type,c.column]))}),U.value=[]}catch(e){console.error("Error sending cell update:",e),p(`Failed to save cell update: ${e.message||"Unknown error"}`,"error")}})}return{academicYears:t,displayYears:S,selectedYear:s,classes:M,divisions:V,selectedClass:o,selectedDivision:f,mappings:u,fileSelected:E,options:x,message:de,previewData:_,previewHeaders:L,editHistory:q,pendingEdits:U,enrolledStudents:A,failedEnrollments:T,enrollmentSummary:O,processing:D,showResultModal:Z,resultModalType:$,resultModalTitle:ee,resultModalDescription:se,showErrorStudentsList:w,validRowsCount:ye,invalidRowsCount:be,errorRows:Se,getStudentFullName:ke,getStudentGR:we,getStudentRoll:Re,getRowError:Ne,academicYearsResource:ue,classesResource:ce,divisionsResource:te,enrollStudentsResource:le,onYearChange:Ee,onClassChange:me,getExcelColumnLetter:Ce,handleFileSelection:De,removeFile:Fe,handleEnrollStudents:Ae,updateMapping:Te,deleteRow:xe,showMessage:p,handleCellEdit:Ie,closeResultModal:Ue,isRowValid:I,markRowAsTouched:Be,getRowStatusClass:Ge,validDate:pe,getTodayDate:$e}}},os={class:"enrollment-container"},ns={class:"scroll-view-content"},as={key:0,class:"loading-overlay"},rs={key:1,class:"modal-overlay"},is={class:"result-modal"},ds={key:0,class:"success-icon"},us={key:1,class:"error-icon"},cs={class:"result-title"},ms={class:"result-description"},vs={class:"modal-actions"},fs={class:"form-card"},hs={class:"form-grid"},gs={class:"form-group required"},_s=["disabled"],ps=["value"],ys={class:"form-group required"},bs=["disabled"],Ss=["value"],ks={key:0,class:"form-group required"},ws=["disabled"],Rs=["value"],Ns={class:"form-card"},Es={class:"form-section"},Cs={key:0,class:"file-selected"},Ds={class:"button-content"},Fs={class:"enroll-button-section"},Bs=["disabled"],Gs={class:"button-content"},Ms={key:0,class:"spinner"},Vs={key:2,class:"form-card summary-card"},Ls={class:"summary-stats"},Us={class:"stat-item"},As={class:"stat-value"},Ys={class:"stat-item"},Ps={class:"stat-value valid"},Ts={class:"stat-item"},xs={class:"stat-value warning"},Is={key:0,class:"success-details"},js={class:"section-title"},qs={class:"results-list"},Os={key:1,class:"error-details"},Hs={class:"section-title"},zs={class:"results-list"},Ws={class:"error-student"},Js={class:"student-details"},Ks={class:"error-text"},Qs={key:3,class:"form-card preview-card"},Xs={class:"summary-stats"},Zs={class:"stat-item"},$s={class:"stat-value"},et={class:"stat-item"},st={class:"stat-value valid"},tt={class:"stat-item"},lt=["title"],ot={key:0,class:"error-indicator"},nt={key:0,class:"error-students-card"},at={class:"section-title"},rt={class:"error-details",style:{"max-height":"200px","overflow-y":"auto"}},it={class:"results-list"},dt={class:"error-student"},ut={class:"student-details"},ct={class:"error-text"},mt={key:0,class:"multiple-errors"},vt={key:1},ft={key:1,class:"table-spacing"},ht={class:"table-container-wrapper"},gt={class:"table-scroll-container"},_t={class:"table-container"},pt={class:"preview-table"},yt=["onUpdate:modelValue","onChange"],bt=["value"],St={class:"header-label"},kt={class:"actions"},wt=["onClick"],Rt={class:"status-cell"},Nt={key:0,class:"status-badge success"},Et={key:1,class:"status-badge error"},Ct={key:2,class:"status-badge warning"},Dt={key:3,class:"status-badge pending"},Ft={key:4,class:"error-tooltip"},Bt=["onUpdate:modelValue","onInput","onBlur","placeholder"];function Gt(w,t,S,s,M,V){return d(),i("div",os,[l("div",ns,[t[37]||(t[37]=l("div",{class:"header"},[l("h1",{class:"title"},"Students Enrollment Screen")],-1)),s.processing?(d(),i("div",as,t[11]||(t[11]=[l("div",{class:"loading-modal"},[l("div",{class:"loading-spinner"}),l("h3",{class:"loading-title"},"Enrolling Students"),l("p",{class:"loading-description"},"Please wait while we process the student data...")],-1)]))):k("",!0),s.showResultModal?(d(),i("div",rs,[l("div",is,[s.resultModalType==="success"?(d(),i("div",ds,t[12]||(t[12]=[l("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):(d(),i("div",us,t[13]||(t[13]=[l("svg",{class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})],-1)]))),l("h3",cs,v(s.resultModalTitle),1),l("p",ms,v(s.resultModalDescription),1),l("div",vs,[s.resultModalType==="success"?(d(),i("button",{key:0,class:"success-button",onClick:t[0]||(t[0]=(...o)=>s.closeResultModal&&s.closeResultModal(...o))}," Continue ")):(d(),i("button",{key:1,class:"primary-button",onClick:t[1]||(t[1]=(...o)=>s.closeResultModal&&s.closeResultModal(...o))}," Try Again "))])])])):k("",!0),l("div",fs,[t[20]||(t[20]=l("h2",{class:"form-title"},"Academic Information",-1)),l("div",hs,[l("div",gs,[t[15]||(t[15]=l("label",null,"Academic Year",-1)),z(l("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.selectedYear=o),class:"picker",onChange:t[3]||(t[3]=(...o)=>s.onYearChange&&s.onYearChange(...o)),disabled:s.academicYearsResource.loading},[t[14]||(t[14]=l("option",{value:null},"Select a Year",-1)),(d(!0),i(B,null,G(s.displayYears,o=>(d(),i("option",{key:o,value:o.original},v(o.display),9,ps))),128))],40,_s),[[X,s.selectedYear]])]),l("div",ys,[t[17]||(t[17]=l("label",null,"Class / Program",-1)),z(l("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.selectedClass=o),class:"picker",onChange:t[5]||(t[5]=(...o)=>s.onClassChange&&s.onClassChange(...o)),disabled:!s.selectedYear||s.classesResource.loading},[t[16]||(t[16]=l("option",{value:null},"Select a Class / Program",-1)),(d(!0),i(B,null,G(s.classes,o=>(d(),i("option",{key:o.name,value:o.name},v(o.name),9,Ss))),128))],40,bs),[[X,s.selectedClass]])]),s.divisions.length>0?(d(),i("div",ks,[t[19]||(t[19]=l("label",null,"Division / Student Group",-1)),s.divisions.length>0?z((d(),i("select",{key:0,"onUpdate:modelValue":t[6]||(t[6]=o=>s.selectedDivision=o),class:"picker",disabled:!s.selectedClass||s.divisionsResource.loading},[t[18]||(t[18]=l("option",{value:null},"Select a Division / Student Group",-1)),(d(!0),i(B,null,G(s.divisions,o=>(d(),i("option",{key:o.name,value:o.name},v(o.name),9,Rs))),128))],8,ws)),[[X,s.selectedDivision]]):k("",!0)])):k("",!0)])]),l("div",Ns,[t[21]||(t[21]=l("h2",{class:"form-title"},"Student Data Upload",-1)),l("div",Es,[s.fileSelected?(d(),i("div",Cs,[l("span",null,"Selected file: "+v(s.fileSelected.name),1),l("button",{onClick:t[7]||(t[7]=(...o)=>s.removeFile&&s.removeFile(...o)),class:"remove-file-btn"},"Ã—")])):k("",!0),l("button",{class:"secondary-button",onClick:t[8]||(t[8]=(...o)=>s.handleFileSelection&&s.handleFileSelection(...o))},[l("span",Ds,v(s.fileSelected?"Change File":"Upload File ðŸ“¤"),1)]),l("div",Fs,[l("button",{class:"enroll-button",onClick:t[9]||(t[9]=(...o)=>s.handleEnrollStudents&&s.handleEnrollStudents(...o)),disabled:s.processing||!s.selectedYear||!s.selectedClass||!s.selectedDivision||!s.fileSelected},[l("span",Gs,[s.processing?(d(),i("span",Ms)):k("",!0),ie(" "+v(s.processing?"Processing...":"Enroll Students âœ…"),1)])],8,Bs)]),s.message?(d(),i("div",{key:1,class:_e(["message",s.message.type])},v(s.message.text),3)):k("",!0)])]),s.enrollmentSummary.total_processed>0?(d(),i("div",Vs,[t[25]||(t[25]=l("h2",{class:"form-title"},"Enrollment Summary",-1)),l("div",Ls,[l("div",Us,[t[22]||(t[22]=l("span",{class:"stat-label"},"Total Processed",-1)),l("span",As,v(s.enrollmentSummary.total_processed),1)]),l("div",Ys,[t[23]||(t[23]=l("span",{class:"stat-label"},"Successful",-1)),l("span",Ps,v(s.enrollmentSummary.successful),1)]),l("div",Ts,[t[24]||(t[24]=l("span",{class:"stat-label"},"Failed",-1)),l("span",xs,v(s.enrollmentSummary.failed),1)])]),s.enrolledStudents.length>0?(d(),i("div",Is,[l("h4",js,"Successfully Enrolled ("+v(s.enrolledStudents.length)+")",1),l("div",qs,[(d(!0),i(B,null,G(s.enrolledStudents,(o,f)=>(d(),i("div",{key:f,class:"success-message"}," âœ… "+v(o),1))),128))])])):k("",!0),s.failedEnrollments.length>0?(d(),i("div",Os,[l("h4",Hs,"Enrollment Errors ("+v(s.failedEnrollments.length)+")",1),l("div",zs,[(d(!0),i(B,null,G(s.failedEnrollments,(o,f)=>(d(),i("div",{key:f,class:"error-message"},[l("div",Ws,[l("strong",null,v(o.student_data["First Name"])+" "+v(o.student_data["Middle Name"])+" "+v(o.student_data["Last Name"]),1),l("span",Js,"(GR: "+v(o.student_data["GR Number"])+", Roll: "+v(o.student_data["Roll No"])+")",1)]),l("div",Ks,"âŒ "+v(o.error),1)]))),128))])])):k("",!0)])):k("",!0),s.fileSelected&&s.previewData.length>0?(d(),i("div",Qs,[t[36]||(t[36]=l("h2",{class:"form-title"},"File Preview (First 100 rows)",-1)),l("div",Xs,[l("div",Zs,[t[26]||(t[26]=l("span",{class:"stat-label"},"Total Rows:",-1)),l("span",$s,v(s.previewData.length),1)]),l("div",et,[t[27]||(t[27]=l("span",{class:"stat-label"},"Ready to Enroll:",-1)),l("span",st,v(s.validRowsCount),1)]),l("div",tt,[t[28]||(t[28]=l("span",{class:"stat-label"},"With Errors:",-1)),l("span",{class:"stat-value warning",style:{cursor:"pointer"},onClick:t[10]||(t[10]=o=>s.showErrorStudentsList=!s.showErrorStudentsList),title:s.invalidRowsCount>0?"Click to view students with errors":""},[ie(v(s.invalidRowsCount)+" ",1),s.invalidRowsCount>0?(d(),i("span",ot,"âš ï¸")):k("",!0)],8,lt)])]),s.showErrorStudentsList&&s.errorRows.length>0?(d(),i("div",nt,[l("h4",at,"Students with Errors ("+v(s.invalidRowsCount)+")",1),l("div",rt,[l("div",it,[(d(!0),i(B,null,G(s.errorRows,(o,f)=>(d(),i("div",{key:f,class:"error-message"},[l("div",dt,[l("strong",null,v(s.getStudentFullName(o)),1),l("span",ut," (GR: "+v(s.getStudentGR(o))+", Roll: "+v(s.getStudentRoll(o))+") ",1)]),l("div",ct,[t[29]||(t[29]=ie(" âš ï¸ ")),s.getRowError(o).includes(";")?(d(),i("span",mt,v(s.getRowError(o)),1)):(d(),i("span",vt,v(s.getRowError(o)),1))])]))),128))])])])):k("",!0),s.showErrorStudentsList&&s.errorRows.length>0?(d(),i("div",ft)):k("",!0),l("div",ht,[l("div",gt,[l("div",_t,[l("table",pt,[l("thead",null,[l("tr",null,[t[30]||(t[30]=l("th",{class:"actions"},"Actions",-1)),t[31]||(t[31]=l("th",{class:"status-cell"},"Status",-1)),(d(!0),i(B,null,G(s.previewHeaders,(o,f)=>(d(),i("th",{key:"letter-"+f},v(s.getExcelColumnLetter(f)),1))),128))]),l("tr",null,[t[33]||(t[33]=l("th",{class:"actions"},null,-1)),t[34]||(t[34]=l("th",{class:"status-cell"},null,-1)),(d(!0),i(B,null,G(s.previewHeaders,(o,f)=>(d(),i("th",{key:"header-"+f},[z(l("select",{"onUpdate:modelValue":u=>s.mappings[f].type=u,class:"table-select",onChange:u=>s.updateMapping(f,"type",u.target.value)},[t[32]||(t[32]=l("option",{value:null},"Select Field",-1)),(d(!0),i(B,null,G(s.options,(u,E)=>(d(),i("option",{key:E,value:u},v(u),9,bt))),128))],40,yt),[[X,s.mappings[f].type]]),l("span",St,v(o),1)]))),128))])]),l("tbody",null,[(d(!0),i(B,null,G(s.previewData,(o,f)=>(d(),i("tr",{key:f,class:_e(s.getRowStatusClass(o))},[l("td",kt,[l("button",{onClick:u=>s.deleteRow(f),class:"trash-icon"},t[35]||(t[35]=[l("span",{class:"icon"},"âŽ",-1)]),8,wt)]),l("td",Rt,[o._status==="success"?(d(),i("span",Nt,"âœ…")):o._status==="error"?(d(),i("span",Et,"âŒ")):s.isRowValid(o)?(d(),i("span",Dt,"ðŸ”„")):(d(),i("span",Ct,"âš ï¸")),o._error?(d(),i("div",Ft,v(o._error),1)):k("",!0)]),(d(!0),i(B,null,G(s.previewHeaders,(u,E)=>(d(),i("td",{key:E},[z(l("input",{"onUpdate:modelValue":x=>o[u]=x,class:"table-input",onInput:x=>s.handleCellEdit(f,u,x.target.value),onBlur:x=>s.markRowAsTouched(f),placeholder:o[u]||"-"},null,40,Bt),[[Ze,o[u]]])]))),128))],2))),128))])])])])])])):k("",!0)])])}const At=Qe(ls,[["render",Gt]]);export{At as default};
