var ne=Object.defineProperty,ae=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var W=(t,e,n)=>e in t?ne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E=(t,e)=>{for(var n in e||(e={}))le.call(e,n)&&W(t,n,e[n]);if(R)for(var n of R(e))de.call(e,n)&&W(t,n,e[n]);return t},N=(t,e)=>ae(t,re(e));var K=(t,e,n)=>new Promise((o,u)=>{var a=r=>{try{l(n.next(r))}catch(f){u(f)}},i=r=>{try{l(n.throw(r))}catch(f){u(f)}},l=r=>r.done?o(r.value):Promise.resolve(r.value).then(a,i);l((n=n.apply(t,e)).next())});import{_ as P,o as d,c as m,b as s,f as b,v as x,g as M,F as h,h as g,t as v,i as w,r as y,j as U,k as H,l as _,n as L,m as F,p as q,q as me,e as ue,x as ce,d as pe,a as ve}from"./index-CGecpXwK.js";const fe={props:{values:Object},computed:{email:{get(){return this.values.email},set(t){this.$emit("update-field",{field:"email",value:t})}},googleAppPassword:{get(){return this.values.googleAppPassword},set(t){this.$emit("update-field",{field:"googleAppPassword",value:t})}}},methods:{updateField(t,e){this.$emit("update-field",{field:t,value:e})}}},be={class:"card"},he={class:"field"},ge={class:"field"};function xe(t,e,n,o,u,a){return d(),m("div",be,[s("div",he,[e[5]||(e[5]=s("label",null,"Email Address",-1)),b(s("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=i=>a.email=i),placeholder:"Enter your email address",onInput:e[1]||(e[1]=i=>a.updateField("email",i.target.value))},null,544),[[x,a.email]])]),s("div",ge,[e[6]||(e[6]=s("label",null,"Google App Password",-1)),b(s("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=i=>a.googleAppPassword=i),placeholder:"Enter your Google app password",onInput:e[3]||(e[3]=i=>a.updateField("googleAppPassword",i.target.value))},null,544),[[x,a.googleAppPassword]])]),s("button",{onClick:e[4]||(e[4]=i=>t.$emit("submit-email"))},"Submit Email Account")])}const Ce=P(fe,[["render",xe],["__scopeId","data-v-a1f91314"]]),Se={props:{values:Object},data(){return{selectedTerm:"",lastValidTermCount:0}},computed:{academicYear:{get(){return this.values.academicYear},set(t){this.$emit("update-field",{field:"academicYear",value:t})}},academicYearStart:{get(){return this.values.academicYearStart},set(t){this.$emit("update-field",{field:"academicYearStart",value:t})}},academicYearEnd:{get(){return this.values.academicYearEnd},set(t){this.$emit("update-field",{field:"academicYearEnd",value:t})}},numberOfTerms:{get(){return this.values.numberOfTerms},set(t){this.$emit("update-field",{field:"numberOfTerms",value:t})}}},methods:{handleNumberOfTermsChange(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.adjustTermsToMatchCount()):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.adjustTermsToMatchCount()},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.adjustTermsToMatchCount())},adjustTermsToMatchCount(){const t=this.values.terms.length,e=this.numberOfTerms;if(e>t){const n=e-t,o=[...this.values.terms];for(let u=0;u<n;u++){const a=t+u+1,{startDate:i,endDate:l}=this.calculateTermDates(a,e);o.push({name:`Term ${a}`,startDate:i,endDate:l})}this.$emit("update-field-array",{field:"terms",value:o})}else if(e<t){const n=t-e,o=[...this.values.terms];o.splice(-n,n),this.$emit("update-field-array",{field:"terms",value:o})}},calculateTermDates(t,e){if(!this.academicYearStart||!this.academicYearEnd)return{startDate:"",endDate:""};const n=new Date(this.academicYearStart),a=(new Date(this.academicYearEnd)-n)/e,i=new Date(n.getTime()+a*(t-1)),l=new Date(n.getTime()+a*t-1),r=f=>f.toISOString().split("T")[0];return{startDate:r(i),endDate:r(l)}},formatDate(t){if(!t)return"";const e={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,e)},updateField(t,e){this.$emit("update-field",{field:t,value:e})},updateTermField(t,e,n){this.$emit("update-field-array",{field:"terms",index:t,subField:e,value:n})},addTerm(){const t={name:"",startDate:"",endDate:""};this.$emit("update-field-array",{field:"terms",value:[...this.values.terms,t]}),this.numberOfTerms=this.values.terms.length},removeTerm(t){const e=[...this.values.terms];e.splice(t,1),this.$emit("update-field-array",{field:"terms",value:e}),this.numberOfTerms=e.length},handleTermsInput(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.$emit("auto-create-terms")):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.$emit("auto-create-terms")},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.$emit("auto-create-terms"))}},mounted(){this.lastValidTermCount=this.numberOfTerms||1}},ye={class:"academic-year-form"},De={class:"form-grid"},Te={class:"form-row"},we={class:"form-group full-width"},_e={class:"form-row date-range-row"},je={class:"form-group"},ke={class:"form-group"},Pe={class:"form-row"},Ae={class:"form-group full-width"},Ee={class:"number-input-group"},Oe={class:"number-input-buttons"},Ye=["disabled"],Ne={class:"form-row"},Le={class:"form-group full-width"},Fe=["value"],Ue={class:"terms-list"},Ie={class:"term-header"},Me={class:"term-title"},Ve=["onClick"],Be={class:"term-body"},$e={class:"form-group"},Ge=["onUpdate:modelValue","placeholder","onInput"],Re={class:"form-row term-dates-row"},We={class:"form-group"},Ke=["onUpdate:modelValue","onInput"],qe={class:"form-group"},He=["onUpdate:modelValue","onInput"],Qe={class:"form-actions"};function Ze(t,e,n,o,u,a){return d(),m("div",ye,[e[23]||(e[23]=s("div",{class:"form-header"},[s("h3",{class:"form-title"},"Academic Year Setup"),s("p",{class:"form-subtitle"}," Provide details about the academic year, its duration, and terms. ")],-1)),s("div",De,[s("div",Te,[s("div",we,[e[13]||(e[13]=s("label",{class:"form-label"},"Academic Year",-1)),b(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>a.academicYear=i),class:"form-input",placeholder:"e.g., 2023-2024",onInput:e[1]||(e[1]=i=>a.updateField("academicYear",i.target.value))},null,544),[[x,a.academicYear]])])]),s("div",_e,[s("div",je,[e[14]||(e[14]=s("label",{class:"form-label"},"Start Date",-1)),b(s("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=i=>a.academicYearStart=i),class:"form-input",onInput:e[3]||(e[3]=i=>a.updateField("academicYearStart",i.target.value))},null,544),[[x,a.academicYearStart]])]),s("div",ke,[e[15]||(e[15]=s("label",{class:"form-label"},"End Date",-1)),b(s("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=i=>a.academicYearEnd=i),class:"form-input",onInput:e[5]||(e[5]=i=>a.updateField("academicYearEnd",i.target.value))},null,544),[[x,a.academicYearEnd]])])]),s("div",Pe,[s("div",Ae,[e[16]||(e[16]=s("label",{class:"form-label"},"Number of Terms",-1)),s("div",Ee,[b(s("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=i=>a.numberOfTerms=i),class:"form-input number-input",placeholder:"e.g., 3",min:"1",onInput:e[7]||(e[7]=(...i)=>a.handleNumberOfTermsChange&&a.handleNumberOfTermsChange(...i))},null,544),[[x,a.numberOfTerms,void 0,{number:!0}]]),s("div",Oe,[s("button",{class:"number-input-btn minus-btn",onClick:e[8]||(e[8]=(...i)=>a.decrementTerms&&a.decrementTerms(...i)),disabled:a.numberOfTerms<=1}," − ",8,Ye),s("button",{class:"number-input-btn plus-btn",onClick:e[9]||(e[9]=(...i)=>a.incrementTerms&&a.incrementTerms(...i))}," + ")])])])]),s("div",Ne,[s("div",Le,[e[18]||(e[18]=s("label",{class:"form-label"},"Current Academic Term",-1)),b(s("select",{"onUpdate:modelValue":e[10]||(e[10]=i=>u.selectedTerm=i),class:"form-select",onChange:e[11]||(e[11]=i=>a.updateField("selectedTerm",i.target.value))},[e[17]||(e[17]=s("option",{value:""},"-- Select a Term --",-1)),(d(!0),m(h,null,g(n.values.terms,(i,l)=>(d(),m("option",{key:l,value:i.name},v(i.name)+" ("+v(a.formatDate(i.startDate))+" - "+v(a.formatDate(i.endDate))+") ",9,Fe))),128))],544),[[M,u.selectedTerm]])])])]),s("div",Ue,[(d(!0),m(h,null,g(n.values.terms,(i,l)=>(d(),m("div",{key:l,class:"term-card"},[s("div",Ie,[s("h4",Me,"Term "+v(l+1),1),s("button",{class:"btn-icon",onClick:r=>a.removeTerm(l),title:"Remove term"}," ✕ ",8,Ve)]),s("div",Be,[s("div",$e,[e[19]||(e[19]=s("label",{class:"form-label"},"Term Name",-1)),b(s("input",{type:"text","onUpdate:modelValue":r=>i.name=r,class:"form-input",placeholder:`e.g., Spring ${l+1}`,onInput:r=>a.updateTermField(l,"name",r.target.value)},null,40,Ge),[[x,i.name]])]),s("div",Re,[s("div",We,[e[20]||(e[20]=s("label",{class:"form-label"},"Start Date",-1)),b(s("input",{type:"date","onUpdate:modelValue":r=>i.startDate=r,class:"form-input",onInput:r=>a.updateTermField(l,"startDate",r.target.value)},null,40,Ke),[[x,i.startDate]])]),s("div",qe,[e[21]||(e[21]=s("label",{class:"form-label"},"End Date",-1)),b(s("input",{type:"date","onUpdate:modelValue":r=>i.endDate=r,class:"form-input",onInput:r=>a.updateTermField(l,"endDate",r.target.value)},null,40,He),[[x,i.endDate]])])])])]))),128))]),s("div",Qe,[s("button",{class:"btn btn-primary",onClick:e[12]||(e[12]=(...i)=>a.addTerm&&a.addTerm(...i))},e[22]||(e[22]=[s("span",{class:"icon"},"+",-1),w(" Add Term ")]))])])}const ze=P(Se,[["render",Ze],["__scopeId","data-v-401732b4"]]),Je={props:{values:Object,previousDataList:Array},emits:["update-field","use-previous-data"],setup(t,{emit:e}){const n=y(null),o=y(t.values.dontCreateClasses||!1),u=y(!1),a=y(""),i=U({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:f=>{console.log("Previous data loaded successfully")},onError:f=>{console.error("Error fetching previous data:",f)}}),l=()=>{if(!n.value){console.warn("No data selected");return}e("use-previous-data",n.value),a.value=n.value.academicYear,u.value=!0,setTimeout(()=>{u.value=!1},5e3)},r=()=>{e("update-field",{field:"dontCreateClasses",value:o.value})};return H(()=>{(!t.previousDataList||t.previousDataList.length===0)&&i.reload()}),{selectedPreviousData:n,dontCreateClasses:o,showSuccessMessage:u,usedPreviousYear:a,previousDataResource:i,handleUsePreviousData:l,updateDontCreateClasses:r}}},Xe={class:"card"},et={key:0,class:"loading"},tt={key:1},st={key:0,class:"success-message"},it={class:"field"},ot=["value"],nt=["disabled"];function at(t,e,n,o,u,a){return d(),m("div",Xe,[e[3]||(e[3]=s("h3",{class:"section-title"},"Use Previous Data",-1)),o.previousDataResource.loading?(d(),m("div",et,"Loading previous data...")):(d(),m("div",tt,[o.showSuccessMessage?(d(),m("div",st," ✓ Previous data from "+v(o.usedPreviousYear)+" has been successfully loaded ",1)):_("",!0),s("div",it,[b(s("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>o.selectedPreviousData=i)},[e[2]||(e[2]=s("option",{value:null},"Select a year",-1)),(d(!0),m(h,null,g(n.previousDataList,(i,l)=>(d(),m("option",{key:l,value:i},v(i.academicYear),9,ot))),128))],512),[[M,o.selectedPreviousData]])]),s("button",{onClick:e[1]||(e[1]=(...i)=>o.handleUsePreviousData&&o.handleUsePreviousData(...i)),disabled:!o.selectedPreviousData}," Use Previous Data ",8,nt)]))])}const rt=P(Je,[["render",at],["__scopeId","data-v-b5328e59"]]),lt=[{id:1,name:"Pre-K"},{id:2,name:"Kindergarten"},{id:3,name:"1st Grade"},{id:4,name:"2nd Grade"},{id:5,name:"3rd Grade"},{id:6,name:"4th Grade"},{id:7,name:"5th Grade"},{id:8,name:"6th Grade"},{id:9,name:"7th Grade"},{id:10,name:"8th Grade"},{id:11,name:"9th Grade"},{id:12,name:"10th Grade"},{id:13,name:"11th Grade"},{id:14,name:"12th Grade"},{id:15,name:"Other"}],dt={school:["Nursery","Jr KG","Sr KG","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th"],college:["FY BSc","SY BSc","TY BSc","FY BCA","SY BCA","TY BCA","FY BTech","SY BTech","TY BTech","Final Year BTech","FY BCom","SY BCom","TY BCom","MBA"]},mt={props:{values:Object},data(){return{selectedInstitution:"",editablePrograms:[],availablePrograms:lt}},watch:{"values.classes":{immediate:!0,handler(t){t&&t.length>0&&(this.editablePrograms=[...t])}}},computed:{selectedPrograms(){return this.values.classes||[]}},methods:{isSelected(t){return this.selectedPrograms.some(e=>e.id===t.id)},toggleProgram(t){let e;this.isSelected(t)?e=this.selectedPrograms.filter(n=>n.id!==t.id):e=[...this.selectedPrograms,{id:t.id,className:t.name,subjects:[],divisions:[]}],this.updatePrograms(e)},handleEditProgram(t,e){const n=this.editablePrograms.map(o=>o.id===t?N(E({},o),{className:e}):o);this.updatePrograms(n)},handleDeleteProgram(t){const e=this.editablePrograms.filter(n=>n.id!==t);this.updatePrograms(e)},handleAddProgram(){const t={id:Math.random().toString(),className:"",subjects:[],divisions:[]},e=[...this.editablePrograms,t];this.updatePrograms(e)},handleInstitutionChange(){const t=(dt[this.selectedInstitution]||[]).map(e=>({id:Math.random().toString(),className:e,subjects:[],divisions:[]}));this.updatePrograms(t)},updatePrograms(t){this.editablePrograms=t,this.$emit("update-field-array",{field:"classes",value:t})}}},ut={class:"program-selector-container"},ct={class:"institution-selector"},pt={key:0,class:"programs-list"},vt=["onUpdate:modelValue","onInput"],ft=["onClick"],bt={key:1,class:"quick-select"},ht={class:"program-grid"},gt=["onClick"];function xt(t,e,n,o,u,a){return d(),m("div",ut,[s("div",ct,[e[4]||(e[4]=s("label",{class:"form-label"},"Select Institution Type",-1)),b(s("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>u.selectedInstitution=i),class:"form-select",onChange:e[1]||(e[1]=(...i)=>a.handleInstitutionChange&&a.handleInstitutionChange(...i))},e[3]||(e[3]=[s("option",{value:""},"Select Institution",-1),s("option",{value:"school"},"School",-1),s("option",{value:"college"},"College",-1)]),544),[[M,u.selectedInstitution]])]),u.editablePrograms.length>0?(d(),m("div",pt,[e[6]||(e[6]=s("h3",{class:"section-title"},"Classes List",-1)),(d(!0),m(h,null,g(u.editablePrograms,i=>(d(),m("div",{key:i.id,class:"program-item"},[b(s("input",{type:"text","onUpdate:modelValue":l=>i.className=l,class:"program-input",onInput:l=>a.handleEditProgram(i.id,l.target.value)},null,40,vt),[[x,i.className]]),s("button",{class:"delete-btn",onClick:l=>a.handleDeleteProgram(i.id),title:"Remove class"},e[5]||(e[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]),8,ft)]))),128))])):_("",!0),u.selectedInstitution===""?(d(),m("div",bt,[e[7]||(e[7]=s("h3",{class:"section-title"},"Quick Select Programs",-1)),s("div",ht,[(d(!0),m(h,null,g(u.availablePrograms,i=>(d(),m("div",{key:i.id,class:L(["program-card",{selected:a.isSelected(i)}]),onClick:l=>a.toggleProgram(i)},v(i.name),11,gt))),128))])])):_("",!0),s("button",{class:"add-btn",onClick:e[2]||(e[2]=(...i)=>a.handleAddProgram&&a.handleAddProgram(...i))},e[8]||(e[8]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),w(" Add Class ")]))])}const Ct=P(mt,[["render",xt],["__scopeId","data-v-f6b17094"]]),St={props:{values:Object},data(){return{newCommonSubject:"",newCommonDivision:"",commonSubjectsList:[],commonDivisionsList:[],classesWithText:[],commonSubjects:["Math","Social Studies","Science","English","History","Geography","Physics","Chemistry","Biology","Computer","Civics","Hindi","Marathi","Arabic","Play"],commonDivisions:["A","B","C","D","E","F"]}},created(){this.values.commonSubjects&&(this.commonSubjectsList=[...this.values.commonSubjects]),this.values.commonDivisions&&(this.commonDivisionsList=[...this.values.commonDivisions])},watch:{"values.classes":{immediate:!0,deep:!0,handler(t){this.classesWithText=t.map(e=>N(E({},e),{subjectsText:"",divisionsText:"",specificSubjects:e.subjects?e.subjects.filter(n=>!this.commonSubjectsList.includes(n)):[],specificDivisions:e.divisions?e.divisions.filter(n=>{const o=n.divisionName.split("-").slice(1).join("-");return!this.commonDivisionsList.includes(o)}):[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}))}},commonSubjectsList:{handler(t){this.$emit("update-field",{field:"commonSubjects",value:t}),this.updateAllClassesWithCommonData()},deep:!0},commonDivisionsList:{handler(t){this.$emit("update-field",{field:"commonDivisions",value:t}),this.updateAllClassesWithCommonData()},deep:!0}},methods:{addCommonSubject(){this.newCommonSubject.trim()&&!this.commonSubjectsList.includes(this.newCommonSubject.trim())&&(this.commonSubjectsList.push(this.newCommonSubject.trim()),this.newCommonSubject="")},removeCommonSubject(t){this.commonSubjectsList.splice(t,1)},isCommonSubjectSelected(t){return this.commonSubjectsList.includes(t)},toggleCommonSubject(t){this.isCommonSubjectSelected(t)?this.removeCommonSubject(this.commonSubjectsList.indexOf(t)):(this.newCommonSubject=t,this.addCommonSubject())},addCommonDivision(){this.newCommonDivision.trim()&&!this.commonDivisionsList.includes(this.newCommonDivision.trim())&&(this.commonDivisionsList.push(this.newCommonDivision.trim()),this.newCommonDivision="")},removeCommonDivision(t){this.commonDivisionsList.splice(t,1)},isCommonDivisionSelected(t){return this.commonDivisionsList.includes(t)},toggleCommonDivision(t){this.isCommonDivisionSelected(t)?this.removeCommonDivision(this.commonDivisionsList.indexOf(t)):(this.newCommonDivision=t,this.addCommonDivision())},addSpecificSubject(t){if(this.classesWithText[t].subjectsText.trim()){const e=[...this.classesWithText];e[t].specificSubjects=[...e[t].specificSubjects,e[t].subjectsText.trim()],e[t].subjectsText="",this.emitUpdatedClasses(e)}},removeSpecificSubject(t,e){const n=[...this.classesWithText];n[t].specificSubjects.splice(e,1),this.emitUpdatedClasses(n)},addSpecificDivision(t){if(this.classesWithText[t].divisionsText.trim()){const e=[...this.classesWithText],n=e[t].className||"Class";e[t].specificDivisions=[...e[t].specificDivisions,{divisionName:`${n}-${e[t].divisionsText.trim()}`}],e[t].divisionsText="",this.emitUpdatedClasses(e)}},removeSpecificDivision(t,e){const n=[...this.classesWithText];n[t].specificDivisions.splice(e,1),this.emitUpdatedClasses(n)},updateClassName(t,e){const n=[...this.classesWithText],o=n[t].className;n[t].className=e,n[t].specificDivisions&&(n[t].specificDivisions=n[t].specificDivisions.map(u=>{const a=u.divisionName.replace(`${o}-`,"");return{divisionName:`${e}-${a}`}})),this.emitUpdatedClasses(n)},updateAllClassesWithCommonData(){const t=this.classesWithText.map(e=>N(E({},e),{specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}));this.emitUpdatedClasses(t)},isCommonSubjectExcluded(t,e){var o;return((o=this.classesWithText[t].excludedCommonSubjects)==null?void 0:o.includes(e))||!1},toggleExcludeCommonSubject(t,e){const n=[...this.classesWithText];n[t].excludedCommonSubjects||(n[t].excludedCommonSubjects=[]);const o=n[t].excludedCommonSubjects.indexOf(e);o>=0?n[t].excludedCommonSubjects.splice(o,1):n[t].excludedCommonSubjects.push(e),this.emitUpdatedClasses(n)},isCommonDivisionExcluded(t,e){var o;return((o=this.classesWithText[t].excludedCommonDivisions)==null?void 0:o.includes(e))||!1},toggleExcludeCommonDivision(t,e){const n=[...this.classesWithText];n[t].excludedCommonDivisions||(n[t].excludedCommonDivisions=[]);const o=n[t].excludedCommonDivisions.indexOf(e);o>=0?n[t].excludedCommonDivisions.splice(o,1):n[t].excludedCommonDivisions.push(e),this.emitUpdatedClasses(n)},emitUpdatedClasses(t){this.$emit("update-field-array",{field:"classes",value:t.map(e=>({className:e.className,subjects:[...this.commonSubjectsList.filter(n=>{var o;return!((o=e.excludedCommonSubjects)!=null&&o.includes(n))}),...e.specificSubjects||[]],divisions:[...this.commonDivisionsList.filter(n=>{var o;return!((o=e.excludedCommonDivisions)!=null&&o.includes(n))}).map(n=>({divisionName:`${e.className}-${n}`})),...e.specificDivisions||[]],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[],specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[]}))})}}},yt={class:"bg-white shadow rounded-lg p-6 space-y-6"},Dt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Tt=["onClick"],wt={class:"quick-select mt-3"},_t={class:"subject-grid grid grid-cols-3 gap-2"},jt=["onClick"],kt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},Pt=["onClick"],At={class:"quick-select mt-3"},Et={class:"division-grid grid grid-cols-6 gap-2"},Ot=["onClick"],Yt={class:"overflow-x-auto"},Nt={class:"min-w-full text-sm text-left text-gray-700"},Lt={class:"px-4 py-2"},Ft={class:"px-4 py-2"},Ut=["onUpdate:modelValue","onInput"],It={class:"px-4 py-2 w-[300px]"},Mt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Vt=["onClick"],Bt=["onClick"],$t={class:"flex gap-2"},Gt=["onUpdate:modelValue","onKeydown"],Rt=["onClick"],Wt={class:"px-4 py-2"},Kt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},qt=["onClick"],Ht=["onClick"],Qt={class:"flex gap-2"},Zt=["onUpdate:modelValue","onKeydown"],zt=["onClick"];function Jt(t,e,n,o,u,a){return d(),m("div",yt,[s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Subjects for All Classes",-1)),s("div",Dt,[(d(!0),m(h,null,g(u.commonSubjectsList,(i,l)=>(d(),m("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm"},[w(v(i)+" ",1),s("button",{onClick:r=>a.removeCommonSubject(l),class:"ml-1.5 text-blue-500 hover:text-blue-700"}," × ",8,Tt)]))),128)),b(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>u.newCommonSubject=i),onKeydown:e[1]||(e[1]=F((...i)=>a.addCommonSubject&&a.addCommonSubject(...i),["enter"])),onBlur:e[2]||(e[2]=(...i)=>a.addCommonSubject&&a.addCommonSubject(...i)),placeholder:"Add subjects...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[x,u.newCommonSubject]])]),s("div",wt,[e[6]||(e[6]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Subjects",-1)),s("div",_t,[(d(!0),m(h,null,g(u.commonSubjects,i=>(d(),m("div",{key:i,class:L(["subject-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-blue-100 border-blue-300":a.isCommonSubjectSelected(i),"bg-gray-50 hover:bg-gray-100":!a.isCommonSubjectSelected(i)}]),onClick:l=>a.toggleCommonSubject(i)},v(i),11,jt))),128))])])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Divisions for All Classes",-1)),s("div",kt,[(d(!0),m(h,null,g(u.commonDivisionsList,(i,l)=>(d(),m("span",{key:l,class:"inline-flex items-center px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm"},[w(v(i)+" ",1),s("button",{onClick:r=>a.removeCommonDivision(l),class:"ml-1.5 text-green-500 hover:text-green-700"}," × ",8,Pt)]))),128)),b(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=i=>u.newCommonDivision=i),onKeydown:e[4]||(e[4]=F((...i)=>a.addCommonDivision&&a.addCommonDivision(...i),["enter"])),onBlur:e[5]||(e[5]=(...i)=>a.addCommonDivision&&a.addCommonDivision(...i)),placeholder:"Add divisions...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[x,u.newCommonDivision]])]),s("div",At,[e[8]||(e[8]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Divisions",-1)),s("div",Et,[(d(!0),m(h,null,g(u.commonDivisions,i=>(d(),m("div",{key:i,class:L(["division-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-green-100 border-green-300":a.isCommonDivisionSelected(i),"bg-gray-50 hover:bg-gray-100":!a.isCommonDivisionSelected(i)}]),onClick:l=>a.toggleCommonDivision(i)},v(i),11,Ot))),128))])])]),e[11]||(e[11]=s("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-2"},"Classes Overview",-1)),s("div",Yt,[s("table",Nt,[e[10]||(e[10]=s("thead",{class:"bg-gray-100"},[s("tr",null,[s("th",{class:"px-4 py-2 font-medium"},"#"),s("th",{class:"px-4 py-2 font-medium"},"Class Name / Programs"),s("th",{class:"px-4 py-2 font-medium"},"Subjects / Courses"),s("th",{class:"px-4 py-2 font-medium"},"Divisions / Student Groups")])],-1)),s("tbody",null,[(d(!0),m(h,null,g(u.classesWithText,(i,l)=>(d(),m("tr",{key:l,class:"border-t hover:bg-gray-50"},[s("td",Lt,v(l+1),1),s("td",Ft,[b(s("input",{type:"text","onUpdate:modelValue":r=>i.className=r,onInput:r=>a.updateClassName(l,r.target.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Ut),[[x,i.className]])]),s("td",It,[s("div",Mt,[(d(!0),m(h,null,g(u.commonSubjectsList,(r,f)=>(d(),m("span",{key:"common-"+f,class:L(["inline-flex items-center px-2 py-1 rounded-full text-xs",a.isCommonSubjectExcluded(l,r)?"bg-red-100 text-red-600":"bg-blue-50 text-blue-600"])},[w(v(r)+" ",1),s("button",{onClick:q(O=>a.toggleExcludeCommonSubject(l,r),["stop"]),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"},v(a.isCommonSubjectExcluded(l,r)?"+":"×"),9,Vt)],2))),128)),(d(!0),m(h,null,g(i.specificSubjects,(r,f)=>(d(),m("span",{key:"specific-"+f,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs"},[w(v(r)+" ",1),s("button",{onClick:O=>a.removeSpecificSubject(l,f),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"}," × ",8,Bt)]))),128))]),s("div",$t,[b(s("input",{type:"text","onUpdate:modelValue":r=>i.subjectsText=r,onKeydown:F(r=>a.addSpecificSubject(l),["enter"]),placeholder:"Add class-specific subject...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Gt),[[x,i.subjectsText]]),s("button",{onClick:r=>a.addSpecificSubject(l),class:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs"}," Add ",8,Rt)])]),s("td",Wt,[s("div",Kt,[(d(!0),m(h,null,g(u.commonDivisionsList,(r,f)=>(d(),m("span",{key:"common-"+f,class:L(["inline-flex items-center px-2 py-1 rounded-full text-xs",a.isCommonDivisionExcluded(l,r)?"bg-red-100 text-red-600 border border-red-300":"bg-green-50 text-green-600"])},[w(v(r)+" ",1),s("button",{onClick:q(O=>a.toggleExcludeCommonDivision(l,r),["stop"]),class:"ml-1 text-green-500 hover:text-green-700 text-xs"},v(a.isCommonDivisionExcluded(l,r)?"+":"×"),9,qt)],2))),128)),(d(!0),m(h,null,g(i.specificDivisions,(r,f)=>(d(),m("span",{key:"specific-"+f,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800 text-xs"},[w(v(r.divisionName.split("-").slice(1).join("-"))+" ",1),s("button",{onClick:O=>a.removeSpecificDivision(l,f),class:"ml-1 text-green-500 hover:text-green-700 text-xs"}," × ",8,Ht)]))),128))]),s("div",Qt,[b(s("input",{type:"text","onUpdate:modelValue":r=>i.divisionsText=r,onKeydown:F(r=>a.addSpecificDivision(l),["enter"]),placeholder:"Add class-specific division...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,Zt),[[x,i.divisionsText]]),s("button",{onClick:r=>a.addSpecificDivision(l),class:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-xs"}," Add ",8,zt)])])]))),128))])])])])}const Xt=P(St,[["render",Jt],["__scopeId","data-v-9515f27e"]]),es={components:{EmailAccountSetup:Ce,AcademicYearTerms:ze,UsePreviousData:rt,ProgramSelection:Ct,SubjectsDivisions:Xt},setup(){const t=y(0),e=y([]),n=y(!1),o=y(!1),u=y(!1),a=y(""),i=y([]),l=y(!1),r=me({email:"",googleAppPassword:"",academicYear:"",academicYearStart:"",academicYearEnd:"",numberOfTerms:"",terms:[],selectedTerm:"",classes:[],subjects:[],divisions:[],commonSubjects:[],commonDivisions:[],dontCreateClasses:!1}),f=y([{title:"Email Account Setup (Optional)",component:"EmailAccountSetup"},{title:"Academic Year & Terms",component:"AcademicYearTerms"},{title:"Use Previous Data",component:"UsePreviousData"},{title:"Select Institution Type & Classes",component:"ProgramSelection"},{title:"Subjects and Divisions",component:"SubjectsDivisions"}]),O=U({url:"school.al_ummah.api3.get_previous_data",params:{values:{}},onSuccess:c=>{e.value=Array.isArray(c)?c.map(p=>N(E({},p),{academicYear:p.json_data?JSON.parse(p.json_data).academicYear:""})):[]},onError:c=>{console.error("Error fetching previous data:",c),e.value=[]}}),V=U({url:"school.al_ummah.api3.create_email_account",params:{email_id:"",password:""},onSuccess:()=>{alert("Email account setup successfully!")},onError:c=>{console.error("Error setting up email account:",c),alert("Error setting up email account.")}}),I=U({url:"school.al_ummah.api3.quick_setup",params:{values:{}},onSuccess:()=>{u.value=!0,t.value++,n.value=!1,o.value=!0},onError:c=>{var p;u.value=!1,a.value=((p=c.messages)==null?void 0:p[0])||"An error occurred while submitting the form.",console.error("Submission error:",c),n.value=!1,o.value=!0}});function Q({classNames:c}){const p=[...r.classes],C=p.reduce((T,S)=>Math.max(T,S.classIndex||0),0),D=c.map((T,S)=>({className:T,subjects:[],divisions:[{divisionName:""}],classIndex:C+S+1}));r.classes=[...p,...D]}function B(){O.reload()}function Z({field:c,value:p}){r[c]=p}function z({field:c,index:p,subField:C,value:D}){p!==void 0&&C?r[c][p][C]=D:p!==void 0?r[c][p]=D:r[c]=D}function J(){return K(this,null,function*(){const{email:c,googleAppPassword:p}=r;if(!c||!p){alert("Please provide both email and Google app password.");return}V.update({params:{email_id:c,password:p}}),V.submit()})}function X(){const c=parseInt(r.numberOfTerms,10),p=new Date(r.academicYearStart),C=new Date(r.academicYearEnd);if(!c||c<=0){alert("Please enter a valid number of terms.");return}if(isNaN(p.getTime())){alert("Please enter valid 'From' date.");return}if(isNaN(C.getTime())){alert("Please enter valid 'To' date.");return}if(p>=C){alert("'From' date must be before 'To' date.");return}const D=Math.ceil((C-p)/(1e3*60*60*24)),T=Math.floor(D/c),S=[];let j=new Date(p);for(let A=0;A<c;A++){const k=new Date(j);k.setDate(j.getDate()+T-1),A===c-1&&k.setTime(C.getTime()),S.push({name:`Term ${A+1}`,startDate:j.toISOString().split("T")[0],endDate:k.toISOString().split("T")[0]}),j=new Date(k),j.setDate(j.getDate()+1)}r.terms=S}function ee(c){if(!(c!=null&&c.json_data)){console.error("Invalid or missing previous data");return}try{const p=JSON.parse(c.json_data);r.classes=p.classes||[],r.subjects=p.subjects||[]}catch(p){console.error("Error parsing previous data:",p),alert("Failed to load previous data. Please try another selection.")}}function te(){t.value<f.value.length-1?(t.value++,l.value=!1):$()}function se(){t.value>0&&(t.value--,l.value=!1)}function $(){n.value=!0,o.value=!1,u.value=!1,a.value="",l.value=!1;const p=G(r,["selectedTerm","commonSubjects","commonDivisions","divisions","institutionName","logo","dontCreateClasses","subjects","terms","email","googleAppPassword","classes"]);if(p.length>0){i.value=p,l.value=!0,n.value=!1,window.scrollTo({top:0,behavior:"smooth"});return}I.update({params:{values:E({},r)}}),I.submit()}function G(c,p){const C=[];return Object.entries(c).forEach(([D,T])=>{if(!p.includes(D)){if(Array.isArray(T))if(T.length===0){const S=Y(D);C.push(`${S} list is empty`)}else T.forEach((S,j)=>{typeof S=="object"&&S!==null&&Object.entries(S).forEach(([A,k])=>{if(!k||typeof k=="string"&&k.trim()===""){const ie=Y(A),oe=Y(D);C.push(`${oe} ${j+1}: ${ie} is required`)}})});else if(!T||typeof T=="string"&&T.trim()===""){const S=Y(D);C.push(`${S} is required`)}}}),C}function Y(c){return c.replace(/([A-Z])/g," $1").replace(/^./,p=>p.toUpperCase()).replace(/([A-Z])/g," $1").trim()}return H(()=>{B()}),{currentStep:t,previousDataList:e,isSubmitting:n,showResultMessage:o,submitSuccess:u,errorMessage:a,missingFields:i,showMissingFields:l,formValues:r,steps:f,quickSetupResource:I,autoCreateClasses:Q,fetchPreviousData:B,updateField:Z,updateFieldArray:z,submitEmailAccount:J,autoCreateTerms:X,usePreviousData:ee,nextStep:te,prevStep:se,submitForm:$,checkMissingFields:G,formatFieldName:Y}}},ts={class:"p-4 max-w-4xl mx-auto"},ss={key:0},is={class:"text-2xl font-semibold mb-6"},os={key:0,class:"missing-fields-alert"},ns={class:"alert-header"},as={class:"alert-content"},rs={class:"missing-fields-list"},ls={class:"flex justify-between gap-4"},ds=["disabled"],ms={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},us={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},cs={class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},ps={key:0,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},vs={key:1,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},fs={class:"mt-3 text-lg font-medium text-gray-900"},bs={class:"mt-2 text-sm text-gray-500"},hs={class:"mt-5"},gs={key:3,class:"text-center mt-10"};function xs(t,e,n,o,u,a){return d(),m("div",ts,[o.currentStep<o.steps.length?(d(),m("div",ss,[s("h2",is,v(o.steps[o.currentStep].title),1),o.missingFields.length>0&&o.showMissingFields?(d(),m("div",os,[s("div",ns,[e[5]||(e[5]=s("div",{class:"alert-icon"},[s("svg",{class:"icon",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})])],-1)),e[6]||(e[6]=s("h3",{class:"alert-title"},"Required Information Missing",-1)),s("button",{onClick:e[0]||(e[0]=i=>o.showMissingFields=!1),class:"close-button"},e[4]||(e[4]=[s("svg",{class:"close-icon",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1)]))]),s("div",as,[e[8]||(e[8]=s("p",{class:"alert-description"},"Please fill in the following required fields before proceeding:",-1)),s("ul",rs,[(d(!0),m(h,null,g(o.missingFields,(i,l)=>(d(),m("li",{key:l,class:"missing-field-item"},[e[7]||(e[7]=s("span",{class:"field-bullet"},"•",-1)),w(" "+v(i),1)]))),128))])])])):_("",!0),(d(),ue(ce(o.steps[o.currentStep].component),{values:o.formValues,previousDataList:o.previousDataList,onUpdateField:o.updateField,onUpdateFieldArray:o.updateFieldArray,onSubmitEmail:o.submitEmailAccount,onAutoCreateTerms:o.autoCreateTerms,onAutoCreateClasses:o.autoCreateClasses,onUsePreviousData:o.usePreviousData,class:"mb-6"},null,40,["values","previousDataList","onUpdateField","onUpdateFieldArray","onSubmitEmail","onAutoCreateTerms","onAutoCreateClasses","onUsePreviousData"])),s("div",ls,[o.currentStep>0?(d(),m("button",{key:0,onClick:e[1]||(e[1]=(...i)=>o.prevStep&&o.prevStep(...i)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"}," Back ")):_("",!0),s("button",{onClick:e[2]||(e[2]=(...i)=>o.nextStep&&o.nextStep(...i)),class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:o.isSubmitting||o.quickSetupResource.loading},v(o.currentStep===o.steps.length-1?o.isSubmitting?"Submitting...":"Submit":"Next"),9,ds)])])):_("",!0),o.isSubmitting?(d(),m("div",ms,e[9]||(e[9]=[s("div",{class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},[s("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),s("h3",{class:"text-lg font-medium text-gray-900"},"Submitting your data..."),s("p",{class:"mt-2 text-sm text-gray-500"},"Please wait while we process your information.")],-1)]))):_("",!0),o.showResultMessage?(d(),m("div",us,[s("div",cs,[o.submitSuccess?(d(),m("div",ps,e[10]||(e[10]=[s("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(d(),m("div",vs,e[11]||(e[11]=[s("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",fs,v(o.submitSuccess?"Form Submitted Successfully!":"Submission Failed"),1),s("p",bs,v(o.submitSuccess?"Your data has been successfully processed.":o.errorMessage||"An error occurred while submitting the form."),1),s("div",hs,[s("button",{onClick:e[3]||(e[3]=i=>o.showResultMessage=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," OK ")])])])):_("",!0),o.currentStep>=o.steps.length&&!o.isSubmitting&&!o.showResultMessage?(d(),m("div",gs,e[12]||(e[12]=[s("h2",{class:"text-2xl font-semibold text-green-600"},"Form Submitted Successfully!",-1)]))):_("",!0)])}const Cs=P(es,[["render",xs],["__scopeId","data-v-9bf6a35d"]]),Ss={components:{MultiStepForm:Cs}},ys={class:"app-container"};function Ds(t,e,n,o,u,a){const i=ve("MultiStepForm");return d(),m("div",ys,[pe(i)])}const _s=P(Ss,[["render",Ds]]);export{_s as default};
