var Y=Object.defineProperty,O=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var A=(t,e,o)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,S=(t,e)=>{for(var o in e||(e={}))U.call(e,o)&&A(t,o,e[o]);if(P)for(var o of P(e))E.call(e,o)&&A(t,o,e[o]);return t},D=(t,e)=>O(t,N(e));var w=(t,e,o)=>new Promise((a,r)=>{var n=l=>{try{d(o.next(l))}catch(h){r(h)}},i=l=>{try{d(o.throw(l))}catch(h){r(h)}},d=l=>l.done?a(l.value):Promise.resolve(l.value).then(n,i);d((o=o.apply(t,e)).next())});import{_ as x,o as m,c as u,b as s,f as p,v as f,g as k,F as v,h as b,t as c,i as g,r as y,j as C,k as F,n as T,l as j,m as V,e as I,p as L,d as M,a as B}from"./index-BsE_pyWB.js";import{p as G,s as W,q as $}from"./apiUtils-CCQy72K0.js";const R={props:{values:Object},computed:{email:{get(){return this.values.email},set(t){this.$emit("update-field",{field:"email",value:t})}},googleAppPassword:{get(){return this.values.googleAppPassword},set(t){this.$emit("update-field",{field:"googleAppPassword",value:t})}}},methods:{updateField(t,e){this.$emit("update-field",{field:t,value:e})}}},K={class:"card"},q={class:"field"},Q={class:"field"};function z(t,e,o,a,r,n){return m(),u("div",K,[s("div",q,[e[5]||(e[5]=s("label",null,"Email Address",-1)),p(s("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=i=>n.email=i),placeholder:"Enter your email address",onInput:e[1]||(e[1]=i=>n.updateField("email",i.target.value))},null,544),[[f,n.email]])]),s("div",Q,[e[6]||(e[6]=s("label",null,"Google App Password",-1)),p(s("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=i=>n.googleAppPassword=i),placeholder:"Enter your Google app password",onInput:e[3]||(e[3]=i=>n.updateField("googleAppPassword",i.target.value))},null,544),[[f,n.googleAppPassword]])]),s("button",{onClick:e[4]||(e[4]=i=>t.$emit("submit-email"))},"Submit Email Account")])}const J=x(R,[["render",z],["__scopeId","data-v-a1f91314"]]),H={props:{values:Object},data(){return{selectedTerm:"",lastValidTermCount:0}},computed:{academicYear:{get(){return this.values.academicYear},set(t){this.$emit("update-field",{field:"academicYear",value:t})}},academicYearStart:{get(){return this.values.academicYearStart},set(t){this.$emit("update-field",{field:"academicYearStart",value:t})}},academicYearEnd:{get(){return this.values.academicYearEnd},set(t){this.$emit("update-field",{field:"academicYearEnd",value:t})}},numberOfTerms:{get(){return this.values.numberOfTerms},set(t){this.$emit("update-field",{field:"numberOfTerms",value:t})}}},methods:{handleNumberOfTermsChange(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.adjustTermsToMatchCount()):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.adjustTermsToMatchCount()},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.adjustTermsToMatchCount())},adjustTermsToMatchCount(){const t=this.values.terms.length,e=this.numberOfTerms;if(e>t){const o=e-t,a=[...this.values.terms];for(let r=0;r<o;r++){const n=t+r+1,{startDate:i,endDate:d}=this.calculateTermDates(n,e);a.push({name:`Term ${n}`,startDate:i,endDate:d})}this.$emit("update-field-array",{field:"terms",value:a})}else if(e<t){const o=t-e,a=[...this.values.terms];a.splice(-o,o),this.$emit("update-field-array",{field:"terms",value:a})}},calculateTermDates(t,e){if(!this.academicYearStart||!this.academicYearEnd)return{startDate:"",endDate:""};const o=new Date(this.academicYearStart),n=(new Date(this.academicYearEnd)-o)/e,i=new Date(o.getTime()+n*(t-1)),d=new Date(o.getTime()+n*t-1),l=h=>h.toISOString().split("T")[0];return{startDate:l(i),endDate:l(d)}},formatDate(t){if(!t)return"";const e={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,e)},updateField(t,e){this.$emit("update-field",{field:t,value:e})},updateTermField(t,e,o){this.$emit("update-field-array",{field:"terms",index:t,subField:e,value:o})},addTerm(){const t={name:"",startDate:"",endDate:""};this.$emit("update-field-array",{field:"terms",value:[...this.values.terms,t]}),this.numberOfTerms=this.values.terms.length},removeTerm(t){const e=[...this.values.terms];e.splice(t,1),this.$emit("update-field-array",{field:"terms",value:e}),this.numberOfTerms=e.length},handleTermsInput(t){const e=parseInt(t.target.value);!isNaN(e)&&e>0?(this.numberOfTerms=e,this.lastValidTermCount=e,this.$emit("auto-create-terms")):this.numberOfTerms=this.lastValidTermCount},incrementTerms(){this.numberOfTerms=parseInt(this.numberOfTerms)+1,this.$emit("auto-create-terms")},decrementTerms(){this.numberOfTerms>1&&(this.numberOfTerms=parseInt(this.numberOfTerms)-1,this.$emit("auto-create-terms"))}},mounted(){this.lastValidTermCount=this.numberOfTerms||1}},X={class:"academic-year-form"},Z={class:"form-grid"},ee={class:"form-row"},te={class:"form-group full-width"},se={class:"form-row date-range-row"},ie={class:"form-group"},oe={class:"form-group"},ne={class:"form-row"},re={class:"form-group full-width"},ae={class:"number-input-group"},le={class:"number-input-buttons"},de=["disabled"],me={class:"form-row"},ue={class:"form-group full-width"},ce=["value"],pe={class:"terms-list"},he={class:"term-header"},fe={class:"term-title"},ve=["onClick"],be={class:"term-body"},ge={class:"form-group"},Ce=["onUpdate:modelValue","placeholder","onInput"],xe={class:"form-row term-dates-row"},Se={class:"form-group"},De=["onUpdate:modelValue","onInput"],ye={class:"form-group"},Te=["onUpdate:modelValue","onInput"],we={class:"form-actions"};function je(t,e,o,a,r,n){return m(),u("div",X,[e[23]||(e[23]=s("div",{class:"form-header"},[s("h3",{class:"form-title"},"Academic Year Setup"),s("p",{class:"form-subtitle"}," Provide details about the academic year, its duration, and terms. ")],-1)),s("div",Z,[s("div",ee,[s("div",te,[e[13]||(e[13]=s("label",{class:"form-label"},"Academic Year",-1)),p(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>n.academicYear=i),class:"form-input",placeholder:"e.g., 2023-2024",onInput:e[1]||(e[1]=i=>n.updateField("academicYear",i.target.value))},null,544),[[f,n.academicYear]])])]),s("div",se,[s("div",ie,[e[14]||(e[14]=s("label",{class:"form-label"},"Start Date",-1)),p(s("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=i=>n.academicYearStart=i),class:"form-input",onInput:e[3]||(e[3]=i=>n.updateField("academicYearStart",i.target.value))},null,544),[[f,n.academicYearStart]])]),s("div",oe,[e[15]||(e[15]=s("label",{class:"form-label"},"End Date",-1)),p(s("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=i=>n.academicYearEnd=i),class:"form-input",onInput:e[5]||(e[5]=i=>n.updateField("academicYearEnd",i.target.value))},null,544),[[f,n.academicYearEnd]])])]),s("div",ne,[s("div",re,[e[16]||(e[16]=s("label",{class:"form-label"},"Number of Terms",-1)),s("div",ae,[p(s("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=i=>n.numberOfTerms=i),class:"form-input number-input",placeholder:"e.g., 3",min:"1",onInput:e[7]||(e[7]=(...i)=>n.handleNumberOfTermsChange&&n.handleNumberOfTermsChange(...i))},null,544),[[f,n.numberOfTerms,void 0,{number:!0}]]),s("div",le,[s("button",{class:"number-input-btn minus-btn",onClick:e[8]||(e[8]=(...i)=>n.decrementTerms&&n.decrementTerms(...i)),disabled:n.numberOfTerms<=1}," − ",8,de),s("button",{class:"number-input-btn plus-btn",onClick:e[9]||(e[9]=(...i)=>n.incrementTerms&&n.incrementTerms(...i))}," + ")])])])]),s("div",me,[s("div",ue,[e[18]||(e[18]=s("label",{class:"form-label"},"Current Academic Term",-1)),p(s("select",{"onUpdate:modelValue":e[10]||(e[10]=i=>r.selectedTerm=i),class:"form-select",onChange:e[11]||(e[11]=i=>n.updateField("selectedTerm",i.target.value))},[e[17]||(e[17]=s("option",{value:""},"-- Select a Term --",-1)),(m(!0),u(v,null,b(o.values.terms,(i,d)=>(m(),u("option",{key:d,value:i.name},c(i.name)+" ("+c(n.formatDate(i.startDate))+" - "+c(n.formatDate(i.endDate))+") ",9,ce))),128))],544),[[k,r.selectedTerm]])])])]),s("div",pe,[(m(!0),u(v,null,b(o.values.terms,(i,d)=>(m(),u("div",{key:d,class:"term-card"},[s("div",he,[s("h4",fe,"Term "+c(d+1),1),s("button",{class:"btn-icon",onClick:l=>n.removeTerm(d),title:"Remove term"}," ✕ ",8,ve)]),s("div",be,[s("div",ge,[e[19]||(e[19]=s("label",{class:"form-label"},"Term Name",-1)),p(s("input",{type:"text","onUpdate:modelValue":l=>i.name=l,class:"form-input",placeholder:`e.g., Spring ${d+1}`,onInput:l=>n.updateTermField(d,"name",l.target.value)},null,40,Ce),[[f,i.name]])]),s("div",xe,[s("div",Se,[e[20]||(e[20]=s("label",{class:"form-label"},"Start Date",-1)),p(s("input",{type:"date","onUpdate:modelValue":l=>i.startDate=l,class:"form-input",onInput:l=>n.updateTermField(d,"startDate",l.target.value)},null,40,De),[[f,i.startDate]])]),s("div",ye,[e[21]||(e[21]=s("label",{class:"form-label"},"End Date",-1)),p(s("input",{type:"date","onUpdate:modelValue":l=>i.endDate=l,class:"form-input",onInput:l=>n.updateTermField(d,"endDate",l.target.value)},null,40,Te),[[f,i.endDate]])])])])]))),128))]),s("div",we,[s("button",{class:"btn btn-primary",onClick:e[12]||(e[12]=(...i)=>n.addTerm&&n.addTerm(...i))},e[22]||(e[22]=[s("span",{class:"icon"},"+",-1),g(" Add Term ")]))])])}const _e=x(H,[["render",je],["__scopeId","data-v-401732b4"]]),ke={props:{values:Object,previousDataList:Array},emits:["update-field","use-previous-data"],setup(t,{emit:e}){const o=y(!1),a=y(null),r=y(t.values.dontCreateClasses||!1),n=y(!1),i=y("");return{loading:o,selectedPreviousData:a,dontCreateClasses:r,showSuccessMessage:n,usedPreviousYear:i,handleUsePreviousData:()=>{if(!a.value){console.warn("No data selected");return}o.value=!0,e("use-previous-data",a.value),i.value=a.value.academicYear,n.value=!0,o.value=!1,setTimeout(()=>{n.value=!1},5e3)},updateDontCreateClasses:()=>{e("update-field",{field:"dontCreateClasses",value:r.value})}}}},Pe={class:"card"},Ae={key:0,class:"loading"},Ve={key:1},Ye={key:0,class:"success-message"},Oe={class:"field"},Ne=["value"],Ue=["disabled"],Ee={class:"switch-container"};function Fe(t,e,o,a,r,n){return m(),u("div",Pe,[e[6]||(e[6]=s("h3",{class:"section-title"},"Use Previous Data",-1)),a.loading?(m(),u("div",Ae,"Loading previous data...")):(m(),u("div",Ve,[a.showSuccessMessage?(m(),u("div",Ye," ✓ Previous data from "+c(a.usedPreviousYear)+" has been successfully loaded ",1)):C("",!0),s("div",Oe,[p(s("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.selectedPreviousData=i)},[e[4]||(e[4]=s("option",{value:null},"Select a year",-1)),(m(!0),u(v,null,b(o.previousDataList,(i,d)=>(m(),u("option",{key:d,value:i},c(i.academicYear),9,Ne))),128))],512),[[k,a.selectedPreviousData]])]),s("button",{onClick:e[1]||(e[1]=(...i)=>a.handleUsePreviousData&&a.handleUsePreviousData(...i)),disabled:!a.selectedPreviousData}," Use Previous Data ",8,Ue),s("div",Ee,[e[5]||(e[5]=s("label",null,"Don't create classes",-1)),p(s("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=i=>a.dontCreateClasses=i),onChange:e[3]||(e[3]=(...i)=>a.updateDontCreateClasses&&a.updateDontCreateClasses(...i))},null,544),[[F,a.dontCreateClasses]])])]))])}const Ie=x(ke,[["render",Fe],["__scopeId","data-v-99250480"]]),Le=[{id:1,name:"Pre-K"},{id:2,name:"Kindergarten"},{id:3,name:"1st Grade"},{id:4,name:"2nd Grade"},{id:5,name:"3rd Grade"},{id:6,name:"4th Grade"},{id:7,name:"5th Grade"},{id:8,name:"6th Grade"},{id:9,name:"7th Grade"},{id:10,name:"8th Grade"},{id:11,name:"9th Grade"},{id:12,name:"10th Grade"},{id:13,name:"11th Grade"},{id:14,name:"12th Grade"},{id:15,name:"Other"}],Me={school:["Nursery","Jr KG","Sr KG","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th"],college:["FY BSc","SY BSc","TY BSc","FY BCA","SY BCA","TY BCA","FY BTech","SY BTech","TY BTech","Final Year BTech","FY BCom","SY BCom","TY BCom","MBA"]},Be={props:{values:Object},data(){return{selectedInstitution:"",editablePrograms:[],availablePrograms:Le}},watch:{"values.classes":{immediate:!0,handler(t){t&&t.length>0&&(this.editablePrograms=[...t])}}},computed:{selectedPrograms(){return this.values.classes||[]}},methods:{isSelected(t){return this.selectedPrograms.some(e=>e.id===t.id)},toggleProgram(t){let e;this.isSelected(t)?e=this.selectedPrograms.filter(o=>o.id!==t.id):e=[...this.selectedPrograms,{id:t.id,className:t.name,subjects:[],divisions:[]}],this.updatePrograms(e)},handleEditProgram(t,e){const o=this.editablePrograms.map(a=>a.id===t?D(S({},a),{className:e}):a);this.updatePrograms(o)},handleDeleteProgram(t){const e=this.editablePrograms.filter(o=>o.id!==t);this.updatePrograms(e)},handleAddProgram(){const t={id:Math.random().toString(),className:"",subjects:[],divisions:[]},e=[...this.editablePrograms,t];this.updatePrograms(e)},handleInstitutionChange(){const t=(Me[this.selectedInstitution]||[]).map(e=>({id:Math.random().toString(),className:e,subjects:[],divisions:[]}));this.updatePrograms(t)},updatePrograms(t){this.editablePrograms=t,this.$emit("update-field-array",{field:"classes",value:t})}}},Ge={class:"program-selector-container"},We={class:"institution-selector"},$e={key:0,class:"programs-list"},Re=["onUpdate:modelValue","onInput"],Ke=["onClick"],qe={key:1,class:"quick-select"},Qe={class:"program-grid"},ze=["onClick"];function Je(t,e,o,a,r,n){return m(),u("div",Ge,[s("div",We,[e[4]||(e[4]=s("label",{class:"form-label"},"Select Institution Type",-1)),p(s("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>r.selectedInstitution=i),class:"form-select",onChange:e[1]||(e[1]=(...i)=>n.handleInstitutionChange&&n.handleInstitutionChange(...i))},e[3]||(e[3]=[s("option",{value:""},"Select Institution",-1),s("option",{value:"school"},"School",-1),s("option",{value:"college"},"College",-1)]),544),[[k,r.selectedInstitution]])]),r.editablePrograms.length>0?(m(),u("div",$e,[e[6]||(e[6]=s("h3",{class:"section-title"},"Classes List",-1)),(m(!0),u(v,null,b(r.editablePrograms,i=>(m(),u("div",{key:i.id,class:"program-item"},[p(s("input",{type:"text","onUpdate:modelValue":d=>i.className=d,class:"program-input",onInput:d=>n.handleEditProgram(i.id,d.target.value)},null,40,Re),[[f,i.className]]),s("button",{class:"delete-btn",onClick:d=>n.handleDeleteProgram(i.id),title:"Remove class"},e[5]||(e[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]),8,Ke)]))),128))])):C("",!0),r.selectedInstitution===""?(m(),u("div",qe,[e[7]||(e[7]=s("h3",{class:"section-title"},"Quick Select Programs",-1)),s("div",Qe,[(m(!0),u(v,null,b(r.availablePrograms,i=>(m(),u("div",{key:i.id,class:T(["program-card",{selected:n.isSelected(i)}]),onClick:d=>n.toggleProgram(i)},c(i.name),11,ze))),128))])])):C("",!0),s("button",{class:"add-btn",onClick:e[2]||(e[2]=(...i)=>n.handleAddProgram&&n.handleAddProgram(...i))},e[8]||(e[8]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),g(" Add Class ")]))])}const He=x(Be,[["render",Je],["__scopeId","data-v-f6b17094"]]),Xe={props:{values:Object},data(){return{newCommonSubject:"",newCommonDivision:"",commonSubjectsList:[],commonDivisionsList:[],classesWithText:[],commonSubjects:["Math","Social Studies","Science","English","History","Geography","Physics","Chemistry","Biology","Computer","Civics","Hindi","Marathi","Arabic","Play"],commonDivisions:["A","B","C","D","E","F"]}},created(){this.values.commonSubjects&&(this.commonSubjectsList=[...this.values.commonSubjects]),this.values.commonDivisions&&(this.commonDivisionsList=[...this.values.commonDivisions])},watch:{"values.classes":{immediate:!0,deep:!0,handler(t){this.classesWithText=t.map(e=>D(S({},e),{subjectsText:"",divisionsText:"",specificSubjects:e.subjects?e.subjects.filter(o=>!this.commonSubjectsList.includes(o)):[],specificDivisions:e.divisions?e.divisions.filter(o=>{const a=o.divisionName.split("-").slice(1).join("-");return!this.commonDivisionsList.includes(a)}):[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}))}},commonSubjectsList:{handler(t){this.$emit("update-field",{field:"commonSubjects",value:t}),this.updateAllClassesWithCommonData()},deep:!0},commonDivisionsList:{handler(t){this.$emit("update-field",{field:"commonDivisions",value:t}),this.updateAllClassesWithCommonData()},deep:!0}},methods:{addCommonSubject(){this.newCommonSubject.trim()&&!this.commonSubjectsList.includes(this.newCommonSubject.trim())&&(this.commonSubjectsList.push(this.newCommonSubject.trim()),this.newCommonSubject="")},removeCommonSubject(t){this.commonSubjectsList.splice(t,1)},isCommonSubjectSelected(t){return this.commonSubjectsList.includes(t)},toggleCommonSubject(t){this.isCommonSubjectSelected(t)?this.removeCommonSubject(this.commonSubjectsList.indexOf(t)):(this.newCommonSubject=t,this.addCommonSubject())},addCommonDivision(){this.newCommonDivision.trim()&&!this.commonDivisionsList.includes(this.newCommonDivision.trim())&&(this.commonDivisionsList.push(this.newCommonDivision.trim()),this.newCommonDivision="")},removeCommonDivision(t){this.commonDivisionsList.splice(t,1)},isCommonDivisionSelected(t){return this.commonDivisionsList.includes(t)},toggleCommonDivision(t){this.isCommonDivisionSelected(t)?this.removeCommonDivision(this.commonDivisionsList.indexOf(t)):(this.newCommonDivision=t,this.addCommonDivision())},addSpecificSubject(t){if(this.classesWithText[t].subjectsText.trim()){const e=[...this.classesWithText];e[t].specificSubjects=[...e[t].specificSubjects,e[t].subjectsText.trim()],e[t].subjectsText="",this.emitUpdatedClasses(e)}},removeSpecificSubject(t,e){const o=[...this.classesWithText];o[t].specificSubjects.splice(e,1),this.emitUpdatedClasses(o)},addSpecificDivision(t){if(this.classesWithText[t].divisionsText.trim()){const e=[...this.classesWithText],o=e[t].className||"Class";e[t].specificDivisions=[...e[t].specificDivisions,{divisionName:`${o}-${e[t].divisionsText.trim()}`}],e[t].divisionsText="",this.emitUpdatedClasses(e)}},removeSpecificDivision(t,e){const o=[...this.classesWithText];o[t].specificDivisions.splice(e,1),this.emitUpdatedClasses(o)},updateClassName(t,e){const o=[...this.classesWithText],a=o[t].className;o[t].className=e,o[t].specificDivisions&&(o[t].specificDivisions=o[t].specificDivisions.map(r=>{const n=r.divisionName.replace(`${a}-`,"");return{divisionName:`${e}-${n}`}})),this.emitUpdatedClasses(o)},updateAllClassesWithCommonData(){const t=this.classesWithText.map(e=>D(S({},e),{specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[]}));this.emitUpdatedClasses(t)},isCommonSubjectExcluded(t,e){var a;return((a=this.classesWithText[t].excludedCommonSubjects)==null?void 0:a.includes(e))||!1},toggleExcludeCommonSubject(t,e){const o=[...this.classesWithText];o[t].excludedCommonSubjects||(o[t].excludedCommonSubjects=[]);const a=o[t].excludedCommonSubjects.indexOf(e);a>=0?o[t].excludedCommonSubjects.splice(a,1):o[t].excludedCommonSubjects.push(e),this.emitUpdatedClasses(o)},isCommonDivisionExcluded(t,e){var a;return((a=this.classesWithText[t].excludedCommonDivisions)==null?void 0:a.includes(e))||!1},toggleExcludeCommonDivision(t,e){const o=[...this.classesWithText];o[t].excludedCommonDivisions||(o[t].excludedCommonDivisions=[]);const a=o[t].excludedCommonDivisions.indexOf(e);a>=0?o[t].excludedCommonDivisions.splice(a,1):o[t].excludedCommonDivisions.push(e),this.emitUpdatedClasses(o)},emitUpdatedClasses(t){this.$emit("update-field-array",{field:"classes",value:t.map(e=>({className:e.className,subjects:[...this.commonSubjectsList.filter(o=>{var a;return!((a=e.excludedCommonSubjects)!=null&&a.includes(o))}),...e.specificSubjects||[]],divisions:[...this.commonDivisionsList.filter(o=>{var a;return!((a=e.excludedCommonDivisions)!=null&&a.includes(o))}).map(o=>({divisionName:`${e.className}-${o}`})),...e.specificDivisions||[]],excludedCommonSubjects:e.excludedCommonSubjects||[],excludedCommonDivisions:e.excludedCommonDivisions||[],specificSubjects:e.specificSubjects||[],specificDivisions:e.specificDivisions||[]}))})}}},Ze={class:"bg-white shadow rounded-lg p-6 space-y-6"},et={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},tt=["onClick"],st={class:"quick-select mt-3"},it={class:"subject-grid grid grid-cols-3 gap-2"},ot=["onClick"],nt={class:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md min-h-[42px]"},rt=["onClick"],at={class:"quick-select mt-3"},lt={class:"division-grid grid grid-cols-6 gap-2"},dt=["onClick"],mt={class:"overflow-x-auto"},ut={class:"min-w-full text-sm text-left text-gray-700"},ct={class:"px-4 py-2"},pt={class:"px-4 py-2"},ht=["onUpdate:modelValue","onInput"],ft={class:"px-4 py-2 w-[300px]"},vt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},bt=["onClick"],gt=["onClick"],Ct={class:"flex gap-2"},xt=["onUpdate:modelValue","onKeydown"],St=["onClick"],Dt={class:"px-4 py-2"},yt={class:"flex flex-wrap gap-1 mb-1 min-h-[40px]"},Tt=["onClick"],wt=["onClick"],jt={class:"flex gap-2"},_t=["onUpdate:modelValue","onKeydown"],kt=["onClick"];function Pt(t,e,o,a,r,n){return m(),u("div",Ze,[s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Subjects for All Classes",-1)),s("div",et,[(m(!0),u(v,null,b(r.commonSubjectsList,(i,d)=>(m(),u("span",{key:d,class:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm"},[g(c(i)+" ",1),s("button",{onClick:l=>n.removeCommonSubject(d),class:"ml-1.5 text-blue-500 hover:text-blue-700"}," × ",8,tt)]))),128)),p(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>r.newCommonSubject=i),onKeydown:e[1]||(e[1]=j((...i)=>n.addCommonSubject&&n.addCommonSubject(...i),["enter"])),onBlur:e[2]||(e[2]=(...i)=>n.addCommonSubject&&n.addCommonSubject(...i)),placeholder:"Add subjects...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[f,r.newCommonSubject]])]),s("div",st,[e[6]||(e[6]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Subjects",-1)),s("div",it,[(m(!0),u(v,null,b(r.commonSubjects,i=>(m(),u("div",{key:i,class:T(["subject-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-blue-100 border-blue-300":n.isCommonSubjectSelected(i),"bg-gray-50 hover:bg-gray-100":!n.isCommonSubjectSelected(i)}]),onClick:d=>n.toggleCommonSubject(i)},c(i),11,ot))),128))])])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Common Divisions for All Classes",-1)),s("div",nt,[(m(!0),u(v,null,b(r.commonDivisionsList,(i,d)=>(m(),u("span",{key:d,class:"inline-flex items-center px-3 py-1 rounded-full bg-green-100 text-green-800 text-sm"},[g(c(i)+" ",1),s("button",{onClick:l=>n.removeCommonDivision(d),class:"ml-1.5 text-green-500 hover:text-green-700"}," × ",8,rt)]))),128)),p(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=i=>r.newCommonDivision=i),onKeydown:e[4]||(e[4]=j((...i)=>n.addCommonDivision&&n.addCommonDivision(...i),["enter"])),onBlur:e[5]||(e[5]=(...i)=>n.addCommonDivision&&n.addCommonDivision(...i)),placeholder:"Add divisions...",class:"flex-1 min-w-[100px] px-2 py-1 border-0 focus:ring-0 focus:outline-none"},null,544),[[f,r.newCommonDivision]])]),s("div",at,[e[8]||(e[8]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Select Divisions",-1)),s("div",lt,[(m(!0),u(v,null,b(r.commonDivisions,i=>(m(),u("div",{key:i,class:T(["division-card px-3 py-2 border rounded-md text-center cursor-pointer text-sm",{"bg-green-100 border-green-300":n.isCommonDivisionSelected(i),"bg-gray-50 hover:bg-gray-100":!n.isCommonDivisionSelected(i)}]),onClick:d=>n.toggleCommonDivision(i)},c(i),11,dt))),128))])])]),e[11]||(e[11]=s("h3",{class:"text-lg font-semibold text-gray-800 border-b pb-2"},"Classes Overview",-1)),s("div",mt,[s("table",ut,[e[10]||(e[10]=s("thead",{class:"bg-gray-100"},[s("tr",null,[s("th",{class:"px-4 py-2 font-medium"},"#"),s("th",{class:"px-4 py-2 font-medium"},"Class Name / Programs"),s("th",{class:"px-4 py-2 font-medium"},"Subjects / Courses"),s("th",{class:"px-4 py-2 font-medium"},"Divisions / Student Groups")])],-1)),s("tbody",null,[(m(!0),u(v,null,b(r.classesWithText,(i,d)=>(m(),u("tr",{key:d,class:"border-t hover:bg-gray-50"},[s("td",ct,c(d+1),1),s("td",pt,[p(s("input",{type:"text","onUpdate:modelValue":l=>i.className=l,onInput:l=>n.updateClassName(d,l.target.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,ht),[[f,i.className]])]),s("td",ft,[s("div",vt,[(m(!0),u(v,null,b(r.commonSubjectsList,(l,h)=>(m(),u("span",{key:"common-"+h,class:T(["inline-flex items-center px-2 py-1 rounded-full text-xs",n.isCommonSubjectExcluded(d,l)?"bg-red-100 text-red-600":"bg-blue-50 text-blue-600"])},[g(c(l)+" ",1),s("button",{onClick:V(_=>n.toggleExcludeCommonSubject(d,l),["stop"]),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"},c(n.isCommonSubjectExcluded(d,l)?"+":"×"),9,bt)],2))),128)),(m(!0),u(v,null,b(i.specificSubjects,(l,h)=>(m(),u("span",{key:"specific-"+h,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs"},[g(c(l)+" ",1),s("button",{onClick:_=>n.removeSpecificSubject(d,h),class:"ml-1 text-blue-500 hover:text-blue-700 text-xs"}," × ",8,gt)]))),128))]),s("div",Ct,[p(s("input",{type:"text","onUpdate:modelValue":l=>i.subjectsText=l,onKeydown:j(l=>n.addSpecificSubject(d),["enter"]),placeholder:"Add class-specific subject...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,xt),[[f,i.subjectsText]]),s("button",{onClick:l=>n.addSpecificSubject(d),class:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs"}," Add ",8,St)])]),s("td",Dt,[s("div",yt,[(m(!0),u(v,null,b(r.commonDivisionsList,(l,h)=>(m(),u("span",{key:"common-"+h,class:T(["inline-flex items-center px-2 py-1 rounded-full text-xs",n.isCommonDivisionExcluded(d,l)?"bg-red-100 text-red-600 border border-red-300":"bg-green-50 text-green-600"])},[g(c(l)+" ",1),s("button",{onClick:V(_=>n.toggleExcludeCommonDivision(d,l),["stop"]),class:"ml-1 text-green-500 hover:text-green-700 text-xs"},c(n.isCommonDivisionExcluded(d,l)?"+":"×"),9,Tt)],2))),128)),(m(!0),u(v,null,b(i.specificDivisions,(l,h)=>(m(),u("span",{key:"specific-"+h,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800 text-xs"},[g(c(l.divisionName.split("-").slice(1).join("-"))+" ",1),s("button",{onClick:_=>n.removeSpecificDivision(d,h),class:"ml-1 text-green-500 hover:text-green-700 text-xs"}," × ",8,wt)]))),128))]),s("div",jt,[p(s("input",{type:"text","onUpdate:modelValue":l=>i.divisionsText=l,onKeydown:j(l=>n.addSpecificDivision(d),["enter"]),placeholder:"Add class-specific division...",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-xs"},null,40,_t),[[f,i.divisionsText]]),s("button",{onClick:l=>n.addSpecificDivision(d),class:"px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-xs"}," Add ",8,kt)])])]))),128))])])])])}const At=x(Xe,[["render",Pt],["__scopeId","data-v-9515f27e"]]),Vt={components:{EmailAccountSetup:J,AcademicYearTerms:_e,UsePreviousData:Ie,ProgramSelection:He,SubjectsDivisions:At},data(){return{currentStep:0,selectedTerm:"",datePicker:{showFrom:!1,showTo:!1,currentField:""},previousDataList:[],selectedPreviousData:null,isSubmitting:!1,showResultMessage:!1,submitSuccess:!1,errorMessage:"",formValues:{email:"",googleAppPassword:"",academicYear:"",academicYearStart:"",academicYearEnd:"",numberOfTerms:"",terms:[],selectedTerm:"",classes:[],subjects:[],divisions:[],commonSubjects:[],commonDivisions:[],dontCreateClasses:!1},steps:[{title:"Email Account Setup (Optional)",component:"EmailAccountSetup"},{title:"Academic Year & Terms",component:"AcademicYearTerms"},{title:"Use Previous Data",component:"UsePreviousData"},{title:"Select Institution Type & Classes",component:"ProgramSelection"},{title:"Subjects and Divisions",component:"SubjectsDivisions"}]}},created(){this.fetchPreviousData()},methods:{handleFieldUpdate(t){this.formValues[t.field]=t.value},handleFieldArrayUpdate(t){this.formValues[t.field]=t.value},autoCreateClasses({classNames:t}){const e=[...this.formValues.classes],o=e.reduce((r,n)=>Math.max(r,n.classIndex||0),0),a=t.map((r,n)=>({className:r,subjects:[],divisions:[{divisionName:""}],classIndex:o+n+1}));this.formValues.classes=[...e,...a]},fetchPreviousData(){return w(this,null,function*(){try{const e=(yield G()).message||[];this.previousDataList=e.map(o=>D(S({},o),{academicYear:JSON.parse(o.json_data).academicYear}))}catch(t){console.error("Error fetching previous data:",t)}})},updateField({field:t,value:e}){this.formValues[t]=e},updateFieldArray({field:t,index:e,subField:o,value:a}){e!==void 0&&o?this.formValues[t][e][o]=a:e!==void 0?this.formValues[t][e]=a:this.formValues[t]=a},submitEmailAccount(){return w(this,null,function*(){const{email:t,googleAppPassword:e}=this.formValues;if(!t||!e){alert("Please provide both email and Google app password.");return}try{yield W({email_id:t,password:e}),alert("Email account setup successfully!")}catch(o){console.error("Error setting up email account:",o),alert("Error setting up email account.")}})},autoCreateTerms(){const t=parseInt(this.formValues.numberOfTerms,10),e=new Date(this.formValues.academicYearStart),o=new Date(this.formValues.academicYearEnd);if(!t||t<=0){alert("Please enter a valid number of terms.");return}if(isNaN(e.getTime())){alert("Please enter valid 'From' date.");return}if(isNaN(o.getTime())){alert("Please enter valid 'To' date.");return}if(e>=o){alert("'From' date must be before 'To' date.");return}const a=Math.ceil((o-e)/(1e3*60*60*24)),r=Math.floor(a/t),n=[];let i=new Date(e);for(let d=0;d<t;d++){const l=new Date(i);l.setDate(i.getDate()+r-1),d===t-1&&l.setTime(o.getTime()),n.push({name:`Term ${d+1}`,startDate:i.toISOString().split("T")[0],endDate:l.toISOString().split("T")[0]}),i=new Date(l),i.setDate(i.getDate()+1)}this.formValues.terms=n},usePreviousData(t){if(!(t!=null&&t.json_data)){console.error("Invalid or missing previous data");return}try{const e=JSON.parse(t.json_data);this.formValues.classes=e.classes||[],this.formValues.subjects=e.subjects||[]}catch(e){console.error("Error parsing previous data:",e),alert("Failed to load previous data. Please try another selection.")}},nextStep(){this.currentStep<this.steps.length-1?this.currentStep++:this.submitForm()},prevStep(){this.currentStep>0&&this.currentStep--},submitForm(){return w(this,null,function*(){this.isSubmitting=!0,this.showResultMessage=!1,this.submitSuccess=!1,this.errorMessage="";const t=["selectedTerm","commonSubjects","commonDivisions","divisions","institutionName","logo","dontCreateClasses","subjects","terms","email","googleAppPassword","classes"],e=this.checkMissingFields(this.formValues,t);if(e.length>0){alert(`Please fill in the following fields:
 - ${e.join(`
- `)}`),this.isSubmitting=!1;return}try{yield $({values:this.formValues}),this.submitSuccess=!0,this.currentStep++}catch(o){this.submitSuccess=!1,this.errorMessage=o.message||"An error occurred while submitting the form.",console.error("Submission error:",o)}finally{this.isSubmitting=!1,this.showResultMessage=!0}})},checkMissingFields(t,e){const o=[];return Object.entries(t).forEach(([a,r])=>{e.includes(a)||(Array.isArray(r)?r.length===0&&o.push(`The list of ${a} is empty`):(!r||typeof r=="string"&&r.trim()==="")&&o.push(`${a} is missing or empty`))}),o}}},Yt={class:"p-4 max-w-4xl mx-auto"},Ot={key:0},Nt={class:"text-2xl font-semibold mb-6"},Ut={class:"flex justify-between gap-4"},Et=["disabled"],Ft={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},It={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Lt={class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},Mt={key:0,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},Bt={key:1,class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},Gt={class:"mt-3 text-lg font-medium text-gray-900"},Wt={class:"mt-2 text-sm text-gray-500"},$t={class:"mt-5"},Rt={key:3,class:"text-center mt-10"};function Kt(t,e,o,a,r,n){return m(),u("div",Yt,[r.currentStep<r.steps.length?(m(),u("div",Ot,[s("h2",Nt,c(r.steps[r.currentStep].title),1),(m(),I(L(r.steps[r.currentStep].component),{values:r.formValues,previousDataList:r.previousDataList,onUpdateField:n.updateField,onUpdateFieldArray:n.updateFieldArray,onSubmitEmail:n.submitEmailAccount,onAutoCreateTerms:n.autoCreateTerms,onAutoCreateClasses:n.autoCreateClasses,onUsePreviousData:n.usePreviousData,class:"mb-6"},null,40,["values","previousDataList","onUpdateField","onUpdateFieldArray","onSubmitEmail","onAutoCreateTerms","onAutoCreateClasses","onUsePreviousData"])),s("div",Ut,[r.currentStep>0?(m(),u("button",{key:0,onClick:e[0]||(e[0]=(...i)=>n.prevStep&&n.prevStep(...i)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300"}," Back ")):C("",!0),s("button",{onClick:e[1]||(e[1]=(...i)=>n.nextStep&&n.nextStep(...i)),class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:r.isSubmitting},c(r.currentStep===r.steps.length-1?r.isSubmitting?"Submitting...":"Submit":"Next"),9,Et)])])):C("",!0),r.isSubmitting?(m(),u("div",Ft,e[3]||(e[3]=[s("div",{class:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center"},[s("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),s("h3",{class:"text-lg font-medium text-gray-900"},"Submitting your data..."),s("p",{class:"mt-2 text-sm text-gray-500"},"Please wait while we process your information.")],-1)]))):C("",!0),r.showResultMessage?(m(),u("div",It,[s("div",Lt,[r.submitSuccess?(m(),u("div",Mt,e[4]||(e[4]=[s("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(m(),u("div",Bt,e[5]||(e[5]=[s("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),s("h3",Gt,c(r.submitSuccess?"Form Submitted Successfully!":"Submission Failed"),1),s("p",Wt,c(r.submitSuccess?"Your data has been successfully processed.":r.errorMessage||"An error occurred while submitting the form."),1),s("div",$t,[s("button",{onClick:e[2]||(e[2]=i=>r.showResultMessage=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," OK ")])])])):C("",!0),r.currentStep>=r.steps.length&&!r.isSubmitting&&!r.showResultMessage?(m(),u("div",Rt,e[6]||(e[6]=[s("h2",{class:"text-2xl font-semibold text-green-600"},"Form Submitted Successfully!",-1)]))):C("",!0)])}const qt=x(Vt,[["render",Kt],["__scopeId","data-v-a6e41147"]]),Qt={components:{MultiStepForm:qt}},zt={class:"app-container"};function Jt(t,e,o,a,r,n){const i=B("MultiStepForm");return m(),u("div",zt,[M(i)])}const es=x(Qt,[["render",Jt]]);export{es as default};
